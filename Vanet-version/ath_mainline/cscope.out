cscope 15 $HOME/kernel/ath_mod               0000723809
	@ath.h

17 #i‚de‡
ATH_H


18 
	#ATH_H


	)

20 
	#CONFIG_ATH_DEBUG


	)

22 
	~<löux/skbuff.h
>

23 
	~<löux/if_ëhî.h
>

24 
	~<löux/•ölock.h
>

25 
	~<√t/mac80211.h
>

35 
	#ATH_KEYMAX
 128

	)

37 c⁄° 
u8
 
	g©h_bˇ°_mac
[
ETH_ALEN
] = {0xff, 0xff, 0xff, 0xff, 0xff, 0xff};

39 
	s©h_™i
 {

40 
boﬁ
 
	mˇld⁄e
;

41 
	ml⁄gˇl_timî
;

42 
	msh‹tˇl_timî
;

43 
	mª£tˇl_timî
;

44 
	mcheck™i_timî
;

45 
timî_li°
 
	mtimî
;

48 
	s©h_cy˛e_cou¡îs
 {

49 
u32
 
	mcy˛es
;

50 
u32
 
	mrx_busy
;

51 
u32
 
	mrx_‰ame
;

52 
u32
 
	mtx_‰ame
;

55 
	e©h_devi˚_°©e
 {

56 
	mATH_HW_UNAVAILABLE
,

57 
	mATH_HW_INITIALIZED
,

60 
	e©h_bus_ty≥
 {

61 
	mATH_PCI
,

62 
	mATH_AHB
,

63 
	mATH_USB
,

66 
	sªg_dmn_∑ú_m≠pög
 {

67 
u16
 
	mªgDmnEnum
;

68 
u16
 
	mªg_5ghz_˘l
;

69 
u16
 
	mªg_2ghz_˘l
;

72 
	s©h_ªguœt‹y
 {

73 
	mÆpha2
[2];

74 
u16
 
	mcou¡ry_code
;

75 
u16
 
	mmax_powî_Àvñ
;

76 
u32
 
	mç_sˇÀ
;

77 
u16
 
	mcuºít_rd
;

78 
u16
 
	mcuºít_rd_ext
;

79 
öt16_t
 
	mpowî_limô
;

80 
ªg_dmn_∑ú_m≠pög
 *
	mªg∑ú
;

83 
	e©h_¸y±_ˇps
 {

84 
	mATH_CRYPT_CAP_CIPHER_AESCCM
 = 
BIT
(0),

85 
	mATH_CRYPT_CAP_MIC_COMBINED
 = 
BIT
(1),

88 
	s©h_keyvÆ
 {

89 
u8
 
	mkv_ty≥
;

90 
u8
 
	mkv_∑d
;

91 
u16
 
	mkv_Àn
;

92 
u8
 
	mkv_vÆ
[16];

93 
u8
 
	mkv_mic
[8];

94 
u8
 
	mkv_txmic
[8];

99 
	e©h_cùhî
 {

100 
	mATH_CIPHER_WEP
 = 0,

101 
	mATH_CIPHER_AES_OCB
 = 1,

102 
	mATH_CIPHER_AES_CCM
 = 2,

103 
	mATH_CIPHER_CKIP
 = 3,

104 
	mATH_CIPHER_TKIP
 = 4,

105 
	mATH_CIPHER_CLR
 = 5,

106 
	mATH_CIPHER_MIC
 = 127

118 
	s©h_›s
 {

119 (*
	mªad
)(*, 
u32
 
	mªg_off£t
);

120 (*
	mmu…i_ªad
)(*, 
u32
 *
	maddr
, u32 *
	mvÆ
, 
u16
 
	mcou¡
);

121 (*
	mwrôe
)(*, 
u32
 
	mvÆ
, u32 
	mªg_off£t
);

122 (*
	míabÀ_wrôe_buf„r
)(*);

123 (*
	mwrôe_Êush
) (*);

124 
u32
 (*
rmw
)(*, u32 
	mªg_off£t
, u32 
	m£t
, u32 
	m˛r
);

127 
	g©h_comm⁄
;

128 
	g©h_bus_›s
;

130 
	s©h_comm⁄
 {

131 *
	mah
;

132 *
	m¥iv
;

133 
õì80211_hw
 *
	mhw
;

134 
	mdebug_mask
;

135 
©h_devi˚_°©e
 
	m°©e
;

137 
©h_™i
 
	m™i
;

139 
u16
 
	mˇchñsz
;

140 
u16
 
	mcuøid
;

141 
u8
 
	mmaˇddr
[
ETH_ALEN
];

142 
u8
 
	mcurbssid
[
ETH_ALEN
];

143 
u8
 
	mbssidmask
[
ETH_ALEN
];

145 
u8
 
	mtx_chaömask
;

146 
u8
 
	mrx_chaömask
;

148 
u32
 
	mrx_bufsize
;

150 
u32
 
	mkeymax
;

151 
DECLARE_BITMAP
(
keym≠
, 
ATH_KEYMAX
);

152 
DECLARE_BITMAP
(
tkù_keym≠
, 
ATH_KEYMAX
);

153 
©h_¸y±_ˇps
 
	m¸y±_ˇps
;

155 
	m˛ockøã
;

157 
•ölock_t
 
	mcc_lock
;

158 
©h_cy˛e_cou¡îs
 
	mcc_™i
;

159 
©h_cy˛e_cou¡îs
 
	mcc_survey
;

161 
©h_ªguœt‹y
 
	mªguœt‹y
;

162 c⁄° 
©h_›s
 *
	m›s
;

163 c⁄° 
©h_bus_›s
 *
	mbus_›s
;

165 
boﬁ
 
	mbtc€x_íabÀd
;

166 
boﬁ
 
	mdißbÀ_™i
;

169 
sk_buff
 *
©h_rxbuf_Æloc
(
©h_comm⁄
 *
comm⁄
,

170 
u32
 
Àn
,

171 
gÂ_t
 
gÂ_mask
);

173 
©h_hw_£tbssidmask
(
©h_comm⁄
 *
comm⁄
);

174 
©h_key_dñëe
(
©h_comm⁄
 *
comm⁄
, 
õì80211_key_c⁄f
 *
key
);

175 
©h_key_c⁄fig
(
©h_comm⁄
 *
comm⁄
,

176 
õì80211_vif
 *
vif
,

177 
õì80211_°a
 *
°a
,

178 
õì80211_key_c⁄f
 *
key
);

179 
boﬁ
 
©h_hw_keyª£t
(
©h_comm⁄
 *
comm⁄
, 
u16
 
íåy
);

180 
©h_hw_cy˛e_cou¡îs_upd©e
(
©h_comm⁄
 *
comm⁄
);

181 
öt32_t
 
©h_hw_gë_li°í_time
(
©h_comm⁄
 *
comm⁄
);

183 
__©åibuã__
 ((
	$f‹m©
 (
¥ötf
, 3, 4))) 

184 
	`©h_¥ötk
(c⁄° *
Àvñ
, 
©h_comm⁄
 *
comm⁄
, c⁄° *
fmt
, ...);

186 
	#©h_emîg
(
comm⁄
, 
fmt
, ...) \

187 
	`©h_¥ötk
(
KERN_EMERG
, 
comm⁄
, 
fmt
, ##
__VA_ARGS__
)

	)

188 
	#©h_Æît
(
comm⁄
, 
fmt
, ...) \

189 
	`©h_¥ötk
(
KERN_ALERT
, 
comm⁄
, 
fmt
, ##
__VA_ARGS__
)

	)

190 
	#©h_¸ô
(
comm⁄
, 
fmt
, ...) \

191 
	`©h_¥ötk
(
KERN_CRIT
, 
comm⁄
, 
fmt
, ##
__VA_ARGS__
)

	)

192 
	#©h_îr
(
comm⁄
, 
fmt
, ...) \

193 
	`©h_¥ötk
(
KERN_ERR
, 
comm⁄
, 
fmt
, ##
__VA_ARGS__
)

	)

194 
	#©h_w¨n
(
comm⁄
, 
fmt
, ...) \

195 
	`©h_¥ötk
(
KERN_WARNING
, 
comm⁄
, 
fmt
, ##
__VA_ARGS__
)

	)

196 
	#©h_nŸi˚
(
comm⁄
, 
fmt
, ...) \

197 
	`©h_¥ötk
(
KERN_NOTICE
, 
comm⁄
, 
fmt
, ##
__VA_ARGS__
)

	)

198 
	#©h_öfo
(
comm⁄
, 
fmt
, ...) \

199 
	`©h_¥ötk
(
KERN_INFO
, 
comm⁄
, 
fmt
, ##
__VA_ARGS__
)

	)

227 
	eATH_DEBUG
 {

228 
ATH_DBG_RESET
 = 0x00000001,

229 
ATH_DBG_QUEUE
 = 0x00000002,

230 
ATH_DBG_EEPROM
 = 0x00000004,

231 
ATH_DBG_CALIBRATE
 = 0x00000008,

232 
ATH_DBG_INTERRUPT
 = 0x00000010,

233 
ATH_DBG_REGULATORY
 = 0x00000020,

234 
ATH_DBG_ANI
 = 0x00000040,

235 
ATH_DBG_XMIT
 = 0x00000080,

236 
ATH_DBG_BEACON
 = 0x00000100,

237 
ATH_DBG_CONFIG
 = 0x00000200,

238 
ATH_DBG_FATAL
 = 0x00000400,

239 
ATH_DBG_PS
 = 0x00000800,

240 
ATH_DBG_HWTIMER
 = 0x00001000,

241 
ATH_DBG_BTCOEX
 = 0x00002000,

242 
ATH_DBG_WMI
 = 0x00004000,

243 
ATH_DBG_BSTUCK
 = 0x00008000,

244 
ATH_DBG_ANY
 = 0xffffffff

247 
	#ATH_DBG_DEFAULT
 (
ATH_DBG_FATAL
)

	)

249 #ifde‡
CONFIG_ATH_DEBUG


251 
	#©h_dbg
(
comm⁄
, 
dbg_mask
, 
fmt
, ...) \

253 
πn
; \

254 i‡((
comm⁄
)->
debug_mask
 & 
dbg_mask
) \

255 
πn
 = 
	`©h_¥ötk
(
KERN_DEBUG
, 
comm⁄
, 
fmt
, \

256 ##
__VA_ARGS__
); \

258 
πn
 = 0; \

260 
πn
; \

261 
	}
})

	)

262 
	#ATH_DBG_WARN
(
foo
, 
¨g
...Ë
	`WARN
(foo,árg)

	)

263 
	#ATH_DBG_WARN_ON_ONCE
(
foo
Ë
	`WARN_ON_ONCE
(foo)

	)

267 
ölöe
 
__©åibuã__
 ((
	$f‹m©
 (
¥ötf
, 3, 4))) 

268 
	$©h_dbg
(
©h_comm⁄
 *
comm⁄
, 
ATH_DEBUG
 
dbg_mask
,

269 c⁄° *
fmt
, ...)

272 
	}
}

273 
	#ATH_DBG_WARN
(
foo
, 
¨g
...Ëdÿ{} 0)

	)

274 
	#ATH_DBG_WARN_ON_ONCE
(
foo
) ({ \

275 
__ªt_w¨n_⁄˚
 = !!(
foo
); \

276 
	`u∆ikñy
(
__ªt_w¨n_⁄˚
); \

277 })

	)

282 #ifde‡
CONFIG_ATH_DEBUG


283 c⁄° *
©h_›mode_to_°rög
(
∆80211_i·y≥
 
›mode
);

285 
ölöe
 c⁄° *
	$©h_›mode_to_°rög
(
∆80211_i·y≥
 
›mode
)

288 
	}
}

	@ath.mod.c

1 
	~<löux/moduÀ.h
>

2 
	~<löux/vîmagic.h
>

3 
	~<löux/compûî.h
>

5 
MODULE_INFO
(
vîmagic
, 
VERMAGIC_STRING
);

7 
moduÀ
 
__this_moduÀ


8 
__©åibuã__
((
£˘i⁄
(".gnu.linkonce.this_module"))) = {

9 .
«me
 = 
KBUILD_MODNAME
,

10 .
	g¨ch
 = 
MODULE_ARCH_INIT
,

13 c⁄° 
modvîsi⁄_öfo
 
	g____vîsi⁄s
[]

14 
__u£d


15 
__©åibuã__
((
£˘i⁄
("__versions"))) = {

27 c⁄° 
	g__moduÀ_dïíds
[]

28 
__u£d


29 
__©åibuã__
((
£˘i⁄
(".modinfo"))) =

	@ath5k/ahb.c

19 
	~<löux/∆80211.h
>

20 
	~<löux/∂©f‹m_devi˚.h
>

21 
	~<löux/ëhîdevi˚.h
>

22 
	~<¨231x_∂©f‹m.h
>

23 
	~"©h5k.h
"

24 
	~"debug.h
"

25 
	~"ba£.h
"

26 
	~"ªg.h
"

29 
	$©h5k_ahb_ªad_ˇchesize
(
©h_comm⁄
 *
comm⁄
, *
csz
)

31 *
csz
 = 
L1_CACHE_BYTES
 >> 2;

32 
	}
}

34 
boﬁ


35 
	$©h5k_ahb_ì¥om_ªad
(
©h_comm⁄
 *
comm⁄
, 
u32
 
off
, 
u16
 *
d©a
)

37 
©h5k_hw
 *
ah
 = 
comm⁄
->
¥iv
;

38 
∂©f‹m_devi˚
 *
pdev
 = 
	`to_∂©f‹m_devi˚
(
ah
->
dev
);

39 
¨231x_bﬂrd_c⁄fig
 *
bcfg
 = 
pdev
->
dev
.
∂©f‹m_d©a
;

40 
u16
 *
ì¥om
, *
ì¥om_íd
;

44 
bcfg
 = 
pdev
->
dev
.
∂©f‹m_d©a
;

45 
ì¥om
 = (
u16
 *Ë
bcfg
->
ødio
;

46 
ì¥om_íd
 = ((*Ë
bcfg
->
c⁄fig
Ë+ 
BOARD_CONFIG_BUFSZ
;

48 
ì¥om
 +
off
;

49 i‡(
ì¥om
 > 
ì¥om_íd
)

50  
Ál£
;

52 *
d©a
 = *
ì¥om
;

53  
åue
;

54 
	}
}

56 
	$©h5k_hw_ªad_§ev
(
©h5k_hw
 *
ah
)

58 
∂©f‹m_devi˚
 *
pdev
 = 
	`to_∂©f‹m_devi˚
(
ah
->
dev
);

59 
¨231x_bﬂrd_c⁄fig
 *
bcfg
 = 
pdev
->
dev
.
∂©f‹m_d©a
;

60 
ah
->
ah_mac_§ev
 = 
bcfg
->
devid
;

62 
	}
}

64 
	$©h5k_ahb_ì¥om_ªad_mac
(
©h5k_hw
 *
ah
, 
u8
 *
mac
)

66 
∂©f‹m_devi˚
 *
pdev
 = 
	`to_∂©f‹m_devi˚
(
ah
->
dev
);

67 
¨231x_bﬂrd_c⁄fig
 *
bcfg
 = 
pdev
->
dev
.
∂©f‹m_d©a
;

68 
u8
 *
cfg_mac
;

70 i‡(
	`to_∂©f‹m_devi˚
(
ah
->
dev
)->
id
 == 0)

71 
cfg_mac
 = 
bcfg
->
c⁄fig
->
wœn0_mac
;

73 
cfg_mac
 = 
bcfg
->
c⁄fig
->
wœn1_mac
;

75 
	`mem˝y
(
mac
, 
cfg_mac
, 
ETH_ALEN
);

77 
	}
}

79 c⁄° 
©h_bus_›s
 
	g©h_ahb_bus_›s
 = {

80 .
©h_bus_ty≥
 = 
ATH_AHB
,

81 .
	gªad_ˇchesize
 = 
©h5k_ahb_ªad_ˇchesize
,

82 .
	gì¥om_ªad
 = 
©h5k_ahb_ì¥om_ªad
,

83 .
	gì¥om_ªad_mac
 = 
©h5k_ahb_ì¥om_ªad_mac
,

87 
	$©h_ahb_¥obe
(
∂©f‹m_devi˚
 *
pdev
)

89 
¨231x_bﬂrd_c⁄fig
 *
bcfg
 = 
pdev
->
dev
.
∂©f‹m_d©a
;

90 
©h5k_hw
 *
ah
;

91 
õì80211_hw
 *
hw
;

92 
ªsour˚
 *
ªs
;

93 
__iomem
 *
mem
;

94 
úq
;

95 
ªt
 = 0;

96 
u32
 
ªg
;

98 i‡(!
pdev
->
dev
.
∂©f‹m_d©a
) {

99 
	`dev_îr
(&
pdev
->
dev
, "noÖlatform data specified\n");

100 
ªt
 = -
EINVAL
;

101 
îr_out
;

104 
ªs
 = 
	`∂©f‹m_gë_ªsour˚
(
pdev
, 
IORESOURCE_MEM
, 0);

105 i‡(
ªs
 =
NULL
) {

106 
	`dev_îr
(&
pdev
->
dev
, "no memoryÑesource found\n");

107 
ªt
 = -
ENXIO
;

108 
îr_out
;

111 
mem
 = 
	`i‹em≠_noˇche
(
ªs
->
°¨t
, 
	`ªsour˚_size
(res));

112 i‡(
mem
 =
NULL
) {

113 
	`dev_îr
(&
pdev
->
dev
, "ioremap failed\n");

114 
ªt
 = -
ENOMEM
;

115 
îr_out
;

118 
ªs
 = 
	`∂©f‹m_gë_ªsour˚
(
pdev
, 
IORESOURCE_IRQ
, 0);

119 i‡(
ªs
 =
NULL
) {

120 
	`dev_îr
(&
pdev
->
dev
, "no IRQÑesource found\n");

121 
ªt
 = -
ENXIO
;

122 
îr_out
;

125 
úq
 = 
ªs
->
°¨t
;

127 
hw
 = 
	`õì80211_Æloc_hw
((
©h5k_hw
), &
©h5k_hw_›s
);

128 i‡(
hw
 =
NULL
) {

129 
	`dev_îr
(&
pdev
->
dev
, "no memory for ieee80211_hw\n");

130 
ªt
 = -
ENOMEM
;

131 
îr_out
;

134 
ah
 = 
hw
->
¥iv
;

135 
ah
->
hw
 = hw;

136 
ah
->
dev
 = &
pdev
->dev;

137 
ah
->
ioba£
 = 
mem
;

138 
ah
->
úq
 = irq;

139 
ah
->
devid
 = 
bcfg
->devid;

141 i‡(
bcfg
->
devid
 >
AR5K_SREV_AR2315_R6
) {

143 
ªg
 = 
	`__øw_ªadl
((
__iomem
 *Ë
AR5K_AR2315_AHB_ARB_CTL
);

144 
ªg
 |
AR5K_AR2315_AHB_ARB_CTL_WLAN
;

145 
	`__øw_wrôñ
(
ªg
, (
__iomem
 *Ë
AR5K_AR2315_AHB_ARB_CTL
);

148 
ªg
 = 
	`__øw_ªadl
((
__iomem
 *Ë
AR5K_AR2315_BYTESWAP
);

149 
ªg
 |
AR5K_AR2315_BYTESWAP_WMAC
;

150 
	`__øw_wrôñ
(
ªg
, (
__iomem
 *Ë
AR5K_AR2315_BYTESWAP
);

154 
ªg
 = 
	`__øw_ªadl
((
__iomem
 *Ë
AR5K_AR5312_ENABLE
);

155 i‡(
	`to_∂©f‹m_devi˚
(
ah
->
dev
)->
id
 == 0)

156 
ªg
 |
AR5K_AR5312_ENABLE_WLAN0
;

158 
ªg
 |
AR5K_AR5312_ENABLE_WLAN1
;

159 
	`__øw_wrôñ
(
ªg
, (
__iomem
 *Ë
AR5K_AR5312_ENABLE
);

166 i‡(
	`to_∂©f‹m_devi˚
(
ah
->
dev
)->
id
 == 0 &&

167 (
bcfg
->
c⁄fig
->
Êags
 & (
BD_WLAN0
 | 
BD_WLAN1
)) ==

168 (
BD_WLAN1
 | 
BD_WLAN0
))

169 
	`__£t_bô
(
ATH_STAT_2G_DISABLED
, 
ah
->
°©us
);

172 
ªt
 = 
	`©h5k_öô_so·c
(
ah
, &
©h_ahb_bus_›s
);

173 i‡(
ªt
 != 0) {

174 
	`dev_îr
(&
pdev
->
dev
, "ÁûedÅÿ©èch devi˚,Éº=%d\n", 
ªt
);

175 
ªt
 = -
ENODEV
;

176 
îr_‰ì_hw
;

179 
	`∂©f‹m_£t_drvd©a
(
pdev
, 
hw
);

183 
îr_‰ì_hw
:

184 
	`õì80211_‰ì_hw
(
hw
);

185 
	`∂©f‹m_£t_drvd©a
(
pdev
, 
NULL
);

186 
îr_out
:

187  
ªt
;

188 
	}
}

190 
	$©h_ahb_ªmove
(
∂©f‹m_devi˚
 *
pdev
)

192 
¨231x_bﬂrd_c⁄fig
 *
bcfg
 = 
pdev
->
dev
.
∂©f‹m_d©a
;

193 
õì80211_hw
 *
hw
 = 
	`∂©f‹m_gë_drvd©a
(
pdev
);

194 
©h5k_hw
 *
ah
;

195 
u32
 
ªg
;

197 i‡(!
hw
)

200 
ah
 = 
hw
->
¥iv
;

202 i‡(
bcfg
->
devid
 >
AR5K_SREV_AR2315_R6
) {

204 
ªg
 = 
	`__øw_ªadl
((
__iomem
 *Ë
AR5K_AR2315_AHB_ARB_CTL
);

205 
ªg
 &~
AR5K_AR2315_AHB_ARB_CTL_WLAN
;

206 
	`__øw_wrôñ
(
ªg
, (
__iomem
 *Ë
AR5K_AR2315_AHB_ARB_CTL
);

209 
ªg
 = 
	`__øw_ªadl
((
__iomem
 *Ë
AR5K_AR5312_ENABLE
);

210 i‡(
	`to_∂©f‹m_devi˚
(
ah
->
dev
)->
id
 == 0)

211 
ªg
 &~
AR5K_AR5312_ENABLE_WLAN0
;

213 
ªg
 &~
AR5K_AR5312_ENABLE_WLAN1
;

214 
	`__øw_wrôñ
(
ªg
, (
__iomem
 *Ë
AR5K_AR5312_ENABLE
);

217 
	`©h5k_deöô_so·c
(
ah
);

218 
	`∂©f‹m_£t_drvd©a
(
pdev
, 
NULL
);

219 
	`õì80211_‰ì_hw
(
hw
);

222 
	}
}

224 
∂©f‹m_drivî
 
	g©h_ahb_drivî
 = {

225 .
¥obe
 = 
©h_ahb_¥obe
,

226 .
	gªmove
 = 
©h_ahb_ªmove
,

227 .
	gdrivî
 = {

228 .
«me
 = "ar231x-wmac",

229 .
	gow√r
 = 
THIS_MODULE
,

233 
__öô


234 
	$©h5k_ahb_öô
()

236  
	`∂©f‹m_drivî_ªgi°î
(&
©h_ahb_drivî
);

237 
	}
}

239 
__exô


240 
	$©h5k_ahb_exô
()

242 
	`∂©f‹m_drivî_uƒegi°î
(&
©h_ahb_drivî
);

243 
	}
}

245 
moduÀ_öô
(
©h5k_ahb_öô
);

246 
moduÀ_exô
(
©h5k_ahb_exô
);

	@ath5k/ani.c

17 
	~"©h5k.h
"

18 
	~"ba£.h
"

19 
	~"ªg.h
"

20 
	~"debug.h
"

21 
	~"™i.h
"

57 
	$©h5k_™i_£t_noi£_immunôy_Àvñ
(
©h5k_hw
 *
ah
, 
Àvñ
)

66 c⁄° 
s8
 
lo
[] = { -52, -56, -60, -64, -70 };

67 c⁄° 
s8
 
hi
[] = { -18, -18, -16, -14, -12 };

68 c⁄° 
s8
 
sz
[] = { -34, -41, -48, -55, -62 };

69 c⁄° 
s8
 
‰
[] = { -70, -72, -75, -78, -80 };

71 c⁄° 
s8
 
lo
[] = { -64, -70 };

72 c⁄° 
s8
 
hi
[] = { -14, -12 };

73 c⁄° 
s8
 
sz
[] = { -55, -62 };

74 c⁄° 
s8
 
‰
[] = { -78, -80 };

76 i‡(
Àvñ
 < 0 ||Üevñ >
	`ARRAY_SIZE
(
sz
)) {

77 
	`ATH5K_ERR
(
ah
, "noise immunityÜevel %d out ofÑange",

78 
Àvñ
);

82 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_DESIRED_SIZE
,

83 
AR5K_PHY_DESIRED_SIZE_TOT
, 
sz
[
Àvñ
]);

84 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_AGCCOARSE
,

85 
AR5K_PHY_AGCCOARSE_LO
, 
lo
[
Àvñ
]);

86 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_AGCCOARSE
,

87 
AR5K_PHY_AGCCOARSE_HI
, 
hi
[
Àvñ
]);

88 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_SIG
,

89 
AR5K_PHY_SIG_FIRPWR
, 
‰
[
Àvñ
]);

91 
ah
->
™i_°©e
.
noi£_imm_Àvñ
 = 
Àvñ
;

92 
	`ATH5K_DBG_UNLIMIT
(
ah
, 
ATH5K_DEBUG_ANI
, "√wÜevñ %d", 
Àvñ
);

93 
	}
}

103 
	$©h5k_™i_£t_•ur_immunôy_Àvñ
(
©h5k_hw
 *
ah
, 
Àvñ
)

105 c⁄° 
vÆ
[] = { 2, 4, 6, 8, 10, 12, 14, 16 };

107 i‡(
Àvñ
 < 0 ||Üevñ >
	`ARRAY_SIZE
(
vÆ
) ||

108 
Àvñ
 > 
ah
->
™i_°©e
.
max_•ur_Àvñ
) {

109 
	`ATH5K_ERR
(
ah
, "spur immunityÜevel %d out ofÑange",

110 
Àvñ
);

114 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_OFDM_SELFCORR
,

115 
AR5K_PHY_OFDM_SELFCORR_CYPWR_THR1
, 
vÆ
[
Àvñ
]);

117 
ah
->
™i_°©e
.
•ur_Àvñ
 = 
Àvñ
;

118 
	`ATH5K_DBG_UNLIMIT
(
ah
, 
ATH5K_DEBUG_ANI
, "√wÜevñ %d", 
Àvñ
);

119 
	}
}

128 
	$©h5k_™i_£t_fú°ï_Àvñ
(
©h5k_hw
 *
ah
, 
Àvñ
)

130 c⁄° 
vÆ
[] = { 0, 4, 8 };

132 i‡(
Àvñ
 < 0 ||Üevñ >
	`ARRAY_SIZE
(
vÆ
)) {

133 
	`ATH5K_ERR
(
ah
, "fú°ïÜevñ %d ouào‡ønge", 
Àvñ
);

137 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_SIG
,

138 
AR5K_PHY_SIG_FIRSTEP
, 
vÆ
[
Àvñ
]);

140 
ah
->
™i_°©e
.
fú°ï_Àvñ
 = 
Àvñ
;

141 
	`ATH5K_DBG_UNLIMIT
(
ah
, 
ATH5K_DEBUG_ANI
, "√wÜevñ %d", 
Àvñ
);

142 
	}
}

152 
	$©h5k_™i_£t_ofdm_wók_sig«l_dëe˘i⁄
(
©h5k_hw
 *
ah
, 
boﬁ
 
⁄
)

154 c⁄° 
m1l
[] = { 127, 50 };

155 c⁄° 
m2l
[] = { 127, 40 };

156 c⁄° 
m1
[] = { 127, 0x4d };

157 c⁄° 
m2
[] = { 127, 0x40 };

158 c⁄° 
m2˙t
[] = { 31, 16 };

159 c⁄° 
m2l˙t
[] = { 63, 48 };

161 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_WEAK_OFDM_LOW_THR
,

162 
AR5K_PHY_WEAK_OFDM_LOW_THR_M1
, 
m1l
[
⁄
]);

163 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_WEAK_OFDM_LOW_THR
,

164 
AR5K_PHY_WEAK_OFDM_LOW_THR_M2
, 
m2l
[
⁄
]);

165 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_WEAK_OFDM_HIGH_THR
,

166 
AR5K_PHY_WEAK_OFDM_HIGH_THR_M1
, 
m1
[
⁄
]);

167 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_WEAK_OFDM_HIGH_THR
,

168 
AR5K_PHY_WEAK_OFDM_HIGH_THR_M2
, 
m2
[
⁄
]);

169 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_WEAK_OFDM_HIGH_THR
,

170 
AR5K_PHY_WEAK_OFDM_HIGH_THR_M2_COUNT
, 
m2˙t
[
⁄
]);

171 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_WEAK_OFDM_LOW_THR
,

172 
AR5K_PHY_WEAK_OFDM_LOW_THR_M2_COUNT
, 
m2l˙t
[
⁄
]);

174 i‡(
⁄
)

175 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_PHY_WEAK_OFDM_LOW_THR
,

176 
AR5K_PHY_WEAK_OFDM_LOW_THR_SELFCOR_EN
);

178 
	`AR5K_REG_DISABLE_BITS
(
ah
, 
AR5K_PHY_WEAK_OFDM_LOW_THR
,

179 
AR5K_PHY_WEAK_OFDM_LOW_THR_SELFCOR_EN
);

181 
ah
->
™i_°©e
.
ofdm_wók_sig
 = 
⁄
;

182 
	`ATH5K_DBG_UNLIMIT
(
ah
, 
ATH5K_DEBUG_ANI
, "turned %s",

183 
⁄
 ? "on" : "off");

184 
	}
}

193 
	$©h5k_™i_£t_cck_wók_sig«l_dëe˘i⁄
(
©h5k_hw
 *
ah
, 
boﬁ
 
⁄
)

195 c⁄° 
vÆ
[] = { 8, 6 };

196 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_CCK_CROSSCORR
,

197 
AR5K_PHY_CCK_CROSSCORR_WEAK_SIG_THR
, 
vÆ
[
⁄
]);

198 
ah
->
™i_°©e
.
cck_wók_sig
 = 
⁄
;

199 
	`ATH5K_DBG_UNLIMIT
(
ah
, 
ATH5K_DEBUG_ANI
, "turned %s",

200 
⁄
 ? "on" : "off");

201 
	}
}

216 
	$©h5k_™i_øi£_immunôy
(
©h5k_hw
 *
ah
, 
©h5k_™i_°©e
 *
as
,

217 
boﬁ
 
ofdm_åiggî
)

219 
rssi
 = 
	`ewma_ªad
(&
ah
->
ah_bóc⁄_rssi_avg
);

221 
	`ATH5K_DBG_UNLIMIT
(
ah
, 
ATH5K_DEBUG_ANI
, "raise immunity (%s)",

222 
ofdm_åiggî
 ? "ODFM" : "CCK");

225 i‡(
as
->
noi£_imm_Àvñ
 < 
ATH5K_ANI_MAX_NOISE_IMM_LVL
) {

226 
	`©h5k_™i_£t_noi£_immunôy_Àvñ
(
ah
, 
as
->
noi£_imm_Àvñ
 + 1);

231 i‡(
ofdm_åiggî
 &&

232 
as
->
•ur_Àvñ
 < 
ah
->
™i_°©e
.
max_•ur_Àvñ
) {

233 
	`©h5k_™i_£t_•ur_immunôy_Àvñ
(
ah
, 
as
->
•ur_Àvñ
 + 1);

238 i‡(
ah
->
›mode
 =
NL80211_IFTYPE_AP
) {

239 i‡(
as
->
fú°ï_Àvñ
 < 
ATH5K_ANI_MAX_FIRSTEP_LVL
)

240 
	`©h5k_™i_£t_fú°ï_Àvñ
(
ah
, 
as
->
fú°ï_Àvñ
 + 1);

250 i‡(
rssi
 > 
ATH5K_ANI_RSSI_THR_HIGH
) {

251 
	`ATH5K_DBG_UNLIMIT
(
ah
, 
ATH5K_DEBUG_ANI
,

255 i‡(
ofdm_åiggî
 && 
as
->
ofdm_wók_sig
 =
åue
) {

256 
	`©h5k_™i_£t_ofdm_wók_sig«l_dëe˘i⁄
(
ah
, 
Ál£
);

257 
	`©h5k_™i_£t_•ur_immunôy_Àvñ
(
ah
, 0);

261 i‡(
as
->
fú°ï_Àvñ
 < 
ATH5K_ANI_MAX_FIRSTEP_LVL
) {

262 
	`©h5k_™i_£t_fú°ï_Àvñ
(
ah
, 
as
->
fú°ï_Àvñ
 + 1);

265 } i‡(
rssi
 > 
ATH5K_ANI_RSSI_THR_LOW
) {

268 
	`ATH5K_DBG_UNLIMIT
(
ah
, 
ATH5K_DEBUG_ANI
,

270 i‡(
ofdm_åiggî
 && 
as
->
ofdm_wók_sig
 =
Ál£
)

271 
	`©h5k_™i_£t_ofdm_wók_sig«l_dëe˘i⁄
(
ah
, 
åue
);

272 i‡(
as
->
fú°ï_Àvñ
 < 
ATH5K_ANI_MAX_FIRSTEP_LVL
)

273 
	`©h5k_™i_£t_fú°ï_Àvñ
(
ah
, 
as
->
fú°ï_Àvñ
 + 1);

275 } i‡(
ah
->
ah_cuºít_ch™√l
->
b™d
 =
IEEE80211_BAND_2GHZ
) {

278 
	`ATH5K_DBG_UNLIMIT
(
ah
, 
ATH5K_DEBUG_ANI
,

280 i‡(
ofdm_åiggî
 && 
as
->
ofdm_wók_sig
 =
åue
)

281 
	`©h5k_™i_£t_ofdm_wók_sig«l_dëe˘i⁄
(
ah
, 
Ál£
);

282 i‡(
as
->
fú°ï_Àvñ
 > 0)

283 
	`©h5k_™i_£t_fú°ï_Àvñ
(
ah
, 0);

292 
	}
}

302 
	$©h5k_™i_lowî_immunôy
(
©h5k_hw
 *
ah
, 
©h5k_™i_°©e
 *
as
)

304 
rssi
 = 
	`ewma_ªad
(&
ah
->
ah_bóc⁄_rssi_avg
);

306 
	`ATH5K_DBG_UNLIMIT
(
ah
, 
ATH5K_DEBUG_ANI
, "lower immunity");

308 i‡(
ah
->
›mode
 =
NL80211_IFTYPE_AP
) {

310 i‡(
as
->
fú°ï_Àvñ
 > 0) {

311 
	`©h5k_™i_£t_fú°ï_Àvñ
(
ah
, 
as
->
fú°ï_Àvñ
 - 1);

316 i‡(
rssi
 > 
ATH5K_ANI_RSSI_THR_HIGH
) {

320 } i‡(
rssi
 > 
ATH5K_ANI_RSSI_THR_LOW
) {

323 i‡(
as
->
ofdm_wók_sig
 =
Ál£
) {

324 
	`©h5k_™i_£t_ofdm_wók_sig«l_dëe˘i⁄
(
ah
,

325 
åue
);

328 i‡(
as
->
fú°ï_Àvñ
 > 0) {

329 
	`©h5k_™i_£t_fú°ï_Àvñ
(
ah
,

330 
as
->
fú°ï_Àvñ
 - 1);

335 i‡(
as
->
fú°ï_Àvñ
 > 0) {

336 
	`©h5k_™i_£t_fú°ï_Àvñ
(
ah
,

337 
as
->
fú°ï_Àvñ
 - 1);

344 i‡(
as
->
•ur_Àvñ
 > 0) {

345 
	`©h5k_™i_£t_•ur_immunôy_Àvñ
(
ah
, 
as
->
•ur_Àvñ
 - 1);

350 i‡(
as
->
noi£_imm_Àvñ
 > 0) {

351 
	`©h5k_™i_£t_noi£_immunôy_Àvñ
(
ah
, 
as
->
noi£_imm_Àvñ
 - 1);

354 
	}
}

365 
	$©h5k_hw_™i_gë_li°í_time
(
©h5k_hw
 *
ah
, 
©h5k_™i_°©e
 *
as
)

367 
©h_comm⁄
 *
comm⁄
 = 
	`©h5k_hw_comm⁄
(
ah
);

368 
li°í
;

370 
	`•ö_lock_bh
(&
comm⁄
->
cc_lock
);

372 
	`©h_hw_cy˛e_cou¡îs_upd©e
(
comm⁄
);

373 
	`mem˝y
(&
as
->
œ°_cc
, &
comm⁄
->
cc_™i
, (as->last_cc));

376 
li°í
 = 
	`©h_hw_gë_li°í_time
(
comm⁄
);

378 
	`•ö_u∆ock_bh
(&
comm⁄
->
cc_lock
);

380  
li°í
;

381 
	}
}

396 
	$©h5k_™i_ßve_™d_˛ór_phy_îr‹s
(
©h5k_hw
 *
ah
,

397 
©h5k_™i_°©e
 *
as
)

399 
ofdm_îr
, 
cck_îr
;

401 i‡(!
ah
->
ah_ˇ∑bûôõs
.
ˇp_has_phyîr_cou¡îs
)

404 
ofdm_îr
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PHYERR_CNT1
);

405 
cck_îr
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PHYERR_CNT2
);

408 
	`©h5k_hw_ªg_wrôe
(
ah
, 
ATH5K_PHYERR_CNT_MAX
 - 
ATH5K_ANI_OFDM_TRIG_HIGH
,

409 
AR5K_PHYERR_CNT1
);

410 
	`©h5k_hw_ªg_wrôe
(
ah
, 
ATH5K_PHYERR_CNT_MAX
 - 
ATH5K_ANI_CCK_TRIG_HIGH
,

411 
AR5K_PHYERR_CNT2
);

413 
ofdm_îr
 = 
ATH5K_ANI_OFDM_TRIG_HIGH
 - (
ATH5K_PHYERR_CNT_MAX
 - ofdm_err);

414 
cck_îr
 = 
ATH5K_ANI_CCK_TRIG_HIGH
 - (
ATH5K_PHYERR_CNT_MAX
 - cck_err);

418 i‡(
ofdm_îr
 <0 && 
cck_îr
 <= 0)

422 i‡(
ofdm_îr
 > 0) {

423 
as
->
ofdm_îr‹s
 +
ofdm_îr
;

424 
as
->
sum_ofdm_îr‹s
 +
ofdm_îr
;

426 i‡(
cck_îr
 > 0) {

427 
as
->
cck_îr‹s
 +
cck_îr
;

428 
as
->
sum_cck_îr‹s
 +
cck_îr
;

431 
	}
}

440 
	$©h5k_™i_≥riod_ª°¨t
(
©h5k_hw
 *
ah
, 
©h5k_™i_°©e
 *
as
)

443 
as
->
œ°_ofdm_îr‹s
 =ás->
ofdm_îr‹s
;

444 
as
->
œ°_cck_îr‹s
 =ás->
cck_îr‹s
;

445 
as
->
œ°_li°í
 =ás->
li°í_time
;

447 
as
->
ofdm_îr‹s
 = 0;

448 
as
->
cck_îr‹s
 = 0;

449 
as
->
li°í_time
 = 0;

450 
	}
}

465 
	$©h5k_™i_ˇlibøti⁄
(
©h5k_hw
 *
ah
)

467 
©h5k_™i_°©e
 *
as
 = &
ah
->
™i_°©e
;

468 
li°í
, 
ofdm_high
, 
ofdm_low
, 
cck_high
, 
cck_low
;

473 
li°í
 = 
	`©h5k_hw_™i_gë_li°í_time
(
ah
, 
as
);

474 
as
->
li°í_time
 +
li°í
;

476 i‡(
as
->
™i_mode
 !
ATH5K_ANI_MODE_AUTO
)

479 
	`©h5k_™i_ßve_™d_˛ór_phy_îr‹s
(
ah
, 
as
);

481 
ofdm_high
 = 
as
->
li°í_time
 * 
ATH5K_ANI_OFDM_TRIG_HIGH
 / 1000;

482 
cck_high
 = 
as
->
li°í_time
 * 
ATH5K_ANI_CCK_TRIG_HIGH
 / 1000;

483 
ofdm_low
 = 
as
->
li°í_time
 * 
ATH5K_ANI_OFDM_TRIG_LOW
 / 1000;

484 
cck_low
 = 
as
->
li°í_time
 * 
ATH5K_ANI_CCK_TRIG_LOW
 / 1000;

486 
	`ATH5K_DBG_UNLIMIT
(
ah
, 
ATH5K_DEBUG_ANI
,

487 "li°í %d (now %d)", 
as
->
li°í_time
, 
li°í
);

488 
	`ATH5K_DBG_UNLIMIT
(
ah
, 
ATH5K_DEBUG_ANI
,

490 
as
->
ofdm_îr‹s
, 
ofdm_high
,ás->
cck_îr‹s
, 
cck_high
);

492 i‡(
as
->
ofdm_îr‹s
 > 
ofdm_high
 ||ás->
cck_îr‹s
 > 
cck_high
) {

494 
boﬁ
 
ofdm_Êag
 = 
as
->
ofdm_îr‹s
 > 
ofdm_high
 ? 
åue
 : 
Ál£
;

495 
	`©h5k_™i_øi£_immunôy
(
ah
, 
as
, 
ofdm_Êag
);

496 
	`©h5k_™i_≥riod_ª°¨t
(
ah
, 
as
);

498 } i‡(
as
->
li°í_time
 > 5 * 
ATH5K_ANI_LISTEN_PERIOD
) {

501 
	`ATH5K_DBG_UNLIMIT
(
ah
, 
ATH5K_DEBUG_ANI
,

503 
as
->
ofdm_îr‹s
, 
ofdm_low
,ás->
cck_îr‹s
, 
cck_low
);

505 i‡(
as
->
ofdm_îr‹s
 <
ofdm_low
 &&ás->
cck_îr‹s
 <
cck_low
)

506 
	`©h5k_™i_lowî_immunôy
(
ah
, 
as
);

508 
	`©h5k_™i_≥riod_ª°¨t
(
ah
, 
as
);

510 
	}
}

526 
	$©h5k_™i_mib_öå
(
©h5k_hw
 *
ah
)

528 
©h5k_™i_°©e
 *
as
 = &
ah
->
™i_°©e
;

532 i‡(!
ah
->
ah_ˇ∑bûôõs
.
ˇp_has_phyîr_cou¡îs
)

536 
	`©h5k_hw_ªg_wrôe
(
ah
, 0, 
AR5K_OFDM_FIL_CNT
);

537 
	`©h5k_hw_ªg_wrôe
(
ah
, 0, 
AR5K_CCK_FIL_CNT
);

539 i‡(
ah
->
™i_°©e
.
™i_mode
 !
ATH5K_ANI_MODE_AUTO
)

545 i‡(
	`©h5k_™i_ßve_™d_˛ór_phy_îr‹s
(
ah
, 
as
) == 0)

548 i‡(
as
->
ofdm_îr‹s
 > 
ATH5K_ANI_OFDM_TRIG_HIGH
 ||

549 
as
->
cck_îr‹s
 > 
ATH5K_ANI_CCK_TRIG_HIGH
)

550 
	`èskÀt_scheduÀ
(&
ah
->
™i_èskÀt
);

551 
	}
}

561 
	$©h5k_™i_phy_îr‹_ªp‹t
(
©h5k_hw
 *
ah
,

562 
©h5k_phy_îr‹_code
 
phyîr
)

564 
©h5k_™i_°©e
 *
as
 = &
ah
->
™i_°©e
;

566 i‡(
phyîr
 =
AR5K_RX_PHY_ERROR_OFDM_TIMING
) {

567 
as
->
ofdm_îr‹s
++;

568 i‡(
as
->
ofdm_îr‹s
 > 
ATH5K_ANI_OFDM_TRIG_HIGH
)

569 
	`èskÀt_scheduÀ
(&
ah
->
™i_èskÀt
);

570 } i‡(
phyîr
 =
AR5K_RX_PHY_ERROR_CCK_TIMING
) {

571 
as
->
cck_îr‹s
++;

572 i‡(
as
->
cck_îr‹s
 > 
ATH5K_ANI_CCK_TRIG_HIGH
)

573 
	`èskÀt_scheduÀ
(&
ah
->
™i_èskÀt
);

575 
	}
}

586 
	$©h5k_íabÀ_phy_îr_cou¡îs
(
©h5k_hw
 *
ah
)

588 
	`©h5k_hw_ªg_wrôe
(
ah
, 
ATH5K_PHYERR_CNT_MAX
 - 
ATH5K_ANI_OFDM_TRIG_HIGH
,

589 
AR5K_PHYERR_CNT1
);

590 
	`©h5k_hw_ªg_wrôe
(
ah
, 
ATH5K_PHYERR_CNT_MAX
 - 
ATH5K_ANI_CCK_TRIG_HIGH
,

591 
AR5K_PHYERR_CNT2
);

592 
	`©h5k_hw_ªg_wrôe
(
ah
, 
AR5K_PHY_ERR_FIL_OFDM
, 
AR5K_PHYERR_CNT1_MASK
);

593 
	`©h5k_hw_ªg_wrôe
(
ah
, 
AR5K_PHY_ERR_FIL_CCK
, 
AR5K_PHYERR_CNT2_MASK
);

596 
	`©h5k_hw_ªg_wrôe
(
ah
, 0, 
AR5K_OFDM_FIL_CNT
);

597 
	`©h5k_hw_ªg_wrôe
(
ah
, 0, 
AR5K_CCK_FIL_CNT
);

598 
	}
}

607 
	$©h5k_dißbÀ_phy_îr_cou¡îs
(
©h5k_hw
 *
ah
)

609 
	`©h5k_hw_ªg_wrôe
(
ah
, 0, 
AR5K_PHYERR_CNT1
);

610 
	`©h5k_hw_ªg_wrôe
(
ah
, 0, 
AR5K_PHYERR_CNT2
);

611 
	`©h5k_hw_ªg_wrôe
(
ah
, 0, 
AR5K_PHYERR_CNT1_MASK
);

612 
	`©h5k_hw_ªg_wrôe
(
ah
, 0, 
AR5K_PHYERR_CNT2_MASK
);

615 
	`©h5k_hw_ªg_wrôe
(
ah
, 0, 
AR5K_OFDM_FIL_CNT
);

616 
	`©h5k_hw_ªg_wrôe
(
ah
, 0, 
AR5K_CCK_FIL_CNT
);

617 
	}
}

627 
	$©h5k_™i_öô
(
©h5k_hw
 *
ah
, 
©h5k_™i_mode
 
mode
)

630 i‡(
ah
->
ah_vîsi⁄
 < 
AR5K_AR5212
)

633 i‡(
mode
 < 
ATH5K_ANI_MODE_OFF
 || modê> 
ATH5K_ANI_MODE_AUTO
) {

634 
	`ATH5K_ERR
(
ah
, "ANI modê%d ouào‡ønge", 
mode
);

639 
	`mem£t
(&
ah
->
™i_°©e
, 0, (ah->ani_state));

642 i‡(
ah
->
ah_mac_§ev
 < 
AR5K_SREV_AR2414
)

643 
ah
->
™i_°©e
.
max_•ur_Àvñ
 = 7;

645 
ah
->
™i_°©e
.
max_•ur_Àvñ
 = 2;

648 i‡(
mode
 =
ATH5K_ANI_MODE_OFF
) {

649 
	`ATH5K_DBG_UNLIMIT
(
ah
, 
ATH5K_DEBUG_ANI
, "ANI off\n");

650 } i‡(
mode
 =
ATH5K_ANI_MODE_MANUAL_LOW
) {

651 
	`ATH5K_DBG_UNLIMIT
(
ah
, 
ATH5K_DEBUG_ANI
,

653 
	`©h5k_™i_£t_noi£_immunôy_Àvñ
(
ah
, 0);

654 
	`©h5k_™i_£t_•ur_immunôy_Àvñ
(
ah
, 0);

655 
	`©h5k_™i_£t_fú°ï_Àvñ
(
ah
, 0);

656 
	`©h5k_™i_£t_ofdm_wók_sig«l_dëe˘i⁄
(
ah
, 
åue
);

657 
	`©h5k_™i_£t_cck_wók_sig«l_dëe˘i⁄
(
ah
, 
åue
);

658 } i‡(
mode
 =
ATH5K_ANI_MODE_MANUAL_HIGH
) {

659 
	`ATH5K_DBG_UNLIMIT
(
ah
, 
ATH5K_DEBUG_ANI
,

661 
	`©h5k_™i_£t_noi£_immunôy_Àvñ
(
ah
,

662 
ATH5K_ANI_MAX_NOISE_IMM_LVL
);

663 
	`©h5k_™i_£t_•ur_immunôy_Àvñ
(
ah
,

664 
ah
->
™i_°©e
.
max_•ur_Àvñ
);

665 
	`©h5k_™i_£t_fú°ï_Àvñ
(
ah
, 
ATH5K_ANI_MAX_FIRSTEP_LVL
);

666 
	`©h5k_™i_£t_ofdm_wók_sig«l_dëe˘i⁄
(
ah
, 
Ál£
);

667 
	`©h5k_™i_£t_cck_wók_sig«l_dëe˘i⁄
(
ah
, 
Ál£
);

668 } i‡(
mode
 =
ATH5K_ANI_MODE_AUTO
) {

669 
	`ATH5K_DBG_UNLIMIT
(
ah
, 
ATH5K_DEBUG_ANI
, "ANIáuto\n");

670 
	`©h5k_™i_£t_noi£_immunôy_Àvñ
(
ah
, 0);

671 
	`©h5k_™i_£t_•ur_immunôy_Àvñ
(
ah
, 0);

672 
	`©h5k_™i_£t_fú°ï_Àvñ
(
ah
, 0);

673 
	`©h5k_™i_£t_ofdm_wók_sig«l_dëe˘i⁄
(
ah
, 
åue
);

674 
	`©h5k_™i_£t_cck_wók_sig«l_dëe˘i⁄
(
ah
, 
Ál£
);

681 i‡(
mode
 =
ATH5K_ANI_MODE_AUTO
) {

682 i‡(
ah
->
ah_ˇ∑bûôõs
.
ˇp_has_phyîr_cou¡îs
)

683 
	`©h5k_íabÀ_phy_îr_cou¡îs
(
ah
);

685 
	`©h5k_hw_£t_rx_fûãr
(
ah
, 
	`©h5k_hw_gë_rx_fûãr
(ah) |

686 
AR5K_RX_FILTER_PHYERR
);

688 i‡(
ah
->
ah_ˇ∑bûôõs
.
ˇp_has_phyîr_cou¡îs
)

689 
	`©h5k_dißbÀ_phy_îr_cou¡îs
(
ah
);

691 
	`©h5k_hw_£t_rx_fûãr
(
ah
, 
	`©h5k_hw_gë_rx_fûãr
(ah) &

692 ~
AR5K_RX_FILTER_PHYERR
);

695 
ah
->
™i_°©e
.
™i_mode
 = 
mode
;

696 
	}
}

701 #ifde‡
CONFIG_ATH5K_DEBUG


704 
	$©h5k_™i_¥öt_cou¡îs
(
©h5k_hw
 *
ah
)

707 
	`¥ötk
(
KERN_NOTICE
 "ACK fail\t%d\n",

708 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_ACK_FAIL
));

709 
	`¥ötk
(
KERN_NOTICE
 "RTS fail\t%d\n",

710 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_RTS_FAIL
));

711 
	`¥ötk
(
KERN_NOTICE
 "RTS success\t%d\n",

712 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_RTS_OK
));

713 
	`¥ötk
(
KERN_NOTICE
 "FCSÉrror\t%d\n",

714 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_FCS_FAIL
));

717 
	`¥ötk
(
KERN_NOTICE
 "tx\t%d\n",

718 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PROFCNT_TX
));

719 
	`¥ötk
(
KERN_NOTICE
 "rx\t%d\n",

720 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PROFCNT_RX
));

721 
	`¥ötk
(
KERN_NOTICE
 "busy\t%d\n",

722 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PROFCNT_RXCLR
));

723 
	`¥ötk
(
KERN_NOTICE
 "cycles\t%d\n",

724 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PROFCNT_CYCLE
));

726 
	`¥ötk
(
KERN_NOTICE
 "AR5K_PHYERR_CNT1\t%d\n",

727 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PHYERR_CNT1
));

728 
	`¥ötk
(
KERN_NOTICE
 "AR5K_PHYERR_CNT2\t%d\n",

729 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PHYERR_CNT2
));

730 
	`¥ötk
(
KERN_NOTICE
 "AR5K_OFDM_FIL_CNT\t%d\n",

731 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_OFDM_FIL_CNT
));

732 
	`¥ötk
(
KERN_NOTICE
 "AR5K_CCK_FIL_CNT\t%d\n",

733 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_CCK_FIL_CNT
));

734 
	}
}

	@ath5k/ani.h

16 #i‚de‡
ANI_H


17 
	#ANI_H


	)

20 
	#ATH5K_ANI_LISTEN_PERIOD
 100

	)

21 
	#ATH5K_ANI_OFDM_TRIG_HIGH
 500

	)

22 
	#ATH5K_ANI_OFDM_TRIG_LOW
 200

	)

23 
	#ATH5K_ANI_CCK_TRIG_HIGH
 200

	)

24 
	#ATH5K_ANI_CCK_TRIG_LOW
 100

	)

27 
	#ATH5K_ANI_RSSI_THR_HIGH
 40

	)

28 
	#ATH5K_ANI_RSSI_THR_LOW
 7

	)

31 
	#ATH5K_ANI_MAX_FIRSTEP_LVL
 2

	)

32 
	#ATH5K_ANI_MAX_NOISE_IMM_LVL
 1

	)

47 
	e©h5k_™i_mode
 {

48 
	mATH5K_ANI_MODE_OFF
 = 0,

49 
	mATH5K_ANI_MODE_MANUAL_LOW
 = 1,

50 
	mATH5K_ANI_MODE_MANUAL_HIGH
 = 2,

51 
	mATH5K_ANI_MODE_AUTO
 = 3

60 
	s©h5k_™i_°©e
 {

61 
©h5k_™i_mode
 
	m™i_mode
;

64 
	mnoi£_imm_Àvñ
;

65 
	m•ur_Àvñ
;

66 
	mfú°ï_Àvñ
;

67 
boﬁ
 
	mofdm_wók_sig
;

68 
boﬁ
 
	mcck_wók_sig
;

70 
	mmax_•ur_Àvñ
;

73 
	mli°í_time
;

74 
	mofdm_îr‹s
;

75 
	mcck_îr‹s
;

78 
©h_cy˛e_cou¡îs
 
	mœ°_cc
;

79 
	mœ°_li°í
;

80 
	mœ°_ofdm_îr‹s
;

81 
	mœ°_cck_îr‹s
;

82 
	msum_ofdm_îr‹s
;

83 
	msum_cck_îr‹s
;

86 
©h5k_™i_öô
(
©h5k_hw
 *
ah
, 
©h5k_™i_mode
 
mode
);

87 
©h5k_™i_mib_öå
(
©h5k_hw
 *
ah
);

88 
©h5k_™i_ˇlibøti⁄
(
©h5k_hw
 *
ah
);

89 
©h5k_™i_phy_îr‹_ªp‹t
(
©h5k_hw
 *
ah
,

90 
©h5k_phy_îr‹_code
 
phyîr
);

93 
©h5k_™i_£t_noi£_immunôy_Àvñ
(
©h5k_hw
 *
ah
, 
Àvñ
);

94 
©h5k_™i_£t_•ur_immunôy_Àvñ
(
©h5k_hw
 *
ah
, 
Àvñ
);

95 
©h5k_™i_£t_fú°ï_Àvñ
(
©h5k_hw
 *
ah
, 
Àvñ
);

96 
©h5k_™i_£t_ofdm_wók_sig«l_dëe˘i⁄
(
©h5k_hw
 *
ah
, 
boﬁ
 
⁄
);

97 
©h5k_™i_£t_cck_wók_sig«l_dëe˘i⁄
(
©h5k_hw
 *
ah
, 
boﬁ
 
⁄
);

99 
©h5k_™i_¥öt_cou¡îs
(
©h5k_hw
 *
ah
);

	@ath5k/ath5k.h

18 #i‚de‡
_ATH5K_H


19 
	#_ATH5K_H


	)

24 
	#CHAN_DEBUG
 1

	)

26 
	#CONFIG_ATH5K_DEBUG
 1

	)

28 
	~<löux/io.h
>

29 
	~<löux/öãºu±.h
>

30 
	~<löux/ty≥s.h
>

31 
	~<löux/avîage.h
>

32 
	~<löux/Àds.h
>

33 
	~<√t/mac80211.h
>

37 
	~"desc.h
"

42 
	~"ì¥om.h
"

43 
	~"debug.h
"

44 
	~"../©h.h
"

45 
	~"™i.h
"

48 
	#PCI_DEVICE_ID_ATHEROS_AR5210
 0x0007

	)

49 
	#PCI_DEVICE_ID_ATHEROS_AR5311
 0x0011

	)

50 
	#PCI_DEVICE_ID_ATHEROS_AR5211
 0x0012

	)

51 
	#PCI_DEVICE_ID_ATHEROS_AR5212
 0x0013

	)

52 
	#PCI_DEVICE_ID_3COM_3CRDAG675
 0x0013

	)

53 
	#PCI_DEVICE_ID_3COM_2_3CRPAG175
 0x0013

	)

54 
	#PCI_DEVICE_ID_ATHEROS_AR5210_AP
 0x0207

	)

55 
	#PCI_DEVICE_ID_ATHEROS_AR5212_IBM
 0x1014

	)

56 
	#PCI_DEVICE_ID_ATHEROS_AR5210_DEFAULT
 0x1107

	)

57 
	#PCI_DEVICE_ID_ATHEROS_AR5212_DEFAULT
 0x1113

	)

58 
	#PCI_DEVICE_ID_ATHEROS_AR5211_DEFAULT
 0x1112

	)

59 
	#PCI_DEVICE_ID_ATHEROS_AR5212_FPGA
 0xf013

	)

60 
	#PCI_DEVICE_ID_ATHEROS_AR5211_LEGACY
 0xff12

	)

61 
	#PCI_DEVICE_ID_ATHEROS_AR5211_FPGA11B
 0xf11b

	)

62 
	#PCI_DEVICE_ID_ATHEROS_AR5312_REV2
 0x0052

	)

63 
	#PCI_DEVICE_ID_ATHEROS_AR5312_REV7
 0x0057

	)

64 
	#PCI_DEVICE_ID_ATHEROS_AR5312_REV8
 0x0058

	)

65 
	#PCI_DEVICE_ID_ATHEROS_AR5212_0014
 0x0014

	)

66 
	#PCI_DEVICE_ID_ATHEROS_AR5212_0015
 0x0015

	)

67 
	#PCI_DEVICE_ID_ATHEROS_AR5212_0016
 0x0016

	)

68 
	#PCI_DEVICE_ID_ATHEROS_AR5212_0017
 0x0017

	)

69 
	#PCI_DEVICE_ID_ATHEROS_AR5212_0018
 0x0018

	)

70 
	#PCI_DEVICE_ID_ATHEROS_AR5212_0019
 0x0019

	)

71 
	#PCI_DEVICE_ID_ATHEROS_AR2413
 0x001®

	)

72 
	#PCI_DEVICE_ID_ATHEROS_AR5413
 0x001b

	)

73 
	#PCI_DEVICE_ID_ATHEROS_AR5424
 0x001¯

	)

74 
	#PCI_DEVICE_ID_ATHEROS_AR5416
 0x0023

	)

75 
	#PCI_DEVICE_ID_ATHEROS_AR5418
 0x0024

	)

81 
	#ATH5K_PRINTF
(
fmt
, ...) \

82 
	`¥ötk
(
KERN_WARNING
 "%s: " 
fmt
, 
__func__
, ##
__VA_ARGS__
)

	)

84 
	#ATH5K_PRINTK
(
_sc
, 
_Àvñ
, 
_fmt
, ...) \

85 
	`¥ötk
(
_Àvñ
 "©h5k %s: " 
_fmt
, \

86 ((
_sc
Ë&& (_sc)->
hw
Ë? 
	`wùhy_«me
((_sc)->hw->
wùhy
) : "", \

87 ##
__VA_ARGS__
)

	)

89 
	#ATH5K_PRINTK_LIMIT
(
_sc
, 
_Àvñ
, 
_fmt
, ...) do { \

90 i‡(
	`√t_øãlimô
()) \

91 
	`ATH5K_PRINTK
(
_sc
, 
_Àvñ
, 
_fmt
, ##
__VA_ARGS__
); \

92 } 0)

	)

94 
	#ATH5K_INFO
(
_sc
, 
_fmt
, ...) \

95 
	`ATH5K_PRINTK
(
_sc
, 
KERN_INFO
, 
_fmt
, ##
__VA_ARGS__
)

	)

97 
	#ATH5K_WARN
(
_sc
, 
_fmt
, ...) \

98 
	`ATH5K_PRINTK_LIMIT
(
_sc
, 
KERN_WARNING
, 
_fmt
, ##
__VA_ARGS__
)

	)

100 
	#ATH5K_ERR
(
_sc
, 
_fmt
, ...) \

101 
	`ATH5K_PRINTK_LIMIT
(
_sc
, 
KERN_ERR
, 
_fmt
, ##
__VA_ARGS__
)

	)

110 
	#AR5K_REG_SM
(
_vÆ
, 
_Êags
) \

111 (((
_vÆ
Ë<< 
_Êags
##
_S
Ë& (_Êags))

	)

114 
	#AR5K_REG_MS
(
_vÆ
, 
_Êags
) \

115 (((
_vÆ
Ë& (
_Êags
)Ë>> _Êags##
_S
)

	)

122 
	#AR5K_REG_WRITE_BITS
(
ah
, 
_ªg
, 
_Êags
, 
_vÆ
) \

123 
	`©h5k_hw_ªg_wrôe
(
ah
, (
	`©h5k_hw_ªg_ªad
◊h, 
_ªg
Ë& ~(
_Êags
)) | \

124 (((
_vÆ
Ë<< 
_Êags
##
_S
Ë& (_Êags)), 
_ªg
)

	)

126 
	#AR5K_REG_MASKED_BITS
(
ah
, 
_ªg
, 
_Êags
, 
_mask
) \

127 
	`©h5k_hw_ªg_wrôe
(
ah
, (
	`©h5k_hw_ªg_ªad
◊h, 
_ªg
) & \

128 (
_mask
)Ë| (
_Êags
), 
_ªg
)

	)

130 
	#AR5K_REG_ENABLE_BITS
(
ah
, 
_ªg
, 
_Êags
) \

131 
	`©h5k_hw_ªg_wrôe
(
ah
, 
	`©h5k_hw_ªg_ªad
◊h, 
_ªg
Ë| (
_Êags
), _ªg)

	)

133 
	#AR5K_REG_DISABLE_BITS
(
ah
, 
_ªg
, 
_Êags
) \

134 
	`©h5k_hw_ªg_wrôe
(
ah
, 
	`©h5k_hw_ªg_ªad
◊h, 
_ªg
Ë& ~(
_Êags
), _ªg)

	)

137 
	#AR5K_PHY_READ
(
ah
, 
_ªg
) \

138 
	`©h5k_hw_ªg_ªad
(
ah
, (ah)->
ah_phy
 + ((
_ªg
Ë<< 2))

	)

140 
	#AR5K_PHY_WRITE
(
ah
, 
_ªg
, 
_vÆ
) \

141 
	`©h5k_hw_ªg_wrôe
(
ah
, 
_vÆ
, (ah)->
ah_phy
 + ((
_ªg
Ë<< 2))

	)

144 
	#AR5K_REG_READ_Q
(
ah
, 
_ªg
, 
_queue
) \

145 (
	`©h5k_hw_ªg_ªad
(
ah
, 
_ªg
Ë& (1 << 
_queue
)) \

146 

	)

147 
	#AR5K_REG_WRITE_Q
(
ah
, 
_ªg
, 
_queue
) \

148 
	`©h5k_hw_ªg_wrôe
(
ah
, (1 << 
_queue
), 
_ªg
)

	)

150 
	#AR5K_Q_ENABLE_BITS
(
_ªg
, 
_queue
) do { \

151 
_ªg
 |1 << 
_queue
; \

152 } 0)

	)

154 
	#AR5K_Q_DISABLE_BITS
(
_ªg
, 
_queue
) do { \

155 
_ªg
 &~(1 << 
_queue
); \

156 } 0)

	)

159 
	#AR5K_REG_WAIT
(
_i
) do { \

160 i‡(
_i
 % 64) \

161 
	`udñay
(1); \

162 } 0)

	)

168 
	#AR5K_TUNE_DMA_BEACON_RESP
 2

	)

169 
	#AR5K_TUNE_SW_BEACON_RESP
 10

	)

170 
	#AR5K_TUNE_ADDITIONAL_SWBA_BACKOFF
 0

	)

171 
	#AR5K_TUNE_RADAR_ALERT
 
Ál£


	)

172 
	#AR5K_TUNE_MIN_TX_FIFO_THRES
 1

	)

173 
	#AR5K_TUNE_MAX_TX_FIFO_THRES
 ((
IEEE80211_MAX_FRAME_LEN
 / 64Ë+ 1)

	)

174 
	#AR5K_TUNE_REGISTER_TIMEOUT
 20000

	)

177 
	#AR5K_TUNE_RSSI_THRES
 129

	)

183 
	#AR5K_TUNE_BMISS_THRES
 7

	)

184 
	#AR5K_TUNE_REGISTER_DWELL_TIME
 20000

	)

185 
	#AR5K_TUNE_BEACON_INTERVAL
 100

	)

186 
	#AR5K_TUNE_AIFS
 2

	)

187 
	#AR5K_TUNE_AIFS_11B
 2

	)

188 
	#AR5K_TUNE_AIFS_XR
 0

	)

189 
	#AR5K_TUNE_CWMIN
 15

	)

190 
	#AR5K_TUNE_CWMIN_11B
 31

	)

191 
	#AR5K_TUNE_CWMIN_XR
 3

	)

192 
	#AR5K_TUNE_CWMAX
 1023

	)

193 
	#AR5K_TUNE_CWMAX_11B
 1023

	)

194 
	#AR5K_TUNE_CWMAX_XR
 7

	)

195 
	#AR5K_TUNE_NOISE_FLOOR
 -72

	)

196 
	#AR5K_TUNE_CCA_MAX_GOOD_VALUE
 -95

	)

197 
	#AR5K_TUNE_MAX_TXPOWER
 63

	)

198 
	#AR5K_TUNE_DEFAULT_TXPOWER
 25

	)

199 
	#AR5K_TUNE_TPC_TXPOWER
 
Ál£


	)

200 
	#ATH5K_TUNE_CALIBRATION_INTERVAL_FULL
 10000

	)

201 
	#ATH5K_TUNE_CALIBRATION_INTERVAL_ANI
 1000

	)

202 
	#ATH5K_TUNE_CALIBRATION_INTERVAL_NF
 60000

	)

204 
	#ATH5K_TX_COMPLETE_POLL_INT
 3000

	)

206 
	#AR5K_INIT_CARR_SENSE_EN
 1

	)

209 #i‡
deföed
(
__BIG_ENDIAN
)

210 
	#AR5K_INIT_CFG
 ( \

211 
AR5K_CFG_SWTD
 | 
AR5K_CFG_SWRD
 \

212 )

	)

214 
	#AR5K_INIT_CFG
 0x00000000

	)

218 
	#AR5K_INIT_CYCRSSI_THR1
 2

	)

221 
	#AR5K_INIT_RETRY_SHORT
 7

	)

222 
	#AR5K_INIT_RETRY_LONG
 4

	)

225 
	#AR5K_INIT_SLOT_TIME_TURBO
 6

	)

226 
	#AR5K_INIT_SLOT_TIME_DEFAULT
 9

	)

227 
	#AR5K_INIT_SLOT_TIME_HALF_RATE
 13

	)

228 
	#AR5K_INIT_SLOT_TIME_QUARTER_RATE
 21

	)

229 
	#AR5K_INIT_SLOT_TIME_B
 20

	)

230 
	#AR5K_SLOT_TIME_MAX
 0xffff

	)

233 
	#AR5K_INIT_SIFS_TURBO
 6

	)

234 
	#AR5K_INIT_SIFS_DEFAULT_BG
 10

	)

235 
	#AR5K_INIT_SIFS_DEFAULT_A
 16

	)

236 
	#AR5K_INIT_SIFS_HALF_RATE
 32

	)

237 
	#AR5K_INIT_SIFS_QUARTER_RATE
 64

	)

242 
	#AR5K_INIT_OFDM_PREAMPLE_TIME
 20

	)

244 
	#AR5K_INIT_OFDM_PREAMBLE_TIME_MIN
 14

	)

245 
	#AR5K_INIT_OFDM_SYMBOL_TIME
 4

	)

246 
	#AR5K_INIT_OFDM_PLCP_BITS
 22

	)

249 
	#AR5K_INIT_RX_LAT_MAX
 63

	)

252 
	#AR5K_INIT_TX_LAT_A
 54

	)

253 
	#AR5K_INIT_TX_LAT_BG
 384

	)

255 
	#AR5K_INIT_TX_LAT_MIN
 32

	)

257 
	#AR5K_INIT_TX_LATENCY_5210
 54

	)

258 
	#AR5K_INIT_RX_LATENCY_5210
 29

	)

261 
	#AR5K_INIT_TXF2TXD_START_DEFAULT
 14

	)

262 
	#AR5K_INIT_TXF2TXD_START_DELAY_10MHZ
 12

	)

263 
	#AR5K_INIT_TXF2TXD_START_DELAY_5MHZ
 13

	)

267 
	#AR5K_SWITCH_SETTLING
 5760

	)

268 
	#AR5K_SWITCH_SETTLING_TURBO
 7168

	)

270 
	#AR5K_AGC_SETTLING
 28

	)

272 
	#AR5K_AGC_SETTLING_TURBO
 37

	)

278 
	e©h5k_vîsi⁄
 {

279 
	mAR5K_AR5210
 = 0,

280 
	mAR5K_AR5211
 = 1,

281 
	mAR5K_AR5212
 = 2,

285 
	e©h5k_ødio
 {

286 
	mAR5K_RF5110
 = 0,

287 
	mAR5K_RF5111
 = 1,

288 
	mAR5K_RF5112
 = 2,

289 
	mAR5K_RF2413
 = 3,

290 
	mAR5K_RF5413
 = 4,

291 
	mAR5K_RF2316
 = 5,

292 
	mAR5K_RF2317
 = 6,

293 
	mAR5K_RF2425
 = 7,

300 
	e©h5k_§ev_ty≥
 {

301 
	mAR5K_VERSION_MAC
,

302 
	mAR5K_VERSION_RAD
,

305 
	s©h5k_§ev_«me
 {

306 c⁄° *
	m§_«me
;

307 
©h5k_§ev_ty≥
 
	m§_ty≥
;

308 
u_öt
 
	m§_vÆ
;

311 
	#AR5K_SREV_UNKNOWN
 0xffff

	)

313 
	#AR5K_SREV_AR5210
 0x00

	)

314 
	#AR5K_SREV_AR5311
 0x10

	)

315 
	#AR5K_SREV_AR5311A
 0x20

	)

316 
	#AR5K_SREV_AR5311B
 0x30

	)

317 
	#AR5K_SREV_AR5211
 0x40

	)

318 
	#AR5K_SREV_AR5212
 0x50

	)

319 
	#AR5K_SREV_AR5312_R2
 0x52

	)

320 
	#AR5K_SREV_AR5212_V4
 0x54

	)

321 
	#AR5K_SREV_AR5213
 0x55

	)

322 
	#AR5K_SREV_AR5312_R7
 0x57

	)

323 
	#AR5K_SREV_AR2313_R8
 0x58

	)

324 
	#AR5K_SREV_AR5213A
 0x59

	)

325 
	#AR5K_SREV_AR2413
 0x78

	)

326 
	#AR5K_SREV_AR2414
 0x70

	)

327 
	#AR5K_SREV_AR2315_R6
 0x86

	)

328 
	#AR5K_SREV_AR2315_R7
 0x87

	)

329 
	#AR5K_SREV_AR5424
 0x90

	)

330 
	#AR5K_SREV_AR2317_R1
 0x90

	)

331 
	#AR5K_SREV_AR2317_R2
 0x91

	)

332 
	#AR5K_SREV_AR5413
 0xa4

	)

333 
	#AR5K_SREV_AR5414
 0xa0

	)

334 
	#AR5K_SREV_AR2415
 0xb0

	)

335 
	#AR5K_SREV_AR5416
 0xc0

	)

336 
	#AR5K_SREV_AR5418
 0xˇ

	)

337 
	#AR5K_SREV_AR2425
 0xe0

	)

338 
	#AR5K_SREV_AR2417
 0xf0

	)

340 
	#AR5K_SREV_RAD_5110
 0x00

	)

341 
	#AR5K_SREV_RAD_5111
 0x10

	)

342 
	#AR5K_SREV_RAD_5111A
 0x15

	)

343 
	#AR5K_SREV_RAD_2111
 0x20

	)

344 
	#AR5K_SREV_RAD_5112
 0x30

	)

345 
	#AR5K_SREV_RAD_5112A
 0x35

	)

346 
	#AR5K_SREV_RAD_5112B
 0x36

	)

347 
	#AR5K_SREV_RAD_2112
 0x40

	)

348 
	#AR5K_SREV_RAD_2112A
 0x45

	)

349 
	#AR5K_SREV_RAD_2112B
 0x46

	)

350 
	#AR5K_SREV_RAD_2413
 0x50

	)

351 
	#AR5K_SREV_RAD_5413
 0x60

	)

352 
	#AR5K_SREV_RAD_2316
 0x70

	)

353 
	#AR5K_SREV_RAD_2317
 0x80

	)

354 
	#AR5K_SREV_RAD_5424
 0xa0

	)

355 
	#AR5K_SREV_RAD_2425
 0xa2

	)

356 
	#AR5K_SREV_RAD_5133
 0xc0

	)

358 
	#AR5K_SREV_PHY_5211
 0x30

	)

359 
	#AR5K_SREV_PHY_5212
 0x41

	)

360 
	#AR5K_SREV_PHY_5212A
 0x42

	)

361 
	#AR5K_SREV_PHY_5212B
 0x43

	)

362 
	#AR5K_SREV_PHY_2413
 0x45

	)

363 
	#AR5K_SREV_PHY_5413
 0x61

	)

364 
	#AR5K_SREV_PHY_2425
 0x70

	)

384 
	#MODULATION_XR
 0x00000200

	)

423 
	#MODULATION_TURBO
 0x00000080

	)

425 
	e©h5k_drivî_mode
 {

426 
	mAR5K_MODE_11A
 = 0,

427 
	mAR5K_MODE_11B
 = 1,

428 
	mAR5K_MODE_11G
 = 2,

429 
	mAR5K_MODE_XR
 = 0,

430 
	mAR5K_MODE_MAX
 = 3

433 
	e©h5k_™t_mode
 {

434 
	mAR5K_ANTMODE_DEFAULT
 = 0,

435 
	mAR5K_ANTMODE_FIXED_A
 = 1,

436 
	mAR5K_ANTMODE_FIXED_B
 = 2,

437 
	mAR5K_ANTMODE_SINGLE_AP
 = 3,

438 
	mAR5K_ANTMODE_SECTOR_AP
 = 4,

439 
	mAR5K_ANTMODE_SECTOR_STA
 = 5,

440 
	mAR5K_ANTMODE_DEBUG
 = 6,

441 
	mAR5K_ANTMODE_MAX
,

444 
	e©h5k_bw_mode
 {

445 
	mAR5K_BWMODE_DEFAULT
 = 0,

446 
	mAR5K_BWMODE_5MHZ
 = 1,

447 
	mAR5K_BWMODE_10MHZ
 = 2,

448 
	mAR5K_BWMODE_40MHZ
 = 3

458 
	s©h5k_tx_°©us
 {

459 
u16
 
	mts_£qnum
;

460 
u16
 
	mts_t°amp
;

461 
u8
 
	mts_°©us
;

462 
u8
 
	mts_föÆ_idx
;

463 
u8
 
	mts_föÆ_ªåy
;

464 
s8
 
	mts_rssi
;

465 
u8
 
	mts_sh‹åëry
;

466 
u8
 
	mts_vútcﬁ
;

467 
u8
 
	mts_™ã¬a
;

470 
	#AR5K_TXSTAT_ALTRATE
 0x80

	)

471 
	#AR5K_TXERR_XRETRY
 0x01

	)

472 
	#AR5K_TXERR_FILT
 0x02

	)

473 
	#AR5K_TXERR_FIFO
 0x04

	)

484 
	e©h5k_tx_queue
 {

485 
	mAR5K_TX_QUEUE_INACTIVE
 = 0,

486 
	mAR5K_TX_QUEUE_DATA
,

487 
	mAR5K_TX_QUEUE_XR_DATA
,

488 
	mAR5K_TX_QUEUE_BEACON
,

489 
	mAR5K_TX_QUEUE_CAB
,

490 
	mAR5K_TX_QUEUE_UAPSD
,

493 
	#AR5K_NUM_TX_QUEUES
 10

	)

494 
	#AR5K_NUM_TX_QUEUES_NOQCU
 2

	)

503 
	e©h5k_tx_queue_subty≥
 {

504 
	mAR5K_WME_AC_BK
 = 0,

505 
	mAR5K_WME_AC_BE
,

506 
	mAR5K_WME_AC_VI
,

507 
	mAR5K_WME_AC_VO
,

516 
	e©h5k_tx_queue_id
 {

517 
	mAR5K_TX_QUEUE_ID_NOQCU_DATA
 = 0,

518 
	mAR5K_TX_QUEUE_ID_NOQCU_BEACON
 = 1,

519 
	mAR5K_TX_QUEUE_ID_DATA_MIN
 = 0,

520 
	mAR5K_TX_QUEUE_ID_DATA_MAX
 = 3,

521 
	mAR5K_TX_QUEUE_ID_DATA_SVP
 = 5,

522 
	mAR5K_TX_QUEUE_ID_CAB
 = 6,

523 
	mAR5K_TX_QUEUE_ID_BEACON
 = 7,

524 
	mAR5K_TX_QUEUE_ID_UAPSD
 = 8,

525 
	mAR5K_TX_QUEUE_ID_XR_DATA
 = 9,

531 
	#AR5K_TXQ_FLAG_TXOKINT_ENABLE
 0x0001

	)

532 
	#AR5K_TXQ_FLAG_TXERRINT_ENABLE
 0x0002

	)

533 
	#AR5K_TXQ_FLAG_TXEOLINT_ENABLE
 0x0004

	)

534 
	#AR5K_TXQ_FLAG_TXDESCINT_ENABLE
 0x0008

	)

535 
	#AR5K_TXQ_FLAG_TXURNINT_ENABLE
 0x0010

	)

536 
	#AR5K_TXQ_FLAG_CBRORNINT_ENABLE
 0x0020

	)

537 
	#AR5K_TXQ_FLAG_CBRURNINT_ENABLE
 0x0040

	)

538 
	#AR5K_TXQ_FLAG_QTRIGINT_ENABLE
 0x0080

	)

539 
	#AR5K_TXQ_FLAG_TXNOFRMINT_ENABLE
 0x0100

	)

540 
	#AR5K_TXQ_FLAG_BACKOFF_DISABLE
 0x0200

	)

541 
	#AR5K_TXQ_FLAG_RDYTIME_EXP_POLICY_ENABLE
 0x0300

	)

542 
	#AR5K_TXQ_FLAG_FRAG_BURST_BACKOFF_ENABLE
 0x0800

	)

543 
	#AR5K_TXQ_FLAG_POST_FR_BKOFF_DIS
 0x1000

	)

544 
	#AR5K_TXQ_FLAG_COMPRESSION_ENABLE
 0x2000

	)

555 
	s©h5k_txq
 {

556 
	mqnum
;

557 
u32
 *
	mlök
;

558 
li°_hód
 
	mq
;

559 
•ölock_t
 
	mlock
;

560 
boﬁ
 
	m£tup
;

561 
	mtxq_Àn
;

562 
	mtxq_max
;

563 
boﬁ
 
	mtxq_pﬁl_m¨k
;

564 
	mtxq_°uck
;

570 
	s©h5k_txq_öfo
 {

571 
©h5k_tx_queue
 
	mtqi_ty≥
;

572 
©h5k_tx_queue_subty≥
 
	mtqi_subty≥
;

573 
u16
 
	mtqi_Êags
;

574 
u8
 
	mtqi_aifs
;

575 
u16
 
	mtqi_cw_mö
;

576 
u16
 
	mtqi_cw_max
;

577 
u32
 
	mtqi_cbr_≥riod
;

578 
u32
 
	mtqi_cbr_ovîÊow_limô
;

579 
u32
 
	mtqi_bur°_time
;

580 
u32
 
	mtqi_ªady_time
;

587 
	e©h5k_pkt_ty≥
 {

588 
	mAR5K_PKT_TYPE_NORMAL
 = 0,

589 
	mAR5K_PKT_TYPE_ATIM
 = 1,

590 
	mAR5K_PKT_TYPE_PSPOLL
 = 2,

591 
	mAR5K_PKT_TYPE_BEACON
 = 3,

592 
	mAR5K_PKT_TYPE_PROBE_RESP
 = 4,

593 
	mAR5K_PKT_TYPE_PIFS
 = 5,

599 
	#AR5K_TXPOWER_OFDM
(
_r
, 
_v
) ( \

600 ((0 & 1Ë<< ((
_v
) + 6)) | \

601 (((
ah
->
ah_txpowî
.
txp_øãs_powî_èbÀ
[(
_r
)]Ë& 0x3fË<< (
_v
)) \

602 )

	)

604 
	#AR5K_TXPOWER_CCK
(
_r
, 
_v
) ( \

605 (
ah
->
ah_txpowî
.
txp_øãs_powî_èbÀ
[(
_r
)] & 0x3fË<< (
_v
) \

606 )

	)

611 
	e©h5k_dmasize
 {

612 
	mAR5K_DMASIZE_4B
 = 0,

613 
	mAR5K_DMASIZE_8B
,

614 
	mAR5K_DMASIZE_16B
,

615 
	mAR5K_DMASIZE_32B
,

616 
	mAR5K_DMASIZE_64B
,

617 
	mAR5K_DMASIZE_128B
,

618 
	mAR5K_DMASIZE_256B
,

619 
	mAR5K_DMASIZE_512B


630 
	s©h5k_rx_°©us
 {

631 
u16
 
	mrs_d©Æí
;

632 
u16
 
	mrs_t°amp
;

633 
u8
 
	mrs_°©us
;

634 
u8
 
	mrs_phyîr
;

635 
s8
 
	mrs_rssi
;

636 
u8
 
	mrs_keyix
;

637 
u8
 
	mrs_øã
;

638 
u8
 
	mrs_™ã¬a
;

639 
u8
 
	mrs_m‹e
;

642 
	#AR5K_RXERR_CRC
 0x01

	)

643 
	#AR5K_RXERR_PHY
 0x02

	)

644 
	#AR5K_RXERR_FIFO
 0x04

	)

645 
	#AR5K_RXERR_DECRYPT
 0x08

	)

646 
	#AR5K_RXERR_MIC
 0x10

	)

647 
	#AR5K_RXKEYIX_INVALID
 ((
u8
Ë-1)

	)

648 
	#AR5K_TXKEYIX_INVALID
 ((
u32
Ë-1)

	)

655 
	#AR5K_BEACON_PERIOD
 0x0000ffff

	)

656 
	#AR5K_BEACON_ENA
 0x00800000

	)

657 
	#AR5K_BEACON_RESET_TSF
 0x01000000

	)

667 
	#TSF_TO_TU
(
_tsf
Ë(
u32
)((_tsfË>> 10)

	)

674 
	e©h5k_rfgaö
 {

675 
	mAR5K_RFGAIN_INACTIVE
 = 0,

676 
	mAR5K_RFGAIN_ACTIVE
,

677 
	mAR5K_RFGAIN_READ_REQUESTED
,

678 
	mAR5K_RFGAIN_NEED_CHANGE
,

681 
	s©h5k_gaö
 {

682 
u8
 
	mg_°ï_idx
;

683 
u8
 
	mg_cuºít
;

684 
u8
 
	mg_èrgë
;

685 
u8
 
	mg_low
;

686 
u8
 
	mg_high
;

687 
u8
 
	mg_f_c‹r
;

688 
u8
 
	mg_°©e
;

695 
	#AR5K_SLOT_TIME_9
 396

	)

696 
	#AR5K_SLOT_TIME_20
 880

	)

697 
	#AR5K_SLOT_TIME_MAX
 0xffff

	)

700 
	#CHANNEL_CW_INT
 0x0008

	)

701 
	#CHANNEL_CCK
 0x0020

	)

702 
	#CHANNEL_OFDM
 0x0040

	)

703 
	#CHANNEL_2GHZ
 0x0080

	)

704 
	#CHANNEL_5GHZ
 0x0100

	)

705 
	#CHANNEL_PASSIVE
 0x0200

	)

706 
	#CHANNEL_DYN
 0x0400

	)

707 
	#CHANNEL_XR
 0x0800

	)

709 
	#CHANNEL_A
 (
CHANNEL_5GHZ
 | 
CHANNEL_OFDM
)

	)

710 
	#CHANNEL_B
 (
CHANNEL_2GHZ
 | 
CHANNEL_CCK
)

	)

711 
	#CHANNEL_G
 (
CHANNEL_2GHZ
 | 
CHANNEL_OFDM
)

	)

712 
	#CHANNEL_X
 (
CHANNEL_5GHZ
 | 
CHANNEL_OFDM
 | 
CHANNEL_XR
)

	)

714 
	#CHANNEL_ALL
 (
CHANNEL_OFDM
 | 
CHANNEL_CCK
 | \

715 
CHANNEL_2GHZ
 | 
CHANNEL_5GHZ
)

	)

717 
	#CHANNEL_MODES
 
CHANNEL_ALL


	)

723 
	#IS_CHAN_XR
(
_c
Ë((_c->
hw_vÆue
 & 
CHANNEL_XR
Ë!0)

	)

724 
	#IS_CHAN_B
(
_c
Ë((_c->
hw_vÆue
 & 
CHANNEL_B
Ë!0)

	)

731 
	s©h5k_©hch™_2ghz
 {

732 
u32
 
	ma2_Êags
;

733 
u16
 
	ma2_©hch™
;

769 
	#AR5K_MAX_RATES
 32

	)

772 
	#ATH5K_RATE_CODE_1M
 0x1B

	)

773 
	#ATH5K_RATE_CODE_2M
 0x1A

	)

774 
	#ATH5K_RATE_CODE_5_5M
 0x19

	)

775 
	#ATH5K_RATE_CODE_11M
 0x18

	)

777 
	#ATH5K_RATE_CODE_6M
 0x0B

	)

778 
	#ATH5K_RATE_CODE_9M
 0x0F

	)

779 
	#ATH5K_RATE_CODE_12M
 0x0A

	)

780 
	#ATH5K_RATE_CODE_18M
 0x0E

	)

781 
	#ATH5K_RATE_CODE_24M
 0x09

	)

782 
	#ATH5K_RATE_CODE_36M
 0x0D

	)

783 
	#ATH5K_RATE_CODE_48M
 0x08

	)

784 
	#ATH5K_RATE_CODE_54M
 0x0C

	)

786 
	#ATH5K_RATE_CODE_XR_500K
 0x07

	)

787 
	#ATH5K_RATE_CODE_XR_1M
 0x02

	)

788 
	#ATH5K_RATE_CODE_XR_2M
 0x06

	)

789 
	#ATH5K_RATE_CODE_XR_3M
 0x01

	)

792 
	#AR5K_SET_SHORT_PREAMBLE
 0x04

	)

798 
	#AR5K_KEYCACHE_SIZE
 8

	)

799 
©h5k_mod∑øm_nohw¸y±
;

808 
	#AR5K_RSSI_EP_MULTIPLIER
 (1 << 7)

	)

810 
	#AR5K_ASSERT_ENTRY
(
_e
, 
_s
) do { \

811 i‡(
_e
 >
_s
) \

812  
Ál£
; \

813 } 0)

	)

871 
	e©h5k_öt
 {

872 
	mAR5K_INT_RXOK
 = 0x00000001,

873 
	mAR5K_INT_RXDESC
 = 0x00000002,

874 
	mAR5K_INT_RXERR
 = 0x00000004,

875 
	mAR5K_INT_RXNOFRM
 = 0x00000008,

876 
	mAR5K_INT_RXEOL
 = 0x00000010,

877 
	mAR5K_INT_RXORN
 = 0x00000020,

878 
	mAR5K_INT_TXOK
 = 0x00000040,

879 
	mAR5K_INT_TXDESC
 = 0x00000080,

880 
	mAR5K_INT_TXERR
 = 0x00000100,

881 
	mAR5K_INT_TXNOFRM
 = 0x00000200,

882 
	mAR5K_INT_TXEOL
 = 0x00000400,

883 
	mAR5K_INT_TXURN
 = 0x00000800,

884 
	mAR5K_INT_MIB
 = 0x00001000,

885 
	mAR5K_INT_SWI
 = 0x00002000,

886 
	mAR5K_INT_RXPHY
 = 0x00004000,

887 
	mAR5K_INT_RXKCM
 = 0x00008000,

888 
	mAR5K_INT_SWBA
 = 0x00010000,

889 
	mAR5K_INT_BRSSI
 = 0x00020000,

890 
	mAR5K_INT_BMISS
 = 0x00040000,

891 
	mAR5K_INT_FATAL
 = 0x00080000,

892 
	mAR5K_INT_BNR
 = 0x00100000,

893 
	mAR5K_INT_TIM
 = 0x00200000,

894 
	mAR5K_INT_DTIM
 = 0x00400000,

895 
	mAR5K_INT_DTIM_SYNC
 = 0x00800000,

896 
	mAR5K_INT_GPIO
 = 0x01000000,

897 
	mAR5K_INT_BCN_TIMEOUT
 = 0x02000000,

898 
	mAR5K_INT_CAB_TIMEOUT
 = 0x04000000,

899 
	mAR5K_INT_RX_DOPPLER
 = 0x08000000,

900 
	mAR5K_INT_QCBRORN
 = 0x10000000,

901 
	mAR5K_INT_QCBRURN
 = 0x20000000,

902 
	mAR5K_INT_QTRIG
 = 0x40000000,

903 
	mAR5K_INT_GLOBAL
 = 0x80000000,

905 
	mAR5K_INT_TX_ALL
 = 
AR5K_INT_TXOK


906 | 
AR5K_INT_TXDESC


907 | 
AR5K_INT_TXERR


908 | 
AR5K_INT_TXEOL


909 | 
AR5K_INT_TXURN
,

911 
	mAR5K_INT_RX_ALL
 = 
AR5K_INT_RXOK


912 | 
AR5K_INT_RXDESC


913 | 
AR5K_INT_RXERR


914 | 
AR5K_INT_RXNOFRM


915 | 
AR5K_INT_RXEOL


916 | 
AR5K_INT_RXORN
,

918 
	mAR5K_INT_COMMON
 = 
AR5K_INT_RXOK


919 | 
AR5K_INT_RXDESC


920 | 
AR5K_INT_RXERR


921 | 
AR5K_INT_RXNOFRM


922 | 
AR5K_INT_RXEOL


923 | 
AR5K_INT_RXORN


924 | 
AR5K_INT_TXOK


925 | 
AR5K_INT_TXDESC


926 | 
AR5K_INT_TXERR


927 | 
AR5K_INT_TXNOFRM


928 | 
AR5K_INT_TXEOL


929 | 
AR5K_INT_TXURN


930 | 
AR5K_INT_MIB


931 | 
AR5K_INT_SWI


932 | 
AR5K_INT_RXPHY


933 | 
AR5K_INT_RXKCM


934 | 
AR5K_INT_SWBA


935 | 
AR5K_INT_BRSSI


936 | 
AR5K_INT_BMISS


937 | 
AR5K_INT_GPIO


938 | 
AR5K_INT_GLOBAL
,

940 
	mAR5K_INT_NOCARD
 = 0xffffffff

944 
	e©h5k_ˇlibøti⁄_mask
 {

945 
	mAR5K_CALIBRATION_FULL
 = 0x01,

946 
	mAR5K_CALIBRATION_SHORT
 = 0x02,

947 
	mAR5K_CALIBRATION_ANI
 = 0x04,

953 
	e©h5k_powî_mode
 {

954 
	mAR5K_PM_UNDEFINED
 = 0,

955 
	mAR5K_PM_AUTO
,

956 
	mAR5K_PM_AWAKE
,

957 
	mAR5K_PM_FULL_SLEEP
,

958 
	mAR5K_PM_NETWORK_SLEEP
,

966 
	#AR5K_LED_INIT
 0

	)

967 
	#AR5K_LED_SCAN
 1

	)

968 
	#AR5K_LED_AUTH
 2

	)

969 
	#AR5K_LED_ASSOC
 3

	)

970 
	#AR5K_LED_RUN
 4

	)

973 
	#AR5K_SOFTLED_PIN
 0

	)

974 
	#AR5K_SOFTLED_ON
 0

	)

975 
	#AR5K_SOFTLED_OFF
 1

	)

979 
	s©h5k_ˇ∑bûôõs
 {

984 
DECLARE_BITMAP
(
ˇp_mode
, 
AR5K_MODE_MAX
);

990 
u16
 
	mønge_2ghz_mö
;

991 
u16
 
	mønge_2ghz_max
;

992 
u16
 
	mønge_5ghz_mö
;

993 
u16
 
	mønge_5ghz_max
;

994 } 
	mˇp_ønge
;

999 
©h5k_ì¥om_öfo
 
	mˇp_ì¥om
;

1005 
u8
 
	mq_tx_num
;

1006 } 
	mˇp_queues
;

1008 
boﬁ
 
	mˇp_has_phyîr_cou¡îs
;

1012 
	#ATH5K_NF_CAL_HIST_MAX
 8

	)

1013 
	s©h5k_nfˇl_hi°
 {

1014 
s16
 
	mödex
;

1015 
s16
 
	mnfvÆ
[
ATH5K_NF_CAL_HIST_MAX
];

1023 
	s©h5k_avg_vÆ
 {

1024 
	mavg
;

1025 
	mavg_weight
;

1028 
	#ATH5K_LED_MAX_NAME_LEN
 31

	)

1033 
	s©h5k_Àd
 {

1034 
	m«me
[
ATH5K_LED_MAX_NAME_LEN
 + 1];

1035 
©h5k_hw
 *
	mah
;

1036 
Àd_˛assdev
 
	mÀd_dev
;

1040 
	s©h5k_rfkûl
 {

1042 
u16
 
	mgpio
;

1044 
boﬁ
 
	mpﬁ¨ôy
;

1046 
èskÀt_°ru˘
 
	mtoggÀq
;

1050 
	s©h5k_°©i°ics
 {

1052 
	m™ã¬a_rx
[5];

1053 
	m™ã¬a_tx
[5];

1056 
	mrx_Æl_cou¡
;

1057 
	mtx_Æl_cou¡
;

1058 
	mrx_byãs_cou¡
;

1061 
	mtx_byãs_cou¡
;

1065 
	mrxîr_¸c
;

1066 
	mrxîr_phy
;

1067 
	mrxîr_phy_code
[32];

1068 
	mrxîr_fifo
;

1069 
	mrxîr_de¸y±
;

1070 
	mrxîr_mic
;

1071 
	mrxîr_¥oc
;

1072 
	mrxîr_jumbo
;

1073 
	mtxîr_ªåy
;

1074 
	mtxîr_fifo
;

1075 
	mtxîr_fût
;

1078 
	mack_Áû
;

1079 
	mπs_Áû
;

1080 
	mπs_ok
;

1081 
	mfcs_îr‹
;

1082 
	mbóc⁄s
;

1084 
	mmib_öå
;

1085 
	mrx‹n_öå
;

1086 
	mrxeﬁ_öå
;

1093 
	#AR5K_MAX_GPIO
 10

	)

1094 
	#AR5K_MAX_RF_BANKS
 8

	)

1096 #i‡
CHAN_DEBUG


1097 
	#ATH_CHAN_MAX
 (26 + 26 + 26 + 200 + 200)

	)

1099 
	#ATH_CHAN_MAX
 (14 + 14 + 14 + 252 + 20)

	)

1102 
	#ATH_RXBUF
 40

	)

1103 
	#ATH_TXBUF
 200

	)

1104 
	#ATH_BCBUF
 4

	)

1105 
	#ATH5K_TXQ_LEN_MAX
 (
ATH_TXBUF
 / 4Ë

	)

1106 
	#ATH5K_TXQ_LEN_LOW
 (
ATH5K_TXQ_LEN_MAX
 / 2Ë

	)

1109 
	s©h5k_hw
 {

1110 
©h_comm⁄
 
	mcomm⁄
;

1112 
pci_dev
 *
	mpdev
;

1113 
devi˚
 *
	mdev
;

1114 
	múq
;

1115 
u16
 
	mdevid
;

1116 
__iomem
 *
	mioba£
;

1117 
muãx
 
	mlock
;

1118 
õì80211_hw
 *
	mhw
;

1119 
õì80211_suµ‹ãd_b™d
 
	msb™ds
[
IEEE80211_NUM_BANDS
];

1120 
õì80211_ch™√l
 
	mch™√ls
[
ATH_CHAN_MAX
];

1121 
õì80211_øã
 
	møãs
[
IEEE80211_NUM_BANDS
][
AR5K_MAX_RATES
];

1122 
s8
 
	møã_idx
[
IEEE80211_NUM_BANDS
][
AR5K_MAX_RATES
];

1123 
∆80211_i·y≥
 
	m›mode
;

1125 #ifde‡
CONFIG_ATH5K_DEBUG


1126 
©h5k_dbg_öfo
 
	mdebug
;

1129 
©h5k_buf
 *
	mbuÂå
;

1130 
©h5k_desc
 *
	mdesc
;

1131 
dma_addr_t
 
	mdesc_daddr
;

1132 
size_t
 
	mdesc_Àn
;

1134 
DECLARE_BITMAP
(
°©us
, 6);

1135 
	#ATH_STAT_INVALID
 0

	)

1136 
	#ATH_STAT_MRRETRY
 1

	)

1137 
	#ATH_STAT_PROMISC
 2

	)

1138 
	#ATH_STAT_LEDSOFT
 3

	)

1139 
	#ATH_STAT_STARTED
 4

	)

1140 
	#ATH_STAT_2G_DISABLED
 5

	)

1142 
	mfûãr_Êags
;

1143 
õì80211_ch™√l
 *
	mcurch™
;

1145 
u16
 
	mnvifs
;

1147 
©h5k_öt
 
	mimask
;

1149 
•ölock_t
 
	múqlock
;

1150 
boﬁ
 
	mrx_≥ndög
;

1151 
boﬁ
 
	mtx_≥ndög
;

1153 
u8
 
	mŒaddr
[
ETH_ALEN
];

1154 
u8
 
	mbssidmask
[
ETH_ALEN
];

1156 
	mÀd_pö
,

1157 
	mÀd_⁄
;

1159 
w‹k_°ru˘
 
	mª£t_w‹k
;

1161 
	mrxbufsize
;

1162 
li°_hód
 
	mrxbuf
;

1163 
•ölock_t
 
	mrxbuÊock
;

1164 
u32
 *
	mrxlök
;

1165 
èskÀt_°ru˘
 
	mrxtq
;

1166 
©h5k_Àd
 
	mrx_Àd
;

1168 
li°_hód
 
	mtxbuf
;

1169 
•ölock_t
 
	mtxbuÊock
;

1170 
	mtxbuf_Àn
;

1171 
©h5k_txq
 
	mtxqs
[
AR5K_NUM_TX_QUEUES
];

1172 
èskÀt_°ru˘
 
	mtxtq
;

1173 
©h5k_Àd
 
	mtx_Àd
;

1175 
©h5k_rfkûl
 
	mrf_kûl
;

1177 
èskÀt_°ru˘
 
	mˇlib
;

1179 
•ölock_t
 
	mblock
;

1180 
èskÀt_°ru˘
 
	mbóc⁄tq
;

1181 
li°_hód
 
	mbcbuf
;

1182 
õì80211_vif
 *
	mb¶Ÿ
[
ATH_BCBUF
];

1183 
u16
 
	mnum_≠_vifs
;

1184 
u16
 
	mnum_adhoc_vifs
;

1185 
	mbhÆq
,

1186 
	mbmisscou¡
,

1187 
	mbötvÆ
,

1188 
	mb£¡
;

1189 
	m√xâbâ
;

1190 
©h5k_txq
 *
	mˇbq
;

1192 
	mpowî_Àvñ
;

1193 
boﬁ
 
	massoc
;

1194 
boﬁ
 
	míabÀ_bóc⁄
;

1196 
©h5k_°©i°ics
 
	m°©s
;

1198 
©h5k_™i_°©e
 
	m™i_°©e
;

1199 
èskÀt_°ru˘
 
	m™i_èskÀt
;

1201 
dñayed_w‹k
 
	mtx_com∂ëe_w‹k
;

1203 
survey_öfo
 
	msurvey
;

1205 
©h5k_öt
 
	mah_imr
;

1207 
õì80211_ch™√l
 *
	mah_cuºít_ch™√l
;

1208 
boﬁ
 
	mah_ˇlibøti⁄
;

1209 
boﬁ
 
	mah_sögÀ_chù
;

1211 
©h5k_vîsi⁄
 
	mah_vîsi⁄
;

1212 
©h5k_ødio
 
	mah_ødio
;

1213 
u32
 
	mah_phy
;

1214 
u32
 
	mah_mac_§ev
;

1215 
u16
 
	mah_mac_vîsi⁄
;

1216 
u16
 
	mah_mac_ªvisi⁄
;

1217 
u16
 
	mah_phy_ªvisi⁄
;

1218 
u16
 
	mah_ødio_5ghz_ªvisi⁄
;

1219 
u16
 
	mah_ødio_2ghz_ªvisi⁄
;

1221 
	#ah_modes
 
ah_ˇ∑bûôõs
.
ˇp_mode


	)

1222 
	#ah_ì_vîsi⁄
 
ah_ˇ∑bûôõs
.
ˇp_ì¥om
.
ì_vîsi⁄


	)

1224 
u8
 
	mah_ªåy_l⁄g
;

1225 
u8
 
	mah_ªåy_sh‹t
;

1227 
u32
 
	mah_u£_32khz_˛ock
;

1229 
u8
 
	mah_covîage_˛ass
;

1230 
boﬁ
 
	mah_ack_bôøã_high
;

1231 
u8
 
	mah_bwmode
;

1232 
boﬁ
 
	mah_sh‹t_¶Ÿ
;

1235 
u32
 
	mah_™t_˘l
[
AR5K_EEPROM_N_MODES
][
AR5K_ANT_MAX
];

1236 
u8
 
	mah_™t_mode
;

1237 
u8
 
	mah_tx_™t
;

1238 
u8
 
	mah_def_™t
;

1240 
©h5k_ˇ∑bûôõs
 
	mah_ˇ∑bûôõs
;

1242 
©h5k_txq_öfo
 
	mah_txq
[
AR5K_NUM_TX_QUEUES
];

1243 
u32
 
	mah_txq_°©us
;

1244 
u32
 
	mah_txq_imr_txok
;

1245 
u32
 
	mah_txq_imr_txîr
;

1246 
u32
 
	mah_txq_imr_txu∫
;

1247 
u32
 
	mah_txq_imr_txdesc
;

1248 
u32
 
	mah_txq_imr_txeﬁ
;

1249 
u32
 
	mah_txq_imr_cbr‹n
;

1250 
u32
 
	mah_txq_imr_cbru∫
;

1251 
u32
 
	mah_txq_imr_qåig
;

1252 
u32
 
	mah_txq_imr_no‰m
;

1253 
u32
 
	mah_txq_i§
;

1254 
u32
 *
	mah_rf_b™ks
;

1255 
size_t
 
	mah_rf_b™ks_size
;

1256 
size_t
 
	mah_rf_ªgs_cou¡
;

1257 
©h5k_gaö
 
	mah_gaö
;

1258 
u8
 
	mah_off£t
[
AR5K_MAX_RF_BANKS
];

1263 
u8
 
	mtmpL
[
AR5K_EEPROM_N_PD_GAINS
]

1264 [
AR5K_EEPROM_POWER_TABLE_SIZE
];

1265 
u8
 
	mtmpR
[
AR5K_EEPROM_N_PD_GAINS
]

1266 [
AR5K_EEPROM_POWER_TABLE_SIZE
];

1267 
u8
 
	mtxp_pd_èbÀ
[
AR5K_EEPROM_POWER_TABLE_SIZE
 * 2];

1268 
u16
 
	mtxp_øãs_powî_èbÀ
[
AR5K_MAX_RATES
];

1269 
u8
 
	mtxp_mö_idx
;

1270 
boﬁ
 
	mtxp_çc
;

1272 
s16
 
	mtxp_mö_pwr
;

1273 
s16
 
	mtxp_max_pwr
;

1274 
s16
 
	mtxp_cur_pwr
;

1276 
s16
 
	mtxp_off£t
;

1277 
s16
 
	mtxp_ofdm
;

1278 
s16
 
	mtxp_cck_ofdm_gaöf_dñè
;

1280 
s16
 
	mtxp_cck_ofdm_pwr_dñè
;

1281 
boﬁ
 
	mtxp_£tup
;

1282 } 
	mah_txpowî
;

1285 
boﬁ
 
	mr_íabÀd
;

1286 
	mr_œ°_Æît
;

1287 
õì80211_ch™√l
 
	mr_œ°_ch™√l
;

1288 } 
	mah_ød¨
;

1290 
©h5k_nfˇl_hi°
 
	mah_nfˇl_hi°
;

1293 
ewma
 
	mah_bóc⁄_rssi_avg
;

1296 
s32
 
	mah_noi£_Êo‹
;

1299 
	mah_ˇl_√xt_fuŒ
;

1300 
	mah_ˇl_√xt_™i
;

1301 
	mah_ˇl_√xt_nf
;

1304 
u8
 
	mah_ˇl_mask
;

1309 (*
	mah_£tup_tx_desc
)(
	m©h5k_hw
 *, 
	m©h5k_desc
 *,

1310 , , , 
	m©h5k_pkt_ty≥
,

1313 (*
	mah_¥oc_tx_desc
)(
	m©h5k_hw
 *, 
	m©h5k_desc
 *,

1314 
	m©h5k_tx_°©us
 *);

1315 (*
	mah_¥oc_rx_desc
)(
	m©h5k_hw
 *, 
	m©h5k_desc
 *,

1316 
	m©h5k_rx_°©us
 *);

1319 
	s©h_bus_›s
 {

1320 
©h_bus_ty≥
 
	m©h_bus_ty≥
;

1321 (*
	mªad_ˇchesize
)(
©h_comm⁄
 *
	mcomm⁄
, *
	mcsz
);

1322 
boﬁ
 (*
ì¥om_ªad
)(
©h_comm⁄
 *
	mcomm⁄
, 
u32
 
	moff
, 
u16
 *
	md©a
);

1323 (*
	mì¥om_ªad_mac
)(
©h5k_hw
 *
	mah
, 
u8
 *
	mmac
);

1329 c⁄° 
õì80211_›s
 
©h5k_hw_›s
;

1332 
©h5k_öô_so·c
(
©h5k_hw
 *
ah
, c⁄° 
©h_bus_›s
 *
bus_›s
);

1333 
©h5k_deöô_so·c
(
©h5k_hw
 *
ah
);

1334 
©h5k_hw_öô
(
©h5k_hw
 *
ah
);

1335 
©h5k_hw_deöô
(
©h5k_hw
 *
ah
);

1337 
©h5k_sysfs_ªgi°î
(
©h5k_hw
 *
ah
);

1338 
©h5k_sysfs_uƒegi°î
(
©h5k_hw
 *
ah
);

1341 
	g©h5k_buf
;

1342 
	g©h5k_txq
;

1344 
©h5k_£t_bóc⁄_fûãr
(
õì80211_hw
 *
hw
, 
boﬁ
 
íabÀ
);

1345 
boﬁ
 
©h5k_™y_vif_assoc
(
©h5k_hw
 *
ah
);

1346 
©h5k_tx_queue
(
õì80211_hw
 *
hw
, 
sk_buff
 *
skb
,

1347 
©h5k_txq
 *
txq
);

1348 
©h5k_°¨t
(
õì80211_hw
 *
hw
);

1349 
©h5k_°›
(
õì80211_hw
 *
hw
);

1350 
©h5k_mode_£tup
(
©h5k_hw
 *
ah
, 
õì80211_vif
 *
vif
);

1351 
©h5k_upd©e_bssid_mask_™d_›mode
(
©h5k_hw
 *
ah
,

1352 
õì80211_vif
 *
vif
);

1353 
©h5k_ch™_£t
(
©h5k_hw
 *
ah
, 
õì80211_ch™√l
 *
ch™
);

1354 
©h5k_bóc⁄_upd©e_timîs
(
©h5k_hw
 *
ah
, 
u64
 
bc_tsf
);

1355 
©h5k_bóc⁄_upd©e
(
õì80211_hw
 *
hw
, 
õì80211_vif
 *
vif
);

1356 
©h5k_bóc⁄_c⁄fig
(
©h5k_hw
 *
ah
);

1357 
©h5k_txbuf_‰ì_skb
(
©h5k_hw
 *
ah
, 
©h5k_buf
 *
bf
);

1358 
©h5k_rxbuf_‰ì_skb
(
©h5k_hw
 *
ah
, 
©h5k_buf
 *
bf
);

1361 c⁄° *
©h5k_chù_«me
(
©h5k_§ev_ty≥
 
ty≥
, 
u_öt16_t
 
vÆ
);

1362 
©h5k_hw_ªad_§ev
(
©h5k_hw
 *
ah
);

1365 
©h5k_öô_Àds
(
©h5k_hw
 *
ah
);

1366 
©h5k_Àd_íabÀ
(
©h5k_hw
 *
ah
);

1367 
©h5k_Àd_off
(
©h5k_hw
 *
ah
);

1368 
©h5k_uƒegi°î_Àds
(
©h5k_hw
 *
ah
);

1372 
©h5k_hw_nic_wakeup
(
©h5k_hw
 *
ah
, 
Êags
, 
boﬁ
 
öôül
);

1373 
©h5k_hw_⁄_hﬁd
(
©h5k_hw
 *
ah
);

1374 
©h5k_hw_ª£t
(
©h5k_hw
 *
ah
, 
∆80211_i·y≥
 
›_mode
,

1375 
õì80211_ch™√l
 *
ch™√l
, 
boﬁ
 
Á°
, boﬁ 
skù_pcu
);

1376 
©h5k_hw_ªgi°î_timeout
(
©h5k_hw
 *
ah
, 
u32
 
ªg
, u32 
Êag
, u32 
vÆ
,

1377 
boﬁ
 
is_£t
);

1382 
©h5k_hw_hto˛ock
(
©h5k_hw
 *
ah
, 
u£c
);

1383 
©h5k_hw_˛ocktoh
(
©h5k_hw
 *
ah
, 
˛ock
);

1384 
©h5k_hw_£t_˛ockøã
(
©h5k_hw
 *
ah
);

1388 
©h5k_hw_°¨t_rx_dma
(
©h5k_hw
 *
ah
);

1389 
u32
 
©h5k_hw_gë_rxdp
(
©h5k_hw
 *
ah
);

1390 
©h5k_hw_£t_rxdp
(
©h5k_hw
 *
ah
, 
u32
 
phys_addr
);

1391 
©h5k_hw_°¨t_tx_dma
(
©h5k_hw
 *
ah
, 
queue
);

1392 
©h5k_hw_°›_bóc⁄_queue
(
©h5k_hw
 *
ah
, 
queue
);

1393 
u32
 
©h5k_hw_gë_txdp
(
©h5k_hw
 *
ah
, 
queue
);

1394 
©h5k_hw_£t_txdp
(
©h5k_hw
 *
ah
, 
queue
,

1395 
u32
 
phys_addr
);

1396 
©h5k_hw_upd©e_tx_åigÀvñ
(
©h5k_hw
 *
ah
, 
boﬁ
 
ö¸ó£
);

1398 
boﬁ
 
©h5k_hw_is_öå_≥ndög
(
©h5k_hw
 *
ah
);

1399 
©h5k_hw_gë_i§
(
©h5k_hw
 *
ah
, 
©h5k_öt
 *
öãºu±_mask
);

1400 
©h5k_öt
 
©h5k_hw_£t_imr
(
©h5k_hw
 *
ah
, ©h5k_öà
√w_mask
);

1401 
©h5k_hw_upd©e_mib_cou¡îs
(
©h5k_hw
 *
ah
);

1403 
©h5k_hw_dma_öô
(
©h5k_hw
 *
ah
);

1404 
©h5k_hw_dma_°›
(
©h5k_hw
 *
ah
);

1407 
©h5k_ì¥om_öô
(
©h5k_hw
 *
ah
);

1408 
©h5k_ì¥om_dëach
(
©h5k_hw
 *
ah
);

1413 
©h5k_hw_gë_‰ame_duøti⁄
(
©h5k_hw
 *
ah
,

1414 
Àn
, 
õì80211_øã
 *
øã
, 
boﬁ
 
sh‹çª
);

1415 
©h5k_hw_gë_deÁu…_¶Ÿtime
(
©h5k_hw
 *
ah
);

1416 
©h5k_hw_gë_deÁu…_sifs
(
©h5k_hw
 *
ah
);

1417 
©h5k_hw_£t_›mode
(
©h5k_hw
 *
ah
, 
∆80211_i·y≥
 
›mode
);

1418 
©h5k_hw_£t_covîage_˛ass
(
©h5k_hw
 *
ah
, 
u8
 
covîage_˛ass
);

1420 
©h5k_hw_£t_Œaddr
(
©h5k_hw
 *
ah
, c⁄° 
u8
 *
mac
);

1421 
©h5k_hw_£t_bssid
(
©h5k_hw
 *
ah
);

1422 
©h5k_hw_£t_bssid_mask
(
©h5k_hw
 *
ah
, c⁄° 
u8
 *
mask
);

1423 
©h5k_hw_£t_mˇ°_fûãr
(
©h5k_hw
 *
ah
, 
u32
 
fûãr0
, u32 
fûãr1
);

1424 
u32
 
©h5k_hw_gë_rx_fûãr
(
©h5k_hw
 *
ah
);

1425 
©h5k_hw_£t_rx_fûãr
(
©h5k_hw
 *
ah
, 
u32
 
fûãr
);

1427 
©h5k_hw_°¨t_rx_pcu
(
©h5k_hw
 *
ah
);

1428 
©h5k_hw_°›_rx_pcu
(
©h5k_hw
 *
ah
);

1430 
u64
 
©h5k_hw_gë_tsf64
(
©h5k_hw
 *
ah
);

1431 
©h5k_hw_£t_tsf64
(
©h5k_hw
 *
ah
, 
u64
 
tsf64
);

1432 
©h5k_hw_ª£t_tsf
(
©h5k_hw
 *
ah
);

1433 
©h5k_hw_öô_bóc⁄
(
©h5k_hw
 *
ah
, 
u32
 
√xt_bóc⁄
, u32 
öãrvÆ
);

1434 
boﬁ
 
©h5k_hw_check_bóc⁄_timîs
(
©h5k_hw
 *
ah
, 
ötvÆ
);

1436 
©h5k_hw_pcu_öô
(
©h5k_hw
 *
ah
, 
∆80211_i·y≥
 
›_mode
,

1437 
u8
 
mode
);

1440 
©h5k_hw_gë_tx_queuïr›s
(
©h5k_hw
 *
ah
, 
queue
,

1441 
©h5k_txq_öfo
 *
queue_öfo
);

1442 
©h5k_hw_£t_tx_queuïr›s
(
©h5k_hw
 *
ah
, 
queue
,

1443 c⁄° 
©h5k_txq_öfo
 *
queue_öfo
);

1444 
©h5k_hw_£tup_tx_queue
(
©h5k_hw
 *
ah
,

1445 
©h5k_tx_queue
 
queue_ty≥
,

1446 
©h5k_txq_öfo
 *
queue_öfo
);

1447 
©h5k_hw_£t_tx_ªåy_limôs
(
©h5k_hw
 *
ah
,

1448 
queue
);

1449 
u32
 
©h5k_hw_num_tx_≥ndög
(
©h5k_hw
 *
ah
, 
queue
);

1450 
©h5k_hw_ªÀa£_tx_queue
(
©h5k_hw
 *
ah
, 
queue
);

1451 
©h5k_hw_ª£t_tx_queue
(
©h5k_hw
 *
ah
, 
queue
);

1452 
©h5k_hw_£t_ifs_öãrvÆs
(
©h5k_hw
 *
ah
, 
¶Ÿ_time
);

1454 
©h5k_hw_öô_queues
(
©h5k_hw
 *
ah
);

1457 
©h5k_hw_öô_desc_fun˘i⁄s
(
©h5k_hw
 *
ah
);

1458 
©h5k_hw_£tup_rx_desc
(
©h5k_hw
 *
ah
, 
©h5k_desc
 *
desc
,

1459 
u32
 
size
, 
Êags
);

1460 
©h5k_hw_£tup_mº_tx_desc
(
©h5k_hw
 *
ah
, 
©h5k_desc
 *
desc
,

1461 
tx_øã1
, 
u_öt
 
tx_åõs1
, u_öà
tx_øã2
,

1462 
u_öt
 
tx_åõs2
, 
tx_øã3
, u_öà
tx_åõs3
);

1466 
©h5k_hw_£t_Àd°©e
(
©h5k_hw
 *
ah
, 
°©e
);

1467 
©h5k_hw_£t_gpio_öput
(
©h5k_hw
 *
ah
, 
u32
 
gpio
);

1468 
©h5k_hw_£t_gpio_ouçut
(
©h5k_hw
 *
ah
, 
u32
 
gpio
);

1469 
u32
 
©h5k_hw_gë_gpio
(
©h5k_hw
 *
ah
, u32 
gpio
);

1470 
©h5k_hw_£t_gpio
(
©h5k_hw
 *
ah
, 
u32
 
gpio
, u32 
vÆ
);

1471 
©h5k_hw_£t_gpio_öå
(
©h5k_hw
 *
ah
, 
gpio
,

1472 
u32
 
öãºu±_Àvñ
);

1476 
©h5k_rfkûl_hw_°¨t
(
©h5k_hw
 *
ah
);

1477 
©h5k_rfkûl_hw_°›
(
©h5k_hw
 *
ah
);

1481 
©h5k_hw_£t_ˇ∑bûôõs
(
©h5k_hw
 *
ah
);

1482 
©h5k_hw_íabÀ_p•ﬁl
(
©h5k_hw
 *
ah
, 
u8
 *
bssid
, 
u16
 
assoc_id
);

1483 
©h5k_hw_dißbÀ_p•ﬁl
(
©h5k_hw
 *
ah
);

1487 
©h5k_hw_wrôe_öôvÆs
(
©h5k_hw
 *
ah
, 
u8
 
mode
, 
boﬁ
 
ch™ge_ch™√l
);

1492 
u16
 
©h5k_hw_ødio_ªvisi⁄
(
©h5k_hw
 *
ah
, 
ch™
);

1493 
©h5k_hw_phy_dißbÀ
(
©h5k_hw
 *
ah
);

1495 
©h5k_rfgaö
 
©h5k_hw_gaöf_ˇlibøã
(
©h5k_hw
 *
ah
);

1496 
©h5k_hw_rfgaö_›t_öô
(
©h5k_hw
 *
ah
);

1498 
boﬁ
 
©h5k_ch™√l_ok
(
©h5k_hw
 *
ah
, 
u16
 
‰eq
, 
Êags
);

1500 
©h5k_hw_öô_nfˇl_hi°
(
©h5k_hw
 *
ah
);

1501 
©h5k_hw_phy_ˇlibøã
(
©h5k_hw
 *
ah
,

1502 
õì80211_ch™√l
 *
ch™√l
);

1503 
©h5k_hw_upd©e_noi£_Êo‹
(
©h5k_hw
 *
ah
);

1505 
boﬁ
 
©h5k_hw_ch™_has_•ur_noi£
(
©h5k_hw
 *
ah
,

1506 
õì80211_ch™√l
 *
ch™√l
);

1508 
©h5k_hw_£t_™ã¬a_mode
(
©h5k_hw
 *
ah
, 
u8
 
™t_mode
);

1509 
©h5k_hw_£t_™ã¬a_swôch
(
©h5k_hw
 *
ah
, 
u8
 
ì_mode
);

1511 
©h5k_hw_£t_txpowî_limô
(
©h5k_hw
 *
ah
, 
u8
 
txpowî
);

1513 
©h5k_hw_phy_öô
(
©h5k_hw
 *
ah
, 
õì80211_ch™√l
 *
ch™√l
,

1514 
u8
 
mode
, 
boﬁ
 
Á°
);

1520 
ölöe
 
©h_comm⁄
 *
	$©h5k_hw_comm⁄
(
©h5k_hw
 *
ah
)

1522  &
ah
->
comm⁄
;

1523 
	}
}

1525 
ölöe
 
©h_ªguœt‹y
 *
	$©h5k_hw_ªguœt‹y
(
©h5k_hw
 *
ah
)

1527  &(
	`©h5k_hw_comm⁄
(
ah
)->
ªguœt‹y
);

1528 
	}
}

1530 #ifde‡
CONFIG_ATHEROS_AR231X


1531 
	#AR5K_AR2315_PCI_BASE
 ((
__iomem
 *)0xb0100000)

	)

1533 
ölöe
 
__iomem
 *
	$©h5k_ahb_ªg
(
©h5k_hw
 *
ah
, 
u16
 
ªg
)

1537 i‡(
	`u∆ikñy
((
ªg
 >= 0x4000) && (reg < 0x5000) &&

1538 (
ah
->
ah_mac_§ev
 >
AR5K_SREV_AR2315_R6
)))

1539  
AR5K_AR2315_PCI_BASE
 + 
ªg
;

1541  
ah
->
ioba£
 + 
ªg
;

1542 
	}
}

1544 
ölöe
 
u32
 
	$©h5k_hw_ªg_ªad
(
©h5k_hw
 *
ah
, 
u16
 
ªg
)

1546  
	`__øw_ªadl
(
	`©h5k_ahb_ªg
(
ah
, 
ªg
));

1547 
	}
}

1549 
ölöe
 
	$©h5k_hw_ªg_wrôe
(
©h5k_hw
 *
ah
, 
u32
 
vÆ
, 
u16
 
ªg
)

1551 
	`__øw_wrôñ
(
vÆ
, 
	`©h5k_ahb_ªg
(
ah
, 
ªg
));

1552 
	}
}

1556 
ölöe
 
u32
 
	$©h5k_hw_ªg_ªad
(
©h5k_hw
 *
ah
, 
u16
 
ªg
)

1558  
	`i‹ód32
(
ah
->
ioba£
 + 
ªg
);

1559 
	}
}

1561 
ölöe
 
	$©h5k_hw_ªg_wrôe
(
©h5k_hw
 *
ah
, 
u32
 
vÆ
, 
u16
 
ªg
)

1563 
	`iowrôe32
(
vÆ
, 
ah
->
ioba£
 + 
ªg
);

1564 
	}
}

1568 
ölöe
 
©h_bus_ty≥
 
	$©h5k_gë_bus_ty≥
(
©h5k_hw
 *
ah
)

1570  
	`©h5k_hw_comm⁄
(
ah
)->
bus_›s
->
©h_bus_ty≥
;

1571 
	}
}

1573 
ölöe
 
	$©h5k_ªad_ˇchesize
(
©h_comm⁄
 *
comm⁄
, *
csz
)

1575 
comm⁄
->
bus_›s
->
	`ªad_ˇchesize
(comm⁄, 
csz
);

1576 
	}
}

1578 
ölöe
 
boﬁ
 
	$©h5k_hw_nvøm_ªad
(
©h5k_hw
 *
ah
, 
u32
 
off
, 
u16
 *
d©a
)

1580 
©h_comm⁄
 *
comm⁄
 = 
	`©h5k_hw_comm⁄
(
ah
);

1581  
comm⁄
->
bus_›s
->
	`ì¥om_ªad
(comm⁄, 
off
, 
d©a
);

1582 
	}
}

1584 
ölöe
 
u32
 
	$©h5k_hw_bôsw≠
(
u32
 
vÆ
, 
bôs
)

1586 
u32
 
ªtvÆ
 = 0, 
bô
, 
i
;

1588 
i
 = 0; i < 
bôs
; i++) {

1589 
bô
 = (
vÆ
 >> 
i
) & 1;

1590 
ªtvÆ
 = (ªtvÆ << 1Ë| 
bô
;

1593  
ªtvÆ
;

1594 
	}
}

	@ath5k/ath5k.mod.c

1 
	~<löux/moduÀ.h
>

2 
	~<löux/vîmagic.h
>

3 
	~<löux/compûî.h
>

5 
MODULE_INFO
(
vîmagic
, 
VERMAGIC_STRING
);

7 
moduÀ
 
__this_moduÀ


8 
__©åibuã__
((
£˘i⁄
(".gnu.linkonce.this_module"))) = {

9 .
«me
 = 
KBUILD_MODNAME
,

10 .
	göô
 = 
öô_moduÀ
,

11 #ifde‡
CONFIG_MODULE_UNLOAD


12 .
	gexô
 = 
˛ónup_moduÀ
,

14 .
	g¨ch
 = 
MODULE_ARCH_INIT
,

17 c⁄° 
modvîsi⁄_öfo
 
	g____vîsi⁄s
[]

18 
__u£d


19 
__©åibuã__
((
£˘i⁄
("__versions"))) = {

151 c⁄° 
	g__moduÀ_dïíds
[]

152 
__u£d


153 
__©åibuã__
((
£˘i⁄
(".modinfo"))) =

156 
MODULE_ALIAS
("pci:v0000168Cd00000207sv*sd*bc*sc*i*");

157 
MODULE_ALIAS
("pci:v0000168Cd00000007sv*sd*bc*sc*i*");

158 
MODULE_ALIAS
("pci:v0000168Cd00000011sv*sd*bc*sc*i*");

159 
MODULE_ALIAS
("pci:v0000168Cd00000012sv*sd*bc*sc*i*");

160 
MODULE_ALIAS
("pci:v0000168Cd00000013sv*sd*bc*sc*i*");

161 
MODULE_ALIAS
("pci:v0000A727d00000013sv*sd*bc*sc*i*");

162 
MODULE_ALIAS
("pci:v000010B7d00000013sv*sd*bc*sc*i*");

163 
MODULE_ALIAS
("pci:v0000168Cd00001014sv*sd*bc*sc*i*");

164 
MODULE_ALIAS
("pci:v0000168Cd00000014sv*sd*bc*sc*i*");

165 
MODULE_ALIAS
("pci:v0000168Cd00000015sv*sd*bc*sc*i*");

166 
MODULE_ALIAS
("pci:v0000168Cd00000016sv*sd*bc*sc*i*");

167 
MODULE_ALIAS
("pci:v0000168Cd00000017sv*sd*bc*sc*i*");

168 
MODULE_ALIAS
("pci:v0000168Cd00000018sv*sd*bc*sc*i*");

169 
MODULE_ALIAS
("pci:v0000168Cd00000019sv*sd*bc*sc*i*");

170 
MODULE_ALIAS
("pci:v0000168Cd0000001Asv*sd*bc*sc*i*");

171 
MODULE_ALIAS
("pci:v0000168Cd0000001Bsv*sd*bc*sc*i*");

172 
MODULE_ALIAS
("pci:v0000168Cd0000001Csv*sd*bc*sc*i*");

173 
MODULE_ALIAS
("pci:v0000168Cd0000001Dsv*sd*bc*sc*i*");

	@ath5k/attach.c

23 
	~<löux/pci.h
>

24 
	~<löux/¶ab.h
>

25 
	~"©h5k.h
"

26 
	~"ªg.h
"

27 
	~"debug.h
"

28 
	~"ba£.h
"

35 
	$©h5k_hw_po°
(
©h5k_hw
 *
ah
)

38 c⁄° 
u32
 
°©ic_∑âîn
[4] = {

42 c⁄° 
u16
 
ªgs
[2] = { 
AR5K_STA_ID0
, 
	`AR5K_PHY
(8) };

43 
i
, 
c
;

44 
u16
 
cur_ªg
;

45 
u32
 
v¨_∑âîn
;

46 
u32
 
öô_vÆ
;

47 
u32
 
cur_vÆ
;

49 
c
 = 0; c < 2; c++) {

51 
cur_ªg
 = 
ªgs
[
c
];

54 
öô_vÆ
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
cur_ªg
);

56 
i
 = 0; i < 256; i++) {

57 
v¨_∑âîn
 = 
i
 << 16 | i;

58 
	`©h5k_hw_ªg_wrôe
(
ah
, 
v¨_∑âîn
, 
cur_ªg
);

59 
cur_vÆ
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
cur_ªg
);

61 i‡(
cur_vÆ
 !
v¨_∑âîn
) {

62 
	`ATH5K_ERR
(
ah
, "POST Failed !!!\n");

63  -
EAGAIN
;

67 
v¨_∑âîn
 = 0x0039080f;

68 
	`©h5k_hw_ªg_wrôe
(
ah
, 
v¨_∑âîn
, 
cur_ªg
);

71 
i
 = 0; i < 4; i++) {

72 
v¨_∑âîn
 = 
°©ic_∑âîn
[
i
];

73 
	`©h5k_hw_ªg_wrôe
(
ah
, 
v¨_∑âîn
, 
cur_ªg
);

74 
cur_vÆ
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
cur_ªg
);

76 i‡(
cur_vÆ
 !
v¨_∑âîn
) {

77 
	`ATH5K_ERR
(
ah
, "POST Failed !!!\n");

78  -
EAGAIN
;

82 
v¨_∑âîn
 = 0x003b080f;

83 
	`©h5k_hw_ªg_wrôe
(
ah
, 
v¨_∑âîn
, 
cur_ªg
);

87 
	`©h5k_hw_ªg_wrôe
(
ah
, 
öô_vÆ
, 
cur_ªg
);

93 
	}
}

105 
	$©h5k_hw_öô
(
©h5k_hw
 *
ah
)

107 c⁄° 
u8
 
zîo_mac
[
ETH_ALEN
] = { };

108 
©h_comm⁄
 *
comm⁄
 = 
	`©h5k_hw_comm⁄
(
ah
);

109 
pci_dev
 *
pdev
 = 
ah
->pdev;

110 
©h5k_ì¥om_öfo
 *
ì
;

111 
ªt
;

112 
u32
 
§ev
;

117 
ah
->
ah_ød¨
.
r_íabÀd
 = 
AR5K_TUNE_RADAR_ALERT
;

118 
ah
->
ah_bwmode
 = 
AR5K_BWMODE_DEFAULT
;

119 
ah
->
ah_txpowî
.
txp_çc
 = 
AR5K_TUNE_TPC_TXPOWER
;

120 
ah
->
ah_imr
 = 0;

121 
ah
->
ah_ªåy_sh‹t
 = 
AR5K_INIT_RETRY_SHORT
;

122 
ah
->
ah_ªåy_l⁄g
 = 
AR5K_INIT_RETRY_LONG
;

123 
ah
->
ah_™t_mode
 = 
AR5K_ANTMODE_DEFAULT
;

124 
ah
->
ah_noi£_Êo‹
 = -95;

125 
ah
->
™i_°©e
.
™i_mode
 = 
ATH5K_ANI_MODE_AUTO
;

126 
ah
->
ah_cuºít_ch™√l
 = &ah->
ch™√ls
[0];

131 
	`©h5k_hw_ªad_§ev
(
ah
);

132 
§ev
 = 
ah
->
ah_mac_§ev
;

133 i‡(
§ev
 < 
AR5K_SREV_AR5311
)

134 
ah
->
ah_vîsi⁄
 = 
AR5K_AR5210
;

135 i‡(
§ev
 < 
AR5K_SREV_AR5212
)

136 
ah
->
ah_vîsi⁄
 = 
AR5K_AR5211
;

138 
ah
->
ah_vîsi⁄
 = 
AR5K_AR5212
;

141 
ah
->
ah_mac_vîsi⁄
 = 
	`AR5K_REG_MS
(
§ev
, 
AR5K_SREV_VER
);

142 
ah
->
ah_mac_ªvisi⁄
 = 
	`AR5K_REG_MS
(
§ev
, 
AR5K_SREV_REV
);

145 
ªt
 = 
	`©h5k_hw_öô_desc_fun˘i⁄s
(
ah
);

146 i‡(
ªt
)

147 
îr
;

150 
ªt
 = 
	`©h5k_hw_nic_wakeup
(
ah
, 0, 
åue
);

151 i‡(
ªt
)

152 
îr
;

155 
ah
->
ah_phy_ªvisi⁄
 = 
	`©h5k_hw_ªg_ªad
◊h, 
AR5K_PHY_CHIP_ID
) &

157 
ah
->
ah_ødio_5ghz_ªvisi⁄
 = 
	`©h5k_hw_ødio_ªvisi⁄
(ah,

158 
CHANNEL_5GHZ
);

159 
ah
->
ah_phy
 = 
	`AR5K_PHY
(0);

162 
ah
->
ah_ødio_5ghz_ªvisi⁄
 & 0xf0) {

163 
AR5K_SREV_RAD_5111
:

164 
ah
->
ah_ødio
 = 
AR5K_RF5111
;

165 
ah
->
ah_sögÀ_chù
 = 
Ál£
;

166 
ah
->
ah_ødio_2ghz_ªvisi⁄
 = 
	`©h5k_hw_ødio_ªvisi⁄
(ah,

167 
CHANNEL_2GHZ
);

169 
AR5K_SREV_RAD_5112
:

170 
AR5K_SREV_RAD_2112
:

171 
ah
->
ah_ødio
 = 
AR5K_RF5112
;

172 
ah
->
ah_sögÀ_chù
 = 
Ál£
;

173 
ah
->
ah_ødio_2ghz_ªvisi⁄
 = 
	`©h5k_hw_ødio_ªvisi⁄
(ah,

174 
CHANNEL_2GHZ
);

176 
AR5K_SREV_RAD_2413
:

177 
ah
->
ah_ødio
 = 
AR5K_RF2413
;

178 
ah
->
ah_sögÀ_chù
 = 
åue
;

180 
AR5K_SREV_RAD_5413
:

181 
ah
->
ah_ødio
 = 
AR5K_RF5413
;

182 
ah
->
ah_sögÀ_chù
 = 
åue
;

184 
AR5K_SREV_RAD_2316
:

185 
ah
->
ah_ødio
 = 
AR5K_RF2316
;

186 
ah
->
ah_sögÀ_chù
 = 
åue
;

188 
AR5K_SREV_RAD_2317
:

189 
ah
->
ah_ødio
 = 
AR5K_RF2317
;

190 
ah
->
ah_sögÀ_chù
 = 
åue
;

192 
AR5K_SREV_RAD_5424
:

193 i‡(
ah
->
ah_mac_vîsi⁄
 =
AR5K_SREV_AR2425
 ||

194 
ah
->
ah_mac_vîsi⁄
 =
AR5K_SREV_AR2417
) {

195 
ah
->
ah_ødio
 = 
AR5K_RF2425
;

196 
ah
->
ah_sögÀ_chù
 = 
åue
;

198 
ah
->
ah_ødio
 = 
AR5K_RF5413
;

199 
ah
->
ah_sögÀ_chù
 = 
åue
;

204 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
) {

205 
ah
->
ah_ødio
 = 
AR5K_RF5110
;

206 
ah
->
ah_sögÀ_chù
 = 
Ál£
;

207 } i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5211
) {

208 
ah
->
ah_ødio
 = 
AR5K_RF5111
;

209 
ah
->
ah_sögÀ_chù
 = 
Ál£
;

210 
ah
->
ah_ødio_2ghz_ªvisi⁄
 = 
	`©h5k_hw_ødio_ªvisi⁄
(ah,

211 
CHANNEL_2GHZ
);

212 } i‡(
ah
->
ah_mac_vîsi⁄
 =(
AR5K_SREV_AR2425
 >> 4) ||

213 
ah
->
ah_mac_vîsi⁄
 =(
AR5K_SREV_AR2417
 >> 4) ||

214 
ah
->
ah_phy_ªvisi⁄
 =
AR5K_SREV_PHY_2425
) {

215 
ah
->
ah_ødio
 = 
AR5K_RF2425
;

216 
ah
->
ah_sögÀ_chù
 = 
åue
;

217 
ah
->
ah_ødio_5ghz_ªvisi⁄
 = 
AR5K_SREV_RAD_2425
;

218 } i‡(
§ev
 =
AR5K_SREV_AR5213A
 &&

219 
ah
->
ah_phy_ªvisi⁄
 =
AR5K_SREV_PHY_5212B
) {

220 
ah
->
ah_ødio
 = 
AR5K_RF5112
;

221 
ah
->
ah_sögÀ_chù
 = 
Ál£
;

222 
ah
->
ah_ødio_5ghz_ªvisi⁄
 = 
AR5K_SREV_RAD_5112B
;

223 } i‡(
ah
->
ah_mac_vîsi⁄
 =(
AR5K_SREV_AR2415
 >> 4) ||

224 
ah
->
ah_mac_vîsi⁄
 =(
AR5K_SREV_AR2315_R6
 >> 4)) {

225 
ah
->
ah_ødio
 = 
AR5K_RF2316
;

226 
ah
->
ah_sögÀ_chù
 = 
åue
;

227 
ah
->
ah_ødio_5ghz_ªvisi⁄
 = 
AR5K_SREV_RAD_2316
;

228 } i‡(
ah
->
ah_mac_vîsi⁄
 =(
AR5K_SREV_AR5414
 >> 4) ||

229 
ah
->
ah_phy_ªvisi⁄
 =
AR5K_SREV_PHY_5413
) {

230 
ah
->
ah_ødio
 = 
AR5K_RF5413
;

231 
ah
->
ah_sögÀ_chù
 = 
åue
;

232 
ah
->
ah_ødio_5ghz_ªvisi⁄
 = 
AR5K_SREV_RAD_5413
;

233 } i‡(
ah
->
ah_mac_vîsi⁄
 =(
AR5K_SREV_AR2414
 >> 4) ||

234 
ah
->
ah_phy_ªvisi⁄
 =
AR5K_SREV_PHY_2413
) {

235 
ah
->
ah_ødio
 = 
AR5K_RF2413
;

236 
ah
->
ah_sögÀ_chù
 = 
åue
;

237 
ah
->
ah_ødio_5ghz_ªvisi⁄
 = 
AR5K_SREV_RAD_2413
;

239 
	`ATH5K_ERR
(
ah
, "Couldn't identifyÑadioÑevision.\n");

240 
ªt
 = -
ENODEV
;

241 
îr
;

247 i‡((
§ev
 >
AR5K_SREV_AR5416
Ë&& (§ev < 
AR5K_SREV_AR2425
)) {

248 
	`ATH5K_ERR
(
ah
, "DeviceÇot yet supported.\n");

249 
ªt
 = -
ENODEV
;

250 
îr
;

256 
ªt
 = 
	`©h5k_hw_po°
(
ah
);

257 i‡(
ªt
)

258 
îr
;

261 i‡(
§ev
 >
AR5K_SREV_AR5213A
)

262 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_PCICFG
, 
AR5K_PCICFG_RETRY_FIX
);

268 
ªt
 = 
	`©h5k_ì¥om_öô
(
ah
);

269 i‡(
ªt
) {

270 
	`ATH5K_ERR
(
ah
, "unableÅo init EEPROM\n");

271 
îr
;

274 
ì
 = &
ah
->
ah_ˇ∑bûôõs
.
ˇp_ì¥om
;

279 i‡((
ah
->
ah_vîsi⁄
 =
AR5K_AR5212
Ë&& 
pdev
 && (
	`pci_is_pcõ
(pdev))) {

280 
	`©h5k_hw_ªg_wrôe
(
ah
, 0x9248fc00, 
AR5K_PCIE_SERDES
);

281 
	`©h5k_hw_ªg_wrôe
(
ah
, 0x24924924, 
AR5K_PCIE_SERDES
);

284 
	`©h5k_hw_ªg_wrôe
(
ah
, 0x28000039, 
AR5K_PCIE_SERDES
);

285 
	`©h5k_hw_ªg_wrôe
(
ah
, 0x53160824, 
AR5K_PCIE_SERDES
);

290 i‡(
ì
->
ì_£rdes
)

291 
	`©h5k_hw_ªg_wrôe
(
ah
, 0xe5980579, 
AR5K_PCIE_SERDES
);

293 
	`©h5k_hw_ªg_wrôe
(
ah
, 0xf6800579, 
AR5K_PCIE_SERDES
);

296 
	`©h5k_hw_ªg_wrôe
(
ah
, 0x001defff, 
AR5K_PCIE_SERDES
);

299 
	`©h5k_hw_ªg_wrôe
(
ah
, 0x1Øabe40, 
AR5K_PCIE_SERDES
);

300 
	`©h5k_hw_ªg_wrôe
(
ah
, 0xbe105554, 
AR5K_PCIE_SERDES
);

301 
	`©h5k_hw_ªg_wrôe
(
ah
, 0x000e3007, 
AR5K_PCIE_SERDES
);

304 
	`©h5k_hw_ªg_wrôe
(
ah
, 0x00000000, 
AR5K_PCIE_SERDES_RESET
);

305 
	`mdñay
(1);

309 
ªt
 = 
	`©h5k_hw_£t_ˇ∑bûôõs
(
ah
);

310 i‡(
ªt
) {

311 
	`ATH5K_ERR
(
ah
, "unableÅo get device capabilities\n");

312 
îr
;

315 i‡(
	`ã°_bô
(
ATH_STAT_2G_DISABLED
, 
ah
->
°©us
)) {

316 
	`__˛ór_bô
(
AR5K_MODE_11B
, 
ah
->
ah_ˇ∑bûôõs
.
ˇp_mode
);

317 
	`__˛ór_bô
(
AR5K_MODE_11G
, 
ah
->
ah_ˇ∑bûôõs
.
ˇp_mode
);

321 
comm⁄
->
keymax
 = (
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
 ?

322 
AR5K_KEYTABLE_SIZE_5210
 : 
AR5K_KEYTABLE_SIZE_5211
);

324 i‡(
§ev
 >
AR5K_SREV_AR5212_V4
 &&

325 (
ì
->
ì_vîsi⁄
 < 
AR5K_EEPROM_VERSION_5_0
 ||

326 !
	`AR5K_EEPROM_AES_DIS
(
ì
->
ì_misc5
)))

327 
comm⁄
->
¸y±_ˇps
 |
ATH_CRYPT_CAP_CIPHER_AESCCM
;

329 i‡(
§ev
 >
AR5K_SREV_AR2414
) {

330 
comm⁄
->
¸y±_ˇps
 |
ATH_CRYPT_CAP_MIC_COMBINED
;

331 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_MISC_MODE
,

332 
AR5K_MISC_MODE_COMBINED_MIC
);

336 
	`©h5k_hw_£t_Œaddr
(
ah
, 
zîo_mac
);

339 
	`mem˝y
(
comm⁄
->
curbssid
, 
©h_bˇ°_mac
, 
ETH_ALEN
);

340 
	`©h5k_hw_£t_bssid
(
ah
);

341 
	`©h5k_hw_£t_›mode
(
ah
,áh->
›mode
);

343 
	`©h5k_hw_rfgaö_›t_öô
(
ah
);

345 
	`©h5k_hw_öô_nfˇl_hi°
(
ah
);

348 
	`©h5k_hw_£t_Àd°©e
(
ah
, 
AR5K_LED_INIT
);

351 
îr
:

352  
ªt
;

353 
	}
}

360 
	$©h5k_hw_deöô
(
©h5k_hw
 *
ah
)

362 
	`__£t_bô
(
ATH_STAT_INVALID
, 
ah
->
°©us
);

364 i‡(
ah
->
ah_rf_b™ks
 !
NULL
)

365 
	`k‰ì
(
ah
->
ah_rf_b™ks
);

367 
	`©h5k_ì¥om_dëach
(
ah
);

370 
	}
}

	@ath5k/base.c

43 
	~<löux/moduÀ.h
>

44 
	~<löux/dñay.h
>

45 
	~<löux/dma-m≠pög.h
>

46 
	~<löux/h¨dúq.h
>

47 
	~<löux/if.h
>

48 
	~<löux/io.h
>

49 
	~<löux/√tdevi˚.h
>

50 
	~<löux/ˇche.h
>

51 
	~<löux/ëhtoﬁ.h
>

52 
	~<löux/uac˚ss.h
>

53 
	~<löux/¶ab.h
>

54 
	~<löux/ëhîdevi˚.h
>

56 
	~<√t/õì80211_ødiŸ≠.h
>

58 
	~<asm/u«lig√d.h
>

60 
	~"ba£.h
"

61 
	~"ªg.h
"

62 
	~"debug.h
"

63 
	~"™i.h
"

65 
	#CREATE_TRACE_POINTS


	)

66 
	~"åa˚.h
"

68 
	g©h5k_mod∑øm_nohw¸y±
;

69 
moduÀ_∑øm_«med
(
nohw¸y±
, 
©h5k_mod∑øm_nohw¸y±
, 
boﬁ
, 
S_IRUGO
);

70 
MODULE_PARM_DESC
(
nohw¸y±
, "Disable hardwareÉncryption.");

72 
	gmod∑øm_Æl_ch™√ls
;

73 
moduÀ_∑øm_«med
(
Æl_ch™√ls
, 
mod∑øm_Æl_ch™√ls
, 
boﬁ
, 
S_IRUGO
);

74 
MODULE_PARM_DESC
(
Æl_ch™√ls
, "Exposeáll channelsÅhe device can use.");

76 
	gmod∑øm_Á°ch™swôch
;

77 
moduÀ_∑øm_«med
(
Á°ch™swôch
, 
mod∑øm_Á°ch™swôch
, 
boﬁ
, 
S_IRUGO
);

78 
MODULE_PARM_DESC
(
Á°ch™swôch
, "Enable fast channel switching for AR2413/AR5413Ñadios.");

82 
MODULE_AUTHOR
("Jiri Slaby");

83 
MODULE_AUTHOR
("Nick Kossifidis");

84 
MODULE_DESCRIPTION
("Support for 5xxx series of Atheros 802.11 wireless LAN cards.");

85 
MODULE_SUPPORTED_DEVICE
("Atheros 5xxx WLAN cards");

86 
MODULE_LICENSE
("Dual BSD/GPL");

88 
©h5k_öô
(
õì80211_hw
 *
hw
);

89 
©h5k_ª£t
(
©h5k_hw
 *
ah
, 
õì80211_ch™√l
 *
ch™
,

90 
boﬁ
 
skù_pcu
);

93 c⁄° 
©h5k_§ev_«me
 
	g§ev_«mes
[] = {

94 #ifde‡
CONFIG_ATHEROS_AR231X


95 { "5312", 
AR5K_VERSION_MAC
, 
AR5K_SREV_AR5312_R2
 },

96 { "5312", 
AR5K_VERSION_MAC
, 
AR5K_SREV_AR5312_R7
 },

97 { "2313", 
AR5K_VERSION_MAC
, 
AR5K_SREV_AR2313_R8
 },

98 { "2315", 
AR5K_VERSION_MAC
, 
AR5K_SREV_AR2315_R6
 },

99 { "2315", 
AR5K_VERSION_MAC
, 
AR5K_SREV_AR2315_R7
 },

100 { "2317", 
AR5K_VERSION_MAC
, 
AR5K_SREV_AR2317_R1
 },

101 { "2317", 
AR5K_VERSION_MAC
, 
AR5K_SREV_AR2317_R2
 },

103 { "5210", 
AR5K_VERSION_MAC
, 
AR5K_SREV_AR5210
 },

104 { "5311", 
AR5K_VERSION_MAC
, 
AR5K_SREV_AR5311
 },

105 { "5311A", 
AR5K_VERSION_MAC
, 
AR5K_SREV_AR5311A
 },

106 { "5311B", 
AR5K_VERSION_MAC
, 
AR5K_SREV_AR5311B
 },

107 { "5211", 
AR5K_VERSION_MAC
, 
AR5K_SREV_AR5211
 },

108 { "5212", 
AR5K_VERSION_MAC
, 
AR5K_SREV_AR5212
 },

109 { "5213", 
AR5K_VERSION_MAC
, 
AR5K_SREV_AR5213
 },

110 { "5213A", 
AR5K_VERSION_MAC
, 
AR5K_SREV_AR5213A
 },

111 { "2413", 
AR5K_VERSION_MAC
, 
AR5K_SREV_AR2413
 },

112 { "2414", 
AR5K_VERSION_MAC
, 
AR5K_SREV_AR2414
 },

113 { "5424", 
AR5K_VERSION_MAC
, 
AR5K_SREV_AR5424
 },

114 { "5413", 
AR5K_VERSION_MAC
, 
AR5K_SREV_AR5413
 },

115 { "5414", 
AR5K_VERSION_MAC
, 
AR5K_SREV_AR5414
 },

116 { "2415", 
AR5K_VERSION_MAC
, 
AR5K_SREV_AR2415
 },

117 { "5416", 
AR5K_VERSION_MAC
, 
AR5K_SREV_AR5416
 },

118 { "5418", 
AR5K_VERSION_MAC
, 
AR5K_SREV_AR5418
 },

119 { "2425", 
AR5K_VERSION_MAC
, 
AR5K_SREV_AR2425
 },

120 { "2417", 
AR5K_VERSION_MAC
, 
AR5K_SREV_AR2417
 },

122 { "xxxxx", 
AR5K_VERSION_MAC
, 
AR5K_SREV_UNKNOWN
 },

123 { "5110", 
AR5K_VERSION_RAD
, 
AR5K_SREV_RAD_5110
 },

124 { "5111", 
AR5K_VERSION_RAD
, 
AR5K_SREV_RAD_5111
 },

125 { "5111A", 
AR5K_VERSION_RAD
, 
AR5K_SREV_RAD_5111A
 },

126 { "2111", 
AR5K_VERSION_RAD
, 
AR5K_SREV_RAD_2111
 },

127 { "5112", 
AR5K_VERSION_RAD
, 
AR5K_SREV_RAD_5112
 },

128 { "5112A", 
AR5K_VERSION_RAD
, 
AR5K_SREV_RAD_5112A
 },

129 { "5112B", 
AR5K_VERSION_RAD
, 
AR5K_SREV_RAD_5112B
 },

130 { "2112", 
AR5K_VERSION_RAD
, 
AR5K_SREV_RAD_2112
 },

131 { "2112A", 
AR5K_VERSION_RAD
, 
AR5K_SREV_RAD_2112A
 },

132 { "2112B", 
AR5K_VERSION_RAD
, 
AR5K_SREV_RAD_2112B
 },

133 { "2413", 
AR5K_VERSION_RAD
, 
AR5K_SREV_RAD_2413
 },

134 { "5413", 
AR5K_VERSION_RAD
, 
AR5K_SREV_RAD_5413
 },

135 { "5424", 
AR5K_VERSION_RAD
, 
AR5K_SREV_RAD_5424
 },

136 { "5133", 
AR5K_VERSION_RAD
, 
AR5K_SREV_RAD_5133
 },

137 #ifde‡
CONFIG_ATHEROS_AR231X


138 { "2316", 
AR5K_VERSION_RAD
, 
AR5K_SREV_RAD_2316
 },

139 { "2317", 
AR5K_VERSION_RAD
, 
AR5K_SREV_RAD_2317
 },

141 { "xxxxx", 
AR5K_VERSION_RAD
, 
AR5K_SREV_UNKNOWN
 },

144 c⁄° 
õì80211_øã
 
	g©h5k_øãs
[] = {

145 { .
bôøã
 = 10,

146 .
	ghw_vÆue
 = 
ATH5K_RATE_CODE_1M
, },

147 { .
	gbôøã
 = 20,

148 .
	ghw_vÆue
 = 
ATH5K_RATE_CODE_2M
,

149 .
	ghw_vÆue_sh‹t
 = 
ATH5K_RATE_CODE_2M
 | 
AR5K_SET_SHORT_PREAMBLE
,

150 .
	gÊags
 = 
IEEE80211_RATE_SHORT_PREAMBLE
 },

151 { .
	gbôøã
 = 55,

152 .
	ghw_vÆue
 = 
ATH5K_RATE_CODE_5_5M
,

153 .
	ghw_vÆue_sh‹t
 = 
ATH5K_RATE_CODE_5_5M
 | 
AR5K_SET_SHORT_PREAMBLE
,

154 .
	gÊags
 = 
IEEE80211_RATE_SHORT_PREAMBLE
 },

155 { .
	gbôøã
 = 110,

156 .
	ghw_vÆue
 = 
ATH5K_RATE_CODE_11M
,

157 .
	ghw_vÆue_sh‹t
 = 
ATH5K_RATE_CODE_11M
 | 
AR5K_SET_SHORT_PREAMBLE
,

158 .
	gÊags
 = 
IEEE80211_RATE_SHORT_PREAMBLE
 },

159 { .
	gbôøã
 = 60,

160 .
	ghw_vÆue
 = 
ATH5K_RATE_CODE_6M
,

161 .
	gÊags
 = 0 },

162 { .
	gbôøã
 = 90,

163 .
	ghw_vÆue
 = 
ATH5K_RATE_CODE_9M
,

164 .
	gÊags
 = 0 },

165 { .
	gbôøã
 = 120,

166 .
	ghw_vÆue
 = 
ATH5K_RATE_CODE_12M
,

167 .
	gÊags
 = 0 },

168 { .
	gbôøã
 = 180,

169 .
	ghw_vÆue
 = 
ATH5K_RATE_CODE_18M
,

170 .
	gÊags
 = 0 },

171 { .
	gbôøã
 = 240,

172 .
	ghw_vÆue
 = 
ATH5K_RATE_CODE_24M
,

173 .
	gÊags
 = 0 },

174 { .
	gbôøã
 = 360,

175 .
	ghw_vÆue
 = 
ATH5K_RATE_CODE_36M
,

176 .
	gÊags
 = 0 },

177 { .
	gbôøã
 = 480,

178 .
	ghw_vÆue
 = 
ATH5K_RATE_CODE_48M
,

179 .
	gÊags
 = 0 },

180 { .
	gbôøã
 = 540,

181 .
	ghw_vÆue
 = 
ATH5K_RATE_CODE_54M
,

182 .
	gÊags
 = 0 },

186 
ölöe
 
u64
 
	$©h5k_exãnd_tsf
(
©h5k_hw
 *
ah
, 
u32
 
r°amp
)

188 
u64
 
tsf
 = 
	`©h5k_hw_gë_tsf64
(
ah
);

190 i‡((
tsf
 & 0x7fffË< 
r°amp
)

191 
tsf
 -= 0x8000;

193  (
tsf
 & ~0x7fffË| 
r°amp
;

194 
	}
}

197 
	$©h5k_chù_«me
(
©h5k_§ev_ty≥
 
ty≥
, 
u_öt16_t
 
vÆ
)

199 c⁄° *
«me
 = "xxxxx";

200 
i
;

202 
i
 = 0; i < 
	`ARRAY_SIZE
(
§ev_«mes
); i++) {

203 i‡(
§ev_«mes
[
i
].
§_ty≥
 !
ty≥
)

206 i‡((
vÆ
 & 0xf0Ë=
§ev_«mes
[
i
].
§_vÆ
)

207 
«me
 = 
§ev_«mes
[
i
].
§_«me
;

209 i‡((
vÆ
 & 0xffË=
§ev_«mes
[
i
].
§_vÆ
) {

210 
«me
 = 
§ev_«mes
[
i
].
§_«me
;

215  
«me
;

216 
	}
}

217 
	$©h5k_i‹ód32
(*
hw_¥iv
, 
u32
 
ªg_off£t
)

219 
©h5k_hw
 *
ah
 = (©h5k_hw *Ë
hw_¥iv
;

220  
	`©h5k_hw_ªg_ªad
(
ah
, 
ªg_off£t
);

221 
	}
}

223 
	$©h5k_iowrôe32
(*
hw_¥iv
, 
u32
 
vÆ
, u32 
ªg_off£t
)

225 
©h5k_hw
 *
ah
 = (©h5k_hw *Ë
hw_¥iv
;

226 
	`©h5k_hw_ªg_wrôe
(
ah
, 
vÆ
, 
ªg_off£t
);

227 
	}
}

229 c⁄° 
©h_›s
 
	g©h5k_comm⁄_›s
 = {

230 .
ªad
 = 
©h5k_i‹ód32
,

231 .
	gwrôe
 = 
©h5k_iowrôe32
,

238 
	$©h5k_ªg_nŸifõr
(
wùhy
 *wùhy, 
ªguœt‹y_ªque°
 *
ªque°
)

240 
õì80211_hw
 *
hw
 = 
	`wùhy_to_õì80211_hw
(
wùhy
);

241 
©h5k_hw
 *
ah
 = 
hw
->
¥iv
;

242 
©h_ªguœt‹y
 *
ªguœt‹y
 = 
	`©h5k_hw_ªguœt‹y
(
ah
);

244  
	`©h_ªg_nŸifõr_≠∂y
(
wùhy
, 
ªque°
, 
ªguœt‹y
);

245 
	}
}

254 
boﬁ
 
	$©h5k_is_°™d¨d_ch™√l
(
ch™
, 
õì80211_b™d
 
b™d
)

256 i‡(
b™d
 =
IEEE80211_BAND_2GHZ
 && 
ch™
 <= 14)

257  
åue
;

260 (((
ch™
 & 3) == 0 && chan >= 36 && chan <= 64) ||

262 ((
ch™
 & 3) == 0 && chan >= 100 && chan <= 140) ||

264 ((
ch™
 & 3) == 1 && chan >= 149 && chan <= 165) ||

266 (
ch™
 == 8 || chan == 12 || chan == 16) ||

268 (
ch™
 == 184 || chan == 188 || chan == 192 || chan == 196));

269 
	}
}

272 
	$©h5k_£tup_ch™√ls
(
©h5k_hw
 *
ah
, 
õì80211_ch™√l
 *
ch™√ls
,

273 
mode
, 
max
)

275 
cou¡
, 
size
, 
ch‰eq
, 
‰eq
, 
ch
;

276 
õì80211_b™d
 
b™d
;

278 
mode
) {

279 
AR5K_MODE_11A
:

281 
size
 = 220;

282 
ch‰eq
 = 
CHANNEL_5GHZ
;

283 
b™d
 = 
IEEE80211_BAND_5GHZ
;

285 
AR5K_MODE_11B
:

286 
AR5K_MODE_11G
:

287 
size
 = 26;

288 
ch‰eq
 = 
CHANNEL_2GHZ
;

289 
b™d
 = 
IEEE80211_BAND_2GHZ
;

292 
	`ATH5K_WARN
(
ah
, "bad mode,Çot copying channels\n");

296 
cou¡
 = 0;

297 
ch
 = 1; ch <
size
 && 
cou¡
 < 
max
; ch++) {

298 
‰eq
 = 
	`õì80211_ch™√l_to_‰equícy
(
ch
, 
b™d
);

300 i‡(
‰eq
 == 0)

304 i‡(!
	`©h5k_ch™√l_ok
(
ah
, 
‰eq
, 
ch‰eq
))

307 i‡(!
mod∑øm_Æl_ch™√ls
 &&

308 !
	`©h5k_is_°™d¨d_ch™√l
(
ch
, 
b™d
))

312 
ch™√ls
[
cou¡
].
˚¡î_‰eq
 = 
‰eq
;

313 
ch™√ls
[
cou¡
].
b™d
 = band;

314 
mode
) {

315 
AR5K_MODE_11A
:

316 
AR5K_MODE_11G
:

317 
ch™√ls
[
cou¡
].
hw_vÆue
 = 
ch‰eq
 | 
CHANNEL_OFDM
;

319 
AR5K_MODE_11B
:

320 
ch™√ls
[
cou¡
].
hw_vÆue
 = 
CHANNEL_B
;

323 
cou¡
++;

326  
cou¡
;

327 
	}
}

330 
	$©h5k_£tup_øã_idx
(
©h5k_hw
 *
ah
, 
õì80211_suµ‹ãd_b™d
 *
b
)

332 
u8
 
i
;

334 
i
 = 0; i < 
AR5K_MAX_RATES
; i++)

335 
ah
->
øã_idx
[
b
->
b™d
][
i
] = -1;

337 
i
 = 0; i < 
b
->
n_bôøãs
; i++) {

338 
ah
->
øã_idx
[
b
->
b™d
][b->
bôøãs
[
i
].
hw_vÆue
] = i;

339 i‡(
b
->
bôøãs
[
i
].
hw_vÆue_sh‹t
)

340 
ah
->
øã_idx
[
b
->
b™d
][b->
bôøãs
[
i
].
hw_vÆue_sh‹t
] = i;

342 
	}
}

345 
	$©h5k_£tup_b™ds
(
õì80211_hw
 *
hw
)

347 
©h5k_hw
 *
ah
 = 
hw
->
¥iv
;

348 
õì80211_suµ‹ãd_b™d
 *
sb™d
;

349 
max_c
, 
cou¡_c
 = 0;

350 
i
;

352 
	`BUILD_BUG_ON
(
	`ARRAY_SIZE
(
ah
->
sb™ds
Ë< 
IEEE80211_NUM_BANDS
);

353 
max_c
 = 
	`ARRAY_SIZE
(
ah
->
ch™√ls
);

356 
sb™d
 = &
ah
->
sb™ds
[
IEEE80211_BAND_2GHZ
];

357 
sb™d
->
b™d
 = 
IEEE80211_BAND_2GHZ
;

358 
sb™d
->
bôøãs
 = &
ah
->
øãs
[
IEEE80211_BAND_2GHZ
][0];

360 i‡(
	`ã°_bô
(
AR5K_MODE_11G
, 
ah
->
ah_ˇ∑bûôõs
.
ˇp_mode
)) {

362 
	`mem˝y
(
sb™d
->
bôøãs
, &
©h5k_øãs
[0],

363 (
õì80211_øã
) * 12);

364 
sb™d
->
n_bôøãs
 = 12;

366 
sb™d
->
ch™√ls
 = 
ah
->channels;

367 
sb™d
->
n_ch™√ls
 = 
	`©h5k_£tup_ch™√ls
(
ah
, sb™d->
ch™√ls
,

368 
AR5K_MODE_11G
, 
max_c
);

370 
hw
->
wùhy
->
b™ds
[
IEEE80211_BAND_2GHZ
] = 
sb™d
;

371 
cou¡_c
 = 
sb™d
->
n_ch™√ls
;

372 
max_c
 -
cou¡_c
;

373 } i‡(
	`ã°_bô
(
AR5K_MODE_11B
, 
ah
->
ah_ˇ∑bûôõs
.
ˇp_mode
)) {

375 
	`mem˝y
(
sb™d
->
bôøãs
, &
©h5k_øãs
[0],

376 (
õì80211_øã
) * 4);

377 
sb™d
->
n_bôøãs
 = 4;

383 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5211
) {

384 
i
 = 0; i < 4; i++) {

385 
sb™d
->
bôøãs
[
i
].
hw_vÆue
 =

386 
sb™d
->
bôøãs
[
i
].
hw_vÆue
 & 0xF;

387 
sb™d
->
bôøãs
[
i
].
hw_vÆue_sh‹t
 =

388 
sb™d
->
bôøãs
[
i
].
hw_vÆue_sh‹t
 & 0xF;

392 
sb™d
->
ch™√ls
 = 
ah
->channels;

393 
sb™d
->
n_ch™√ls
 = 
	`©h5k_£tup_ch™√ls
(
ah
, sb™d->
ch™√ls
,

394 
AR5K_MODE_11B
, 
max_c
);

396 
hw
->
wùhy
->
b™ds
[
IEEE80211_BAND_2GHZ
] = 
sb™d
;

397 
cou¡_c
 = 
sb™d
->
n_ch™√ls
;

398 
max_c
 -
cou¡_c
;

400 
	`©h5k_£tup_øã_idx
(
ah
, 
sb™d
);

403 i‡(
	`ã°_bô
(
AR5K_MODE_11A
, 
ah
->
ah_ˇ∑bûôõs
.
ˇp_mode
)) {

404 
sb™d
 = &
ah
->
sb™ds
[
IEEE80211_BAND_5GHZ
];

405 
sb™d
->
b™d
 = 
IEEE80211_BAND_5GHZ
;

406 
sb™d
->
bôøãs
 = &
ah
->
øãs
[
IEEE80211_BAND_5GHZ
][0];

408 
	`mem˝y
(
sb™d
->
bôøãs
, &
©h5k_øãs
[4],

409 (
õì80211_øã
) * 8);

410 
sb™d
->
n_bôøãs
 = 8;

412 
sb™d
->
ch™√ls
 = &
ah
->ch™√ls[
cou¡_c
];

413 
sb™d
->
n_ch™√ls
 = 
	`©h5k_£tup_ch™√ls
(
ah
, sb™d->
ch™√ls
,

414 
AR5K_MODE_11A
, 
max_c
);

416 
hw
->
wùhy
->
b™ds
[
IEEE80211_BAND_5GHZ
] = 
sb™d
;

418 
	`©h5k_£tup_øã_idx
(
ah
, 
sb™d
);

420 
	`©h5k_debug_dump_b™ds
(
ah
);

423 
	}
}

433 
	$©h5k_ch™_£t
(
©h5k_hw
 *
ah
, 
õì80211_ch™√l
 *
ch™
)

435 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_RESET
,

437 
ah
->
curch™
->
˚¡î_‰eq
, 
ch™
->center_freq);

439 
	`¥ötk
("VANET-debug:áth5k_chan_set\n");

447  
	`©h5k_ª£t
(
ah
, 
ch™
, 
åue
);

448 
	}
}

450 
	$©h5k_vif_ôî
(*
d©a
, 
u8
 *
mac
, 
õì80211_vif
 *
vif
)

452 
©h5k_vif_ôî_d©a
 *
ôî_d©a
 = 
d©a
;

453 
i
;

454 
©h5k_vif
 *
avf
 = (*)
vif
->
drv_¥iv
;

456 i‡(
ôî_d©a
->
hw_maˇddr
)

457 
i
 = 0; i < 
ETH_ALEN
; i++)

458 
ôî_d©a
->
mask
[
i
] &=

459 ~(
ôî_d©a
->
hw_maˇddr
[
i
] ^ 
mac
[i]);

461 i‡(!
ôî_d©a
->
found_a˘ive
) {

462 
ôî_d©a
->
found_a˘ive
 = 
åue
;

463 
	`mem˝y
(
ôî_d©a
->
a˘ive_mac
, 
mac
, 
ETH_ALEN
);

466 i‡(
ôî_d©a
->
√ed_£t_hw_addr
 && iãr_d©a->
hw_maˇddr
)

467 i‡(
	`com∑ª_ëhî_addr
(
ôî_d©a
->
hw_maˇddr
, 
mac
) == 0)

468 
ôî_d©a
->
√ed_£t_hw_addr
 = 
Ál£
;

470 i‡(!
ôî_d©a
->
™y_assoc
) {

471 i‡(
avf
->
assoc
)

472 
ôî_d©a
->
™y_assoc
 = 
åue
;

480 i‡(
avf
->
›mode
 =
NL80211_IFTYPE_AP
)

481 
ôî_d©a
->
›mode
 = 
NL80211_IFTYPE_AP
;

483 i‡(
avf
->
›mode
 =
NL80211_IFTYPE_STATION
)

484 
ôî_d©a
->
n_°as
++;

485 i‡(
ôî_d©a
->
›mode
 =
NL80211_IFTYPE_UNSPECIFIED
)

486 
ôî_d©a
->
›mode
 = 
avf
->opmode;

488 
	}
}

491 
	$©h5k_upd©e_bssid_mask_™d_›mode
(
©h5k_hw
 *
ah
,

492 
õì80211_vif
 *
vif
)

494 
©h_comm⁄
 *
comm⁄
 = 
	`©h5k_hw_comm⁄
(
ah
);

495 
©h5k_vif_ôî_d©a
 
ôî_d©a
;

496 
u32
 
rfût
;

502 
ôî_d©a
.
hw_maˇddr
 = 
comm⁄
->
maˇddr
;

503 
	`mem£t
(&
ôî_d©a
.
mask
, 0xff, 
ETH_ALEN
);

504 
ôî_d©a
.
found_a˘ive
 = 
Ál£
;

505 
ôî_d©a
.
√ed_£t_hw_addr
 = 
åue
;

506 
ôî_d©a
.
›mode
 = 
NL80211_IFTYPE_UNSPECIFIED
;

507 
ôî_d©a
.
n_°as
 = 0;

509 i‡(
vif
)

510 
	`©h5k_vif_ôî
(&
ôî_d©a
, 
vif
->
addr
, vif);

513 
	`õì80211_ôî©e_a˘ive_öãrÁ˚s_©omic
(
ah
->
hw
, 
©h5k_vif_ôî
,

514 &
ôî_d©a
);

515 
	`mem˝y
(
ah
->
bssidmask
, 
ôî_d©a
.
mask
, 
ETH_ALEN
);

517 
ah
->
›mode
 = 
ôî_d©a
.opmode;

518 i‡(
ah
->
›mode
 =
NL80211_IFTYPE_UNSPECIFIED
)

520 
ah
->
›mode
 = 
NL80211_IFTYPE_STATION
;

522 
	`©h5k_hw_£t_›mode
(
ah
,áh->
›mode
);

523 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_MODE
, "mode setup opmode %d (%s)\n",

524 
ah
->
›mode
, 
	`©h_›mode_to_°rög
(ah->opmode));

526 i‡(
ôî_d©a
.
√ed_£t_hw_addr
 && iãr_d©a.
found_a˘ive
)

527 
	`©h5k_hw_£t_Œaddr
(
ah
, 
ôî_d©a
.
a˘ive_mac
);

529 i‡(
	`©h5k_hw_hasbssidmask
(
ah
))

530 
	`©h5k_hw_£t_bssid_mask
(
ah
,áh->
bssidmask
);

533 i‡(
ôî_d©a
.
n_°as
 > 1) {

538 
ah
->
fûãr_Êags
 |
AR5K_RX_FILTER_PROM
;

541 
rfût
 = 
ah
->
fûãr_Êags
;

542 
	`©h5k_hw_£t_rx_fûãr
(
ah
, 
rfût
);

543 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_MODE
, "RX fûã∏0x%x\n", 
rfût
);

544 
	}
}

546 
ölöe
 

547 
	$©h5k_hw_to_drivî_rix
(
©h5k_hw
 *
ah
, 
hw_rix
)

549 
rix
;

552 i‡(
	`WARN
(
hw_rix
 < 0 || hw_rix >
AR5K_MAX_RATES
,

553 "hw_rix ouào‡bounds: %x\n", 
hw_rix
))

556 
rix
 = 
ah
->
øã_idx
[ah->
curch™
->
b™d
][
hw_rix
];

557 i‡(
	`WARN
(
rix
 < 0, "övÆid hw_rix: %x\n", 
hw_rix
))

558 
rix
 = 0;

560  
rix
;

561 
	}
}

568 
sk_buff
 *
	$©h5k_rx_skb_Æloc
(
©h5k_hw
 *
ah
, 
dma_addr_t
 *
skb_addr
)

570 
©h_comm⁄
 *
comm⁄
 = 
	`©h5k_hw_comm⁄
(
ah
);

571 
sk_buff
 *
skb
;

577 
skb
 = 
	`©h_rxbuf_Æloc
(
comm⁄
,

578 
comm⁄
->
rx_bufsize
,

579 
GFP_ATOMIC
);

581 i‡(!
skb
) {

582 
	`ATH5K_ERR
(
ah
, "can'tálloc skbuff of size %u\n",

583 
comm⁄
->
rx_bufsize
);

584  
NULL
;

587 *
skb_addr
 = 
	`dma_m≠_sögÀ
(
ah
->
dev
,

588 
skb
->
d©a
, 
comm⁄
->
rx_bufsize
,

589 
DMA_FROM_DEVICE
);

591 i‡(
	`u∆ikñy
(
	`dma_m≠pög_îr‹
(
ah
->
dev
, *
skb_addr
))) {

592 
	`ATH5K_ERR
(
ah
, "%s: DMA m≠pög faûed\n", 
__func__
);

593 
	`dev_k‰ì_skb
(
skb
);

594  
NULL
;

596  
skb
;

597 
	}
}

600 
	$©h5k_rxbuf_£tup
(
©h5k_hw
 *
ah
, 
©h5k_buf
 *
bf
)

602 
sk_buff
 *
skb
 = 
bf
->skb;

603 
©h5k_desc
 *
ds
;

604 
ªt
;

606 i‡(!
skb
) {

607 
skb
 = 
	`©h5k_rx_skb_Æloc
(
ah
, &
bf
->
skbaddr
);

608 i‡(!
skb
)

609  -
ENOMEM
;

610 
bf
->
skb
 = skb;

628 
ds
 = 
bf
->
desc
;

629 
ds
->
ds_lök
 = 
bf
->
daddr
;

630 
ds
->
ds_d©a
 = 
bf
->
skbaddr
;

631 
ªt
 = 
	`©h5k_hw_£tup_rx_desc
(
ah
, 
ds
,áh->
comm⁄
.
rx_bufsize
, 0);

632 i‡(
ªt
) {

633 
	`ATH5K_ERR
(
ah
, "%s: couldÇŸ sëu∞RX desc\n", 
__func__
);

634  
ªt
;

637 i‡(
ah
->
rxlök
 !
NULL
)

638 *
ah
->
rxlök
 = 
bf
->
daddr
;

639 
ah
->
rxlök
 = &
ds
->
ds_lök
;

641 
	}
}

643 
©h5k_pkt_ty≥
 
	$gë_hw_∑ckë_ty≥
(
sk_buff
 *
skb
)

645 
õì80211_hdr
 *
hdr
;

646 
©h5k_pkt_ty≥
 
hty≥
;

647 
__À16
 
fc
;

649 
hdr
 = (
õì80211_hdr
 *)
skb
->
d©a
;

650 
fc
 = 
hdr
->
‰ame_c⁄åﬁ
;

652 i‡(
	`õì80211_is_bóc⁄
(
fc
))

653 
hty≥
 = 
AR5K_PKT_TYPE_BEACON
;

654 i‡(
	`õì80211_is_¥obe_ª•
(
fc
))

655 
hty≥
 = 
AR5K_PKT_TYPE_PROBE_RESP
;

656 i‡(
	`õì80211_is_©im
(
fc
))

657 
hty≥
 = 
AR5K_PKT_TYPE_ATIM
;

658 i‡(
	`õì80211_is_p•ﬁl
(
fc
))

659 
hty≥
 = 
AR5K_PKT_TYPE_PSPOLL
;

661 
hty≥
 = 
AR5K_PKT_TYPE_NORMAL
;

663  
hty≥
;

664 
	}
}

667 
	$©h5k_txbuf_£tup
(
©h5k_hw
 *
ah
, 
©h5k_buf
 *
bf
,

668 
©h5k_txq
 *
txq
, 
∑dsize
)

670 
©h5k_desc
 *
ds
 = 
bf
->
desc
;

671 
sk_buff
 *
skb
 = 
bf
->skb;

672 
õì80211_tx_öfo
 *
öfo
 = 
	`IEEE80211_SKB_CB
(
skb
);

673 
pkéí
, 
Êags
, 
keyidx
 = 
AR5K_TXKEYIX_INVALID
;

674 
õì80211_øã
 *
øã
;

675 
mº_øã
[3], 
mº_åõs
[3];

676 
i
, 
ªt
;

677 
u16
 
hw_øã
;

678 
u16
 
˘s_øã
 = 0;

679 
u16
 
duøti⁄
 = 0;

680 
u8
 
rc_Êags
;

682 
Êags
 = 
AR5K_TXDESC_INTREQ
 | 
AR5K_TXDESC_CLRDMASK
;

685 
bf
->
skbaddr
 = 
	`dma_m≠_sögÀ
(
ah
->
dev
, 
skb
->
d©a
, skb->
Àn
,

686 
DMA_TO_DEVICE
);

688 
øã
 = 
	`õì80211_gë_tx_øã
(
ah
->
hw
, 
öfo
);

689 i‡(!
øã
) {

690 
ªt
 = -
EINVAL
;

691 
îr_unm≠
;

694 i‡(
öfo
->
Êags
 & 
IEEE80211_TX_CTL_NO_ACK
)

695 
Êags
 |
AR5K_TXDESC_NOACK
;

697 
rc_Êags
 = 
öfo
->
c⁄åﬁ
.
øãs
[0].
Êags
;

698 
hw_øã
 = (
rc_Êags
 & 
IEEE80211_TX_RC_USE_SHORT_PREAMBLE
) ?

699 
øã
->
hw_vÆue_sh‹t
 :Ñ©e->
hw_vÆue
;

701 
pkéí
 = 
skb
->
Àn
;

706 i‡(
öfo
->
c⁄åﬁ
.
hw_key
) {

707 
keyidx
 = 
öfo
->
c⁄åﬁ
.
hw_key
->
hw_key_idx
;

708 
pkéí
 +
öfo
->
c⁄åﬁ
.
hw_key
->
icv_Àn
;

710 i‡(
rc_Êags
 & 
IEEE80211_TX_RC_USE_RTS_CTS
) {

711 
Êags
 |
AR5K_TXDESC_RTSENA
;

712 
˘s_øã
 = 
	`õì80211_gë_πs_˘s_øã
(
ah
->
hw
, 
öfo
)->
hw_vÆue
;

713 
duøti⁄
 = 
	`À16_to_˝u
(
	`õì80211_πs_duøti⁄
(
ah
->
hw
,

714 
öfo
->
c⁄åﬁ
.
vif
, 
pkéí
, info));

716 i‡(
rc_Êags
 & 
IEEE80211_TX_RC_USE_CTS_PROTECT
) {

717 
Êags
 |
AR5K_TXDESC_CTSENA
;

718 
˘s_øã
 = 
	`õì80211_gë_πs_˘s_øã
(
ah
->
hw
, 
öfo
)->
hw_vÆue
;

719 
duøti⁄
 = 
	`À16_to_˝u
(
	`õì80211_˘°o£lf_duøti⁄
(
ah
->
hw
,

720 
öfo
->
c⁄åﬁ
.
vif
, 
pkéí
, info));

722 
ªt
 = 
ah
->
	`ah_£tup_tx_desc
◊h, 
ds
, 
pkéí
,

723 
	`õì80211_gë_hdæí_‰om_skb
(
skb
), 
∑dsize
,

724 
	`gë_hw_∑ckë_ty≥
(
skb
),

725 (
ah
->
powî_Àvñ
 * 2),

726 
hw_øã
,

727 
öfo
->
c⁄åﬁ
.
øãs
[0].
cou¡
, 
keyidx
, 
ah
->
ah_tx_™t
, 
Êags
,

728 
˘s_øã
, 
duøti⁄
);

729 i‡(
ªt
)

730 
îr_unm≠
;

732 
	`mem£t
(
mº_øã
, 0, (mrr_rate));

733 
	`mem£t
(
mº_åõs
, 0, (mrr_tries));

734 
i
 = 0; i < 3; i++) {

735 
øã
 = 
	`õì80211_gë_Æt_ªåy_øã
(
ah
->
hw
, 
öfo
, 
i
);

736 i‡(!
øã
)

739 
mº_øã
[
i
] = 
øã
->
hw_vÆue
;

740 
mº_åõs
[
i
] = 
öfo
->
c⁄åﬁ
.
øãs
[ò+ 1].
cou¡
;

743 
	`©h5k_hw_£tup_mº_tx_desc
(
ah
, 
ds
,

744 
mº_øã
[0], 
mº_åõs
[0],

745 
mº_øã
[1], 
mº_åõs
[1],

746 
mº_øã
[2], 
mº_åõs
[2]);

748 
ds
->
ds_lök
 = 0;

749 
ds
->
ds_d©a
 = 
bf
->
skbaddr
;

751 
	`•ö_lock_bh
(&
txq
->
lock
);

752 
	`li°_add_èû
(&
bf
->
li°
, &
txq
->
q
);

753 
txq
->
txq_Àn
++;

754 i‡(
txq
->
lök
 =
NULL
)

755 
	`©h5k_hw_£t_txdp
(
ah
, 
txq
->
qnum
, 
bf
->
daddr
);

757 *
txq
->
lök
 = 
bf
->
daddr
;

759 
txq
->
lök
 = &
ds
->
ds_lök
;

760 
	`©h5k_hw_°¨t_tx_dma
(
ah
, 
txq
->
qnum
);

761 
	`mmiowb
();

762 
	`•ö_u∆ock_bh
(&
txq
->
lock
);

765 
îr_unm≠
:

766 
	`dma_unm≠_sögÀ
(
ah
->
dev
, 
bf
->
skbaddr
, 
skb
->
Àn
, 
DMA_TO_DEVICE
);

767  
ªt
;

768 
	}
}

775 
	$©h5k_desc_Æloc
(
©h5k_hw
 *
ah
)

777 
©h5k_desc
 *
ds
;

778 
©h5k_buf
 *
bf
;

779 
dma_addr_t
 
da
;

780 
i
;

781 
ªt
;

784 
ah
->
desc_Àn
 = (
©h5k_desc
) *

785 (
ATH_TXBUF
 + 
ATH_RXBUF
 + 
ATH_BCBUF
 + 1);

787 
ah
->
desc
 = 
	`dma_Æloc_cohîít
◊h->
dev
,áh->
desc_Àn
,

788 &
ah
->
desc_daddr
, 
GFP_KERNEL
);

789 i‡(
ah
->
desc
 =
NULL
) {

790 
	`ATH5K_ERR
(
ah
, "can'tállocate descriptors\n");

791 
ªt
 = -
ENOMEM
;

792 
îr
;

794 
ds
 = 
ah
->
desc
;

795 
da
 = 
ah
->
desc_daddr
;

796 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_ANY
, "DMA map: %p (%zu) -> %llx\n",

797 
ds
, 
ah
->
desc_Àn
, (Ôh->
desc_daddr
);

799 
bf
 = 
	`kˇŒoc
(1 + 
ATH_TXBUF
 + 
ATH_RXBUF
 + 
ATH_BCBUF
,

800 (
©h5k_buf
), 
GFP_KERNEL
);

801 i‡(
bf
 =
NULL
) {

802 
	`ATH5K_ERR
(
ah
, "can'tállocate bufptr\n");

803 
ªt
 = -
ENOMEM
;

804 
îr_‰ì
;

806 
ah
->
buÂå
 = 
bf
;

808 
	`INIT_LIST_HEAD
(&
ah
->
rxbuf
);

809 
i
 = 0; i < 
ATH_RXBUF
; i++, 
bf
++, 
ds
++, 
da
 += (*ds)) {

810 
bf
->
desc
 = 
ds
;

811 
bf
->
daddr
 = 
da
;

812 
	`li°_add_èû
(&
bf
->
li°
, &
ah
->
rxbuf
);

815 
	`INIT_LIST_HEAD
(&
ah
->
txbuf
);

816 
ah
->
txbuf_Àn
 = 
ATH_TXBUF
;

817 
i
 = 0; i < 
ATH_TXBUF
; i++, 
bf
++, 
ds
++, 
da
 += (*ds)) {

818 
bf
->
desc
 = 
ds
;

819 
bf
->
daddr
 = 
da
;

820 
	`li°_add_èû
(&
bf
->
li°
, &
ah
->
txbuf
);

824 
	`INIT_LIST_HEAD
(&
ah
->
bcbuf
);

825 
i
 = 0; i < 
ATH_BCBUF
; i++, 
bf
++, 
ds
++, 
da
 += (*ds)) {

826 
bf
->
desc
 = 
ds
;

827 
bf
->
daddr
 = 
da
;

828 
	`li°_add_èû
(&
bf
->
li°
, &
ah
->
bcbuf
);

832 
îr_‰ì
:

833 
	`dma_‰ì_cohîít
(
ah
->
dev
,áh->
desc_Àn
,áh->
desc
,áh->
desc_daddr
);

834 
îr
:

835 
ah
->
desc
 = 
NULL
;

836  
ªt
;

837 
	}
}

840 
	$©h5k_txbuf_‰ì_skb
(
©h5k_hw
 *
ah
, 
©h5k_buf
 *
bf
)

842 
	`BUG_ON
(!
bf
);

843 i‡(!
bf
->
skb
)

845 
	`dma_unm≠_sögÀ
(
ah
->
dev
, 
bf
->
skbaddr
, bf->
skb
->
Àn
,

846 
DMA_TO_DEVICE
);

847 
	`dev_k‰ì_skb_™y
(
bf
->
skb
);

848 
bf
->
skb
 = 
NULL
;

849 
bf
->
skbaddr
 = 0;

850 
bf
->
desc
->
ds_d©a
 = 0;

851 
	}
}

854 
	$©h5k_rxbuf_‰ì_skb
(
©h5k_hw
 *
ah
, 
©h5k_buf
 *
bf
)

856 
©h_comm⁄
 *
comm⁄
 = 
	`©h5k_hw_comm⁄
(
ah
);

858 
	`BUG_ON
(!
bf
);

859 i‡(!
bf
->
skb
)

861 
	`dma_unm≠_sögÀ
(
ah
->
dev
, 
bf
->
skbaddr
, 
comm⁄
->
rx_bufsize
,

862 
DMA_FROM_DEVICE
);

863 
	`dev_k‰ì_skb_™y
(
bf
->
skb
);

864 
bf
->
skb
 = 
NULL
;

865 
bf
->
skbaddr
 = 0;

866 
bf
->
desc
->
ds_d©a
 = 0;

867 
	}
}

870 
	$©h5k_desc_‰ì
(
©h5k_hw
 *
ah
)

872 
©h5k_buf
 *
bf
;

874 
	`li°_f‹_óch_íåy
(
bf
, &
ah
->
txbuf
, 
li°
)

875 
	`©h5k_txbuf_‰ì_skb
(
ah
, 
bf
);

876 
	`li°_f‹_óch_íåy
(
bf
, &
ah
->
rxbuf
, 
li°
)

877 
	`©h5k_rxbuf_‰ì_skb
(
ah
, 
bf
);

878 
	`li°_f‹_óch_íåy
(
bf
, &
ah
->
bcbuf
, 
li°
)

879 
	`©h5k_txbuf_‰ì_skb
(
ah
, 
bf
);

882 
	`dma_‰ì_cohîít
(
ah
->
dev
,áh->
desc_Àn
,áh->
desc
,áh->
desc_daddr
);

883 
ah
->
desc
 = 
NULL
;

884 
ah
->
desc_daddr
 = 0;

886 
	`k‰ì
(
ah
->
buÂå
);

887 
ah
->
buÂå
 = 
NULL
;

888 
	}
}

895 
©h5k_txq
 *

896 
	$©h5k_txq_£tup
(
©h5k_hw
 *
ah
,

897 
qty≥
, 
subty≥
)

899 
©h5k_txq
 *
txq
;

900 
©h5k_txq_öfo
 
qi
 = {

901 .
tqi_subty≥
 = 
subty≥
,

904 .
tqi_aifs
 = 
AR5K_TUNE_AIFS
,

905 .
tqi_cw_mö
 = 
AR5K_TUNE_CWMIN
,

906 .
tqi_cw_max
 = 
AR5K_TUNE_CWMAX


908 
qnum
;

922 
qi
.
tqi_Êags
 = 
AR5K_TXQ_FLAG_TXEOLINT_ENABLE
 |

923 
AR5K_TXQ_FLAG_TXDESCINT_ENABLE
;

924 
qnum
 = 
	`©h5k_hw_£tup_tx_queue
(
ah
, 
qty≥
, &
qi
);

925 i‡(
qnum
 < 0) {

930  
	`ERR_PTR
(
qnum
);

932 i‡(
qnum
 >
	`ARRAY_SIZE
(
ah
->
txqs
)) {

933 
	`ATH5K_ERR
(
ah
, "hw qnum %u out ofÑange, max %tu!\n",

934 
qnum
, 
	`ARRAY_SIZE
(
ah
->
txqs
));

935 
	`©h5k_hw_ªÀa£_tx_queue
(
ah
, 
qnum
);

936  
	`ERR_PTR
(-
EINVAL
);

938 
txq
 = &
ah
->
txqs
[
qnum
];

939 i‡(!
txq
->
£tup
) {

940 
txq
->
qnum
 = qnum;

941 
txq
->
lök
 = 
NULL
;

942 
	`INIT_LIST_HEAD
(&
txq
->
q
);

943 
	`•ö_lock_öô
(&
txq
->
lock
);

944 
txq
->
£tup
 = 
åue
;

945 
txq
->
txq_Àn
 = 0;

946 
txq
->
txq_max
 = 
ATH5K_TXQ_LEN_MAX
;

947 
txq
->
txq_pﬁl_m¨k
 = 
Ál£
;

948 
txq
->
txq_°uck
 = 0;

950  &
ah
->
txqs
[
qnum
];

951 
	}
}

954 
	$©h5k_bóc⁄q_£tup
(
©h5k_hw
 *
ah
)

956 
©h5k_txq_öfo
 
qi
 = {

959 .
tqi_aifs
 = 
AR5K_TUNE_AIFS
,

960 .
tqi_cw_mö
 = 
AR5K_TUNE_CWMIN
,

961 .
tqi_cw_max
 = 
AR5K_TUNE_CWMAX
,

963 .
tqi_Êags
 = 
AR5K_TXQ_FLAG_TXDESCINT_ENABLE


966  
	`©h5k_hw_£tup_tx_queue
(
ah
, 
AR5K_TX_QUEUE_BEACON
, &
qi
);

967 
	}
}

970 
	$©h5k_bóc⁄q_c⁄fig
(
©h5k_hw
 *
ah
)

972 
©h5k_txq_öfo
 
qi
;

973 
ªt
;

975 
ªt
 = 
	`©h5k_hw_gë_tx_queuïr›s
(
ah
,áh->
bhÆq
, &
qi
);

976 i‡(
ªt
)

977 
îr
;

979 i‡(
ah
->
›mode
 =
NL80211_IFTYPE_AP
 ||

980 
ah
->
›mode
 =
NL80211_IFTYPE_MESH_POINT
) {

985 
qi
.
tqi_aifs
 = 0;

986 
qi
.
tqi_cw_mö
 = 0;

987 
qi
.
tqi_cw_max
 = 0;

988 } i‡(
ah
->
›mode
 =
NL80211_IFTYPE_ADHOC
) {

992 
qi
.
tqi_aifs
 = 0;

993 
qi
.
tqi_cw_mö
 = 0;

994 
qi
.
tqi_cw_max
 = 2 * 
AR5K_TUNE_CWMIN
;

997 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_BEACON
,

999 
qi
.
tqi_aifs
, qi.
tqi_cw_mö
, qi.
tqi_cw_max
);

1001 
ªt
 = 
	`©h5k_hw_£t_tx_queuïr›s
(
ah
,áh->
bhÆq
, &
qi
);

1002 i‡(
ªt
) {

1003 
	`ATH5K_ERR
(
ah
, "%s: unableÅo updateÖarameters for beacon "

1004 "h¨dw¨êqueue!\n", 
__func__
);

1005 
îr
;

1007 
ªt
 = 
	`©h5k_hw_ª£t_tx_queue
(
ah
,áh->
bhÆq
);

1008 i‡(
ªt
)

1009 
îr
;

1012 
ªt
 = 
	`©h5k_hw_gë_tx_queuïr›s
(
ah
, 
AR5K_TX_QUEUE_ID_CAB
, &
qi
);

1013 i‡(
ªt
)

1014 
îr
;

1016 
qi
.
tqi_ªady_time
 = (
ah
->
bötvÆ
 * 80) / 100;

1017 
ªt
 = 
	`©h5k_hw_£t_tx_queuïr›s
(
ah
, 
AR5K_TX_QUEUE_ID_CAB
, &
qi
);

1018 i‡(
ªt
)

1019 
îr
;

1021 
ªt
 = 
	`©h5k_hw_ª£t_tx_queue
(
ah
, 
AR5K_TX_QUEUE_ID_CAB
);

1022 
îr
:

1023  
ªt
;

1024 
	}
}

1038 
	$©h5k_døö_tx_buffs
(
©h5k_hw
 *
ah
)

1040 
©h5k_txq
 *
txq
;

1041 
©h5k_buf
 *
bf
, *
bf0
;

1042 
i
;

1044 
i
 = 0; i < 
	`ARRAY_SIZE
(
ah
->
txqs
); i++) {

1045 i‡(
ah
->
txqs
[
i
].
£tup
) {

1046 
txq
 = &
ah
->
txqs
[
i
];

1047 
	`•ö_lock_bh
(&
txq
->
lock
);

1048 
	`li°_f‹_óch_íåy_ß„
(
bf
, 
bf0
, &
txq
->
q
, 
li°
) {

1049 
	`©h5k_debug_¥öâxbuf
(
ah
, 
bf
);

1051 
	`©h5k_txbuf_‰ì_skb
(
ah
, 
bf
);

1053 
	`•ö_lock_bh
(&
ah
->
txbuÊock
);

1054 
	`li°_move_èû
(&
bf
->
li°
, &
ah
->
txbuf
);

1055 
ah
->
txbuf_Àn
++;

1056 
txq
->
txq_Àn
--;

1057 
	`•ö_u∆ock_bh
(&
ah
->
txbuÊock
);

1059 
txq
->
lök
 = 
NULL
;

1060 
txq
->
txq_pﬁl_m¨k
 = 
Ál£
;

1061 
	`•ö_u∆ock_bh
(&
txq
->
lock
);

1064 
	}
}

1067 
	$©h5k_txq_ªÀa£
(
©h5k_hw
 *
ah
)

1069 
©h5k_txq
 *
txq
 = 
ah
->
txqs
;

1070 
i
;

1072 
i
 = 0; i < 
	`ARRAY_SIZE
(
ah
->
txqs
); i++, 
txq
++)

1073 i‡(
txq
->
£tup
) {

1074 
	`©h5k_hw_ªÀa£_tx_queue
(
ah
, 
txq
->
qnum
);

1075 
txq
->
£tup
 = 
Ál£
;

1077 
	}
}

1088 
	$©h5k_rx_°¨t
(
©h5k_hw
 *
ah
)

1090 
©h_comm⁄
 *
comm⁄
 = 
	`©h5k_hw_comm⁄
(
ah
);

1091 
©h5k_buf
 *
bf
;

1092 
ªt
;

1094 
comm⁄
->
rx_bufsize
 = 
	`roundup
(
IEEE80211_MAX_FRAME_LEN
, comm⁄->
ˇchñsz
);

1096 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_RESET
, "cachelsz %uÑx_bufsize %u\n",

1097 
comm⁄
->
ˇchñsz
, comm⁄->
rx_bufsize
);

1099 
	`•ö_lock_bh
(&
ah
->
rxbuÊock
);

1100 
ah
->
rxlök
 = 
NULL
;

1101 
	`li°_f‹_óch_íåy
(
bf
, &
ah
->
rxbuf
, 
li°
) {

1102 
ªt
 = 
	`©h5k_rxbuf_£tup
(
ah
, 
bf
);

1103 i‡(
ªt
 != 0) {

1104 
	`•ö_u∆ock_bh
(&
ah
->
rxbuÊock
);

1105 
îr
;

1108 
bf
 = 
	`li°_fú°_íåy
(&
ah
->
rxbuf
, 
©h5k_buf
, 
li°
);

1109 
	`©h5k_hw_£t_rxdp
(
ah
, 
bf
->
daddr
);

1110 
	`•ö_u∆ock_bh
(&
ah
->
rxbuÊock
);

1112 
	`©h5k_hw_°¨t_rx_dma
(
ah
);

1113 
	`©h5k_upd©e_bssid_mask_™d_›mode
(
ah
, 
NULL
);

1114 
	`©h5k_hw_°¨t_rx_pcu
(
ah
);

1117 
îr
:

1118  
ªt
;

1119 
	}
}

1129 
	$©h5k_rx_°›
(
©h5k_hw
 *
ah
)

1132 
	`©h5k_hw_£t_rx_fûãr
(
ah
, 0);

1133 
	`©h5k_hw_°›_rx_pcu
(
ah
);

1135 
	`©h5k_debug_¥öåxbuffs
(
ah
);

1136 
	}
}

1139 
	$©h5k_rx_de¸y±ed
(
©h5k_hw
 *
ah
, 
sk_buff
 *
skb
,

1140 
©h5k_rx_°©us
 *
rs
)

1142 
©h_comm⁄
 *
comm⁄
 = 
	`©h5k_hw_comm⁄
(
ah
);

1143 
õì80211_hdr
 *
hdr
 = (*)
skb
->
d©a
;

1144 
keyix
, 
hÀn
;

1146 i‡(!(
rs
->
rs_°©us
 & 
AR5K_RXERR_DECRYPT
) &&

1147 
rs
->
rs_keyix
 !
AR5K_RXKEYIX_INVALID
)

1148  
RX_FLAG_DECRYPTED
;

1153 
hÀn
 = 
	`õì80211_hdæí
(
hdr
->
‰ame_c⁄åﬁ
);

1154 i‡(
	`õì80211_has_¥Ÿe˘ed
(
hdr
->
‰ame_c⁄åﬁ
) &&

1155 !(
rs
->
rs_°©us
 & 
AR5K_RXERR_DECRYPT
) &&

1156 
skb
->
Àn
 >
hÀn
 + 4) {

1157 
keyix
 = 
skb
->
d©a
[
hÀn
 + 3] >> 6;

1159 i‡(
	`ã°_bô
(
keyix
, 
comm⁄
->
keym≠
))

1160  
RX_FLAG_DECRYPTED
;

1164 
	}
}

1168 
	$©h5k_check_ibss_tsf
(
©h5k_hw
 *
ah
, 
sk_buff
 *
skb
,

1169 
õì80211_rx_°©us
 *
rxs
)

1171 
©h_comm⁄
 *
comm⁄
 = 
	`©h5k_hw_comm⁄
(
ah
);

1172 
u64
 
tsf
, 
bc_t°amp
;

1173 
u32
 
hw_tu
;

1174 
õì80211_mgmt
 *
mgmt
 = (õì80211_mgmà*)
skb
->
d©a
;

1176 i‡(
	`õì80211_is_bóc⁄
(
mgmt
->
‰ame_c⁄åﬁ
) &&

1177 
	`À16_to_˝u
(
mgmt
->
u
.
bóc⁄
.
ˇ∑b_öfo
Ë& 
WLAN_CAPABILITY_IBSS
 &&

1178 
	`memcmp
(
mgmt
->
bssid
, 
comm⁄
->
curbssid
, 
ETH_ALEN
) == 0) {

1184 
tsf
 = 
	`©h5k_hw_gë_tsf64
(
ah
);

1185 
bc_t°amp
 = 
	`À64_to_˝u
(
mgmt
->
u
.
bóc⁄
.
time°amp
);

1186 
hw_tu
 = 
	`TSF_TO_TU
(
tsf
);

1188 
	`ATH5K_DBG_UNLIMIT
(
ah
, 
ATH5K_DEBUG_BEACON
,

1190 ()
bc_t°amp
,

1191 ()
rxs
->
ma˘ime
,

1192 ()(
rxs
->
ma˘ime
 - 
bc_t°amp
),

1193 ()
tsf
);

1206 i‡(
bc_t°amp
 > 
rxs
->
ma˘ime
) {

1207 
	`ATH5K_DBG_UNLIMIT
(
ah
, 
ATH5K_DEBUG_BEACON
,

1209 ()
rxs
->
ma˘ime
,

1210 ()
tsf
);

1211 
rxs
->
ma˘ime
 = 
tsf
;

1220 i‡(
hw_tu
 >
ah
->
√xâbâ
)

1221 
	`©h5k_bóc⁄_upd©e_timîs
(
ah
, 
bc_t°amp
);

1226 i‡(!
	`©h5k_hw_check_bóc⁄_timîs
(
ah
,áh->
bötvÆ
)) {

1227 
	`©h5k_bóc⁄_upd©e_timîs
(
ah
, 
bc_t°amp
);

1228 
	`ATH5K_DBG_UNLIMIT
(
ah
, 
ATH5K_DEBUG_BEACON
,

1232 
	}
}

1235 
	$©h5k_upd©e_bóc⁄_rssi
(
©h5k_hw
 *
ah
, 
sk_buff
 *
skb
, 
rssi
)

1237 
õì80211_mgmt
 *
mgmt
 = (õì80211_mgmà*)
skb
->
d©a
;

1238 
©h_comm⁄
 *
comm⁄
 = 
	`©h5k_hw_comm⁄
(
ah
);

1241 i‡(!
	`õì80211_is_bóc⁄
(
mgmt
->
‰ame_c⁄åﬁ
) ||

1242 
	`memcmp
(
mgmt
->
bssid
, 
comm⁄
->
curbssid
, 
ETH_ALEN
) != 0)

1245 
	`ewma_add
(&
ah
->
ah_bóc⁄_rssi_avg
, 
rssi
);

1249 
	}
}

1254 
	$©h5k_comm⁄_∑dpos
(
sk_buff
 *
skb
)

1256 
õì80211_hdr
 *
hdr
 = (õì80211_hd∏*)
skb
->
d©a
;

1257 
__À16
 
‰ame_c⁄åﬁ
 = 
hdr
->frame_control;

1258 
∑dpos
 = 24;

1260 i‡(
	`õì80211_has_a4
(
‰ame_c⁄åﬁ
))

1261 
∑dpos
 +
ETH_ALEN
;

1263 i‡(
	`õì80211_is_d©a_qos
(
‰ame_c⁄åﬁ
))

1264 
∑dpos
 +
IEEE80211_QOS_CTL_LEN
;

1266  
∑dpos
;

1267 
	}
}

1273 
	$©h5k_add_∑ddög
(
sk_buff
 *
skb
)

1275 
∑dpos
 = 
	`©h5k_comm⁄_∑dpos
(
skb
);

1276 
∑dsize
 = 
∑dpos
 & 3;

1278 i‡(
∑dsize
 && 
skb
->
Àn
 > 
∑dpos
) {

1280 i‡(
	`skb_hódroom
(
skb
Ë< 
∑dsize
)

1283 
	`skb_push
(
skb
, 
∑dsize
);

1284 
	`memmove
(
skb
->
d©a
, skb->d©®+ 
∑dsize
, 
∑dpos
);

1285  
∑dsize
;

1289 
	}
}

1304 
	$©h5k_ªmove_∑ddög
(
sk_buff
 *
skb
)

1306 
∑dpos
 = 
	`©h5k_comm⁄_∑dpos
(
skb
);

1307 
∑dsize
 = 
∑dpos
 & 3;

1309 i‡(
∑dsize
 && 
skb
->
Àn
 >
∑dpos
 +Öadsize) {

1310 
	`memmove
(
skb
->
d©a
 + 
∑dsize
, skb->d©a, 
∑dpos
);

1311 
	`skb_puŒ
(
skb
, 
∑dsize
);

1312  
∑dsize
;

1316 
	}
}

1319 
	$©h5k_ª˚ive_‰ame
(
©h5k_hw
 *
ah
, 
sk_buff
 *
skb
,

1320 
©h5k_rx_°©us
 *
rs
)

1322 
õì80211_rx_°©us
 *
rxs
;

1324 
	`©h5k_ªmove_∑ddög
(
skb
);

1326 
rxs
 = 
	`IEEE80211_SKB_RXCB
(
skb
);

1328 
rxs
->
Êag
 = 0;

1329 i‡(
	`u∆ikñy
(
rs
->
rs_°©us
 & 
AR5K_RXERR_MIC
))

1330 
rxs
->
Êag
 |
RX_FLAG_MMIC_ERROR
;

1352 
rxs
->
ma˘ime
 = 
	`©h5k_exãnd_tsf
(
ah
, 
rs
->
rs_t°amp
);

1353 
rxs
->
Êag
 |
RX_FLAG_MACTIME_MPDU
;

1355 
rxs
->
‰eq
 = 
ah
->
curch™
->
˚¡î_‰eq
;

1356 
rxs
->
b™d
 = 
ah
->
curch™
->band;

1358 
rxs
->
sig«l
 = 
ah
->
ah_noi£_Êo‹
 + 
rs
->
rs_rssi
;

1360 
rxs
->
™ã¬a
 = 
rs
->
rs_™ã¬a
;

1362 i‡(
rs
->
rs_™ã¬a
 > 0 &&Ñs->rs_antenna < 5)

1363 
ah
->
°©s
.
™ã¬a_rx
[
rs
->
rs_™ã¬a
]++;

1365 
ah
->
°©s
.
™ã¬a_rx
[0]++;

1367 
rxs
->
øã_idx
 = 
	`©h5k_hw_to_drivî_rix
(
ah
, 
rs
->
rs_øã
);

1368 
rxs
->
Êag
 |
	`©h5k_rx_de¸y±ed
(
ah
, 
skb
, 
rs
);

1370 i‡(
rxs
->
øã_idx
 >0 && 
rs
->
rs_øã
 ==

1371 
ah
->
sb™ds
[ah->
curch™
->
b™d
].
bôøãs
[
rxs
->
øã_idx
].
hw_vÆue_sh‹t
)

1372 
rxs
->
Êag
 |
RX_FLAG_SHORTPRE
;

1374 
	`åa˚_©h5k_rx
(
ah
, 
skb
);

1376 
	`©h5k_upd©e_bóc⁄_rssi
(
ah
, 
skb
, 
rs
->
rs_rssi
);

1379 i‡(
ah
->
›mode
 =
NL80211_IFTYPE_ADHOC
)

1380 
	`©h5k_check_ibss_tsf
(
ah
, 
skb
, 
rxs
);

1382 
	`õì80211_rx
(
ah
->
hw
, 
skb
);

1383 
	}
}

1390 
boﬁ


1391 
	$©h5k_ª˚ive_‰ame_ok
(
©h5k_hw
 *
ah
, 
©h5k_rx_°©us
 *
rs
)

1393 
ah
->
°©s
.
rx_Æl_cou¡
++;

1394 
ah
->
°©s
.
rx_byãs_cou¡
 +
rs
->
rs_d©Æí
;

1396 i‡(
	`u∆ikñy
(
rs
->
rs_°©us
)) {

1397 i‡(
rs
->
rs_°©us
 & 
AR5K_RXERR_CRC
)

1398 
ah
->
°©s
.
rxîr_¸c
++;

1399 i‡(
rs
->
rs_°©us
 & 
AR5K_RXERR_FIFO
)

1400 
ah
->
°©s
.
rxîr_fifo
++;

1401 i‡(
rs
->
rs_°©us
 & 
AR5K_RXERR_PHY
) {

1402 
ah
->
°©s
.
rxîr_phy
++;

1403 i‡(
rs
->
rs_phyîr
 > 0 &&Ñs->rs_phyerr < 32)

1404 
ah
->
°©s
.
rxîr_phy_code
[
rs
->
rs_phyîr
]++;

1405  
Ál£
;

1407 i‡(
rs
->
rs_°©us
 & 
AR5K_RXERR_DECRYPT
) {

1418 
ah
->
°©s
.
rxîr_de¸y±
++;

1419 i‡(
rs
->
rs_keyix
 =
AR5K_RXKEYIX_INVALID
 &&

1420 !(
rs
->
rs_°©us
 & 
AR5K_RXERR_CRC
))

1421  
åue
;

1423 i‡(
rs
->
rs_°©us
 & 
AR5K_RXERR_MIC
) {

1424 
ah
->
°©s
.
rxîr_mic
++;

1425  
åue
;

1429 i‡(
rs
->
rs_°©us
 & ~(
AR5K_RXERR_DECRYPT
))

1430  
Ál£
;

1433 i‡(
	`u∆ikñy
(
rs
->
rs_m‹e
)) {

1434 
ah
->
°©s
.
rxîr_jumbo
++;

1435  
Ál£
;

1437  
åue
;

1438 
	}
}

1441 
	$©h5k_£t_cuºít_imask
(
©h5k_hw
 *
ah
)

1443 
©h5k_öt
 
imask
;

1444 
Êags
;

1446 
	`•ö_lock_úqßve
(&
ah
->
úqlock
, 
Êags
);

1447 
imask
 = 
ah
->imask;

1448 i‡(
ah
->
rx_≥ndög
)

1449 
imask
 &~
AR5K_INT_RX_ALL
;

1450 i‡(
ah
->
tx_≥ndög
)

1451 
imask
 &~
AR5K_INT_TX_ALL
;

1452 
	`©h5k_hw_£t_imr
(
ah
, 
imask
);

1453 
	`•ö_u∆ock_úqª°‹e
(&
ah
->
úqlock
, 
Êags
);

1454 
	}
}

1457 
	$©h5k_èskÀt_rx
(
d©a
)

1459 
©h5k_rx_°©us
 
rs
 = {};

1460 
sk_buff
 *
skb
, *
√xt_skb
;

1461 
dma_addr_t
 
√xt_skb_addr
;

1462 
©h5k_hw
 *
ah
 = (*)
d©a
;

1463 
©h_comm⁄
 *
comm⁄
 = 
	`©h5k_hw_comm⁄
(
ah
);

1464 
©h5k_buf
 *
bf
;

1465 
©h5k_desc
 *
ds
;

1466 
ªt
;

1468 
	`•ö_lock
(&
ah
->
rxbuÊock
);

1469 i‡(
	`li°_em±y
(&
ah
->
rxbuf
)) {

1470 
	`ATH5K_WARN
(
ah
, "emptyÑx bufÖool\n");

1471 
u∆ock
;

1474 
bf
 = 
	`li°_fú°_íåy
(&
ah
->
rxbuf
, 
©h5k_buf
, 
li°
);

1475 
	`BUG_ON
(
bf
->
skb
 =
NULL
);

1476 
skb
 = 
bf
->skb;

1477 
ds
 = 
bf
->
desc
;

1480 i‡(
	`©h5k_hw_gë_rxdp
(
ah
Ë=
bf
->
daddr
)

1483 
ªt
 = 
ah
->
	`ah_¥oc_rx_desc
◊h, 
ds
, &
rs
);

1484 i‡(
	`u∆ikñy
(
ªt
 =-
EINPROGRESS
))

1486 i‡(
	`u∆ikñy
(
ªt
)) {

1487 
	`ATH5K_ERR
(
ah
, "error inÖrocessingÑx descriptor\n");

1488 
ah
->
°©s
.
rxîr_¥oc
++;

1492 i‡(
	`©h5k_ª˚ive_‰ame_ok
(
ah
, &
rs
)) {

1493 
√xt_skb
 = 
	`©h5k_rx_skb_Æloc
(
ah
, &
√xt_skb_addr
);

1499 i‡(!
√xt_skb
)

1500 
√xt
;

1502 
	`dma_unm≠_sögÀ
(
ah
->
dev
, 
bf
->
skbaddr
,

1503 
comm⁄
->
rx_bufsize
,

1504 
DMA_FROM_DEVICE
);

1506 
	`skb_put
(
skb
, 
rs
.
rs_d©Æí
);

1508 
	`©h5k_ª˚ive_‰ame
(
ah
, 
skb
, &
rs
);

1510 
bf
->
skb
 = 
√xt_skb
;

1511 
bf
->
skbaddr
 = 
√xt_skb_addr
;

1513 
√xt
:

1514 
	`li°_move_èû
(&
bf
->
li°
, &
ah
->
rxbuf
);

1515 } 
	`©h5k_rxbuf_£tup
(
ah
, 
bf
) == 0);

1516 
u∆ock
:

1517 
	`•ö_u∆ock
(&
ah
->
rxbuÊock
);

1518 
ah
->
rx_≥ndög
 = 
Ál£
;

1519 
	`©h5k_£t_cuºít_imask
(
ah
);

1520 
	}
}

1528 
	$©h5k_tx_queue
(
õì80211_hw
 *
hw
, 
sk_buff
 *
skb
,

1529 
©h5k_txq
 *
txq
)

1531 
©h5k_hw
 *
ah
 = 
hw
->
¥iv
;

1532 
©h5k_buf
 *
bf
;

1533 
Êags
;

1534 
∑dsize
;

1536 
	`åa˚_©h5k_tx
(
ah
, 
skb
, 
txq
);

1542 
∑dsize
 = 
	`©h5k_add_∑ddög
(
skb
);

1543 i‡(
∑dsize
 < 0) {

1544 
	`ATH5K_ERR
(
ah
, "tx hdrlenÇot %%4:ÇotÉnough"

1546 
dr›_∑ckë
;

1549 i‡(
txq
->
txq_Àn
 >txq->
txq_max
 &&

1550 
txq
->
qnum
 <
AR5K_TX_QUEUE_ID_DATA_MAX
)

1551 
	`õì80211_°›_queue
(
hw
, 
txq
->
qnum
);

1553 
	`•ö_lock_úqßve
(&
ah
->
txbuÊock
, 
Êags
);

1554 i‡(
	`li°_em±y
(&
ah
->
txbuf
)) {

1555 
	`ATH5K_ERR
(
ah
, "no furtherÅxbufávailable, droppingÖacket\n");

1556 
	`•ö_u∆ock_úqª°‹e
(&
ah
->
txbuÊock
, 
Êags
);

1557 
	`õì80211_°›_queues
(
hw
);

1558 
dr›_∑ckë
;

1560 
bf
 = 
	`li°_fú°_íåy
(&
ah
->
txbuf
, 
©h5k_buf
, 
li°
);

1561 
	`li°_dñ
(&
bf
->
li°
);

1562 
ah
->
txbuf_Àn
--;

1563 i‡(
	`li°_em±y
(&
ah
->
txbuf
))

1564 
	`õì80211_°›_queues
(
hw
);

1565 
	`•ö_u∆ock_úqª°‹e
(&
ah
->
txbuÊock
, 
Êags
);

1567 
bf
->
skb
 = skb;

1569 i‡(
	`©h5k_txbuf_£tup
(
ah
, 
bf
, 
txq
, 
∑dsize
)) {

1570 
bf
->
skb
 = 
NULL
;

1571 
	`•ö_lock_úqßve
(&
ah
->
txbuÊock
, 
Êags
);

1572 
	`li°_add_èû
(&
bf
->
li°
, &
ah
->
txbuf
);

1573 
ah
->
txbuf_Àn
++;

1574 
	`•ö_u∆ock_úqª°‹e
(&
ah
->
txbuÊock
, 
Êags
);

1575 
dr›_∑ckë
;

1579 
dr›_∑ckë
:

1580 
	`dev_k‰ì_skb_™y
(
skb
);

1581 
	}
}

1584 
	$©h5k_tx_‰ame_com∂ëed
(
©h5k_hw
 *
ah
, 
sk_buff
 *
skb
,

1585 
©h5k_txq
 *
txq
, 
©h5k_tx_°©us
 *
ts
)

1587 
õì80211_tx_öfo
 *
öfo
;

1588 
u8
 
åõs
[3];

1589 
i
;

1591 
ah
->
°©s
.
tx_Æl_cou¡
++;

1592 
ah
->
°©s
.
tx_byãs_cou¡
 +
skb
->
Àn
;

1593 
öfo
 = 
	`IEEE80211_SKB_CB
(
skb
);

1595 
åõs
[0] = 
öfo
->
°©us
.
øãs
[0].
cou¡
;

1596 
åõs
[1] = 
öfo
->
°©us
.
øãs
[1].
cou¡
;

1597 
åõs
[2] = 
öfo
->
°©us
.
øãs
[2].
cou¡
;

1599 
	`õì80211_tx_öfo_˛ór_°©us
(
öfo
);

1601 
i
 = 0; i < 
ts
->
ts_föÆ_idx
; i++) {

1602 
õì80211_tx_øã
 *
r
 =

1603 &
öfo
->
°©us
.
øãs
[
i
];

1605 
r
->
cou¡
 = 
åõs
[
i
];

1608 
öfo
->
°©us
.
øãs
[
ts
->
ts_föÆ_idx
].
cou¡
 =Ås->
ts_föÆ_ªåy
;

1609 
öfo
->
°©us
.
øãs
[
ts
->
ts_föÆ_idx
 + 1].
idx
 = -1;

1611 i‡(
	`u∆ikñy
(
ts
->
ts_°©us
)) {

1612 
ah
->
°©s
.
ack_Áû
++;

1613 i‡(
ts
->
ts_°©us
 & 
AR5K_TXERR_FILT
) {

1614 
öfo
->
Êags
 |
IEEE80211_TX_STAT_TX_FILTERED
;

1615 
ah
->
°©s
.
txîr_fût
++;

1617 i‡(
ts
->
ts_°©us
 & 
AR5K_TXERR_XRETRY
)

1618 
ah
->
°©s
.
txîr_ªåy
++;

1619 i‡(
ts
->
ts_°©us
 & 
AR5K_TXERR_FIFO
)

1620 
ah
->
°©s
.
txîr_fifo
++;

1622 
öfo
->
Êags
 |
IEEE80211_TX_STAT_ACK
;

1623 
öfo
->
°©us
.
ack_sig«l
 = 
ts
->
ts_rssi
;

1626 
öfo
->
°©us
.
øãs
[
ts
->
ts_föÆ_idx
].
cou¡
++;

1633 
	`©h5k_ªmove_∑ddög
(
skb
);

1635 i‡(
ts
->
ts_™ã¬a
 > 0 &&Ås->ts_antenna < 5)

1636 
ah
->
°©s
.
™ã¬a_tx
[
ts
->
ts_™ã¬a
]++;

1638 
ah
->
°©s
.
™ã¬a_tx
[0]++;

1640 
	`åa˚_©h5k_tx_com∂ëe
(
ah
, 
skb
, 
txq
, 
ts
);

1641 
	`õì80211_tx_°©us
(
ah
->
hw
, 
skb
);

1642 
	}
}

1645 
	$©h5k_tx_¥o˚ssq
(
©h5k_hw
 *
ah
, 
©h5k_txq
 *
txq
)

1647 
©h5k_tx_°©us
 
ts
 = {};

1648 
©h5k_buf
 *
bf
, *
bf0
;

1649 
©h5k_desc
 *
ds
;

1650 
sk_buff
 *
skb
;

1651 
ªt
;

1653 
	`•ö_lock
(&
txq
->
lock
);

1654 
	`li°_f‹_óch_íåy_ß„
(
bf
, 
bf0
, &
txq
->
q
, 
li°
) {

1656 
txq
->
txq_pﬁl_m¨k
 = 
Ál£
;

1659 i‡(
bf
->
skb
 !
NULL
) {

1660 
ds
 = 
bf
->
desc
;

1662 
ªt
 = 
ah
->
	`ah_¥oc_tx_desc
◊h, 
ds
, &
ts
);

1663 i‡(
	`u∆ikñy
(
ªt
 =-
EINPROGRESS
))

1665 i‡(
	`u∆ikñy
(
ªt
)) {

1666 
	`ATH5K_ERR
(
ah
,

1668 "queuê%u\n", 
ªt
, 
txq
->
qnum
);

1672 
skb
 = 
bf
->skb;

1673 
bf
->
skb
 = 
NULL
;

1675 
	`dma_unm≠_sögÀ
(
ah
->
dev
, 
bf
->
skbaddr
, 
skb
->
Àn
,

1676 
DMA_TO_DEVICE
);

1677 
	`©h5k_tx_‰ame_com∂ëed
(
ah
, 
skb
, 
txq
, &
ts
);

1686 i‡(
	`©h5k_hw_gë_txdp
(
ah
, 
txq
->
qnum
Ë!
bf
->
daddr
) {

1687 
	`•ö_lock
(&
ah
->
txbuÊock
);

1688 
	`li°_move_èû
(&
bf
->
li°
, &
ah
->
txbuf
);

1689 
ah
->
txbuf_Àn
++;

1690 
txq
->
txq_Àn
--;

1691 
	`•ö_u∆ock
(&
ah
->
txbuÊock
);

1694 
	`•ö_u∆ock
(&
txq
->
lock
);

1695 i‡(
txq
->
txq_Àn
 < 
ATH5K_TXQ_LEN_LOW
 &&Åxq->
qnum
 < 4)

1696 
	`õì80211_wake_queue
(
ah
->
hw
, 
txq
->
qnum
);

1697 
	}
}

1700 
	$©h5k_èskÀt_tx
(
d©a
)

1702 
i
;

1703 
©h5k_hw
 *
ah
 = (*)
d©a
;

1705 
i
 = 0; i < 
AR5K_NUM_TX_QUEUES
; i++)

1706 i‡(
ah
->
txqs
[
i
].
£tup
 && (ah->
ah_txq_i§
 & 
	`BIT
(i)))

1707 
	`©h5k_tx_¥o˚ssq
(
ah
, &ah->
txqs
[
i
]);

1709 
ah
->
tx_≥ndög
 = 
Ál£
;

1710 
	`©h5k_£t_cuºít_imask
(
ah
);

1711 
	}
}

1722 
	$©h5k_bóc⁄_£tup
(
©h5k_hw
 *
ah
, 
©h5k_buf
 *
bf
)

1724 
sk_buff
 *
skb
 = 
bf
->skb;

1725 
õì80211_tx_öfo
 *
öfo
 = 
	`IEEE80211_SKB_CB
(
skb
);

1726 
©h5k_desc
 *
ds
;

1727 
ªt
 = 0;

1728 
u8
 
™ã¬a
;

1729 
u32
 
Êags
;

1730 c⁄° 
∑dsize
 = 0;

1732 
bf
->
skbaddr
 = 
	`dma_m≠_sögÀ
(
ah
->
dev
, 
skb
->
d©a
, skb->
Àn
,

1733 
DMA_TO_DEVICE
);

1734 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_BEACON
, "skb %p [data %pÜen %u] "

1735 "skbadd∏%Œx\n", 
skb
, skb->
d©a
, skb->
Àn
,

1736 ()
bf
->
skbaddr
);

1738 i‡(
	`dma_m≠pög_îr‹
(
ah
->
dev
, 
bf
->
skbaddr
)) {

1739 
	`ATH5K_ERR
(
ah
, "beacon DMA mapping failed\n");

1740 
	`dev_k‰ì_skb_™y
(
skb
);

1741 
bf
->
skb
 = 
NULL
;

1742  -
EIO
;

1745 
ds
 = 
bf
->
desc
;

1746 
™ã¬a
 = 
ah
->
ah_tx_™t
;

1748 
Êags
 = 
AR5K_TXDESC_NOACK
;

1749 i‡(
ah
->
›mode
 =
NL80211_IFTYPE_ADHOC
 && 
	`©h5k_hw_hasveﬁ
(ah)) {

1750 
ds
->
ds_lök
 = 
bf
->
daddr
;

1751 
Êags
 |
AR5K_TXDESC_VEOL
;

1753 
ds
->
ds_lök
 = 0;

1773 i‡(
ah
->
ah_™t_mode
 =
AR5K_ANTMODE_SECTOR_AP
)

1774 
™ã¬a
 = 
ah
->
b£¡
 & 4 ? 2 : 1;

1780 
ds
->
ds_d©a
 = 
bf
->
skbaddr
;

1781 
ªt
 = 
ah
->
	`ah_£tup_tx_desc
◊h, 
ds
, 
skb
->
Àn
,

1782 
	`õì80211_gë_hdæí_‰om_skb
(
skb
), 
∑dsize
,

1783 
AR5K_PKT_TYPE_BEACON
, (
ah
->
powî_Àvñ
 * 2),

1784 
	`õì80211_gë_tx_øã
(
ah
->
hw
, 
öfo
)->
hw_vÆue
,

1785 1, 
AR5K_TXKEYIX_INVALID
,

1786 
™ã¬a
, 
Êags
, 0, 0);

1787 i‡(
ªt
)

1788 
îr_unm≠
;

1791 
îr_unm≠
:

1792 
	`dma_unm≠_sögÀ
(
ah
->
dev
, 
bf
->
skbaddr
, 
skb
->
Àn
, 
DMA_TO_DEVICE
);

1793  
ªt
;

1794 
	}
}

1804 
	$©h5k_bóc⁄_upd©e
(
õì80211_hw
 *
hw
, 
õì80211_vif
 *
vif
)

1806 
ªt
;

1807 
©h5k_hw
 *
ah
 = 
hw
->
¥iv
;

1808 
©h5k_vif
 *
avf
 = (*)
vif
->
drv_¥iv
;

1809 
sk_buff
 *
skb
;

1811 i‡(
	`WARN_ON
(!
vif
)) {

1812 
ªt
 = -
EINVAL
;

1813 
out
;

1816 
skb
 = 
	`õì80211_bóc⁄_gë
(
hw
, 
vif
);

1818 i‡(!
skb
) {

1819 
ªt
 = -
ENOMEM
;

1820 
out
;

1823 
	`©h5k_txbuf_‰ì_skb
(
ah
, 
avf
->
bbuf
);

1824 
avf
->
bbuf
->
skb
 = skb;

1825 
ªt
 = 
	`©h5k_bóc⁄_£tup
(
ah
, 
avf
->
bbuf
);

1826 
out
:

1827  
ªt
;

1828 
	}
}

1839 
	$©h5k_bóc⁄_£nd
(
©h5k_hw
 *
ah
)

1841 
õì80211_vif
 *
vif
;

1842 
©h5k_vif
 *
avf
;

1843 
©h5k_buf
 *
bf
;

1844 
sk_buff
 *
skb
;

1845 
îr
;

1847 
	`ATH5K_DBG_UNLIMIT
(
ah
, 
ATH5K_DEBUG_BEACON
, "in beacon_send\n");

1856 i‡(
	`u∆ikñy
(
	`©h5k_hw_num_tx_≥ndög
(
ah
,áh->
bhÆq
) != 0)) {

1857 
ah
->
bmisscou¡
++;

1858 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_BEACON
,

1859 "mis£d %u c⁄£cutivêbóc⁄s\n", 
ah
->
bmisscou¡
);

1860 i‡(
ah
->
bmisscou¡
 > 10) {

1861 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_BEACON
,

1863 
ah
->
bmisscou¡
);

1864 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_RESET
,

1866 
	`õì80211_queue_w‹k
(
ah
->
hw
, &ah->
ª£t_w‹k
);

1870 i‡(
	`u∆ikñy
(
ah
->
bmisscou¡
 != 0)) {

1871 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_BEACON
,

1873 
ah
->
bmisscou¡
);

1874 
ah
->
bmisscou¡
 = 0;

1877 i‡((
ah
->
›mode
 =
NL80211_IFTYPE_AP
 &&áh->
num_≠_vifs
 > 1) ||

1878 
ah
->
›mode
 =
NL80211_IFTYPE_MESH_POINT
) {

1879 
u64
 
tsf
 = 
	`©h5k_hw_gë_tsf64
(
ah
);

1880 
u32
 
ts·u
 = 
	`TSF_TO_TU
(
tsf
);

1881 
¶Ÿ
 = ((
ts·u
 % 
ah
->
bötvÆ
Ë* 
ATH_BCBUF
) /áh->bintval;

1882 
vif
 = 
ah
->
b¶Ÿ
[(
¶Ÿ
 + 1Ë% 
ATH_BCBUF
];

1883 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_BEACON
,

1885 ()
tsf
, 
ts·u
, 
ah
->
bötvÆ
, 
¶Ÿ
, 
vif
);

1887 
vif
 = 
ah
->
b¶Ÿ
[0];

1889 i‡(!
vif
)

1892 
avf
 = (*)
vif
->
drv_¥iv
;

1893 
bf
 = 
avf
->
bbuf
;

1900 i‡(
	`u∆ikñy
(
	`©h5k_hw_°›_bóc⁄_queue
(
ah
,áh->
bhÆq
))) {

1901 
	`ATH5K_WARN
(
ah
, "bóc⁄ queuê%u didn'à°¨t/°› ?\n",áh->
bhÆq
);

1906 i‡(
ah
->
›mode
 =
NL80211_IFTYPE_AP
 ||

1907 
ah
->
›mode
 =
NL80211_IFTYPE_MESH_POINT
) {

1908 
îr
 = 
	`©h5k_bóc⁄_upd©e
(
ah
->
hw
, 
vif
);

1909 i‡(
îr
)

1913 i‡(
	`u∆ikñy
(
bf
->
skb
 =
NULL
 || 
ah
->
›mode
 =
NL80211_IFTYPE_STATION
 ||

1914 
ah
->
›mode
 =
NL80211_IFTYPE_MONITOR
)) {

1915 
	`ATH5K_WARN
(
ah
, "bf=%∞bf_skb=%p\n", 
bf
, bf->
skb
);

1919 
	`åa˚_©h5k_tx
(
ah
, 
bf
->
skb
, &ah->
txqs
[ah->
bhÆq
]);

1921 
	`©h5k_hw_£t_txdp
(
ah
,áh->
bhÆq
, 
bf
->
daddr
);

1922 
	`©h5k_hw_°¨t_tx_dma
(
ah
,áh->
bhÆq
);

1923 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_BEACON
, "TXDP[%u] = %llx (%p)\n",

1924 
ah
->
bhÆq
, ()
bf
->
daddr
, bf->
desc
);

1926 
skb
 = 
	`õì80211_gë_buf„ªd_bc
(
ah
->
hw
, 
vif
);

1927 
skb
) {

1928 
	`©h5k_tx_queue
(
ah
->
hw
, 
skb
,áh->
ˇbq
);

1930 i‡(
ah
->
ˇbq
->
txq_Àn
 >ah->ˇbq->
txq_max
)

1933 
skb
 = 
	`õì80211_gë_buf„ªd_bc
(
ah
->
hw
, 
vif
);

1936 
ah
->
b£¡
++;

1937 
	}
}

1956 
	$©h5k_bóc⁄_upd©e_timîs
(
©h5k_hw
 *
ah
, 
u64
 
bc_tsf
)

1958 
u32
 
√xâbâ
, 
ötvÆ
, 
hw_tu
, 
bc_tu
;

1959 
u64
 
hw_tsf
;

1961 
ötvÆ
 = 
ah
->
bötvÆ
 & 
AR5K_BEACON_PERIOD
;

1962 i‡(
ah
->
›mode
 =
NL80211_IFTYPE_AP
 &&áh->
num_≠_vifs
 > 1) {

1963 
ötvÆ
 /
ATH_BCBUF
;

1964 i‡(
ötvÆ
 < 15)

1965 
	`ATH5K_WARN
(
ah
, "intval %u isÅooÜow, min 15\n",

1966 
ötvÆ
);

1968 i‡(
	`WARN_ON
(!
ötvÆ
))

1972 
bc_tu
 = 
	`TSF_TO_TU
(
bc_tsf
);

1975 
hw_tsf
 = 
	`©h5k_hw_gë_tsf64
(
ah
);

1976 
hw_tu
 = 
	`TSF_TO_TU
(
hw_tsf
);

1978 
	#FUDGE
 (
AR5K_TUNE_SW_BEACON_RESP
 + 3)

	)

1983 i‡(
bc_tsf
 == -1) {

1988 
√xâbâ
 = 
	`roundup
(
hw_tu
 + 
FUDGE
, 
ötvÆ
);

1989 } i‡(
bc_tsf
 == 0) {

1994 
√xâbâ
 = 
ötvÆ
;

1995 
ötvÆ
 |
AR5K_BEACON_RESET_TSF
;

1996 } i‡(
bc_tsf
 > 
hw_tsf
) {

2004 
	`ATH5K_DBG_UNLIMIT
(
ah
, 
ATH5K_DEBUG_BEACON
,

2015 
√xâbâ
 = 
bc_tu
 + 
	`roundup
(
hw_tu
 + 
FUDGE
 - bc_tu, 
ötvÆ
);

2017 #unde‡
FUDGE


2019 
ah
->
√xâbâ
 =Çexttbtt;

2021 
ötvÆ
 |
AR5K_BEACON_ENA
;

2022 
	`©h5k_hw_öô_bóc⁄
(
ah
, 
√xâbâ
, 
ötvÆ
);

2028 i‡(
bc_tsf
 == -1)

2029 
	`ATH5K_DBG_UNLIMIT
(
ah
, 
ATH5K_DEBUG_BEACON
,

2031 i‡(
bc_tsf
 == 0)

2032 
	`ATH5K_DBG_UNLIMIT
(
ah
, 
ATH5K_DEBUG_BEACON
,

2035 
	`ATH5K_DBG_UNLIMIT
(
ah
, 
ATH5K_DEBUG_BEACON
,

2038 
	`ATH5K_DBG_UNLIMIT
(
ah
, 
ATH5K_DEBUG_BEACON
,

2040 (Ë
bc_tsf
,

2041 (Ë
hw_tsf
, 
bc_tu
, 
hw_tu
, 
√xâbâ
);

2042 
	`ATH5K_DBG_UNLIMIT
(
ah
, 
ATH5K_DEBUG_BEACON
, "intval %u %s %s\n",

2043 
ötvÆ
 & 
AR5K_BEACON_PERIOD
,

2044 
ötvÆ
 & 
AR5K_BEACON_ENA
 ? "AR5K_BEACON_ENA" : "",

2045 
ötvÆ
 & 
AR5K_BEACON_RESET_TSF
 ? "AR5K_BEACON_RESET_TSF" : "");

2046 
	}
}

2057 
	$©h5k_bóc⁄_c⁄fig
(
©h5k_hw
 *
ah
)

2059 
Êags
;

2061 
	`•ö_lock_úqßve
(&
ah
->
block
, 
Êags
);

2062 
ah
->
bmisscou¡
 = 0;

2063 
ah
->
imask
 &~(
AR5K_INT_BMISS
 | 
AR5K_INT_SWBA
);

2065 i‡(
ah
->
íabÀ_bóc⁄
) {

2073 
	`©h5k_bóc⁄q_c⁄fig
(
ah
);

2075 
ah
->
imask
 |
AR5K_INT_SWBA
;

2077 i‡(
ah
->
›mode
 =
NL80211_IFTYPE_ADHOC
) {

2078 i‡(
	`©h5k_hw_hasveﬁ
(
ah
))

2079 
	`©h5k_bóc⁄_£nd
(
ah
);

2081 
	`©h5k_bóc⁄_upd©e_timîs
(
ah
, -1);

2083 
	`©h5k_hw_°›_bóc⁄_queue
(
ah
,áh->
bhÆq
);

2086 
	`©h5k_hw_£t_imr
(
ah
,áh->
imask
);

2087 
	`mmiowb
();

2088 
	`•ö_u∆ock_úqª°‹e
(&
ah
->
block
, 
Êags
);

2089 
	}
}

2091 
	$©h5k_èskÀt_bóc⁄
(
d©a
)

2093 
©h5k_hw
 *
ah
 = (©h5k_hw *Ë
d©a
;

2103 i‡(
ah
->
›mode
 =
NL80211_IFTYPE_ADHOC
) {

2105 
u64
 
tsf
 = 
	`©h5k_hw_gë_tsf64
(
ah
);

2106 
ah
->
√xâbâ
 +ah->
bötvÆ
;

2107 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_BEACON
,

2110 
ah
->
√xâbâ
,

2111 
	`TSF_TO_TU
(
tsf
),

2112 (Ë
tsf
);

2114 
	`•ö_lock
(&
ah
->
block
);

2115 
	`©h5k_bóc⁄_£nd
(
ah
);

2116 
	`•ö_u∆ock
(&
ah
->
block
);

2118 
	}
}

2126 
	$©h5k_öå_ˇlibøti⁄_pﬁl
(
©h5k_hw
 *
ah
)

2128 i‡(
	`time_is_bef‹e_eq_jiffõs
(
ah
->
ah_ˇl_√xt_™i
) &&

2129 !(
ah
->
ah_ˇl_mask
 & 
AR5K_CALIBRATION_FULL
)) {

2131 
ah
->
ah_ˇl_√xt_™i
 = 
jiffõs
 +

2132 
	`m£cs_to_jiffõs
(
ATH5K_TUNE_CALIBRATION_INTERVAL_ANI
);

2133 
	`èskÀt_scheduÀ
(&
ah
->
™i_èskÀt
);

2135 } i‡(
	`time_is_bef‹e_eq_jiffõs
(
ah
->
ah_ˇl_√xt_fuŒ
)) {

2136 
ah
->
ah_ˇl_√xt_fuŒ
 = 
jiffõs
 +

2137 
	`m£cs_to_jiffõs
(
ATH5K_TUNE_CALIBRATION_INTERVAL_FULL
);

2138 
	`èskÀt_scheduÀ
(&
ah
->
ˇlib
);

2143 
	}
}

2146 
	$©h5k_scheduÀ_rx
(
©h5k_hw
 *
ah
)

2148 
ah
->
rx_≥ndög
 = 
åue
;

2149 
	`èskÀt_scheduÀ
(&
ah
->
rxtq
);

2150 
	}
}

2153 
	$©h5k_scheduÀ_tx
(
©h5k_hw
 *
ah
)

2155 
ah
->
tx_≥ndög
 = 
åue
;

2156 
	`èskÀt_scheduÀ
(&
ah
->
txtq
);

2157 
	}
}

2159 
úqªtu∫_t


2160 
	$©h5k_öå
(
úq
, *
dev_id
)

2162 
©h5k_hw
 *
ah
 = 
dev_id
;

2163 
©h5k_öt
 
°©us
;

2164 
cou¡î
 = 1000;

2166 i‡(
	`u∆ikñy
(
	`ã°_bô
(
ATH_STAT_INVALID
, 
ah
->
°©us
) ||

2167 ((
	`©h5k_gë_bus_ty≥
(
ah
Ë!
ATH_AHB
) &&

2168 !
	`©h5k_hw_is_öå_≥ndög
(
ah
))))

2169  
IRQ_NONE
;

2172 
	`©h5k_hw_gë_i§
(
ah
, &
°©us
);

2173 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_INTR
, "status 0x%x/0x%x\n",

2174 
°©us
, 
ah
->
imask
);

2175 i‡(
	`u∆ikñy
(
°©us
 & 
AR5K_INT_FATAL
)) {

2180 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_RESET
,

2182 
	`õì80211_queue_w‹k
(
ah
->
hw
, &ah->
ª£t_w‹k
);

2183 } i‡(
	`u∆ikñy
(
°©us
 & 
AR5K_INT_RXORN
)) {

2193 
ah
->
°©s
.
rx‹n_öå
++;

2194 i‡(
ah
->
ah_mac_§ev
 < 
AR5K_SREV_AR5212
) {

2195 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_RESET
,

2197 
	`õì80211_queue_w‹k
(
ah
->
hw
, &ah->
ª£t_w‹k
);

2199 
	`©h5k_scheduÀ_rx
(
ah
);

2201 i‡(
°©us
 & 
AR5K_INT_SWBA
)

2202 
	`èskÀt_hi_scheduÀ
(&
ah
->
bóc⁄tq
);

2204 i‡(
°©us
 & 
AR5K_INT_RXEOL
) {

2210 
ah
->
°©s
.
rxeﬁ_öå
++;

2212 i‡(
°©us
 & 
AR5K_INT_TXURN
) {

2214 
	`©h5k_hw_upd©e_tx_åigÀvñ
(
ah
, 
åue
);

2216 i‡(
°©us
 & (
AR5K_INT_RXOK
 | 
AR5K_INT_RXERR
))

2217 
	`©h5k_scheduÀ_rx
(
ah
);

2218 i‡(
°©us
 & (
AR5K_INT_TXOK
 | 
AR5K_INT_TXDESC


2219 | 
AR5K_INT_TXERR
 | 
AR5K_INT_TXEOL
))

2220 
	`©h5k_scheduÀ_tx
(
ah
);

2221 i‡(
°©us
 & 
AR5K_INT_BMISS
) {

2224 i‡(
°©us
 & 
AR5K_INT_MIB
) {

2225 
ah
->
°©s
.
mib_öå
++;

2226 
	`©h5k_hw_upd©e_mib_cou¡îs
(
ah
);

2227 
	`©h5k_™i_mib_öå
(
ah
);

2229 i‡(
°©us
 & 
AR5K_INT_GPIO
)

2230 
	`èskÀt_scheduÀ
(&
ah
->
rf_kûl
.
toggÀq
);

2234 i‡(
	`©h5k_gë_bus_ty≥
(
ah
Ë=
ATH_AHB
)

2237 } 
	`©h5k_hw_is_öå_≥ndög
(
ah
Ë&& --
cou¡î
 > 0);

2239 i‡(
ah
->
rx_≥ndög
 ||áh->
tx_≥ndög
)

2240 
	`©h5k_£t_cuºít_imask
(
ah
);

2242 i‡(
	`u∆ikñy
(!
cou¡î
))

2243 
	`ATH5K_WARN
(
ah
, "too many interrupts, giving up forÇow\n");

2245 
	`©h5k_öå_ˇlibøti⁄_pﬁl
(
ah
);

2247  
IRQ_HANDLED
;

2248 
	}
}

2255 
	$©h5k_èskÀt_ˇlibøã
(
d©a
)

2257 
©h5k_hw
 *
ah
 = (*)
d©a
;

2260 
ah
->
ah_ˇl_mask
 |
AR5K_CALIBRATION_FULL
;

2262 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_CALIBRATE
, "channel %u/%x\n",

2263 
	`õì80211_‰equícy_to_ch™√l
(
ah
->
curch™
->
˚¡î_‰eq
),

2264 
ah
->
curch™
->
hw_vÆue
);

2266 i‡(
	`©h5k_hw_gaöf_ˇlibøã
(
ah
Ë=
AR5K_RFGAIN_NEED_CHANGE
) {

2271 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_RESET
, "calibration,Ñesetting\n");

2272 
	`õì80211_queue_w‹k
(
ah
->
hw
, &ah->
ª£t_w‹k
);

2274 i‡(
	`©h5k_hw_phy_ˇlibøã
(
ah
,áh->
curch™
))

2275 
	`ATH5K_ERR
(
ah
, "calibration of channel %u failed\n",

2276 
	`õì80211_‰equícy_to_ch™√l
(

2277 
ah
->
curch™
->
˚¡î_‰eq
));

2283 i‡(
	`time_is_bef‹e_eq_jiffõs
(
ah
->
ah_ˇl_√xt_nf
)) {

2284 
ah
->
ah_ˇl_√xt_nf
 = 
jiffõs
 +

2285 
	`m£cs_to_jiffõs
(
ATH5K_TUNE_CALIBRATION_INTERVAL_NF
);

2286 
	`©h5k_hw_upd©e_noi£_Êo‹
(
ah
);

2289 
ah
->
ah_ˇl_mask
 &~
AR5K_CALIBRATION_FULL
;

2290 
	}
}

2294 
	$©h5k_èskÀt_™i
(
d©a
)

2296 
©h5k_hw
 *
ah
 = (*)
d©a
;

2298 
ah
->
ah_ˇl_mask
 |
AR5K_CALIBRATION_ANI
;

2299 
	`©h5k_™i_ˇlibøti⁄
(
ah
);

2300 
ah
->
ah_ˇl_mask
 &~
AR5K_CALIBRATION_ANI
;

2301 
	}
}

2305 
	$©h5k_tx_com∂ëe_pﬁl_w‹k
(
w‹k_°ru˘
 *
w‹k
)

2307 
©h5k_hw
 *
ah
 = 
	`c⁄èöî_of
(
w‹k
, ath5k_hw,

2308 
tx_com∂ëe_w‹k
.
w‹k
);

2309 
©h5k_txq
 *
txq
;

2310 
i
;

2311 
boﬁ
 
√edª£t
 = 
Ál£
;

2313 
	`muãx_lock
(&
ah
->
lock
);

2315 
i
 = 0; i < 
	`ARRAY_SIZE
(
ah
->
txqs
); i++) {

2316 i‡(
ah
->
txqs
[
i
].
£tup
) {

2317 
txq
 = &
ah
->
txqs
[
i
];

2318 
	`•ö_lock_bh
(&
txq
->
lock
);

2319 i‡(
txq
->
txq_Àn
 > 1) {

2320 i‡(
txq
->
txq_pﬁl_m¨k
) {

2321 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_XMIT
,

2323 
txq
->
qnum
);

2324 
√edª£t
 = 
åue
;

2325 
txq
->
txq_°uck
++;

2326 
	`•ö_u∆ock_bh
(&
txq
->
lock
);

2329 
txq
->
txq_pﬁl_m¨k
 = 
åue
;

2332 
	`•ö_u∆ock_bh
(&
txq
->
lock
);

2336 i‡(
√edª£t
) {

2337 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_RESET
,

2339 
	`©h5k_ª£t
(
ah
, 
NULL
, 
åue
);

2342 
	`muãx_u∆ock
(&
ah
->
lock
);

2344 
	`õì80211_queue_dñayed_w‹k
(
ah
->
hw
, &ah->
tx_com∂ëe_w‹k
,

2345 
	`m£cs_to_jiffõs
(
ATH5K_TX_COMPLETE_POLL_INT
));

2346 
	}
}

2353 
__devöô


2354 
	$©h5k_öô_so·c
(
©h5k_hw
 *
ah
, c⁄° 
©h_bus_›s
 *
bus_›s
)

2356 
õì80211_hw
 *
hw
 = 
ah
->hw;

2357 
©h_comm⁄
 *
comm⁄
;

2358 
ªt
;

2359 
csz
;

2362 
	`SET_IEEE80211_DEV
(
hw
, 
ah
->
dev
);

2363 
hw
->
Êags
 = 
IEEE80211_HW_RX_INCLUDES_FCS
 |

2364 
IEEE80211_HW_HOST_BROADCAST_PS_BUFFERING
 |

2365 
IEEE80211_HW_SIGNAL_DBM
 |

2366 
IEEE80211_HW_REPORTS_TX_ACK_STATUS
;

2368 
hw
->
wùhy
->
öãrÁ˚_modes
 =

2369 
	`BIT
(
NL80211_IFTYPE_AP
) |

2370 
	`BIT
(
NL80211_IFTYPE_STATION
) |

2371 
	`BIT
(
NL80211_IFTYPE_ADHOC
) |

2372 
	`BIT
(
NL80211_IFTYPE_MESH_POINT
);

2375 
hw
->
wùhy
->
avaûabÀ_™ã¬as_tx
 = 0x3;

2376 
hw
->
wùhy
->
avaûabÀ_™ã¬as_rx
 = 0x3;

2378 
hw
->
exåa_tx_hódroom
 = 2;

2379 
hw
->
ch™√l_ch™ge_time
 = 5000;

2385 
	`__£t_bô
(
ATH_STAT_INVALID
, 
ah
->
°©us
);

2387 
ah
->
›mode
 = 
NL80211_IFTYPE_STATION
;

2388 
ah
->
bötvÆ
 = 1000;

2389 
	`muãx_öô
(&
ah
->
lock
);

2390 
	`•ö_lock_öô
(&
ah
->
rxbuÊock
);

2391 
	`•ö_lock_öô
(&
ah
->
txbuÊock
);

2392 
	`•ö_lock_öô
(&
ah
->
block
);

2393 
	`•ö_lock_öô
(&
ah
->
úqlock
);

2396 
ªt
 = 
	`ªque°_úq
(
ah
->
úq
, 
©h5k_öå
, 
IRQF_SHARED
, "ath",áh);

2397 i‡(
ªt
) {

2398 
	`ATH5K_ERR
(
ah
, "request_irq failed\n");

2399 
îr
;

2402 
comm⁄
 = 
	`©h5k_hw_comm⁄
(
ah
);

2403 
comm⁄
->
›s
 = &
©h5k_comm⁄_›s
;

2404 
comm⁄
->
bus_›s
 = bus_ops;

2405 
comm⁄
->
ah
 =áh;

2406 
comm⁄
->
hw
 = hw;

2407 
comm⁄
->
¥iv
 = 
ah
;

2408 
comm⁄
->
˛ockøã
 = 40;

2414 
	`©h5k_ªad_ˇchesize
(
comm⁄
, &
csz
);

2415 
comm⁄
->
ˇchñsz
 = 
csz
 << 2;

2417 
	`•ö_lock_öô
(&
comm⁄
->
cc_lock
);

2420 
ªt
 = 
	`©h5k_hw_öô
(
ah
);

2421 i‡(
ªt
)

2422 
îr_úq
;

2425 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5212
) {

2426 
hw
->
max_øãs
 = 4;

2427 
hw
->
max_øã_åõs
 = 
	`max
(
AR5K_INIT_RETRY_SHORT
,

2428 
AR5K_INIT_RETRY_LONG
);

2431 
hw
->
vif_d©a_size
 = (
©h5k_vif
);

2434 
ªt
 = 
	`©h5k_öô
(
hw
);

2435 i‡(
ªt
)

2436 
îr_ah
;

2438 
	`ATH5K_INFO
(
ah
, "Atheros AR%s chip found (MAC: 0x%x, PHY: 0x%x)\n",

2439 
	`©h5k_chù_«me
(
AR5K_VERSION_MAC
, 
ah
->
ah_mac_§ev
),

2440 
ah
->
ah_mac_§ev
,

2441 
ah
->
ah_phy_ªvisi⁄
);

2443 i‡(!
ah
->
ah_sögÀ_chù
) {

2445 i‡(
ah
->
ah_ødio_5ghz_ªvisi⁄
 &&

2446 !
ah
->
ah_ødio_2ghz_ªvisi⁄
) {

2448 i‡(!
	`ã°_bô
(
AR5K_MODE_11A
,

2449 
ah
->
ah_ˇ∑bûôõs
.
ˇp_mode
)) {

2450 
	`ATH5K_INFO
(
ah
, "RF%s 2GHzÑadio found (0x%x)\n",

2451 
	`©h5k_chù_«me
(
AR5K_VERSION_RAD
,

2452 
ah
->
ah_ødio_5ghz_ªvisi⁄
),

2453 
ah
->
ah_ødio_5ghz_ªvisi⁄
);

2456 } i‡(!
	`ã°_bô
(
AR5K_MODE_11B
,

2457 
ah
->
ah_ˇ∑bûôõs
.
ˇp_mode
)) {

2458 
	`ATH5K_INFO
(
ah
, "RF%s 5GHzÑadio found (0x%x)\n",

2459 
	`©h5k_chù_«me
(
AR5K_VERSION_RAD
,

2460 
ah
->
ah_ødio_5ghz_ªvisi⁄
),

2461 
ah
->
ah_ødio_5ghz_ªvisi⁄
);

2464 
	`ATH5K_INFO
(
ah
, "RF%s multibandÑadio found"

2466 
	`©h5k_chù_«me
(
AR5K_VERSION_RAD
,

2467 
ah
->
ah_ødio_5ghz_ªvisi⁄
),

2468 
ah
->
ah_ødio_5ghz_ªvisi⁄
);

2473 i‡(
ah
->
ah_ødio_5ghz_ªvisi⁄
 &&

2474 
ah
->
ah_ødio_2ghz_ªvisi⁄
) {

2475 
	`ATH5K_INFO
(
ah
, "RF%s 5GHzÑadio found (0x%x)\n",

2476 
	`©h5k_chù_«me
(
AR5K_VERSION_RAD
,

2477 
ah
->
ah_ødio_5ghz_ªvisi⁄
),

2478 
ah
->
ah_ødio_5ghz_ªvisi⁄
);

2479 
	`ATH5K_INFO
(
ah
, "RF%s 2GHzÑadio found (0x%x)\n",

2480 
	`©h5k_chù_«me
(
AR5K_VERSION_RAD
,

2481 
ah
->
ah_ødio_2ghz_ªvisi⁄
),

2482 
ah
->
ah_ødio_2ghz_ªvisi⁄
);

2486 
	`©h5k_debug_öô_devi˚
(
ah
);

2489 
	`__˛ór_bô
(
ATH_STAT_INVALID
, 
ah
->
°©us
);

2492 
îr_ah
:

2493 
	`©h5k_hw_deöô
(
ah
);

2494 
îr_úq
:

2495 
	`‰ì_úq
(
ah
->
úq
,áh);

2496 
îr
:

2497  
ªt
;

2498 
	}
}

2501 
	$©h5k_°›_locked
(
©h5k_hw
 *
ah
)

2504 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_RESET
, "invalid %u\n",

2505 
	`ã°_bô
(
ATH_STAT_INVALID
, 
ah
->
°©us
));

2522 
	`õì80211_°›_queues
(
ah
->
hw
);

2524 i‡(!
	`ã°_bô
(
ATH_STAT_INVALID
, 
ah
->
°©us
)) {

2525 
	`©h5k_Àd_off
(
ah
);

2526 
	`©h5k_hw_£t_imr
(
ah
, 0);

2527 
	`synchr⁄ize_úq
(
ah
->
úq
);

2528 
	`©h5k_rx_°›
(
ah
);

2529 
	`©h5k_hw_dma_°›
(
ah
);

2530 
	`©h5k_døö_tx_buffs
(
ah
);

2531 
	`©h5k_hw_phy_dißbÀ
(
ah
);

2535 
	}
}

2537 
	$©h5k_°¨t
(
õì80211_hw
 *
hw
)

2539 
©h5k_hw
 *
ah
 = 
hw
->
¥iv
;

2540 
©h_comm⁄
 *
comm⁄
 = 
	`©h5k_hw_comm⁄
(
ah
);

2541 
ªt
, 
i
;

2543 
	`muãx_lock
(&
ah
->
lock
);

2545 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_RESET
, "modê%d\n",áh->
›mode
);

2551 
	`©h5k_°›_locked
(
ah
);

2560 
ah
->
curch™
 =áh->
hw
->
c⁄f
.
ch™√l
;

2561 
ah
->
imask
 = 
AR5K_INT_RXOK
 | 
AR5K_INT_RXERR
 | 
AR5K_INT_RXEOL
 |

2562 
AR5K_INT_RXORN
 | 
AR5K_INT_TXDESC
 | 
AR5K_INT_TXEOL
 |

2563 
AR5K_INT_FATAL
 | 
AR5K_INT_GLOBAL
 | 
AR5K_INT_MIB
;

2565 
ªt
 = 
	`©h5k_ª£t
(
ah
, 
NULL
, 
Ál£
);

2566 i‡(
ªt
)

2567 
d⁄e
;

2569 
	`©h5k_rfkûl_hw_°¨t
(
ah
);

2575 
i
 = 0; i < 
comm⁄
->
keymax
; i++)

2576 
	`©h_hw_keyª£t
(
comm⁄
, (
u16
Ë
i
);

2580 
ah
->
ah_ack_bôøã_high
 = 
åue
;

2582 
i
 = 0; i < 
	`ARRAY_SIZE
(
ah
->
b¶Ÿ
); i++)

2583 
ah
->
b¶Ÿ
[
i
] = 
NULL
;

2585 
ªt
 = 0;

2586 
d⁄e
:

2587 
	`mmiowb
();

2588 
	`muãx_u∆ock
(&
ah
->
lock
);

2590 
	`õì80211_queue_dñayed_w‹k
(
ah
->
hw
, &ah->
tx_com∂ëe_w‹k
,

2591 
	`m£cs_to_jiffõs
(
ATH5K_TX_COMPLETE_POLL_INT
));

2593  
ªt
;

2594 
	}
}

2596 
	$©h5k_°›_èskÀts
(
©h5k_hw
 *
ah
)

2598 
ah
->
rx_≥ndög
 = 
Ál£
;

2599 
ah
->
tx_≥ndög
 = 
Ál£
;

2600 
	`èskÀt_kûl
(&
ah
->
rxtq
);

2601 
	`èskÀt_kûl
(&
ah
->
txtq
);

2602 
	`èskÀt_kûl
(&
ah
->
ˇlib
);

2603 
	`èskÀt_kûl
(&
ah
->
bóc⁄tq
);

2604 
	`èskÀt_kûl
(&
ah
->
™i_èskÀt
);

2605 
	}
}

2613 
	$©h5k_°›
(
õì80211_hw
 *
hw
)

2615 
©h5k_hw
 *
ah
 = 
hw
->
¥iv
;

2616 
ªt
;

2618 
	`muãx_lock
(&
ah
->
lock
);

2619 
ªt
 = 
	`©h5k_°›_locked
(
ah
);

2620 i‡(
ªt
 =0 && !
	`ã°_bô
(
ATH_STAT_INVALID
, 
ah
->
°©us
)) {

2641 
ªt
 = 
	`©h5k_hw_⁄_hﬁd
(
ah
);

2643 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_RESET
,

2647 
	`mmiowb
();

2648 
	`muãx_u∆ock
(&
ah
->
lock
);

2650 
	`©h5k_°›_èskÀts
(
ah
);

2652 
	`ˇn˚l_dñayed_w‹k_sync
(&
ah
->
tx_com∂ëe_w‹k
);

2654 
	`©h5k_rfkûl_hw_°›
(
ah
);

2655 
	}
}

2664 
	$©h5k_ª£t
(
©h5k_hw
 *
ah
, 
õì80211_ch™√l
 *
ch™
,

2665 
boﬁ
 
skù_pcu
)

2667 
©h_comm⁄
 *
comm⁄
 = 
	`©h5k_hw_comm⁄
(
ah
);

2668 
ªt
, 
™i_mode
;

2669 
boﬁ
 
Á°
;

2671 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_RESET
, "resetting\n");

2673 
	`©h5k_hw_£t_imr
(
ah
, 0);

2674 
	`synchr⁄ize_úq
(
ah
->
úq
);

2675 
	`©h5k_°›_èskÀts
(
ah
);

2680 
™i_mode
 = 
ah
->
™i_°©e
.ani_mode;

2681 
	`©h5k_™i_öô
(
ah
, 
ATH5K_ANI_MODE_OFF
);

2686 
	`©h5k_døö_tx_buffs
(
ah
);

2687 i‡(
ch™
)

2688 
ah
->
curch™
 = 
ch™
;

2690 
Á°
 = ((
ch™
 !
NULL
Ë&& 
mod∑øm_Á°ch™swôch
) ? 1 : 0;

2692 
ªt
 = 
	`©h5k_hw_ª£t
(
ah
,áh->
›mode
,áh->
curch™
, 
Á°
, 
skù_pcu
);

2693 i‡(
ªt
) {

2694 
	`ATH5K_ERR
(
ah
, "ˇn'àª£àh¨dw¨ê(%d)\n", 
ªt
);

2695 
îr
;

2698 
ªt
 = 
	`©h5k_rx_°¨t
(
ah
);

2699 i‡(
ªt
) {

2700 
	`ATH5K_ERR
(
ah
, "can't startÑecvÜogic\n");

2701 
îr
;

2704 
	`©h5k_™i_öô
(
ah
, 
™i_mode
);

2706 
ah
->
ah_ˇl_√xt_fuŒ
 = 
jiffõs
 + 
	`m£cs_to_jiffõs
(100);

2707 
ah
->
ah_ˇl_√xt_™i
 = 
jiffõs
;

2708 
ah
->
ah_ˇl_√xt_nf
 = 
jiffõs
;

2709 
	`ewma_öô
(&
ah
->
ah_bóc⁄_rssi_avg
, 1024, 8);

2712 
	`mem£t
(&
ah
->
survey
, 0, (ah->survey));

2713 
	`•ö_lock_bh
(&
comm⁄
->
cc_lock
);

2714 
	`©h_hw_cy˛e_cou¡îs_upd©e
(
comm⁄
);

2715 
	`mem£t
(&
comm⁄
->
cc_survey
, 0, (common->cc_survey));

2716 
	`mem£t
(&
comm⁄
->
cc_™i
, 0, (common->cc_ani));

2717 
	`•ö_u∆ock_bh
(&
comm⁄
->
cc_lock
);

2730 
	`©h5k_bóc⁄_c⁄fig
(
ah
);

2733 
	`õì80211_wake_queues
(
ah
->
hw
);

2736 
îr
:

2737  
ªt
;

2738 
	}
}

2740 
	$©h5k_ª£t_w‹k
(
w‹k_°ru˘
 *
w‹k
)

2742 
©h5k_hw
 *
ah
 = 
	`c⁄èöî_of
(
w‹k
, ath5k_hw,

2743 
ª£t_w‹k
);

2745 
	`muãx_lock
(&
ah
->
lock
);

2746 
	`©h5k_ª£t
(
ah
, 
NULL
, 
åue
);

2747 
	`muãx_u∆ock
(&
ah
->
lock
);

2748 
	}
}

2750 
__devöô


2751 
	$©h5k_öô
(
õì80211_hw
 *
hw
)

2754 
©h5k_hw
 *
ah
 = 
hw
->
¥iv
;

2755 
©h_ªguœt‹y
 *
ªguœt‹y
 = 
	`©h5k_hw_ªguœt‹y
(
ah
);

2756 
©h5k_txq
 *
txq
;

2757 
u8
 
mac
[
ETH_ALEN
] = {};

2758 
ªt
;

2768 
ªt
 = 
	`©h5k_hw_£tup_mº_tx_desc
(
ah
, 
NULL
, 0, 0, 0, 0, 0, 0);

2770 i‡(
ªt
 < 0)

2771 
îr
;

2772 i‡(
ªt
 > 0)

2773 
	`__£t_bô
(
ATH_STAT_MRRETRY
, 
ah
->
°©us
);

2781 
ªt
 = 
	`©h5k_£tup_b™ds
(
hw
);

2782 i‡(
ªt
) {

2783 
	`ATH5K_ERR
(
ah
, "can't get channels\n");

2784 
îr
;

2790 
ªt
 = 
	`©h5k_desc_Æloc
(
ah
);

2791 i‡(
ªt
) {

2792 
	`ATH5K_ERR
(
ah
, "can'tállocate descriptors\n");

2793 
îr
;

2802 
ªt
 = 
	`©h5k_bóc⁄q_£tup
(
ah
);

2803 i‡(
ªt
 < 0) {

2804 
	`ATH5K_ERR
(
ah
, "can't setupá beacon xmit queue\n");

2805 
îr_desc
;

2807 
ah
->
bhÆq
 = 
ªt
;

2808 
ah
->
ˇbq
 = 
	`©h5k_txq_£tup
◊h, 
AR5K_TX_QUEUE_CAB
, 0);

2809 i‡(
	`IS_ERR
(
ah
->
ˇbq
)) {

2810 
	`ATH5K_ERR
(
ah
, "can't setup cab queue\n");

2811 
ªt
 = 
	`PTR_ERR
(
ah
->
ˇbq
);

2812 
îr_bhÆ
;

2817 i‡(
ah
->
ah_ˇ∑bûôõs
.
ˇp_queues
.
q_tx_num
 >= 6) {

2820 
txq
 = 
	`©h5k_txq_£tup
(
ah
, 
AR5K_TX_QUEUE_DATA
, 
AR5K_WME_AC_VO
);

2821 i‡(
	`IS_ERR
(
txq
)) {

2822 
	`ATH5K_ERR
(
ah
, "can't setup xmit queue\n");

2823 
ªt
 = 
	`PTR_ERR
(
txq
);

2824 
îr_queues
;

2826 
txq
 = 
	`©h5k_txq_£tup
(
ah
, 
AR5K_TX_QUEUE_DATA
, 
AR5K_WME_AC_VI
);

2827 i‡(
	`IS_ERR
(
txq
)) {

2828 
	`ATH5K_ERR
(
ah
, "can't setup xmit queue\n");

2829 
ªt
 = 
	`PTR_ERR
(
txq
);

2830 
îr_queues
;

2832 
txq
 = 
	`©h5k_txq_£tup
(
ah
, 
AR5K_TX_QUEUE_DATA
, 
AR5K_WME_AC_BE
);

2833 i‡(
	`IS_ERR
(
txq
)) {

2834 
	`ATH5K_ERR
(
ah
, "can't setup xmit queue\n");

2835 
ªt
 = 
	`PTR_ERR
(
txq
);

2836 
îr_queues
;

2838 
txq
 = 
	`©h5k_txq_£tup
(
ah
, 
AR5K_TX_QUEUE_DATA
, 
AR5K_WME_AC_BK
);

2839 i‡(
	`IS_ERR
(
txq
)) {

2840 
	`ATH5K_ERR
(
ah
, "can't setup xmit queue\n");

2841 
ªt
 = 
	`PTR_ERR
(
txq
);

2842 
îr_queues
;

2844 
hw
->
queues
 = 4;

2847 
txq
 = 
	`©h5k_txq_£tup
(
ah
, 
AR5K_TX_QUEUE_DATA
, 
AR5K_WME_AC_BE
);

2848 i‡(
	`IS_ERR
(
txq
)) {

2849 
	`ATH5K_ERR
(
ah
, "can't setup xmit queue\n");

2850 
ªt
 = 
	`PTR_ERR
(
txq
);

2851 
îr_queues
;

2853 
hw
->
queues
 = 1;

2856 
	`èskÀt_öô
(&
ah
->
rxtq
, 
©h5k_èskÀt_rx
, ()ah);

2857 
	`èskÀt_öô
(&
ah
->
txtq
, 
©h5k_èskÀt_tx
, ()ah);

2858 
	`èskÀt_öô
(&
ah
->
ˇlib
, 
©h5k_èskÀt_ˇlibøã
, ()ah);

2859 
	`èskÀt_öô
(&
ah
->
bóc⁄tq
, 
©h5k_èskÀt_bóc⁄
, ()ah);

2860 
	`èskÀt_öô
(&
ah
->
™i_èskÀt
, 
©h5k_èskÀt_™i
, ()ah);

2862 
	`INIT_WORK
(&
ah
->
ª£t_w‹k
, 
©h5k_ª£t_w‹k
);

2863 
	`INIT_DELAYED_WORK
(&
ah
->
tx_com∂ëe_w‹k
, 
©h5k_tx_com∂ëe_pﬁl_w‹k
);

2865 
ªt
 = 
	`©h5k_hw_comm⁄
(
ah
)->
bus_›s
->
	`ì¥om_ªad_mac
◊h, 
mac
);

2866 i‡(
ªt
) {

2867 
	`ATH5K_ERR
(
ah
, "unableÅoÑeadáddress from EEPROM\n");

2868 
îr_queues
;

2871 
	`SET_IEEE80211_PERM_ADDR
(
hw
, 
mac
);

2872 
	`mem˝y
(&
ah
->
Œaddr
, 
mac
, 
ETH_ALEN
);

2874 
	`©h5k_upd©e_bssid_mask_™d_›mode
(
ah
, 
NULL
);

2876 
ªguœt‹y
->
cuºít_rd
 = 
ah
->
ah_ˇ∑bûôõs
.
ˇp_ì¥om
.
ì_ªgdomaö
;

2877 
ªt
 = 
	`©h_ªgd_öô
(
ªguœt‹y
, 
hw
->
wùhy
, 
©h5k_ªg_nŸifõr
);

2878 i‡(
ªt
) {

2879 
	`ATH5K_ERR
(
ah
, "can't initializeÑegulatory system\n");

2880 
îr_queues
;

2883 
ªt
 = 
	`õì80211_ªgi°î_hw
(
hw
);

2884 i‡(
ªt
) {

2885 
	`ATH5K_ERR
(
ah
, "can'tÑegister ieee80211 hw\n");

2886 
îr_queues
;

2889 i‡(!
	`©h_is_w‹ld_ªgd
(
ªguœt‹y
))

2890 
	`ªguœt‹y_höt
(
hw
->
wùhy
, 
ªguœt‹y
->
Æpha2
);

2892 
	`©h5k_öô_Àds
(
ah
);

2894 
	`©h5k_sysfs_ªgi°î
(
ah
);

2897 
îr_queues
:

2898 
	`©h5k_txq_ªÀa£
(
ah
);

2899 
îr_bhÆ
:

2900 
	`©h5k_hw_ªÀa£_tx_queue
(
ah
,áh->
bhÆq
);

2901 
îr_desc
:

2902 
	`©h5k_desc_‰ì
(
ah
);

2903 
îr
:

2904  
ªt
;

2905 
	}
}

2908 
	$©h5k_deöô_so·c
(
©h5k_hw
 *
ah
)

2910 
õì80211_hw
 *
hw
 = 
ah
->hw;

2925 
	`õì80211_uƒegi°î_hw
(
hw
);

2926 
	`©h5k_desc_‰ì
(
ah
);

2927 
	`©h5k_txq_ªÀa£
(
ah
);

2928 
	`©h5k_hw_ªÀa£_tx_queue
(
ah
,áh->
bhÆq
);

2929 
	`©h5k_uƒegi°î_Àds
(
ah
);

2931 
	`©h5k_sysfs_uƒegi°î
(
ah
);

2937 
	`©h5k_hw_deöô
(
ah
);

2938 
	`‰ì_úq
(
ah
->
úq
,áh);

2939 
	}
}

2941 
boﬁ


2942 
	$©h5k_™y_vif_assoc
(
©h5k_hw
 *
ah
)

2944 
©h5k_vif_ôî_d©a
 
ôî_d©a
;

2945 
ôî_d©a
.
hw_maˇddr
 = 
NULL
;

2946 
ôî_d©a
.
™y_assoc
 = 
Ál£
;

2947 
ôî_d©a
.
√ed_£t_hw_addr
 = 
Ál£
;

2948 
ôî_d©a
.
found_a˘ive
 = 
åue
;

2950 
	`õì80211_ôî©e_a˘ive_öãrÁ˚s_©omic
(
ah
->
hw
, 
©h5k_vif_ôî
,

2951 &
ôî_d©a
);

2952  
ôî_d©a
.
™y_assoc
;

2953 
	}
}

2956 
	$©h5k_£t_bóc⁄_fûãr
(
õì80211_hw
 *
hw
, 
boﬁ
 
íabÀ
)

2958 
©h5k_hw
 *
ah
 = 
hw
->
¥iv
;

2959 
u32
 
rfût
;

2960 
rfût
 = 
	`©h5k_hw_gë_rx_fûãr
(
ah
);

2961 i‡(
íabÀ
)

2962 
rfût
 |
AR5K_RX_FILTER_BEACON
;

2964 
rfût
 &~
AR5K_RX_FILTER_BEACON
;

2965 
	`©h5k_hw_£t_rx_fûãr
(
ah
, 
rfût
);

2966 
ah
->
fûãr_Êags
 = 
rfût
;

2967 
	}
}

	@ath5k/base.h

41 #i‚de‡
_DEV_ATH_ATHVAR_H


42 
	#_DEV_ATH_ATHVAR_H


	)

44 
	~<löux/öãºu±.h
>

45 
	~<löux/li°.h
>

46 
	~<löux/wúñess.h
>

47 
	~<löux/if_ëhî.h
>

48 
	~<löux/rfkûl.h
>

49 
	~<löux/w‹kqueue.h
>

51 
	~"©h5k.h
"

52 
	~"../ªgd.h
"

53 
	~"../©h.h
"

55 
	s©h5k_buf
 {

56 
li°_hód
 
	mli°
;

57 
©h5k_desc
 *
	mdesc
;

58 
dma_addr_t
 
	mdaddr
;

59 
sk_buff
 *
	mskb
;

60 
dma_addr_t
 
	mskbaddr
;

63 
	s©h5k_vif
 {

64 
boﬁ
 
	massoc
;

65 
∆80211_i·y≥
 
	m›mode
;

66 
	mb¶Ÿ
;

67 
©h5k_buf
 *
	mbbuf
;

68 
u8
 
	mŒaddr
[
ETH_ALEN
];

71 
	s©h5k_vif_ôî_d©a
 {

72 c⁄° 
u8
 *
	mhw_maˇddr
;

73 
u8
 
	mmask
[
ETH_ALEN
];

74 
u8
 
	ma˘ive_mac
[
ETH_ALEN
];

75 
boﬁ
 
	m√ed_£t_hw_addr
;

76 
boﬁ
 
	mfound_a˘ive
;

77 
boﬁ
 
	m™y_assoc
;

78 
∆80211_i·y≥
 
	m›mode
;

79 
	mn_°as
;

81 
©h5k_vif_ôî
(*
d©a
, 
u8
 *
mac
, 
õì80211_vif
 *
vif
);

85 
	#©h5k_hw_hasbssidmask
(
_ah
Ë(
ah
->
ah_vîsi⁄
 =
AR5K_AR5212
)

	)

88 
	#©h5k_hw_hasveﬁ
(
_ah
Ë(
ah
->
ah_vîsi⁄
 !
AR5K_AR5210
)

	)

	@ath5k/caps.c

24 
	~"©h5k.h
"

25 
	~"ªg.h
"

26 
	~"debug.h
"

27 
	~"ba£.h
"

33 
	$©h5k_hw_£t_ˇ∑bûôõs
(
©h5k_hw
 *
ah
)

35 
©h5k_ˇ∑bûôõs
 *
ˇps
 = &
ah
->
ah_ˇ∑bûôõs
;

36 
u16
 
ì_hódî
;

39 
ì_hódî
 = 
ˇps
->
ˇp_ì¥om
.ee_header;

41 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
) {

46 
ˇps
->
ˇp_ønge
.
ønge_5ghz_mö
 = 5120;

47 
ˇps
->
ˇp_ønge
.
ønge_5ghz_max
 = 5430;

48 
ˇps
->
ˇp_ønge
.
ønge_2ghz_mö
 = 0;

49 
ˇps
->
ˇp_ønge
.
ønge_2ghz_max
 = 0;

52 
	`__£t_bô
(
AR5K_MODE_11A
, 
ˇps
->
ˇp_mode
);

68 i‡(
	`AR5K_EEPROM_HDR_11A
(
ì_hódî
)) {

69 i‡(
	`©h_is_49ghz_Ælowed
(
ˇps
->
ˇp_ì¥om
.
ì_ªgdomaö
))

70 
ˇps
->
ˇp_ønge
.
ønge_5ghz_mö
 = 4920;

72 
ˇps
->
ˇp_ønge
.
ønge_5ghz_mö
 = 5005;

73 
ˇps
->
ˇp_ønge
.
ønge_5ghz_max
 = 6100;

76 
	`__£t_bô
(
AR5K_MODE_11A
, 
ˇps
->
ˇp_mode
);

81 i‡(
	`AR5K_EEPROM_HDR_11B
(
ì_hódî
) ||

82 (
	`AR5K_EEPROM_HDR_11G
(
ì_hódî
) &&

83 
ah
->
ah_vîsi⁄
 !
AR5K_AR5211
)) {

85 
ˇps
->
ˇp_ønge
.
ønge_2ghz_mö
 = 2412;

86 
ˇps
->
ˇp_ønge
.
ønge_2ghz_max
 = 2732;

88 i‡(
	`AR5K_EEPROM_HDR_11B
(
ì_hódî
))

89 
	`__£t_bô
(
AR5K_MODE_11B
, 
ˇps
->
ˇp_mode
);

91 i‡(
	`AR5K_EEPROM_HDR_11G
(
ì_hódî
) &&

92 
ah
->
ah_vîsi⁄
 !
AR5K_AR5211
)

93 
	`__£t_bô
(
AR5K_MODE_11G
, 
ˇps
->
ˇp_mode
);

97 i‡((
ah
->
ah_ødio_5ghz_ªvisi⁄
 & 0xf0Ë=
AR5K_SREV_RAD_2112
)

98 
	`__˛ór_bô
(
AR5K_MODE_11A
, 
ˇps
->
ˇp_mode
);

101 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
)

102 
ˇps
->
ˇp_queues
.
q_tx_num
 = 
AR5K_NUM_TX_QUEUES_NOQCU
;

104 
ˇps
->
ˇp_queues
.
q_tx_num
 = 
AR5K_NUM_TX_QUEUES
;

107 i‡(
ah
->
ah_mac_§ev
 >
AR5K_SREV_AR5213A
)

108 
ˇps
->
ˇp_has_phyîr_cou¡îs
 = 
åue
;

110 
ˇps
->
ˇp_has_phyîr_cou¡îs
 = 
Ál£
;

113 
	}
}

120 
	$©h5k_hw_íabÀ_p•ﬁl
(
©h5k_hw
 *
ah
, 
u8
 *
bssid
,

121 
u16
 
assoc_id
)

123 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
) {

124 
	`AR5K_REG_DISABLE_BITS
(
ah
, 
AR5K_STA_ID1
,

125 
AR5K_STA_ID1_NO_PSPOLL
 | 
AR5K_STA_ID1_DEFAULT_ANTENNA
);

129  -
EIO
;

130 
	}
}

132 
	$©h5k_hw_dißbÀ_p•ﬁl
(
©h5k_hw
 *
ah
)

134 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
) {

135 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_STA_ID1
,

136 
AR5K_STA_ID1_NO_PSPOLL
 | 
AR5K_STA_ID1_DEFAULT_ANTENNA
);

140  -
EIO
;

141 
	}
}

	@ath5k/debug.c

61 
	~"ba£.h
"

62 
	~"debug.h
"

63 
	~"../©h.h
"

65 
	g©h5k_debug
;

66 
moduÀ_∑øm_«med
(
debug
, 
©h5k_debug
, 
uöt
, 0);

68 c⁄° *
	$©h_›mode_to_°rög
(
∆80211_i·y≥
 
›mode
)

70 
›mode
) {

71 
NL80211_IFTYPE_UNSPECIFIED
:

73 
NL80211_IFTYPE_ADHOC
:

75 
NL80211_IFTYPE_STATION
:

77 
NL80211_IFTYPE_AP
:

79 
NL80211_IFTYPE_AP_VLAN
:

81 
NL80211_IFTYPE_WDS
:

83 
NL80211_IFTYPE_MONITOR
:

85 
NL80211_IFTYPE_MESH_POINT
:

87 
NL80211_IFTYPE_P2P_CLIENT
:

89 
NL80211_IFTYPE_P2P_GO
:

94 
	}
}

97 #ifde‡
CONFIG_ATH5K_DEBUG


99 
	~<löux/£q_fûe.h
>

100 
	~"ªg.h
"

101 
	~"™i.h
"

103 
	$©h5k_debugfs_›í
(
öode
 *öode, 
fûe
 *file)

105 
fûe
->
¥iv©e_d©a
 = 
öode
->
i_¥iv©e
;

107 
	}
}

112 
	sªg
 {

113 c⁄° *
	m«me
;

114 
	maddr
;

117 
	#REG_STRUCT_INIT
(
r
Ë{ #r,Ñ }

	)

120 c⁄° 
ªg
 
	gªgs
[] = {

121 
REG_STRUCT_INIT
(
AR5K_CR
),

122 
REG_STRUCT_INIT
(
AR5K_RXDP
),

123 
REG_STRUCT_INIT
(
AR5K_CFG
),

124 
REG_STRUCT_INIT
(
AR5K_IER
),

125 
REG_STRUCT_INIT
(
AR5K_BCR
),

126 
REG_STRUCT_INIT
(
AR5K_RTSD0
),

127 
REG_STRUCT_INIT
(
AR5K_RTSD1
),

128 
REG_STRUCT_INIT
(
AR5K_TXCFG
),

129 
REG_STRUCT_INIT
(
AR5K_RXCFG
),

130 
REG_STRUCT_INIT
(
AR5K_RXJLA
),

131 
REG_STRUCT_INIT
(
AR5K_MIBC
),

132 
REG_STRUCT_INIT
(
AR5K_TOPS
),

133 
REG_STRUCT_INIT
(
AR5K_RXNOFRM
),

134 
REG_STRUCT_INIT
(
AR5K_TXNOFRM
),

135 
REG_STRUCT_INIT
(
AR5K_RPGTO
),

136 
REG_STRUCT_INIT
(
AR5K_RFCNT
),

137 
REG_STRUCT_INIT
(
AR5K_MISC
),

138 
REG_STRUCT_INIT
(
AR5K_QCUDCU_CLKGT
),

139 
REG_STRUCT_INIT
(
AR5K_ISR
),

140 
REG_STRUCT_INIT
(
AR5K_PISR
),

141 
REG_STRUCT_INIT
(
AR5K_SISR0
),

142 
REG_STRUCT_INIT
(
AR5K_SISR1
),

143 
REG_STRUCT_INIT
(
AR5K_SISR2
),

144 
REG_STRUCT_INIT
(
AR5K_SISR3
),

145 
REG_STRUCT_INIT
(
AR5K_SISR4
),

146 
REG_STRUCT_INIT
(
AR5K_IMR
),

147 
REG_STRUCT_INIT
(
AR5K_PIMR
),

148 
REG_STRUCT_INIT
(
AR5K_SIMR0
),

149 
REG_STRUCT_INIT
(
AR5K_SIMR1
),

150 
REG_STRUCT_INIT
(
AR5K_SIMR2
),

151 
REG_STRUCT_INIT
(
AR5K_SIMR3
),

152 
REG_STRUCT_INIT
(
AR5K_SIMR4
),

153 
REG_STRUCT_INIT
(
AR5K_DCM_ADDR
),

154 
REG_STRUCT_INIT
(
AR5K_DCCFG
),

155 
REG_STRUCT_INIT
(
AR5K_CCFG
),

156 
REG_STRUCT_INIT
(
AR5K_CPC0
),

157 
REG_STRUCT_INIT
(
AR5K_CPC1
),

158 
REG_STRUCT_INIT
(
AR5K_CPC2
),

159 
REG_STRUCT_INIT
(
AR5K_CPC3
),

160 
REG_STRUCT_INIT
(
AR5K_CPCOVF
),

161 
REG_STRUCT_INIT
(
AR5K_RESET_CTL
),

162 
REG_STRUCT_INIT
(
AR5K_SLEEP_CTL
),

163 
REG_STRUCT_INIT
(
AR5K_INTPEND
),

164 
REG_STRUCT_INIT
(
AR5K_SFR
),

165 
REG_STRUCT_INIT
(
AR5K_PCICFG
),

166 
REG_STRUCT_INIT
(
AR5K_GPIOCR
),

167 
REG_STRUCT_INIT
(
AR5K_GPIODO
),

168 
REG_STRUCT_INIT
(
AR5K_SREV
),

171 *
	$ªg_°¨t
(
£q_fûe
 *
£q
, 
loff_t
 *
pos
)

173  *
pos
 < 
	`ARRAY_SIZE
(
ªgs
Ë? (*)&ªgs[*pos] : 
NULL
;

174 
	}
}

176 
	$ªg_°›
(
£q_fûe
 *
£q
, *
p
)

179 
	}
}

181 *
	$ªg_√xt
(
£q_fûe
 *
£q
, *
p
, 
loff_t
 *
pos
)

183 ++*
pos
;

184  *
pos
 < 
	`ARRAY_SIZE
(
ªgs
Ë? (*)&ªgs[*pos] : 
NULL
;

185 
	}
}

187 
	$ªg_show
(
£q_fûe
 *
£q
, *
p
)

189 
©h5k_hw
 *
ah
 = 
£q
->
¥iv©e
;

190 
ªg
 *
r
 = 
p
;

191 
	`£q_¥ötf
(
£q
, "%-25s0x%08x\n", 
r
->
«me
,

192 
	`©h5k_hw_ªg_ªad
(
ah
, 
r
->
addr
));

194 
	}
}

196 c⁄° 
£q_›î©i⁄s
 
	gªgi°î_£q_›s
 = {

197 .
°¨t
 = 
ªg_°¨t
,

198 .
	g√xt
 = 
ªg_√xt
,

199 .
	g°›
 = 
ªg_°›
,

200 .
	gshow
 = 
ªg_show


203 
	$›í_fûe_ªgi°îs
(
öode
 *öode, 
fûe
 *file)

205 
£q_fûe
 *
s
;

206 
ªs
;

207 
ªs
 = 
	`£q_›í
(
fûe
, &
ªgi°î_£q_›s
);

208 i‡(
ªs
 == 0) {

209 
s
 = 
fûe
->
¥iv©e_d©a
;

210 
s
->
¥iv©e
 = 
öode
->
i_¥iv©e
;

212  
ªs
;

213 
	}
}

215 c⁄° 
fûe_›î©i⁄s
 
	gf›s_ªgi°îs
 = {

216 .
›í
 = 
›í_fûe_ªgi°îs
,

217 .
	gªad
 = 
£q_ªad
,

218 .
	gŒ£ek
 = 
£q_l£ek
,

219 .
	gªÀa£
 = 
£q_ªÀa£
,

220 .
	gow√r
 = 
THIS_MODULE
,

226 
ssize_t
 
	$ªad_fûe_bóc⁄
(
fûe
 *fûe, 
__u£r
 *
u£r_buf
,

227 
size_t
 
cou¡
, 
loff_t
 *
µos
)

229 
©h5k_hw
 *
ah
 = 
fûe
->
¥iv©e_d©a
;

230 
buf
[500];

231 
Àn
 = 0;

232 
v
;

233 
u64
 
tsf
;

235 
v
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_BEACON
);

236 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

238 "AR5K_BEACON", 
v
, v & 
AR5K_BEACON_PERIOD
,

239 (
v
 & 
AR5K_BEACON_TIM
Ë>> 
AR5K_BEACON_TIM_S
);

241 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, "%-24s0x%08x\n",

242 "AR5K_LAST_TSTP", 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_LAST_TSTP
));

244 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, "%-24s0x%08x\n\n",

245 "AR5K_BEACON_CNT", 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_BEACON_CNT
));

247 
v
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_TIMER0
);

248 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, "%-24s0x%08x\tTU: %08x\n",

249 "AR5K_TIMER0 (TBTT)", 
v
, v);

251 
v
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_TIMER1
);

252 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, "%-24s0x%08x\tTU: %08x\n",

253 "AR5K_TIMER1 (DMA)", 
v
, v >> 3);

255 
v
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_TIMER2
);

256 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, "%-24s0x%08x\tTU: %08x\n",

257 "AR5K_TIMER2 (SWBA)", 
v
, v >> 3);

259 
v
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_TIMER3
);

260 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, "%-24s0x%08x\tTU: %08x\n",

261 "AR5K_TIMER3 (ATIM)", 
v
, v);

263 
tsf
 = 
	`©h5k_hw_gë_tsf64
(
ah
);

264 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

266 ()
tsf
, 
	`TSF_TO_TU
(tsf));

268 i‡(
Àn
 > (
buf
))

269 
Àn
 = (
buf
);

271  
	`sim∂e_ªad_‰om_buf„r
(
u£r_buf
, 
cou¡
, 
µos
, 
buf
, 
Àn
);

272 
	}
}

274 
ssize_t
 
	$wrôe_fûe_bóc⁄
(
fûe
 *file,

275 c⁄° 
__u£r
 *
u£rbuf
,

276 
size_t
 
cou¡
, 
loff_t
 *
µos
)

278 
©h5k_hw
 *
ah
 = 
fûe
->
¥iv©e_d©a
;

279 
buf
[20];

281 i‡(
	`c›y_‰om_u£r
(
buf
, 
u£rbuf
, 
	`mö
(
cou¡
, (buf))))

282  -
EFAULT
;

284 i‡(
	`°∫cmp
(
buf
, "disable", 7) == 0) {

285 
	`AR5K_REG_DISABLE_BITS
(
ah
, 
AR5K_BEACON
, 
AR5K_BEACON_ENABLE
);

286 
	`¥ötk
(
KERN_INFO
 "debugfs disable beacons\n");

287 } i‡(
	`°∫cmp
(
buf
, "enable", 6) == 0) {

288 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_BEACON
, 
AR5K_BEACON_ENABLE
);

289 
	`¥ötk
(
KERN_INFO
 "debugfsÉnable beacons\n");

291  
cou¡
;

292 
	}
}

294 c⁄° 
fûe_›î©i⁄s
 
	gf›s_bóc⁄
 = {

295 .
ªad
 = 
ªad_fûe_bóc⁄
,

296 .
	gwrôe
 = 
wrôe_fûe_bóc⁄
,

297 .
	g›í
 = 
©h5k_debugfs_›í
,

298 .
	gow√r
 = 
THIS_MODULE
,

299 .
	gŒ£ek
 = 
deÁu…_Œ£ek
,

305 
ssize_t
 
	$wrôe_fûe_ª£t
(
fûe
 *file,

306 c⁄° 
__u£r
 *
u£rbuf
,

307 
size_t
 
cou¡
, 
loff_t
 *
µos
)

309 
©h5k_hw
 *
ah
 = 
fûe
->
¥iv©e_d©a
;

310 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_RESET
, "debug fileÅriggeredÑeset\n");

311 
	`õì80211_queue_w‹k
(
ah
->
hw
, &ah->
ª£t_w‹k
);

312  
cou¡
;

313 
	}
}

315 c⁄° 
fûe_›î©i⁄s
 
	gf›s_ª£t
 = {

316 .
wrôe
 = 
wrôe_fûe_ª£t
,

317 .
	g›í
 = 
©h5k_debugfs_›í
,

318 .
	gow√r
 = 
THIS_MODULE
,

319 .
	gŒ£ek
 = 
no›_Œ£ek
,

326 
©h5k_debug_Àvñ
 
	mÀvñ
;

327 c⁄° *
	m«me
;

328 c⁄° *
	mdesc
;

329 } 
	gdbg_öfo
[] = {

330 { 
ATH5K_DEBUG_RESET
, "reset", "resetánd initialization" },

331 { 
ATH5K_DEBUG_INTR
, "intr", "interrupt handling" },

332 { 
ATH5K_DEBUG_MODE
, "mode", "mode init/setup" },

333 { 
ATH5K_DEBUG_XMIT
, "xmit", "basic xmit operation" },

334 { 
ATH5K_DEBUG_BEACON
, "beacon", "beacon handling" },

335 { 
ATH5K_DEBUG_CALIBRATE
, "calib", "periodic calibration" },

336 { 
ATH5K_DEBUG_TXPOWER
, "txpower", "transmitÖower setting" },

337 { 
ATH5K_DEBUG_LED
, "led", "LED management" },

338 { 
ATH5K_DEBUG_DUMPBANDS
, "dumpbands", "dump bands" },

339 { 
ATH5K_DEBUG_DMA
, "dma", "dma start/stop" },

340 { 
ATH5K_DEBUG_ANI
, "ani", "adaptiveÇoise immunity" },

341 { 
ATH5K_DEBUG_DESC
, "desc", "descriptor chains" },

342 { 
ATH5K_DEBUG_ANY
, "all", "showáll debugÜevels" },

345 
ssize_t
 
	$ªad_fûe_debug
(
fûe
 *fûe, 
__u£r
 *
u£r_buf
,

346 
size_t
 
cou¡
, 
loff_t
 *
µos
)

348 
©h5k_hw
 *
ah
 = 
fûe
->
¥iv©e_d©a
;

349 
buf
[700];

350 
Àn
 = 0;

351 
i
;

353 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

354 "DEBUG LEVEL: 0x%08x\n\n", 
ah
->
debug
.
Àvñ
);

356 
i
 = 0; i < 
	`ARRAY_SIZE
(
dbg_öfo
) - 1; i++) {

357 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

358 "%10†%¯0x%08x - %s\n", 
dbg_öfo
[
i
].
«me
,

359 
ah
->
debug
.
Àvñ
 & 
dbg_öfo
[
i
].level ? '+' : ' ',

360 
dbg_öfo
[
i
].
Àvñ
, dbg_öfo[i].
desc
);

362 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

363 "%10†%¯0x%08x - %s\n", 
dbg_öfo
[
i
].
«me
,

364 
ah
->
debug
.
Àvñ
 =
dbg_öfo
[
i
].level ? '+' : ' ',

365 
dbg_öfo
[
i
].
Àvñ
, dbg_öfo[i].
desc
);

367 i‡(
Àn
 > (
buf
))

368 
Àn
 = (
buf
);

370  
	`sim∂e_ªad_‰om_buf„r
(
u£r_buf
, 
cou¡
, 
µos
, 
buf
, 
Àn
);

371 
	}
}

373 
ssize_t
 
	$wrôe_fûe_debug
(
fûe
 *file,

374 c⁄° 
__u£r
 *
u£rbuf
,

375 
size_t
 
cou¡
, 
loff_t
 *
µos
)

377 
©h5k_hw
 *
ah
 = 
fûe
->
¥iv©e_d©a
;

378 
i
;

379 
buf
[20];

381 i‡(
	`c›y_‰om_u£r
(
buf
, 
u£rbuf
, 
	`mö
(
cou¡
, (buf))))

382  -
EFAULT
;

384 
i
 = 0; i < 
	`ARRAY_SIZE
(
dbg_öfo
); i++) {

385 i‡(
	`°∫cmp
(
buf
, 
dbg_öfo
[
i
].
«me
,

386 
	`°æí
(
dbg_öfo
[
i
].
«me
)) == 0) {

387 
ah
->
debug
.
Àvñ
 ^
dbg_öfo
[
i
].level;

391  
cou¡
;

392 
	}
}

394 c⁄° 
fûe_›î©i⁄s
 
	gf›s_debug
 = {

395 .
ªad
 = 
ªad_fûe_debug
,

396 .
	gwrôe
 = 
wrôe_fûe_debug
,

397 .
	g›í
 = 
©h5k_debugfs_›í
,

398 .
	gow√r
 = 
THIS_MODULE
,

399 .
	gŒ£ek
 = 
deÁu…_Œ£ek
,

405 
ssize_t
 
	$ªad_fûe_™ã¬a
(
fûe
 *fûe, 
__u£r
 *
u£r_buf
,

406 
size_t
 
cou¡
, 
loff_t
 *
µos
)

408 
©h5k_hw
 *
ah
 = 
fûe
->
¥iv©e_d©a
;

409 
buf
[700];

410 
Àn
 = 0;

411 
i
;

412 
v
;

414 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, "antenna mode\t%d\n",

415 
ah
->
ah_™t_mode
);

416 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, "defaultántenna\t%d\n",

417 
ah
->
ah_def_™t
);

418 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, "txántenna\t%d\n",

419 
ah
->
ah_tx_™t
);

421 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, "\nANTENNA\t\tRX\tTX\n");

422 
i
 = 1; i < 
	`ARRAY_SIZE
(
ah
->
°©s
.
™ã¬a_rx
); i++) {

423 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

425 
i
, 
ah
->
°©s
.
™ã¬a_rx
[i],áh->°©s.
™ã¬a_tx
[i]);

427 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, "[invalid]\t%d\t%d\n",

428 
ah
->
°©s
.
™ã¬a_rx
[0],áh->°©s.
™ã¬a_tx
[0]);

430 
v
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_DEFAULT_ANTENNA
);

431 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

432 "\nAR5K_DEFAULT_ANTENNA\t0x%08x\n", 
v
);

434 
v
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_STA_ID1
);

435 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

437 (
v
 & 
AR5K_STA_ID1_DEFAULT_ANTENNA
) != 0);

438 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

440 (
v
 & 
AR5K_STA_ID1_DESC_ANTENNA
) != 0);

441 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

443 (
v
 & 
AR5K_STA_ID1_RTS_DEF_ANTENNA
) != 0);

444 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

446 (
v
 & 
AR5K_STA_ID1_SELFGEN_DEF_ANT
) != 0);

448 
v
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PHY_AGCCTL
);

449 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

451 (
v
 & 
AR5K_PHY_AGCCTL_OFDM_DIV_DIS
) != 0);

453 
v
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PHY_RESTART
);

454 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

456 (
v
 & 
AR5K_PHY_RESTART_DIV_GC
Ë>> 
AR5K_PHY_RESTART_DIV_GC_S
);

458 
v
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PHY_FAST_ANT_DIV
);

459 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

461 (
v
 & 
AR5K_PHY_FAST_ANT_DIV_EN
) != 0);

463 
v
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PHY_ANT_SWITCH_TABLE_0
);

464 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

465 "\nAR5K_PHY_ANT_SWITCH_TABLE_0\t0x%08x\n", 
v
);

466 
v
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PHY_ANT_SWITCH_TABLE_1
);

467 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

468 "AR5K_PHY_ANT_SWITCH_TABLE_1\t0x%08x\n", 
v
);

470 i‡(
Àn
 > (
buf
))

471 
Àn
 = (
buf
);

473  
	`sim∂e_ªad_‰om_buf„r
(
u£r_buf
, 
cou¡
, 
µos
, 
buf
, 
Àn
);

474 
	}
}

476 
ssize_t
 
	$wrôe_fûe_™ã¬a
(
fûe
 *file,

477 c⁄° 
__u£r
 *
u£rbuf
,

478 
size_t
 
cou¡
, 
loff_t
 *
µos
)

480 
©h5k_hw
 *
ah
 = 
fûe
->
¥iv©e_d©a
;

481 
i
;

482 
buf
[20];

484 i‡(
	`c›y_‰om_u£r
(
buf
, 
u£rbuf
, 
	`mö
(
cou¡
, (buf))))

485  -
EFAULT
;

487 i‡(
	`°∫cmp
(
buf
, "diversity", 9) == 0) {

488 
	`©h5k_hw_£t_™ã¬a_mode
(
ah
, 
AR5K_ANTMODE_DEFAULT
);

489 
	`¥ötk
(
KERN_INFO
 "ath5k debug:Énable diversity\n");

490 } i‡(
	`°∫cmp
(
buf
, "fixed-a", 7) == 0) {

491 
	`©h5k_hw_£t_™ã¬a_mode
(
ah
, 
AR5K_ANTMODE_FIXED_A
);

492 
	`¥ötk
(
KERN_INFO
 "ath5k debugfs: fixedántenna A\n");

493 } i‡(
	`°∫cmp
(
buf
, "fixed-b", 7) == 0) {

494 
	`©h5k_hw_£t_™ã¬a_mode
(
ah
, 
AR5K_ANTMODE_FIXED_B
);

495 
	`¥ötk
(
KERN_INFO
 "ath5k debug: fixedántenna B\n");

496 } i‡(
	`°∫cmp
(
buf
, "clear", 5) == 0) {

497 
i
 = 0; i < 
	`ARRAY_SIZE
(
ah
->
°©s
.
™ã¬a_rx
); i++) {

498 
ah
->
°©s
.
™ã¬a_rx
[
i
] = 0;

499 
ah
->
°©s
.
™ã¬a_tx
[
i
] = 0;

501 
	`¥ötk
(
KERN_INFO
 "ath5k debug: clearedántenna stats\n");

503  
cou¡
;

504 
	}
}

506 c⁄° 
fûe_›î©i⁄s
 
	gf›s_™ã¬a
 = {

507 .
ªad
 = 
ªad_fûe_™ã¬a
,

508 .
	gwrôe
 = 
wrôe_fûe_™ã¬a
,

509 .
	g›í
 = 
©h5k_debugfs_›í
,

510 .
	gow√r
 = 
THIS_MODULE
,

511 .
	gŒ£ek
 = 
deÁu…_Œ£ek
,

516 
ssize_t
 
	$ªad_fûe_misc
(
fûe
 *fûe, 
__u£r
 *
u£r_buf
,

517 
size_t
 
cou¡
, 
loff_t
 *
µos
)

519 
©h5k_hw
 *
ah
 = 
fûe
->
¥iv©e_d©a
;

520 
buf
[700];

521 
Àn
 = 0;

522 
u32
 
fût
 = 
	`©h5k_hw_gë_rx_fûãr
(
ah
);

524 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, "bssid-mask: %pM\n",

525 
ah
->
bssidmask
);

526 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, "filter-flags: 0x%x ",

527 
fût
);

528 i‡(
fût
 & 
AR5K_RX_FILTER_UCAST
)

529 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, " UCAST");

530 i‡(
fût
 & 
AR5K_RX_FILTER_MCAST
)

531 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, " MCAST");

532 i‡(
fût
 & 
AR5K_RX_FILTER_BCAST
)

533 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, " BCAST");

534 i‡(
fût
 & 
AR5K_RX_FILTER_CONTROL
)

535 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, " CONTROL");

536 i‡(
fût
 & 
AR5K_RX_FILTER_BEACON
)

537 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, " BEACON");

538 i‡(
fût
 & 
AR5K_RX_FILTER_PROM
)

539 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, " PROM");

540 i‡(
fût
 & 
AR5K_RX_FILTER_XRPOLL
)

541 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, " XRPOLL");

542 i‡(
fût
 & 
AR5K_RX_FILTER_PROBEREQ
)

543 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, " PROBEREQ");

544 i‡(
fût
 & 
AR5K_RX_FILTER_PHYERR_5212
)

545 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, " PHYERR-5212");

546 i‡(
fût
 & 
AR5K_RX_FILTER_RADARERR_5212
)

547 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, " RADARERR-5212");

548 i‡(
fût
 & 
AR5K_RX_FILTER_PHYERR_5211
)

549 
	`¢¥ötf
(
buf
 + 
Àn
, (buf) -Üen, " PHYERR-5211");

550 i‡(
fût
 & 
AR5K_RX_FILTER_RADARERR_5211
)

551 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, " RADARERR-5211");

553 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, "\nopmode: %s (%d)\n",

554 
	`©h_›mode_to_°rög
(
ah
->
›mode
),áh->opmode);

556 i‡(
Àn
 > (
buf
))

557 
Àn
 = (
buf
);

559  
	`sim∂e_ªad_‰om_buf„r
(
u£r_buf
, 
cou¡
, 
µos
, 
buf
, 
Àn
);

560 
	}
}

562 c⁄° 
fûe_›î©i⁄s
 
	gf›s_misc
 = {

563 .
ªad
 = 
ªad_fûe_misc
,

564 .
	g›í
 = 
©h5k_debugfs_›í
,

565 .
	gow√r
 = 
THIS_MODULE
,

571 
ssize_t
 
	$ªad_fûe_‰amìº‹s
(
fûe
 *fûe, 
__u£r
 *
u£r_buf
,

572 
size_t
 
cou¡
, 
loff_t
 *
µos
)

574 
©h5k_hw
 *
ah
 = 
fûe
->
¥iv©e_d©a
;

575 
©h5k_°©i°ics
 *
°
 = &
ah
->
°©s
;

576 
buf
[700];

577 
Àn
 = 0;

578 
i
;

580 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

582 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, "CRC\t%u\t(%u%%)\n",

583 
°
->
rxîr_¸c
,

584 
°
->
rx_Æl_cou¡
 > 0 ?

585 
°
->
rxîr_¸c
 * 100 / st->
rx_Æl_cou¡
 : 0);

586 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, "PHY\t%u\t(%u%%)\n",

587 
°
->
rxîr_phy
,

588 
°
->
rx_Æl_cou¡
 > 0 ?

589 
°
->
rxîr_phy
 * 100 / st->
rx_Æl_cou¡
 : 0);

590 
i
 = 0; i < 32; i++) {

591 i‡(
°
->
rxîr_phy_code
[
i
])

592 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

594 
i
, 
°
->
rxîr_phy_code
[i]);

597 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, "FIFO\t%u\t(%u%%)\n",

598 
°
->
rxîr_fifo
,

599 
°
->
rx_Æl_cou¡
 > 0 ?

600 
°
->
rxîr_fifo
 * 100 / st->
rx_Æl_cou¡
 : 0);

601 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, "decrypt\t%u\t(%u%%)\n",

602 
°
->
rxîr_de¸y±
,

603 
°
->
rx_Æl_cou¡
 > 0 ?

604 
°
->
rxîr_de¸y±
 * 100 / st->
rx_Æl_cou¡
 : 0);

605 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, "MIC\t%u\t(%u%%)\n",

606 
°
->
rxîr_mic
,

607 
°
->
rx_Æl_cou¡
 > 0 ?

608 
°
->
rxîr_mic
 * 100 / st->
rx_Æl_cou¡
 : 0);

609 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, "process\t%u\t(%u%%)\n",

610 
°
->
rxîr_¥oc
,

611 
°
->
rx_Æl_cou¡
 > 0 ?

612 
°
->
rxîr_¥oc
 * 100 / st->
rx_Æl_cou¡
 : 0);

613 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, "jumbo\t%u\t(%u%%)\n",

614 
°
->
rxîr_jumbo
,

615 
°
->
rx_Æl_cou¡
 > 0 ?

616 
°
->
rxîr_jumbo
 * 100 / st->
rx_Æl_cou¡
 : 0);

617 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, "[RXáll\t%u]\n",

618 
°
->
rx_Æl_cou¡
);

619 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, "RX-all-bytes\t%u\n",

620 
°
->
rx_byãs_cou¡
);

622 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

624 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, "retry\t%u\t(%u%%)\n",

625 
°
->
txîr_ªåy
,

626 
°
->
tx_Æl_cou¡
 > 0 ?

627 
°
->
txîr_ªåy
 * 100 / st->
tx_Æl_cou¡
 : 0);

628 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, "FIFO\t%u\t(%u%%)\n",

629 
°
->
txîr_fifo
,

630 
°
->
tx_Æl_cou¡
 > 0 ?

631 
°
->
txîr_fifo
 * 100 / st->
tx_Æl_cou¡
 : 0);

632 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, "filter\t%u\t(%u%%)\n",

633 
°
->
txîr_fût
,

634 
°
->
tx_Æl_cou¡
 > 0 ?

635 
°
->
txîr_fût
 * 100 / st->
tx_Æl_cou¡
 : 0);

636 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, "[TXáll\t%u]\n",

637 
°
->
tx_Æl_cou¡
);

638 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, "TX-all-bytes\t%u\n",

639 
°
->
tx_byãs_cou¡
);

641 i‡(
Àn
 > (
buf
))

642 
Àn
 = (
buf
);

644  
	`sim∂e_ªad_‰om_buf„r
(
u£r_buf
, 
cou¡
, 
µos
, 
buf
, 
Àn
);

645 
	}
}

647 
ssize_t
 
	$wrôe_fûe_‰amìº‹s
(
fûe
 *file,

648 c⁄° 
__u£r
 *
u£rbuf
,

649 
size_t
 
cou¡
, 
loff_t
 *
µos
)

651 
©h5k_hw
 *
ah
 = 
fûe
->
¥iv©e_d©a
;

652 
©h5k_°©i°ics
 *
°
 = &
ah
->
°©s
;

653 
buf
[20];

655 i‡(
	`c›y_‰om_u£r
(
buf
, 
u£rbuf
, 
	`mö
(
cou¡
, (buf))))

656  -
EFAULT
;

658 i‡(
	`°∫cmp
(
buf
, "clear", 5) == 0) {

659 
°
->
rxîr_¸c
 = 0;

660 
°
->
rxîr_phy
 = 0;

661 
°
->
rxîr_fifo
 = 0;

662 
°
->
rxîr_de¸y±
 = 0;

663 
°
->
rxîr_mic
 = 0;

664 
°
->
rxîr_¥oc
 = 0;

665 
°
->
rxîr_jumbo
 = 0;

666 
°
->
rx_Æl_cou¡
 = 0;

667 
°
->
txîr_ªåy
 = 0;

668 
°
->
txîr_fifo
 = 0;

669 
°
->
txîr_fût
 = 0;

670 
°
->
tx_Æl_cou¡
 = 0;

671 
	`¥ötk
(
KERN_INFO
 "ath5k debug: cleared frameerrors stats\n");

673  
cou¡
;

674 
	}
}

676 c⁄° 
fûe_›î©i⁄s
 
	gf›s_‰amìº‹s
 = {

677 .
ªad
 = 
ªad_fûe_‰amìº‹s
,

678 .
	gwrôe
 = 
wrôe_fûe_‰amìº‹s
,

679 .
	g›í
 = 
©h5k_debugfs_›í
,

680 .
	gow√r
 = 
THIS_MODULE
,

681 .
	gŒ£ek
 = 
deÁu…_Œ£ek
,

687 
ssize_t
 
	$ªad_fûe_™i
(
fûe
 *fûe, 
__u£r
 *
u£r_buf
,

688 
size_t
 
cou¡
, 
loff_t
 *
µos
)

690 
©h5k_hw
 *
ah
 = 
fûe
->
¥iv©e_d©a
;

691 
©h5k_°©i°ics
 *
°
 = &
ah
->
°©s
;

692 
©h5k_™i_°©e
 *
as
 = &
ah
->
™i_°©e
;

694 
buf
[700];

695 
Àn
 = 0;

697 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

699 
ah
->
ah_ˇ∑bûôõs
.
ˇp_has_phyîr_cou¡îs
 ?

701 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

703 
as
->
max_•ur_Àvñ
);

704 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

706 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, "operating mode:\t\t\t");

707 
as
->
™i_mode
) {

708 
ATH5K_ANI_MODE_OFF
:

709 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, "OFF\n");

711 
ATH5K_ANI_MODE_MANUAL_LOW
:

712 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

715 
ATH5K_ANI_MODE_MANUAL_HIGH
:

716 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

719 
ATH5K_ANI_MODE_AUTO
:

720 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, "AUTO\n");

723 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

727 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

729 
as
->
noi£_imm_Àvñ
);

730 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

732 
as
->
•ur_Àvñ
);

733 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

735 
as
->
fú°ï_Àvñ
);

736 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

738 
as
->
ofdm_wók_sig
 ? "on" : "off");

739 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

741 
as
->
cck_wók_sig
 ? "on" : "off");

743 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

745 
°
->
mib_öå
);

746 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

748 ()
	`ewma_ªad
(&
ah
->
ah_bóc⁄_rssi_avg
));

750 
	#CC_PRINT
(
_°ru˘
, 
_fõld
) \

751 
_°ru˘
.
_fõld
, \

752 
_°ru˘
.
cy˛es
 > 0 ? \

753 
_°ru˘
.
_fõld
 * 100 / _°ru˘.
cy˛es
 : 0

	)

755 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

757 
	`CC_PRINT
(
as
->
œ°_cc
, 
tx_‰ame
));

758 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

760 
	`CC_PRINT
(
as
->
œ°_cc
, 
rx_‰ame
));

761 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

763 
	`CC_PRINT
(
as
->
œ°_cc
, 
rx_busy
));

764 #unde‡
CC_PRINT


765 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen, "profcnt cycles\t\t%u\n",

766 
as
->
œ°_cc
.
cy˛es
);

767 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

769 
as
->
li°í_time
,ás->
œ°_li°í
);

770 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

772 
as
->
ofdm_îr‹s
,ás->
œ°_ofdm_îr‹s
,

773 
as
->
sum_ofdm_îr‹s
);

774 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

776 
as
->
cck_îr‹s
,ás->
œ°_cck_îr‹s
,

777 
as
->
sum_cck_îr‹s
);

778 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

780 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PHYERR_CNT1
),

781 
ATH5K_ANI_OFDM_TRIG_HIGH
 - (
ATH5K_PHYERR_CNT_MAX
 -

782 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PHYERR_CNT1
)));

783 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

785 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PHYERR_CNT2
),

786 
ATH5K_ANI_CCK_TRIG_HIGH
 - (
ATH5K_PHYERR_CNT_MAX
 -

787 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PHYERR_CNT2
)));

789 i‡(
Àn
 > (
buf
))

790 
Àn
 = (
buf
);

792  
	`sim∂e_ªad_‰om_buf„r
(
u£r_buf
, 
cou¡
, 
µos
, 
buf
, 
Àn
);

793 
	}
}

795 
ssize_t
 
	$wrôe_fûe_™i
(
fûe
 *file,

796 c⁄° 
__u£r
 *
u£rbuf
,

797 
size_t
 
cou¡
, 
loff_t
 *
µos
)

799 
©h5k_hw
 *
ah
 = 
fûe
->
¥iv©e_d©a
;

800 
buf
[20];

802 i‡(
	`c›y_‰om_u£r
(
buf
, 
u£rbuf
, 
	`mö
(
cou¡
, (buf))))

803  -
EFAULT
;

805 i‡(
	`°∫cmp
(
buf
, "sens-low", 8) == 0) {

806 
	`©h5k_™i_öô
(
ah
, 
ATH5K_ANI_MODE_MANUAL_HIGH
);

807 } i‡(
	`°∫cmp
(
buf
, "sens-high", 9) == 0) {

808 
	`©h5k_™i_öô
(
ah
, 
ATH5K_ANI_MODE_MANUAL_LOW
);

809 } i‡(
	`°∫cmp
(
buf
, "ani-off", 7) == 0) {

810 
	`©h5k_™i_öô
(
ah
, 
ATH5K_ANI_MODE_OFF
);

811 } i‡(
	`°∫cmp
(
buf
, "ani-on", 6) == 0) {

812 
	`©h5k_™i_öô
(
ah
, 
ATH5K_ANI_MODE_AUTO
);

813 } i‡(
	`°∫cmp
(
buf
, "noise-low", 9) == 0) {

814 
	`©h5k_™i_£t_noi£_immunôy_Àvñ
(
ah
, 0);

815 } i‡(
	`°∫cmp
(
buf
, "noise-high", 10) == 0) {

816 
	`©h5k_™i_£t_noi£_immunôy_Àvñ
(
ah
,

817 
ATH5K_ANI_MAX_NOISE_IMM_LVL
);

818 } i‡(
	`°∫cmp
(
buf
, "spur-low", 8) == 0) {

819 
	`©h5k_™i_£t_•ur_immunôy_Àvñ
(
ah
, 0);

820 } i‡(
	`°∫cmp
(
buf
, "spur-high", 9) == 0) {

821 
	`©h5k_™i_£t_•ur_immunôy_Àvñ
(
ah
,

822 
ah
->
™i_°©e
.
max_•ur_Àvñ
);

823 } i‡(
	`°∫cmp
(
buf
, "fir-low", 7) == 0) {

824 
	`©h5k_™i_£t_fú°ï_Àvñ
(
ah
, 0);

825 } i‡(
	`°∫cmp
(
buf
, "fir-high", 8) == 0) {

826 
	`©h5k_™i_£t_fú°ï_Àvñ
(
ah
, 
ATH5K_ANI_MAX_FIRSTEP_LVL
);

827 } i‡(
	`°∫cmp
(
buf
, "ofdm-off", 8) == 0) {

828 
	`©h5k_™i_£t_ofdm_wók_sig«l_dëe˘i⁄
(
ah
, 
Ál£
);

829 } i‡(
	`°∫cmp
(
buf
, "ofdm-on", 7) == 0) {

830 
	`©h5k_™i_£t_ofdm_wók_sig«l_dëe˘i⁄
(
ah
, 
åue
);

831 } i‡(
	`°∫cmp
(
buf
, "cck-off", 7) == 0) {

832 
	`©h5k_™i_£t_cck_wók_sig«l_dëe˘i⁄
(
ah
, 
Ál£
);

833 } i‡(
	`°∫cmp
(
buf
, "cck-on", 6) == 0) {

834 
	`©h5k_™i_£t_cck_wók_sig«l_dëe˘i⁄
(
ah
, 
åue
);

836  
cou¡
;

837 
	}
}

839 c⁄° 
fûe_›î©i⁄s
 
	gf›s_™i
 = {

840 .
ªad
 = 
ªad_fûe_™i
,

841 .
	gwrôe
 = 
wrôe_fûe_™i
,

842 .
	g›í
 = 
©h5k_debugfs_›í
,

843 .
	gow√r
 = 
THIS_MODULE
,

844 .
	gŒ£ek
 = 
deÁu…_Œ£ek
,

850 
ssize_t
 
	$ªad_fûe_queue
(
fûe
 *fûe, 
__u£r
 *
u£r_buf
,

851 
size_t
 
cou¡
, 
loff_t
 *
µos
)

853 
©h5k_hw
 *
ah
 = 
fûe
->
¥iv©e_d©a
;

854 
buf
[700];

855 
Àn
 = 0;

857 
©h5k_txq
 *
txq
;

858 
©h5k_buf
 *
bf
, *
bf0
;

859 
i
, 
n
;

861 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

862 "avaûabÀÅxbuf„rs: %d\n", 
ah
->
txbuf_Àn
);

864 
i
 = 0; i < 
	`ARRAY_SIZE
(
ah
->
txqs
); i++) {

865 
txq
 = &
ah
->
txqs
[
i
];

867 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

868 "%02d: %s£tup\n", 
i
, 
txq
->
£tup
 ? "" : "not ");

870 i‡(!
txq
->
£tup
)

873 
n
 = 0;

874 
	`•ö_lock_bh
(&
txq
->
lock
);

875 
	`li°_f‹_óch_íåy_ß„
(
bf
, 
bf0
, &
txq
->
q
, 
li°
)

876 
n
++;

877 
	`•ö_u∆ock_bh
(&
txq
->
lock
);

879 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

880 "Üí: %d bufs: %d\n", 
txq
->
txq_Àn
, 
n
);

881 
Àn
 +
	`¢¥ötf
(
buf
 +Üen, (buf) -Üen,

882 " stuck: %d\n", 
txq
->
txq_°uck
);

885 i‡(
Àn
 > (
buf
))

886 
Àn
 = (
buf
);

888  
	`sim∂e_ªad_‰om_buf„r
(
u£r_buf
, 
cou¡
, 
µos
, 
buf
, 
Àn
);

889 
	}
}

891 
ssize_t
 
	$wrôe_fûe_queue
(
fûe
 *file,

892 c⁄° 
__u£r
 *
u£rbuf
,

893 
size_t
 
cou¡
, 
loff_t
 *
µos
)

895 
©h5k_hw
 *
ah
 = 
fûe
->
¥iv©e_d©a
;

896 
buf
[20];

898 i‡(
	`c›y_‰om_u£r
(
buf
, 
u£rbuf
, 
	`mö
(
cou¡
, (buf))))

899  -
EFAULT
;

901 i‡(
	`°∫cmp
(
buf
, "start", 5) == 0)

902 
	`õì80211_wake_queues
(
ah
->
hw
);

903 i‡(
	`°∫cmp
(
buf
, "stop", 4) == 0)

904 
	`õì80211_°›_queues
(
ah
->
hw
);

906  
cou¡
;

907 
	}
}

910 c⁄° 
fûe_›î©i⁄s
 
	gf›s_queue
 = {

911 .
ªad
 = 
ªad_fûe_queue
,

912 .
	gwrôe
 = 
wrôe_fûe_queue
,

913 .
	g›í
 = 
©h5k_debugfs_›í
,

914 .
	gow√r
 = 
THIS_MODULE
,

915 .
	gŒ£ek
 = 
deÁu…_Œ£ek
,

920 
	$©h5k_debug_öô_devi˚
(
©h5k_hw
 *
ah
)

922 
díåy
 *
phydú
;

924 
ah
->
debug
.
Àvñ
 = 
©h5k_debug
;

926 
phydú
 = 
	`debugfs_¸óã_dú
("©h5k", 
ah
->
hw
->
wùhy
->
debugfsdú
);

927 i‡(!
phydú
)

930 
	`debugfs_¸óã_fûe
("debug", 
S_IWUSR
 | 
S_IRUSR
, 
phydú
, 
ah
,

931 &
f›s_debug
);

933 
	`debugfs_¸óã_fûe
("ªgi°îs", 
S_IRUSR
, 
phydú
, 
ah
, &
f›s_ªgi°îs
);

935 
	`debugfs_¸óã_fûe
("bóc⁄", 
S_IWUSR
 | 
S_IRUSR
, 
phydú
, 
ah
,

936 &
f›s_bóc⁄
);

938 
	`debugfs_¸óã_fûe
("ª£t", 
S_IWUSR
, 
phydú
, 
ah
, &
f›s_ª£t
);

940 
	`debugfs_¸óã_fûe
("™ã¬a", 
S_IWUSR
 | 
S_IRUSR
, 
phydú
, 
ah
,

941 &
f›s_™ã¬a
);

943 
	`debugfs_¸óã_fûe
("misc", 
S_IRUSR
, 
phydú
, 
ah
, &
f›s_misc
);

945 
	`debugfs_¸óã_fûe
("‰amìº‹s", 
S_IWUSR
 | 
S_IRUSR
, 
phydú
, 
ah
,

946 &
f›s_‰amìº‹s
);

948 
	`debugfs_¸óã_fûe
("™i", 
S_IWUSR
 | 
S_IRUSR
, 
phydú
, 
ah
, &
f›s_™i
);

950 
	`debugfs_¸óã_fûe
("queue", 
S_IWUSR
 | 
S_IRUSR
, 
phydú
, 
ah
,

951 &
f›s_queue
);

953 
	`debugfs_¸óã_boﬁ
("32khz_˛ock", 
S_IWUSR
 | 
S_IRUSR
, 
phydú
,

954 &
ah
->
ah_u£_32khz_˛ock
);

955 
	}
}

960 
	$©h5k_debug_dump_b™ds
(
©h5k_hw
 *
ah
)

962 
b
, 
i
;

964 i‡(
	`likñy
(!(
ah
->
debug
.
Àvñ
 & 
ATH5K_DEBUG_DUMPBANDS
)))

967 
	`BUG_ON
(!
ah
->
sb™ds
);

969 
b
 = 0; b < 
IEEE80211_NUM_BANDS
; b++) {

970 
õì80211_suµ‹ãd_b™d
 *
b™d
 = &
ah
->
sb™ds
[
b
];

971 
b«me
[6];

972 
b™d
->band) {

973 
IEEE80211_BAND_2GHZ
:

974 
	`°r˝y
(
b«me
, "2 GHz");

976 
IEEE80211_BAND_5GHZ
:

977 
	`°r˝y
(
b«me
, "5 GHz");

980 
	`¥ötk
(
KERN_DEBUG
 "BandÇot supported: %d\n",

981 
b™d
->band);

984 
	`¥ötk
(
KERN_DEBUG
 "B™d %s: ch™√l†%d,Ñ©e†%d\n", 
b«me
,

985 
b™d
->
n_ch™√ls
, b™d->
n_bôøãs
);

986 
	`¥ötk
(
KERN_DEBUG
 " channels:\n");

987 
i
 = 0; i < 
b™d
->
n_ch™√ls
; i++)

988 
	`¥ötk
(
KERN_DEBUG
 " %3d %d %.4x %.4x\n",

989 
	`õì80211_‰equícy_to_ch™√l
(

990 
b™d
->
ch™√ls
[
i
].
˚¡î_‰eq
),

991 
b™d
->
ch™√ls
[
i
].
˚¡î_‰eq
,

992 
b™d
->
ch™√ls
[
i
].
hw_vÆue
,

993 
b™d
->
ch™√ls
[
i
].
Êags
);

994 
	`¥ötk
(
KERN_DEBUG
 "Ñates:\n");

995 
i
 = 0; i < 
b™d
->
n_bôøãs
; i++)

996 
	`¥ötk
(
KERN_DEBUG
 " %4d %.4x %.4x %.4x\n",

997 
b™d
->
bôøãs
[
i
].
bôøã
,

998 
b™d
->
bôøãs
[
i
].
hw_vÆue
,

999 
b™d
->
bôøãs
[
i
].
Êags
,

1000 
b™d
->
bôøãs
[
i
].
hw_vÆue_sh‹t
);

1002 
	}
}

1004 
ölöe
 

1005 
	$©h5k_debug_¥öåxbuf
(
©h5k_buf
 *
bf
, 
d⁄e
,

1006 
©h5k_rx_°©us
 *
rs
)

1008 
©h5k_desc
 *
ds
 = 
bf
->
desc
;

1009 
©h5k_hw_Æl_rx_desc
 *
rd
 = &
ds
->
ud
.
ds_rx
;

1011 
	`¥ötk
(
KERN_DEBUG
 "R (%p %llx) %08x %08x %08x %08x %08x %08x %c\n",

1012 
ds
, ()
bf
->
daddr
,

1013 
ds
->
ds_lök
, ds->
ds_d©a
,

1014 
rd
->
rx_˘l
.
rx_c⁄åﬁ_0
,Ñd->rx_˘l.
rx_c⁄åﬁ_1
,

1015 
rd
->
rx_°©
.
rx_°©us_0
,Ñd->rx_°©.
rx_°©us_1
,

1016 !
d⁄e
 ? ' ' : (
rs
->
rs_°©us
 == 0) ? '*' : '!');

1017 
	}
}

1020 
	$©h5k_debug_¥öåxbuffs
(
©h5k_hw
 *
ah
)

1022 
©h5k_desc
 *
ds
;

1023 
©h5k_buf
 *
bf
;

1024 
©h5k_rx_°©us
 
rs
 = {};

1025 
°©us
;

1027 i‡(
	`likñy
(!(
ah
->
debug
.
Àvñ
 & 
ATH5K_DEBUG_DESC
)))

1030 
	`¥ötk
(
KERN_DEBUG
 "rxdp %x,Ñxlink %p\n",

1031 
	`©h5k_hw_gë_rxdp
(
ah
),áh->
rxlök
);

1033 
	`•ö_lock_bh
(&
ah
->
rxbuÊock
);

1034 
	`li°_f‹_óch_íåy
(
bf
, &
ah
->
rxbuf
, 
li°
) {

1035 
ds
 = 
bf
->
desc
;

1036 
°©us
 = 
ah
->
	`ah_¥oc_rx_desc
◊h, 
ds
, &
rs
);

1037 i‡(!
°©us
)

1038 
	`©h5k_debug_¥öåxbuf
(
bf
, 
°©us
 =0, &
rs
);

1040 
	`•ö_u∆ock_bh
(&
ah
->
rxbuÊock
);

1041 
	}
}

1044 
	$©h5k_debug_¥öâxbuf
(
©h5k_hw
 *
ah
, 
©h5k_buf
 *
bf
)

1046 
©h5k_desc
 *
ds
 = 
bf
->
desc
;

1047 
©h5k_hw_5212_tx_desc
 *
td
 = &
ds
->
ud
.
ds_tx5212
;

1048 
©h5k_tx_°©us
 
ts
 = {};

1049 
d⁄e
;

1051 i‡(
	`likñy
(!(
ah
->
debug
.
Àvñ
 & 
ATH5K_DEBUG_DESC
)))

1054 
d⁄e
 = 
ah
->
	`ah_¥oc_tx_desc
◊h, 
bf
->
desc
, &
ts
);

1056 
	`¥ötk
(
KERN_DEBUG
 "T (%p %llx) %08x %08x %08x %08x %08x %08x %08x "

1057 "%08x %c\n", 
ds
, ()
bf
->
daddr
, ds->
ds_lök
,

1058 
ds
->
ds_d©a
, 
td
->
tx_˘l
.
tx_c⁄åﬁ_0
,Åd->tx_˘l.
tx_c⁄åﬁ_1
,

1059 
td
->
tx_˘l
.
tx_c⁄åﬁ_2
,Åd->tx_˘l.
tx_c⁄åﬁ_3
,

1060 
td
->
tx_°©
.
tx_°©us_0
,Åd->tx_°©.
tx_°©us_1
,

1061 
d⁄e
 ? ' ' : (
ts
.
ts_°©us
 == 0) ? '*' : '!');

1062 
	}
}

	@ath5k/debug.h

61 #i‚de‡
_ATH5K_DEBUG_H


62 
	#_ATH5K_DEBUG_H


	)

64 
	g©h5k_hw
;

65 
	gsk_buff
;

66 
	g©h5k_buf
;

68 
	s©h5k_dbg_öfo
 {

69 
	mÀvñ
;

98 
	e©h5k_debug_Àvñ
 {

99 
	mATH5K_DEBUG_RESET
 = 0x00000001,

100 
	mATH5K_DEBUG_INTR
 = 0x00000002,

101 
	mATH5K_DEBUG_MODE
 = 0x00000004,

102 
	mATH5K_DEBUG_XMIT
 = 0x00000008,

103 
	mATH5K_DEBUG_BEACON
 = 0x00000010,

104 
	mATH5K_DEBUG_CALIBRATE
 = 0x00000020,

105 
	mATH5K_DEBUG_TXPOWER
 = 0x00000040,

106 
	mATH5K_DEBUG_LED
 = 0x00000080,

107 
	mATH5K_DEBUG_DUMPBANDS
 = 0x00000400,

108 
	mATH5K_DEBUG_DMA
 = 0x00000800,

109 
	mATH5K_DEBUG_ANI
 = 0x00002000,

110 
	mATH5K_DEBUG_DESC
 = 0x00004000,

111 
	mATH5K_DEBUG_ANY
 = 0xffffffff

114 #ifde‡
CONFIG_ATH5K_DEBUG


116 
	#ATH5K_DBG
(
_sc
, 
_m
, 
_fmt
, ...) do { \

117 (
_sc
)->
debug
.
Àvñ
 = 0x00000045; \

118 i‡(
	`u∆ikñy
((
_sc
)->
debug
.
Àvñ
 & (
_m
Ë&& 
	`√t_øãlimô
())) \

119 
	`ATH5K_PRINTK
(
_sc
, 
KERN_DEBUG
, "(%s:%d): " 
_fmt
, \

120 
__func__
, 
__LINE__
, ##
__VA_ARGS__
); \

121 } 0)

	)

123 
	#ATH5K_DBG_UNLIMIT
(
_sc
, 
_m
, 
_fmt
, ...) do { \

124 i‡(
	`u∆ikñy
((
_sc
)->
debug
.
Àvñ
 & (
_m
))) \

125 
	`ATH5K_PRINTK
(
_sc
, 
KERN_DEBUG
, "(%s:%d): " 
_fmt
, \

126 
__func__
, 
__LINE__
, ##
__VA_ARGS__
); \

127 } 0)

	)

129 c⁄° *
©h_›mode_to_°rög
(
∆80211_i·y≥
 
›mode
);

132 
©h5k_debug_öô_devi˚
(
©h5k_hw
 *
ah
);

135 
©h5k_debug_¥öåxbuffs
(
©h5k_hw
 *
ah
);

138 
©h5k_debug_dump_b™ds
(
©h5k_hw
 *
ah
);

141 
©h5k_debug_¥öâxbuf
(
©h5k_hw
 *
ah
, 
©h5k_buf
 *
bf
);

145 
	~<löux/compûî.h
>

147 
ölöe
 
__©åibuã__
 ((
	$f‹m©
 (
¥ötf
, 3, 4)))

148 
	$ATH5K_DBG
(
©h5k_hw
 *
ah
, 
m
, c⁄° *
fmt
, ...) {

149 
	}
}

151 
ölöe
 
__©åibuã__
 ((
	$f‹m©
 (
¥ötf
, 3, 4)))

152 
	$ATH5K_DBG_UNLIMIT
(
©h5k_hw
 *
ah
, 
m
, c⁄° *
fmt
, ...)

153 {
	}
}

155 
ölöe
 

156 
	$©h5k_debug_öô_devi˚
(
©h5k_hw
 *
ah
Ë{
	}
}

158 
ölöe
 

159 
	$©h5k_debug_¥öåxbuffs
(
©h5k_hw
 *
ah
Ë{
	}
}

161 
ölöe
 

162 
	$©h5k_debug_dump_b™ds
(
©h5k_hw
 *
ah
Ë{
	}
}

164 
ölöe
 

165 
	$©h5k_debug_¥öâxbuf
(
©h5k_hw
 *
ah
, 
©h5k_buf
 *
bf
Ë{
	}
}

	@ath5k/desc.c

24 
	~"©h5k.h
"

25 
	~"ªg.h
"

26 
	~"debug.h
"

27 
	~"ba£.h
"

38 
	$©h5k_hw_£tup_2w‹d_tx_desc
(
©h5k_hw
 *
ah
, 
©h5k_desc
 *
desc
,

39 
pkt_Àn
, 
hdr_Àn
, 
∑dsize
,

40 
©h5k_pkt_ty≥
 
ty≥
,

41 
tx_powî
, 
tx_øã0
, 
tx_åõs0
,

42 
key_ödex
, 
™ã¬a_mode
, 
Êags
,

43 
πs˘s_øã
, 
πs˘s_duøti⁄
)

45 
u32
 
‰ame_ty≥
;

46 
©h5k_hw_2w_tx_˘l
 *
tx_˘l
;

47 
‰ame_Àn
;

49 
tx_˘l
 = &
desc
->
ud
.
ds_tx5210
.tx_ctl;

57 i‡(
	`u∆ikñy
(
tx_åõs0
 == 0)) {

58 
	`ATH5K_ERR
(
ah
, "zeroÑetries\n");

59 
	`WARN_ON
(1);

60  -
EINVAL
;

62 i‡(
	`u∆ikñy
(
tx_øã0
 == 0)) {

63 
	`ATH5K_ERR
(
ah
, "zeroÑate\n");

64 
	`WARN_ON
(1);

65  -
EINVAL
;

69 
	`mem£t
(&
desc
->
ud
.
ds_tx5210
, 0, (
©h5k_hw_5210_tx_desc
));

76 
‰ame_Àn
 = 
pkt_Àn
 - 
∑dsize
 + 
FCS_LEN
;

78 i‡(
‰ame_Àn
 & ~
AR5K_2W_TX_DESC_CTL0_FRAME_LEN
)

79  -
EINVAL
;

81 
tx_˘l
->
tx_c⁄åﬁ_0
 = 
‰ame_Àn
 & 
AR5K_2W_TX_DESC_CTL0_FRAME_LEN
;

86 i‡(
ty≥
 =
AR5K_PKT_TYPE_BEACON
)

87 
pkt_Àn
 = 
	`roundup
(pkt_len, 4);

89 i‡(
pkt_Àn
 & ~
AR5K_2W_TX_DESC_CTL1_BUF_LEN
)

90  -
EINVAL
;

92 
tx_˘l
->
tx_c⁄åﬁ_1
 = 
pkt_Àn
 & 
AR5K_2W_TX_DESC_CTL1_BUF_LEN
;

97 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
) {

98 i‡(
hdr_Àn
 & ~
AR5K_2W_TX_DESC_CTL0_HEADER_LEN_5210
)

99  -
EINVAL
;

100 
tx_˘l
->
tx_c⁄åﬁ_0
 |=

101 
	`AR5K_REG_SM
(
hdr_Àn
, 
AR5K_2W_TX_DESC_CTL0_HEADER_LEN_5210
);

105 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
) {

106 
ty≥
) {

107 
AR5K_PKT_TYPE_BEACON
:

108 
AR5K_PKT_TYPE_PROBE_RESP
:

109 
‰ame_ty≥
 = 
AR5K_AR5210_TX_DESC_FRAME_TYPE_NO_DELAY
;

111 
AR5K_PKT_TYPE_PIFS
:

112 
‰ame_ty≥
 = 
AR5K_AR5210_TX_DESC_FRAME_TYPE_PIFS
;

115 
‰ame_ty≥
 = 
ty≥
;

119 
tx_˘l
->
tx_c⁄åﬁ_0
 |=

120 
	`AR5K_REG_SM
(
‰ame_ty≥
, 
AR5K_2W_TX_DESC_CTL0_FRAME_TYPE_5210
) |

121 
	`AR5K_REG_SM
(
tx_øã0
, 
AR5K_2W_TX_DESC_CTL0_XMIT_RATE
);

124 
tx_˘l
->
tx_c⁄åﬁ_0
 |=

125 
	`AR5K_REG_SM
(
tx_øã0
, 
AR5K_2W_TX_DESC_CTL0_XMIT_RATE
) |

126 
	`AR5K_REG_SM
(
™ã¬a_mode
,

127 
AR5K_2W_TX_DESC_CTL0_ANT_MODE_XMIT
);

128 
tx_˘l
->
tx_c⁄åﬁ_1
 |=

129 
	`AR5K_REG_SM
(
ty≥
, 
AR5K_2W_TX_DESC_CTL1_FRAME_TYPE_5211
);

132 
	#_TX_FLAGS
(
_c
, 
_Êag
) \

133 i‡(
Êags
 & 
AR5K_TXDESC_
##
_Êag
) { \

134 
tx_˘l
->
tx_c⁄åﬁ_
##
_c
 |= \

135 
AR5K_2W_TX_DESC_CTL
##
_c
##
_
##
_Êag
; \

136 }

	)

137 
	#_TX_FLAGS_5211
(
_c
, 
_Êag
) \

138 i‡(
Êags
 & 
AR5K_TXDESC_
##
_Êag
) { \

139 
tx_˘l
->
tx_c⁄åﬁ_
##
_c
 |= \

140 
AR5K_2W_TX_DESC_CTL
##
_c
##
_
##
_Êag
##
_5211
; \

141 }

	)

142 
	`_TX_FLAGS
(0, 
CLRDMASK
);

143 
	`_TX_FLAGS
(0, 
INTREQ
);

144 
	`_TX_FLAGS
(0, 
RTSENA
);

146 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5211
) {

147 
	`_TX_FLAGS_5211
(0, 
VEOL
);

148 
	`_TX_FLAGS_5211
(1, 
NOACK
);

151 #unde‡
_TX_FLAGS


152 #unde‡
_TX_FLAGS_5211


157 i‡(
key_ödex
 !
AR5K_TXKEYIX_INVALID
) {

158 
tx_˘l
->
tx_c⁄åﬁ_0
 |=

159 
AR5K_2W_TX_DESC_CTL0_ENCRYPT_KEY_VALID
;

160 
tx_˘l
->
tx_c⁄åﬁ_1
 |=

161 
	`AR5K_REG_SM
(
key_ödex
,

162 
AR5K_2W_TX_DESC_CTL1_ENC_KEY_IDX
);

168 i‡((
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
) &&

169 (
Êags
 & (
AR5K_TXDESC_RTSENA
 | 
AR5K_TXDESC_CTSENA
)))

170 
tx_˘l
->
tx_c⁄åﬁ_1
 |
πs˘s_duøti⁄
 &

171 
AR5K_2W_TX_DESC_CTL1_RTS_DURATION_5210
;

174 
	}
}

179 
	$©h5k_hw_£tup_4w‹d_tx_desc
(
©h5k_hw
 *
ah
,

180 
©h5k_desc
 *
desc
, 
pkt_Àn
, 
hdr_Àn
,

181 
∑dsize
,

182 
©h5k_pkt_ty≥
 
ty≥
, 
tx_powî
, 
tx_øã0
,

183 
tx_åõs0
, 
key_ödex
,

184 
™ã¬a_mode
, 
Êags
,

185 
πs˘s_øã
,

186 
πs˘s_duøti⁄
)

188 
©h5k_hw_4w_tx_˘l
 *
tx_˘l
;

189 
‰ame_Àn
;

195 
u32
 
tx˘l0
 = 0, 
tx˘l1
 = 0, 
tx˘l2
 = 0, 
tx˘l3
 = 0;

197 
tx_˘l
 = &
desc
->
ud
.
ds_tx5212
.tx_ctl;

205 i‡(
	`u∆ikñy
(
tx_åõs0
 == 0)) {

206 
	`ATH5K_ERR
(
ah
, "zeroÑetries\n");

207 
	`WARN_ON
(1);

208  -
EINVAL
;

210 i‡(
	`u∆ikñy
(
tx_øã0
 == 0)) {

211 
	`ATH5K_ERR
(
ah
, "zeroÑate\n");

212 
	`WARN_ON
(1);

213  -
EINVAL
;

217 
	`¥ötk
("VANET-debug:Åx_powî=%d,áh_txpowî.txp_off£t=%d\n", 
tx_powî
, 
ah
->
ah_txpowî
.
txp_off£t
);

218 
tx_powî
 +
ah
->
ah_txpowî
.
txp_off£t
;

219 i‡(
tx_powî
 > 
AR5K_TUNE_MAX_TXPOWER
)

220 
tx_powî
 = 
AR5K_TUNE_MAX_TXPOWER
;

222 
	`¥ötk
("VANET-debug:Åx_powî = %d\n", 
tx_powî
);

225 
	`mem£t
(&
desc
->
ud
.
ds_tx5212
.
tx_°©
, 0,

226 (
desc
->
ud
.
ds_tx5212
.
tx_°©
));

233 
‰ame_Àn
 = 
pkt_Àn
 - 
∑dsize
 + 
FCS_LEN
;

235 i‡(
‰ame_Àn
 & ~
AR5K_4W_TX_DESC_CTL0_FRAME_LEN
)

236  -
EINVAL
;

238 
tx˘l0
 = 
‰ame_Àn
 & 
AR5K_4W_TX_DESC_CTL0_FRAME_LEN
;

243 i‡(
ty≥
 =
AR5K_PKT_TYPE_BEACON
)

244 
pkt_Àn
 = 
	`roundup
(pkt_len, 4);

246 i‡(
pkt_Àn
 & ~
AR5K_4W_TX_DESC_CTL1_BUF_LEN
)

247  -
EINVAL
;

249 
tx˘l1
 = 
pkt_Àn
 & 
AR5K_4W_TX_DESC_CTL1_BUF_LEN
;

251 
tx˘l0
 |
	`AR5K_REG_SM
(
tx_powî
, 
AR5K_4W_TX_DESC_CTL0_XMIT_POWER
) |

252 
	`AR5K_REG_SM
(
™ã¬a_mode
, 
AR5K_4W_TX_DESC_CTL0_ANT_MODE_XMIT
);

253 
tx˘l1
 |
	`AR5K_REG_SM
(
ty≥
, 
AR5K_4W_TX_DESC_CTL1_FRAME_TYPE
);

254 
tx˘l2
 = 
	`AR5K_REG_SM
(
tx_åõs0
, 
AR5K_4W_TX_DESC_CTL2_XMIT_TRIES0
);

255 
tx˘l3
 = 
tx_øã0
 & 
AR5K_4W_TX_DESC_CTL3_XMIT_RATE0
;

257 
	#_TX_FLAGS
(
_c
, 
_Êag
) \

258 i‡(
Êags
 & 
AR5K_TXDESC_
##
_Êag
) { \

259 
tx˘l
##
_c
 |
AR5K_4W_TX_DESC_CTL
##_c##
_
##
_Êag
; \

260 }

	)

262 
	`_TX_FLAGS
(0, 
CLRDMASK
);

263 
	`_TX_FLAGS
(0, 
VEOL
);

264 
	`_TX_FLAGS
(0, 
INTREQ
);

265 
	`_TX_FLAGS
(0, 
RTSENA
);

266 
	`_TX_FLAGS
(0, 
CTSENA
);

267 
	`_TX_FLAGS
(1, 
NOACK
);

269 #unde‡
_TX_FLAGS


274 i‡(
key_ödex
 !
AR5K_TXKEYIX_INVALID
) {

275 
tx˘l0
 |
AR5K_4W_TX_DESC_CTL0_ENCRYPT_KEY_VALID
;

276 
tx˘l1
 |
	`AR5K_REG_SM
(
key_ödex
,

277 
AR5K_4W_TX_DESC_CTL1_ENCRYPT_KEY_IDX
);

283 i‡(
Êags
 & (
AR5K_TXDESC_RTSENA
 | 
AR5K_TXDESC_CTSENA
)) {

284 i‡((
Êags
 & 
AR5K_TXDESC_RTSENA
) &&

285 (
Êags
 & 
AR5K_TXDESC_CTSENA
))

286  -
EINVAL
;

287 
tx˘l2
 |
πs˘s_duøti⁄
 & 
AR5K_4W_TX_DESC_CTL2_RTS_DURATION
;

288 
tx˘l3
 |
	`AR5K_REG_SM
(
πs˘s_øã
,

289 
AR5K_4W_TX_DESC_CTL3_RTS_CTS_RATE
);

292 
tx_˘l
->
tx_c⁄åﬁ_0
 = 
tx˘l0
;

293 
tx_˘l
->
tx_c⁄åﬁ_1
 = 
tx˘l1
;

294 
tx_˘l
->
tx_c⁄åﬁ_2
 = 
tx˘l2
;

295 
tx_˘l
->
tx_c⁄åﬁ_3
 = 
tx˘l3
;

298 
	}
}

304 
	$©h5k_hw_£tup_mº_tx_desc
(
©h5k_hw
 *
ah
, 
©h5k_desc
 *
desc
,

305 
tx_øã1
, 
u_öt
 
tx_åõs1
, u_öà
tx_øã2
,

306 
u_öt
 
tx_åõs2
, 
tx_øã3
, u_öà
tx_åõs3
)

308 
©h5k_hw_4w_tx_˘l
 *
tx_˘l
;

311 i‡(
ah
->
ah_vîsi⁄
 < 
AR5K_AR5212
)

320 i‡(
	`u∆ikñy
((
tx_øã1
 =0 && 
tx_åõs1
 != 0) ||

321 (
tx_øã2
 =0 && 
tx_åõs2
 != 0) ||

322 (
tx_øã3
 =0 && 
tx_åõs3
 != 0))) {

323 
	`ATH5K_ERR
(
ah
, "zeroÑate\n");

324 
	`WARN_ON
(1);

325  -
EINVAL
;

328 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5212
) {

329 
tx_˘l
 = &
desc
->
ud
.
ds_tx5212
.tx_ctl;

331 
	#_XTX_TRIES
(
_n
) \

332 i‡(
tx_åõs
##
_n
) { \

333 
tx_˘l
->
tx_c⁄åﬁ_2
 |= \

334 
	`AR5K_REG_SM
(
tx_åõs
##
_n
, \

335 
AR5K_4W_TX_DESC_CTL2_XMIT_TRIES
##
_n
); \

336 
tx_˘l
->
tx_c⁄åﬁ_3
 |= \

337 
	`AR5K_REG_SM
(
tx_øã
##
_n
, \

338 
AR5K_4W_TX_DESC_CTL3_XMIT_RATE
##
_n
); \

339 }

	)

341 
	`_XTX_TRIES
(1);

342 
	`_XTX_TRIES
(2);

343 
	`_XTX_TRIES
(3);

345 #unde‡
_XTX_TRIES


351 
	}
}

361 
	$©h5k_hw_¥oc_2w‹d_tx_°©us
(
©h5k_hw
 *
ah
,

362 
©h5k_desc
 *
desc
, 
©h5k_tx_°©us
 *
ts
)

364 
©h5k_hw_2w_tx_˘l
 *
tx_˘l
;

365 
©h5k_hw_tx_°©us
 *
tx_°©us
;

367 
tx_˘l
 = &
desc
->
ud
.
ds_tx5210
.tx_ctl;

368 
tx_°©us
 = &
desc
->
ud
.
ds_tx5210
.
tx_°©
;

371 i‡(
	`u∆ikñy
((
tx_°©us
->
tx_°©us_1
 & 
AR5K_DESC_TX_STATUS1_DONE
) == 0))

372  -
EINPROGRESS
;

377 
ts
->
ts_t°amp
 = 
	`AR5K_REG_MS
(
tx_°©us
->
tx_°©us_0
,

378 
AR5K_DESC_TX_STATUS0_SEND_TIMESTAMP
);

379 
ts
->
ts_sh‹åëry
 = 
	`AR5K_REG_MS
(
tx_°©us
->
tx_°©us_0
,

380 
AR5K_DESC_TX_STATUS0_SHORT_RETRY_COUNT
);

381 
ts
->
ts_föÆ_ªåy
 = 
	`AR5K_REG_MS
(
tx_°©us
->
tx_°©us_0
,

382 
AR5K_DESC_TX_STATUS0_LONG_RETRY_COUNT
);

384 
ts
->
ts_£qnum
 = 
	`AR5K_REG_MS
(
tx_°©us
->
tx_°©us_1
,

385 
AR5K_DESC_TX_STATUS1_SEQ_NUM
);

386 
ts
->
ts_rssi
 = 
	`AR5K_REG_MS
(
tx_°©us
->
tx_°©us_1
,

387 
AR5K_DESC_TX_STATUS1_ACK_SIG_STRENGTH
);

388 
ts
->
ts_™ã¬a
 = 1;

389 
ts
->
ts_°©us
 = 0;

390 
ts
->
ts_föÆ_idx
 = 0;

392 i‡(!(
tx_°©us
->
tx_°©us_0
 & 
AR5K_DESC_TX_STATUS0_FRAME_XMIT_OK
)) {

393 i‡(
tx_°©us
->
tx_°©us_0
 &

394 
AR5K_DESC_TX_STATUS0_EXCESSIVE_RETRIES
)

395 
ts
->
ts_°©us
 |
AR5K_TXERR_XRETRY
;

397 i‡(
tx_°©us
->
tx_°©us_0
 & 
AR5K_DESC_TX_STATUS0_FIFO_UNDERRUN
)

398 
ts
->
ts_°©us
 |
AR5K_TXERR_FIFO
;

400 i‡(
tx_°©us
->
tx_°©us_0
 & 
AR5K_DESC_TX_STATUS0_FILTERED
)

401 
ts
->
ts_°©us
 |
AR5K_TXERR_FILT
;

405 
	}
}

410 
	$©h5k_hw_¥oc_4w‹d_tx_°©us
(
©h5k_hw
 *
ah
,

411 
©h5k_desc
 *
desc
, 
©h5k_tx_°©us
 *
ts
)

413 
©h5k_hw_4w_tx_˘l
 *
tx_˘l
;

414 
©h5k_hw_tx_°©us
 *
tx_°©us
;

415 
u32
 
tx°©0
, 
tx°©1
;

417 
tx_˘l
 = &
desc
->
ud
.
ds_tx5212
.tx_ctl;

418 
tx_°©us
 = &
desc
->
ud
.
ds_tx5212
.
tx_°©
;

420 
tx°©1
 = 
	`ACCESS_ONCE
(
tx_°©us
->
tx_°©us_1
);

423 i‡(
	`u∆ikñy
(!(
tx°©1
 & 
AR5K_DESC_TX_STATUS1_DONE
)))

424  -
EINPROGRESS
;

426 
tx°©0
 = 
	`ACCESS_ONCE
(
tx_°©us
->
tx_°©us_0
);

431 
ts
->
ts_t°amp
 = 
	`AR5K_REG_MS
(
tx°©0
,

432 
AR5K_DESC_TX_STATUS0_SEND_TIMESTAMP
);

433 
ts
->
ts_sh‹åëry
 = 
	`AR5K_REG_MS
(
tx°©0
,

434 
AR5K_DESC_TX_STATUS0_SHORT_RETRY_COUNT
);

435 
ts
->
ts_föÆ_ªåy
 = 
	`AR5K_REG_MS
(
tx°©0
,

436 
AR5K_DESC_TX_STATUS0_LONG_RETRY_COUNT
);

437 
ts
->
ts_£qnum
 = 
	`AR5K_REG_MS
(
tx°©1
,

438 
AR5K_DESC_TX_STATUS1_SEQ_NUM
);

439 
ts
->
ts_rssi
 = 
	`AR5K_REG_MS
(
tx°©1
,

440 
AR5K_DESC_TX_STATUS1_ACK_SIG_STRENGTH
);

441 
ts
->
ts_™ã¬a
 = (
tx°©1
 &

442 
AR5K_DESC_TX_STATUS1_XMIT_ANTENNA_5212
) ? 2 : 1;

443 
ts
->
ts_°©us
 = 0;

445 
ts
->
ts_föÆ_idx
 = 
	`AR5K_REG_MS
(
tx°©1
,

446 
AR5K_DESC_TX_STATUS1_FINAL_TS_IX_5212
);

449 i‡(!(
tx°©0
 & 
AR5K_DESC_TX_STATUS0_FRAME_XMIT_OK
)) {

450 i‡(
tx°©0
 & 
AR5K_DESC_TX_STATUS0_EXCESSIVE_RETRIES
)

451 
ts
->
ts_°©us
 |
AR5K_TXERR_XRETRY
;

453 i‡(
tx°©0
 & 
AR5K_DESC_TX_STATUS0_FIFO_UNDERRUN
)

454 
ts
->
ts_°©us
 |
AR5K_TXERR_FIFO
;

456 i‡(
tx°©0
 & 
AR5K_DESC_TX_STATUS0_FILTERED
)

457 
ts
->
ts_°©us
 |
AR5K_TXERR_FILT
;

461 
	}
}

471 
	$©h5k_hw_£tup_rx_desc
(
©h5k_hw
 *
ah
, 
©h5k_desc
 *
desc
,

472 
u32
 
size
, 
Êags
)

474 
©h5k_hw_rx_˘l
 *
rx_˘l
;

476 
rx_˘l
 = &
desc
->
ud
.
ds_rx
.rx_ctl;

485 
	`mem£t
(&
desc
->
ud
.
ds_rx
, 0, (
©h5k_hw_Æl_rx_desc
));

487 i‡(
	`u∆ikñy
(
size
 & ~
AR5K_DESC_RX_CTL1_BUF_LEN
))

488  -
EINVAL
;

491 
rx_˘l
->
rx_c⁄åﬁ_1
 = 
size
 & 
AR5K_DESC_RX_CTL1_BUF_LEN
;

493 i‡(
Êags
 & 
AR5K_RXDESC_INTREQ
)

494 
rx_˘l
->
rx_c⁄åﬁ_1
 |
AR5K_DESC_RX_CTL1_INTREQ
;

497 
	}
}

502 
	$©h5k_hw_¥oc_5210_rx_°©us
(
©h5k_hw
 *
ah
,

503 
©h5k_desc
 *
desc
, 
©h5k_rx_°©us
 *
rs
)

505 
©h5k_hw_rx_°©us
 *
rx_°©us
;

507 
rx_°©us
 = &
desc
->
ud
.
ds_rx
.
rx_°©
;

510 i‡(
	`u∆ikñy
(!(
rx_°©us
->
rx_°©us_1
 &

511 
AR5K_5210_RX_DESC_STATUS1_DONE
)))

512  -
EINPROGRESS
;

514 
	`mem£t
(
rs
, 0, (
©h5k_rx_°©us
));

519 
rs
->
rs_d©Æí
 = 
rx_°©us
->
rx_°©us_0
 &

520 
AR5K_5210_RX_DESC_STATUS0_DATA_LEN
;

521 
rs
->
rs_rssi
 = 
	`AR5K_REG_MS
(
rx_°©us
->
rx_°©us_0
,

522 
AR5K_5210_RX_DESC_STATUS0_RECEIVE_SIGNAL
);

523 
rs
->
rs_øã
 = 
	`AR5K_REG_MS
(
rx_°©us
->
rx_°©us_0
,

524 
AR5K_5210_RX_DESC_STATUS0_RECEIVE_RATE
);

525 
rs
->
rs_m‹e
 = !!(
rx_°©us
->
rx_°©us_0
 &

526 
AR5K_5210_RX_DESC_STATUS0_MORE
);

532 
rs
->
rs_t°amp
 = 
	`AR5K_REG_MS
(
rx_°©us
->
rx_°©us_1
,

533 
AR5K_5210_RX_DESC_STATUS1_RECEIVE_TIMESTAMP
);

535 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5211
)

536 
rs
->
rs_™ã¬a
 = 
	`AR5K_REG_MS
(
rx_°©us
->
rx_°©us_0
,

537 
AR5K_5210_RX_DESC_STATUS0_RECEIVE_ANT_5211
);

539 
rs
->
rs_™ã¬a
 = (
rx_°©us
->
rx_°©us_0
 &

540 
AR5K_5210_RX_DESC_STATUS0_RECEIVE_ANT_5210
)

546 i‡(
rx_°©us
->
rx_°©us_1
 & 
AR5K_5210_RX_DESC_STATUS1_KEY_INDEX_VALID
)

547 
rs
->
rs_keyix
 = 
	`AR5K_REG_MS
(
rx_°©us
->
rx_°©us_1
,

548 
AR5K_5210_RX_DESC_STATUS1_KEY_INDEX
);

550 
rs
->
rs_keyix
 = 
AR5K_RXKEYIX_INVALID
;

555 i‡(!(
rx_°©us
->
rx_°©us_1
 &

556 
AR5K_5210_RX_DESC_STATUS1_FRAME_RECEIVE_OK
)) {

557 i‡(
rx_°©us
->
rx_°©us_1
 &

558 
AR5K_5210_RX_DESC_STATUS1_CRC_ERROR
)

559 
rs
->
rs_°©us
 |
AR5K_RXERR_CRC
;

562 i‡((
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
) &&

563 (
rx_°©us
->
rx_°©us_1
 &

564 
AR5K_5210_RX_DESC_STATUS1_FIFO_OVERRUN_5210
))

565 
rs
->
rs_°©us
 |
AR5K_RXERR_FIFO
;

567 i‡(
rx_°©us
->
rx_°©us_1
 &

568 
AR5K_5210_RX_DESC_STATUS1_PHY_ERROR
) {

569 
rs
->
rs_°©us
 |
AR5K_RXERR_PHY
;

570 
rs
->
rs_phyîr
 = 
	`AR5K_REG_MS
(
rx_°©us
->
rx_°©us_1
,

571 
AR5K_5210_RX_DESC_STATUS1_PHY_ERROR
);

574 i‡(
rx_°©us
->
rx_°©us_1
 &

575 
AR5K_5210_RX_DESC_STATUS1_DECRYPT_CRC_ERROR
)

576 
rs
->
rs_°©us
 |
AR5K_RXERR_DECRYPT
;

580 
	}
}

585 
	$©h5k_hw_¥oc_5212_rx_°©us
(
©h5k_hw
 *
ah
,

586 
©h5k_desc
 *
desc
,

587 
©h5k_rx_°©us
 *
rs
)

589 
©h5k_hw_rx_°©us
 *
rx_°©us
;

590 
u32
 
rx°©0
, 
rx°©1
;

592 
rx_°©us
 = &
desc
->
ud
.
ds_rx
.
rx_°©
;

593 
rx°©1
 = 
	`ACCESS_ONCE
(
rx_°©us
->
rx_°©us_1
);

596 i‡(
	`u∆ikñy
(!(
rx°©1
 & 
AR5K_5212_RX_DESC_STATUS1_DONE
)))

597  -
EINPROGRESS
;

599 
	`mem£t
(
rs
, 0, (
©h5k_rx_°©us
));

600 
rx°©0
 = 
	`ACCESS_ONCE
(
rx_°©us
->
rx_°©us_0
);

605 
rs
->
rs_d©Æí
 = 
rx°©0
 & 
AR5K_5212_RX_DESC_STATUS0_DATA_LEN
;

606 
rs
->
rs_rssi
 = 
	`AR5K_REG_MS
(
rx°©0
,

607 
AR5K_5212_RX_DESC_STATUS0_RECEIVE_SIGNAL
);

608 
rs
->
rs_øã
 = 
	`AR5K_REG_MS
(
rx°©0
,

609 
AR5K_5212_RX_DESC_STATUS0_RECEIVE_RATE
);

610 
rs
->
rs_™ã¬a
 = 
	`AR5K_REG_MS
(
rx°©0
,

611 
AR5K_5212_RX_DESC_STATUS0_RECEIVE_ANTENNA
);

612 
rs
->
rs_m‹e
 = !!(
rx°©0
 & 
AR5K_5212_RX_DESC_STATUS0_MORE
);

613 
rs
->
rs_t°amp
 = 
	`AR5K_REG_MS
(
rx°©1
,

614 
AR5K_5212_RX_DESC_STATUS1_RECEIVE_TIMESTAMP
);

619 i‡(
rx°©1
 & 
AR5K_5212_RX_DESC_STATUS1_KEY_INDEX_VALID
)

620 
rs
->
rs_keyix
 = 
	`AR5K_REG_MS
(
rx°©1
,

621 
AR5K_5212_RX_DESC_STATUS1_KEY_INDEX
);

623 
rs
->
rs_keyix
 = 
AR5K_RXKEYIX_INVALID
;

628 i‡(!(
rx°©1
 & 
AR5K_5212_RX_DESC_STATUS1_FRAME_RECEIVE_OK
)) {

629 i‡(
rx°©1
 & 
AR5K_5212_RX_DESC_STATUS1_CRC_ERROR
)

630 
rs
->
rs_°©us
 |
AR5K_RXERR_CRC
;

632 i‡(
rx°©1
 & 
AR5K_5212_RX_DESC_STATUS1_PHY_ERROR
) {

633 
rs
->
rs_°©us
 |
AR5K_RXERR_PHY
;

634 
rs
->
rs_phyîr
 = 
	`AR5K_REG_MS
(
rx°©1
,

635 
AR5K_5212_RX_DESC_STATUS1_PHY_ERROR_CODE
);

636 i‡(!
ah
->
ah_ˇ∑bûôõs
.
ˇp_has_phyîr_cou¡îs
)

637 
	`©h5k_™i_phy_îr‹_ªp‹t
(
ah
, 
rs
->
rs_phyîr
);

640 i‡(
rx°©1
 & 
AR5K_5212_RX_DESC_STATUS1_DECRYPT_CRC_ERROR
)

641 
rs
->
rs_°©us
 |
AR5K_RXERR_DECRYPT
;

643 i‡(
rx°©1
 & 
AR5K_5212_RX_DESC_STATUS1_MIC_ERROR
)

644 
rs
->
rs_°©us
 |
AR5K_RXERR_MIC
;

647 
	}
}

657 
	$©h5k_hw_öô_desc_fun˘i⁄s
(
©h5k_hw
 *
ah
)

659 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5212
) {

660 
ah
->
ah_£tup_tx_desc
 = 
©h5k_hw_£tup_4w‹d_tx_desc
;

661 
ah
->
ah_¥oc_tx_desc
 = 
©h5k_hw_¥oc_4w‹d_tx_°©us
;

662 
ah
->
ah_¥oc_rx_desc
 = 
©h5k_hw_¥oc_5212_rx_°©us
;

663 } i‡(
ah
->
ah_vîsi⁄
 <
AR5K_AR5211
) {

664 
ah
->
ah_£tup_tx_desc
 = 
©h5k_hw_£tup_2w‹d_tx_desc
;

665 
ah
->
ah_¥oc_tx_desc
 = 
©h5k_hw_¥oc_2w‹d_tx_°©us
;

666 
ah
->
ah_¥oc_rx_desc
 = 
©h5k_hw_¥oc_5210_rx_°©us
;

668  -
ENOTSUPP
;

670 
	}
}

	@ath5k/desc.h

26 
	s©h5k_hw_rx_˘l
 {

27 
u32
 
	mrx_c⁄åﬁ_0
;

28 
u32
 
	mrx_c⁄åﬁ_1
;

29 } 
__∑cked
 
__Æig√d
(4);

32 
	#AR5K_DESC_RX_CTL1_BUF_LEN
 0x00000ff‡

	)

33 
	#AR5K_DESC_RX_CTL1_INTREQ
 0x00002000

	)

39 
	s©h5k_hw_rx_°©us
 {

40 
u32
 
	mrx_°©us_0
;

41 
u32
 
	mrx_°©us_1
;

42 } 
__∑cked
 
__Æig√d
(4);

46 
	#AR5K_5210_RX_DESC_STATUS0_DATA_LEN
 0x00000ff‡

	)

47 
	#AR5K_5210_RX_DESC_STATUS0_MORE
 0x00001000

	)

48 
	#AR5K_5210_RX_DESC_STATUS0_RECEIVE_ANT_5210
 0x00004000

	)

49 
	#AR5K_5210_RX_DESC_STATUS0_RECEIVE_RATE
 0x00078000

	)

50 
	#AR5K_5210_RX_DESC_STATUS0_RECEIVE_RATE_S
 15

	)

51 
	#AR5K_5210_RX_DESC_STATUS0_RECEIVE_SIGNAL
 0x07f80000

	)

52 
	#AR5K_5210_RX_DESC_STATUS0_RECEIVE_SIGNAL_S
 19

	)

53 
	#AR5K_5210_RX_DESC_STATUS0_RECEIVE_ANT_5211
 0x38000000

	)

54 
	#AR5K_5210_RX_DESC_STATUS0_RECEIVE_ANT_5211_S
 27

	)

57 
	#AR5K_5210_RX_DESC_STATUS1_DONE
 0x00000001

	)

58 
	#AR5K_5210_RX_DESC_STATUS1_FRAME_RECEIVE_OK
 0x00000002

	)

59 
	#AR5K_5210_RX_DESC_STATUS1_CRC_ERROR
 0x00000004

	)

60 
	#AR5K_5210_RX_DESC_STATUS1_FIFO_OVERRUN_5210
 0x00000008

	)

61 
	#AR5K_5210_RX_DESC_STATUS1_DECRYPT_CRC_ERROR
 0x00000010

	)

62 
	#AR5K_5210_RX_DESC_STATUS1_PHY_ERROR
 0x000000e0

	)

63 
	#AR5K_5210_RX_DESC_STATUS1_PHY_ERROR_S
 5

	)

64 
	#AR5K_5210_RX_DESC_STATUS1_KEY_INDEX_VALID
 0x00000100

	)

65 
	#AR5K_5210_RX_DESC_STATUS1_KEY_INDEX
 0x00007e00

	)

66 
	#AR5K_5210_RX_DESC_STATUS1_KEY_INDEX_S
 9

	)

67 
	#AR5K_5210_RX_DESC_STATUS1_RECEIVE_TIMESTAMP
 0x0fff8000

	)

68 
	#AR5K_5210_RX_DESC_STATUS1_RECEIVE_TIMESTAMP_S
 15

	)

69 
	#AR5K_5210_RX_DESC_STATUS1_KEY_CACHE_MISS
 0x10000000

	)

73 
	#AR5K_5212_RX_DESC_STATUS0_DATA_LEN
 0x00000ff‡

	)

74 
	#AR5K_5212_RX_DESC_STATUS0_MORE
 0x00001000

	)

75 
	#AR5K_5212_RX_DESC_STATUS0_DECOMP_CRC_ERROR
 0x00002000

	)

76 
	#AR5K_5212_RX_DESC_STATUS0_RECEIVE_RATE
 0x000f8000

	)

77 
	#AR5K_5212_RX_DESC_STATUS0_RECEIVE_RATE_S
 15

	)

78 
	#AR5K_5212_RX_DESC_STATUS0_RECEIVE_SIGNAL
 0x0ff00000

	)

79 
	#AR5K_5212_RX_DESC_STATUS0_RECEIVE_SIGNAL_S
 20

	)

80 
	#AR5K_5212_RX_DESC_STATUS0_RECEIVE_ANTENNA
 0xf0000000

	)

81 
	#AR5K_5212_RX_DESC_STATUS0_RECEIVE_ANTENNA_S
 28

	)

84 
	#AR5K_5212_RX_DESC_STATUS1_DONE
 0x00000001

	)

85 
	#AR5K_5212_RX_DESC_STATUS1_FRAME_RECEIVE_OK
 0x00000002

	)

86 
	#AR5K_5212_RX_DESC_STATUS1_CRC_ERROR
 0x00000004

	)

87 
	#AR5K_5212_RX_DESC_STATUS1_DECRYPT_CRC_ERROR
 0x00000008

	)

88 
	#AR5K_5212_RX_DESC_STATUS1_PHY_ERROR
 0x00000010

	)

89 
	#AR5K_5212_RX_DESC_STATUS1_MIC_ERROR
 0x00000020

	)

90 
	#AR5K_5212_RX_DESC_STATUS1_KEY_INDEX_VALID
 0x00000100

	)

91 
	#AR5K_5212_RX_DESC_STATUS1_KEY_INDEX
 0x0000„00

	)

92 
	#AR5K_5212_RX_DESC_STATUS1_KEY_INDEX_S
 9

	)

93 
	#AR5K_5212_RX_DESC_STATUS1_RECEIVE_TIMESTAMP
 0x7fff0000

	)

94 
	#AR5K_5212_RX_DESC_STATUS1_RECEIVE_TIMESTAMP_S
 16

	)

95 
	#AR5K_5212_RX_DESC_STATUS1_KEY_CACHE_MISS
 0x80000000

	)

96 
	#AR5K_5212_RX_DESC_STATUS1_PHY_ERROR_CODE
 0x0000ff00

	)

97 
	#AR5K_5212_RX_DESC_STATUS1_PHY_ERROR_CODE_S
 8

	)

102 
	e©h5k_phy_îr‹_code
 {

103 
	mAR5K_RX_PHY_ERROR_UNDERRUN
 = 0,

104 
	mAR5K_RX_PHY_ERROR_TIMING
 = 1,

105 
	mAR5K_RX_PHY_ERROR_PARITY
 = 2,

106 
	mAR5K_RX_PHY_ERROR_RATE
 = 3,

107 
	mAR5K_RX_PHY_ERROR_LENGTH
 = 4,

108 
	mAR5K_RX_PHY_ERROR_RADAR
 = 5,

109 
	mAR5K_RX_PHY_ERROR_SERVICE
 = 6,

110 
	mAR5K_RX_PHY_ERROR_TOR
 = 7,

112 
	mAR5K_RX_PHY_ERROR_OFDM_TIMING
 = 17,

113 
	mAR5K_RX_PHY_ERROR_OFDM_SIGNAL_PARITY
 = 18,

114 
	mAR5K_RX_PHY_ERROR_OFDM_RATE_ILLEGAL
 = 19,

115 
	mAR5K_RX_PHY_ERROR_OFDM_LENGTH_ILLEGAL
 = 20,

116 
	mAR5K_RX_PHY_ERROR_OFDM_POWER_DROP
 = 21,

117 
	mAR5K_RX_PHY_ERROR_OFDM_SERVICE
 = 22,

118 
	mAR5K_RX_PHY_ERROR_OFDM_RESTART
 = 23,

119 
	mAR5K_RX_PHY_ERROR_CCK_TIMING
 = 25,

120 
	mAR5K_RX_PHY_ERROR_CCK_HEADER_CRC
 = 26,

121 
	mAR5K_RX_PHY_ERROR_CCK_RATE_ILLEGAL
 = 27,

122 
	mAR5K_RX_PHY_ERROR_CCK_SERVICE
 = 30,

123 
	mAR5K_RX_PHY_ERROR_CCK_RESTART
 = 31,

129 
	s©h5k_hw_2w_tx_˘l
 {

130 
u32
 
	mtx_c⁄åﬁ_0
;

131 
u32
 
	mtx_c⁄åﬁ_1
;

132 } 
__∑cked
 
__Æig√d
(4);

135 
	#AR5K_2W_TX_DESC_CTL0_FRAME_LEN
 0x00000ff‡

	)

136 
	#AR5K_2W_TX_DESC_CTL0_HEADER_LEN_5210
 0x0003f000

	)

137 
	#AR5K_2W_TX_DESC_CTL0_HEADER_LEN_5210_S
 12

	)

138 
	#AR5K_2W_TX_DESC_CTL0_XMIT_RATE
 0x003c0000

	)

139 
	#AR5K_2W_TX_DESC_CTL0_XMIT_RATE_S
 18

	)

140 
	#AR5K_2W_TX_DESC_CTL0_RTSENA
 0x00400000

	)

141 
	#AR5K_2W_TX_DESC_CTL0_LONG_PACKET_5210
 0x00800000

	)

142 
	#AR5K_2W_TX_DESC_CTL0_VEOL_5211
 0x00800000

	)

143 
	#AR5K_2W_TX_DESC_CTL0_CLRDMASK
 0x01000000

	)

144 
	#AR5K_2W_TX_DESC_CTL0_ANT_MODE_XMIT_5210
 0x02000000

	)

145 
	#AR5K_2W_TX_DESC_CTL0_ANT_MODE_XMIT_5211
 0x1e000000

	)

146 
	#AR5K_2W_TX_DESC_CTL0_ANT_MODE_XMIT
 \

147 (
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
 ? \

148 
AR5K_2W_TX_DESC_CTL0_ANT_MODE_XMIT_5210
 : \

149 
AR5K_2W_TX_DESC_CTL0_ANT_MODE_XMIT_5211
)

	)

150 
	#AR5K_2W_TX_DESC_CTL0_ANT_MODE_XMIT_S
 25

	)

151 
	#AR5K_2W_TX_DESC_CTL0_FRAME_TYPE_5210
 0x1c000000

	)

152 
	#AR5K_2W_TX_DESC_CTL0_FRAME_TYPE_5210_S
 26

	)

153 
	#AR5K_2W_TX_DESC_CTL0_INTREQ
 0x20000000

	)

154 
	#AR5K_2W_TX_DESC_CTL0_ENCRYPT_KEY_VALID
 0x40000000

	)

157 
	#AR5K_2W_TX_DESC_CTL1_BUF_LEN
 0x00000ff‡

	)

158 
	#AR5K_2W_TX_DESC_CTL1_MORE
 0x00001000

	)

159 
	#AR5K_2W_TX_DESC_CTL1_ENC_KEY_IDX_5210
 0x0007e000

	)

160 
	#AR5K_2W_TX_DESC_CTL1_ENC_KEY_IDX_5211
 0x000„000

	)

161 
	#AR5K_2W_TX_DESC_CTL1_ENC_KEY_IDX
 \

162 (
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
 ? \

163 
AR5K_2W_TX_DESC_CTL1_ENC_KEY_IDX_5210
 : \

164 
AR5K_2W_TX_DESC_CTL1_ENC_KEY_IDX_5211
)

	)

165 
	#AR5K_2W_TX_DESC_CTL1_ENC_KEY_IDX_S
 13

	)

166 
	#AR5K_2W_TX_DESC_CTL1_FRAME_TYPE_5211
 0x00700000

	)

167 
	#AR5K_2W_TX_DESC_CTL1_FRAME_TYPE_5211_S
 20

	)

168 
	#AR5K_2W_TX_DESC_CTL1_NOACK_5211
 0x00800000

	)

169 
	#AR5K_2W_TX_DESC_CTL1_RTS_DURATION_5210
 0xfff80000

	)

172 
	#AR5K_AR5210_TX_DESC_FRAME_TYPE_NORMAL
 0

	)

173 
	#AR5K_AR5210_TX_DESC_FRAME_TYPE_ATIM
 1

	)

174 
	#AR5K_AR5210_TX_DESC_FRAME_TYPE_PSPOLL
 2

	)

175 
	#AR5K_AR5210_TX_DESC_FRAME_TYPE_NO_DELAY
 3

	)

176 
	#AR5K_AR5211_TX_DESC_FRAME_TYPE_BEACON
 3

	)

177 
	#AR5K_AR5210_TX_DESC_FRAME_TYPE_PIFS
 4

	)

178 
	#AR5K_AR5211_TX_DESC_FRAME_TYPE_PRESP
 4

	)

183 
	s©h5k_hw_4w_tx_˘l
 {

184 
u32
 
	mtx_c⁄åﬁ_0
;

185 
u32
 
	mtx_c⁄åﬁ_1
;

186 
u32
 
	mtx_c⁄åﬁ_2
;

187 
u32
 
	mtx_c⁄åﬁ_3
;

188 } 
__∑cked
 
__Æig√d
(4);

191 
	#AR5K_4W_TX_DESC_CTL0_FRAME_LEN
 0x00000ff‡

	)

192 
	#AR5K_4W_TX_DESC_CTL0_XMIT_POWER
 0x003f0000

	)

193 
	#AR5K_4W_TX_DESC_CTL0_XMIT_POWER_S
 16

	)

194 
	#AR5K_4W_TX_DESC_CTL0_RTSENA
 0x00400000

	)

195 
	#AR5K_4W_TX_DESC_CTL0_VEOL
 0x00800000

	)

196 
	#AR5K_4W_TX_DESC_CTL0_CLRDMASK
 0x01000000

	)

197 
	#AR5K_4W_TX_DESC_CTL0_ANT_MODE_XMIT
 0x1e000000

	)

198 
	#AR5K_4W_TX_DESC_CTL0_ANT_MODE_XMIT_S
 25

	)

199 
	#AR5K_4W_TX_DESC_CTL0_INTREQ
 0x20000000

	)

200 
	#AR5K_4W_TX_DESC_CTL0_ENCRYPT_KEY_VALID
 0x40000000

	)

201 
	#AR5K_4W_TX_DESC_CTL0_CTSENA
 0x80000000

	)

204 
	#AR5K_4W_TX_DESC_CTL1_BUF_LEN
 0x00000ff‡

	)

205 
	#AR5K_4W_TX_DESC_CTL1_MORE
 0x00001000

	)

206 
	#AR5K_4W_TX_DESC_CTL1_ENCRYPT_KEY_IDX
 0x000„000

	)

207 
	#AR5K_4W_TX_DESC_CTL1_ENCRYPT_KEY_IDX_S
 13

	)

208 
	#AR5K_4W_TX_DESC_CTL1_FRAME_TYPE
 0x00f00000

	)

209 
	#AR5K_4W_TX_DESC_CTL1_FRAME_TYPE_S
 20

	)

210 
	#AR5K_4W_TX_DESC_CTL1_NOACK
 0x01000000

	)

211 
	#AR5K_4W_TX_DESC_CTL1_COMP_PROC
 0x06000000

	)

212 
	#AR5K_4W_TX_DESC_CTL1_COMP_PROC_S
 25

	)

213 
	#AR5K_4W_TX_DESC_CTL1_COMP_IV_LEN
 0x18000000

	)

214 
	#AR5K_4W_TX_DESC_CTL1_COMP_IV_LEN_S
 27

	)

215 
	#AR5K_4W_TX_DESC_CTL1_COMP_ICV_LEN
 0x60000000

	)

216 
	#AR5K_4W_TX_DESC_CTL1_COMP_ICV_LEN_S
 29

	)

219 
	#AR5K_4W_TX_DESC_CTL2_RTS_DURATION
 0x00007ff‡

	)

220 
	#AR5K_4W_TX_DESC_CTL2_DURATION_UPD_EN
 0x00008000

	)

221 
	#AR5K_4W_TX_DESC_CTL2_XMIT_TRIES0
 0x000f0000

	)

222 
	#AR5K_4W_TX_DESC_CTL2_XMIT_TRIES0_S
 16

	)

223 
	#AR5K_4W_TX_DESC_CTL2_XMIT_TRIES1
 0x00f00000

	)

224 
	#AR5K_4W_TX_DESC_CTL2_XMIT_TRIES1_S
 20

	)

225 
	#AR5K_4W_TX_DESC_CTL2_XMIT_TRIES2
 0x0f000000

	)

226 
	#AR5K_4W_TX_DESC_CTL2_XMIT_TRIES2_S
 24

	)

227 
	#AR5K_4W_TX_DESC_CTL2_XMIT_TRIES3
 0xf0000000

	)

228 
	#AR5K_4W_TX_DESC_CTL2_XMIT_TRIES3_S
 28

	)

231 
	#AR5K_4W_TX_DESC_CTL3_XMIT_RATE0
 0x0000001‡

	)

232 
	#AR5K_4W_TX_DESC_CTL3_XMIT_RATE1
 0x000003e0

	)

233 
	#AR5K_4W_TX_DESC_CTL3_XMIT_RATE1_S
 5

	)

234 
	#AR5K_4W_TX_DESC_CTL3_XMIT_RATE2
 0x00007c00

	)

235 
	#AR5K_4W_TX_DESC_CTL3_XMIT_RATE2_S
 10

	)

236 
	#AR5K_4W_TX_DESC_CTL3_XMIT_RATE3
 0x000f8000

	)

237 
	#AR5K_4W_TX_DESC_CTL3_XMIT_RATE3_S
 15

	)

238 
	#AR5K_4W_TX_DESC_CTL3_RTS_CTS_RATE
 0x01f00000

	)

239 
	#AR5K_4W_TX_DESC_CTL3_RTS_CTS_RATE_S
 20

	)

244 
	s©h5k_hw_tx_°©us
 {

245 
u32
 
	mtx_°©us_0
;

246 
u32
 
	mtx_°©us_1
;

247 } 
__∑cked
 
__Æig√d
(4);

250 
	#AR5K_DESC_TX_STATUS0_FRAME_XMIT_OK
 0x00000001

	)

251 
	#AR5K_DESC_TX_STATUS0_EXCESSIVE_RETRIES
 0x00000002

	)

252 
	#AR5K_DESC_TX_STATUS0_FIFO_UNDERRUN
 0x00000004

	)

253 
	#AR5K_DESC_TX_STATUS0_FILTERED
 0x00000008

	)

259 
	#AR5K_DESC_TX_STATUS0_SHORT_RETRY_COUNT
 0x000000f0

	)

260 
	#AR5K_DESC_TX_STATUS0_SHORT_RETRY_COUNT_S
 4

	)

261 
	#AR5K_DESC_TX_STATUS0_LONG_RETRY_COUNT
 0x00000f00

	)

262 
	#AR5K_DESC_TX_STATUS0_LONG_RETRY_COUNT_S
 8

	)

263 
	#AR5K_DESC_TX_STATUS0_VIRTCOLL_CT_5211
 0x0000f000

	)

264 
	#AR5K_DESC_TX_STATUS0_VIRTCOLL_CT_5212_S
 12

	)

265 
	#AR5K_DESC_TX_STATUS0_SEND_TIMESTAMP
 0xffff0000

	)

266 
	#AR5K_DESC_TX_STATUS0_SEND_TIMESTAMP_S
 16

	)

269 
	#AR5K_DESC_TX_STATUS1_DONE
 0x00000001

	)

270 
	#AR5K_DESC_TX_STATUS1_SEQ_NUM
 0x00001f„

	)

271 
	#AR5K_DESC_TX_STATUS1_SEQ_NUM_S
 1

	)

272 
	#AR5K_DESC_TX_STATUS1_ACK_SIG_STRENGTH
 0x001„000

	)

273 
	#AR5K_DESC_TX_STATUS1_ACK_SIG_STRENGTH_S
 13

	)

274 
	#AR5K_DESC_TX_STATUS1_FINAL_TS_IX_5212
 0x00600000

	)

275 
	#AR5K_DESC_TX_STATUS1_FINAL_TS_IX_5212_S
 21

	)

276 
	#AR5K_DESC_TX_STATUS1_COMP_SUCCESS_5212
 0x00800000

	)

277 
	#AR5K_DESC_TX_STATUS1_XMIT_ANTENNA_5212
 0x01000000

	)

282 
	s©h5k_hw_5210_tx_desc
 {

283 
©h5k_hw_2w_tx_˘l
 
	mtx_˘l
;

284 
©h5k_hw_tx_°©us
 
	mtx_°©
;

285 } 
__∑cked
 
__Æig√d
(4);

290 
	s©h5k_hw_5212_tx_desc
 {

291 
©h5k_hw_4w_tx_˘l
 
	mtx_˘l
;

292 
©h5k_hw_tx_°©us
 
	mtx_°©
;

293 } 
__∑cked
 
__Æig√d
(4);

298 
	s©h5k_hw_Æl_rx_desc
 {

299 
©h5k_hw_rx_˘l
 
	mrx_˘l
;

300 
©h5k_hw_rx_°©us
 
	mrx_°©
;

301 } 
__∑cked
 
__Æig√d
(4);

307 
	s©h5k_desc
 {

308 
u32
 
	mds_lök
;

309 
u32
 
	mds_d©a
;

312 
©h5k_hw_5210_tx_desc
 
	mds_tx5210
;

313 
©h5k_hw_5212_tx_desc
 
	mds_tx5212
;

314 
©h5k_hw_Æl_rx_desc
 
	mds_rx
;

315 } 
	mud
;

316 } 
__∑cked
 
__Æig√d
(4);

318 
	#AR5K_RXDESC_INTREQ
 0x0020

	)

320 
	#AR5K_TXDESC_CLRDMASK
 0x0001

	)

321 
	#AR5K_TXDESC_NOACK
 0x0002

	)

322 
	#AR5K_TXDESC_RTSENA
 0x0004

	)

323 
	#AR5K_TXDESC_CTSENA
 0x0008

	)

324 
	#AR5K_TXDESC_INTREQ
 0x0010

	)

325 
	#AR5K_TXDESC_VEOL
 0x0020

	)

	@ath5k/dma.c

35 
	~"©h5k.h
"

36 
	~"ªg.h
"

37 
	~"debug.h
"

38 
	~"ba£.h
"

50 
	$©h5k_hw_°¨t_rx_dma
(
©h5k_hw
 *
ah
)

52 
	`©h5k_hw_ªg_wrôe
(
ah
, 
AR5K_CR_RXE
, 
AR5K_CR
);

53 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_CR
);

54 
	}
}

61 
	$©h5k_hw_°›_rx_dma
(
©h5k_hw
 *
ah
)

63 
i
;

65 
	`©h5k_hw_ªg_wrôe
(
ah
, 
AR5K_CR_RXD
, 
AR5K_CR
);

70 
i
 = 1000; i > 0 &&

71 (
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_CR
Ë& 
AR5K_CR_RXE
) != 0;

72 
i
--)

73 
	`udñay
(100);

75 i‡(!
i
)

76 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_DMA
,

79  
i
 ? 0 : -
EBUSY
;

80 
	}
}

87 
u32
 
	$©h5k_hw_gë_rxdp
(
©h5k_hw
 *
ah
)

89  
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_RXDP
);

90 
	}
}

100 
	$©h5k_hw_£t_rxdp
(
©h5k_hw
 *
ah
, 
u32
 
phys_addr
)

102 i‡(
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_CR
Ë& 
AR5K_CR_RXE
) {

103 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_DMA
,

105  -
EIO
;

108 
	`©h5k_hw_ªg_wrôe
(
ah
, 
phys_addr
, 
AR5K_RXDP
);

110 
	}
}

132 
	$©h5k_hw_°¨t_tx_dma
(
©h5k_hw
 *
ah
, 
queue
)

134 
u32
 
tx_queue
;

136 
	`AR5K_ASSERT_ENTRY
(
queue
, 
ah
->
ah_ˇ∑bûôõs
.
ˇp_queues
.
q_tx_num
);

139 i‡(
ah
->
ah_txq
[
queue
].
tqi_ty≥
 =
AR5K_TX_QUEUE_INACTIVE
)

140  -
EINVAL
;

142 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
) {

143 
tx_queue
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_CR
);

148 
ah
->
ah_txq
[
queue
].
tqi_ty≥
) {

149 
AR5K_TX_QUEUE_DATA
:

150 
tx_queue
 |
AR5K_CR_TXE0
 & ~
AR5K_CR_TXD0
;

152 
AR5K_TX_QUEUE_BEACON
:

153 
tx_queue
 |
AR5K_CR_TXE1
 & ~
AR5K_CR_TXD1
;

154 
	`©h5k_hw_ªg_wrôe
(
ah
, 
AR5K_BCR_TQ1V
 | 
AR5K_BCR_BDMAE
,

155 
AR5K_BSR
);

157 
AR5K_TX_QUEUE_CAB
:

158 
tx_queue
 |
AR5K_CR_TXE1
 & ~
AR5K_CR_TXD1
;

159 
	`©h5k_hw_ªg_wrôe
(
ah
, 
AR5K_BCR_TQ1FV
 | 
AR5K_BCR_TQ1V
 |

160 
AR5K_BCR_BDMAE
, 
AR5K_BSR
);

163  -
EINVAL
;

166 
	`©h5k_hw_ªg_wrôe
(
ah
, 
tx_queue
, 
AR5K_CR
);

167 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_CR
);

170 i‡(
	`AR5K_REG_READ_Q
(
ah
, 
AR5K_QCU_TXD
, 
queue
))

171  -
EIO
;

174 
	`AR5K_REG_WRITE_Q
(
ah
, 
AR5K_QCU_TXE
, 
queue
);

178 
	}
}

191 
	$©h5k_hw_°›_tx_dma
(
©h5k_hw
 *
ah
, 
queue
)

193 
i
 = 40;

194 
u32
 
tx_queue
, 
≥ndög
;

196 
	`AR5K_ASSERT_ENTRY
(
queue
, 
ah
->
ah_ˇ∑bûôõs
.
ˇp_queues
.
q_tx_num
);

199 i‡(
ah
->
ah_txq
[
queue
].
tqi_ty≥
 =
AR5K_TX_QUEUE_INACTIVE
)

200  -
EINVAL
;

202 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
) {

203 
tx_queue
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_CR
);

208 
ah
->
ah_txq
[
queue
].
tqi_ty≥
) {

209 
AR5K_TX_QUEUE_DATA
:

210 
tx_queue
 |
AR5K_CR_TXD0
 & ~
AR5K_CR_TXE0
;

212 
AR5K_TX_QUEUE_BEACON
:

213 
AR5K_TX_QUEUE_CAB
:

215 
tx_queue
 |
AR5K_CR_TXD1
 & ~AR5K_CR_TXD1;

216 
	`©h5k_hw_ªg_wrôe
(
ah
, 0, 
AR5K_BSR
);

219  -
EINVAL
;

223 
	`©h5k_hw_ªg_wrôe
(
ah
, 
tx_queue
, 
AR5K_CR
);

224 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_CR
);

231 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
	`AR5K_QUEUE_MISC
(
queue
),

232 
AR5K_QCU_MISC_DCU_EARLY
);

237 
	`AR5K_REG_WRITE_Q
(
ah
, 
AR5K_QCU_TXD
, 
queue
);

240 
i
 = 1000; i > 0 &&

241 (
	`AR5K_REG_READ_Q
(
ah
, 
AR5K_QCU_TXE
, 
queue
) != 0);

242 
i
--)

243 
	`udñay
(100);

245 i‡(
	`AR5K_REG_READ_Q
(
ah
, 
AR5K_QCU_TXE
, 
queue
))

246 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_DMA
,

247 "queuê%òdidn'à°› !\n", 
queue
);

250 
i
 = 1000;

252 
≥ndög
 = 
	`©h5k_hw_ªg_ªad
(
ah
,

253 
	`AR5K_QUEUE_STATUS
(
queue
)) &

254 
AR5K_QCU_STS_FRMPENDCNT
;

255 
	`udñay
(100);

256 } --
i
 && 
≥ndög
);

260 i‡(
ah
->
ah_mac_vîsi⁄
 >(
AR5K_SREV_AR2414
 >> 4) &&

261 
≥ndög
) {

263 
	`©h5k_hw_ªg_wrôe
(
ah
,

264 
	`AR5K_REG_SM
(100, 
AR5K_QUIET_CTL2_QT_PER
)|

265 
	`AR5K_REG_SM
(10, 
AR5K_QUIET_CTL2_QT_DUR
),

266 
AR5K_QUIET_CTL2
);

269 
	`©h5k_hw_ªg_wrôe
(
ah
,

270 
AR5K_QUIET_CTL1_QT_EN
 |

271 
	`AR5K_REG_SM
(
	`©h5k_hw_ªg_ªad
(
ah
,

272 
AR5K_TSF_L32_5211
) >> 10,

273 
AR5K_QUIET_CTL1_NEXT_QT_TSF
),

274 
AR5K_QUIET_CTL1
);

277 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_DIAG_SW_5211
,

278 
AR5K_DIAG_SW_CHANNEL_IDLE_HIGH
);

281 
	`udñay
(400);

282 
	`AR5K_REG_DISABLE_BITS
(
ah
, 
AR5K_QUIET_CTL1
,

283 
AR5K_QUIET_CTL1_QT_EN
);

286 
i
 = 100;

288 
≥ndög
 = 
	`©h5k_hw_ªg_ªad
(
ah
,

289 
	`AR5K_QUEUE_STATUS
(
queue
)) &

290 
AR5K_QCU_STS_FRMPENDCNT
;

291 
	`udñay
(100);

292 } --
i
 && 
≥ndög
);

294 
	`AR5K_REG_DISABLE_BITS
(
ah
, 
AR5K_DIAG_SW_5211
,

295 
AR5K_DIAG_SW_CHANNEL_IDLE_HIGH
);

297 i‡(
≥ndög
)

298 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_DMA
,

300 
queue
);

306 
	`AR5K_REG_DISABLE_BITS
(
ah
, 
	`AR5K_QUEUE_MISC
(
queue
),

307 
AR5K_QCU_MISC_DCU_EARLY
);

310 
	`©h5k_hw_ªg_wrôe
(
ah
, 0, 
AR5K_QCU_TXD
);

311 i‡(
≥ndög
) {

312 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_DMA
,

314 
queue
, 
≥ndög
);

315  -
EBUSY
;

321 
	}
}

331 
	$©h5k_hw_°›_bóc⁄_queue
(
©h5k_hw
 *
ah
, 
queue
)

333 
ªt
;

334 
ªt
 = 
	`©h5k_hw_°›_tx_dma
(
ah
, 
queue
);

335 i‡(
ªt
) {

336 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_DMA
,

338  -
EIO
;

341 
	}
}

356 
u32
 
	$©h5k_hw_gë_txdp
(
©h5k_hw
 *
ah
, 
queue
)

358 
u16
 
tx_ªg
;

360 
	`AR5K_ASSERT_ENTRY
(
queue
, 
ah
->
ah_ˇ∑bûôõs
.
ˇp_queues
.
q_tx_num
);

366 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
) {

367 
ah
->
ah_txq
[
queue
].
tqi_ty≥
) {

368 
AR5K_TX_QUEUE_DATA
:

369 
tx_ªg
 = 
AR5K_NOQCU_TXDP0
;

371 
AR5K_TX_QUEUE_BEACON
:

372 
AR5K_TX_QUEUE_CAB
:

373 
tx_ªg
 = 
AR5K_NOQCU_TXDP1
;

379 
tx_ªg
 = 
	`AR5K_QUEUE_TXDP
(
queue
);

382  
	`©h5k_hw_ªg_ªad
(
ah
, 
tx_ªg
);

383 
	}
}

398 
	$©h5k_hw_£t_txdp
(
©h5k_hw
 *
ah
, 
queue
, 
u32
 
phys_addr
)

400 
u16
 
tx_ªg
;

402 
	`AR5K_ASSERT_ENTRY
(
queue
, 
ah
->
ah_ˇ∑bûôõs
.
ˇp_queues
.
q_tx_num
);

408 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
) {

409 
ah
->
ah_txq
[
queue
].
tqi_ty≥
) {

410 
AR5K_TX_QUEUE_DATA
:

411 
tx_ªg
 = 
AR5K_NOQCU_TXDP0
;

413 
AR5K_TX_QUEUE_BEACON
:

414 
AR5K_TX_QUEUE_CAB
:

415 
tx_ªg
 = 
AR5K_NOQCU_TXDP1
;

418  -
EINVAL
;

426 i‡(
	`AR5K_REG_READ_Q
(
ah
, 
AR5K_QCU_TXE
, 
queue
))

427  -
EIO
;

429 
tx_ªg
 = 
	`AR5K_QUEUE_TXDP
(
queue
);

433 
	`©h5k_hw_ªg_wrôe
(
ah
, 
phys_addr
, 
tx_ªg
);

436 
	}
}

456 
	$©h5k_hw_upd©e_tx_åigÀvñ
(
©h5k_hw
 *
ah
, 
boﬁ
 
ö¸ó£
)

458 
u32
 
åiggî_Àvñ
, 
imr
;

459 
ªt
 = -
EIO
;

464 
imr
 = 
	`©h5k_hw_£t_imr
(
ah
,áh->
ah_imr
 & ~
AR5K_INT_GLOBAL
);

466 
åiggî_Àvñ
 = 
	`AR5K_REG_MS
(
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_TXCFG
),

467 
AR5K_TXCFG_TXFULL
);

469 i‡(!
ö¸ó£
) {

470 i‡(--
åiggî_Àvñ
 < 
AR5K_TUNE_MIN_TX_FIFO_THRES
)

471 
d⁄e
;

473 
åiggî_Àvñ
 +=

474 ((
AR5K_TUNE_MAX_TX_FIFO_THRES
 - 
åiggî_Àvñ
) / 2);

479 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
)

480 
	`©h5k_hw_ªg_wrôe
(
ah
, 
åiggî_Àvñ
, 
AR5K_TRIG_LVL
);

482 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_TXCFG
,

483 
AR5K_TXCFG_TXFULL
, 
åiggî_Àvñ
);

485 
ªt
 = 0;

487 
d⁄e
:

491 
	`©h5k_hw_£t_imr
(
ah
, 
imr
);

493  
ªt
;

494 
	}
}

509 
boﬁ
 
	$©h5k_hw_is_öå_≥ndög
(
©h5k_hw
 *
ah
)

511  
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_INTPEND
) == 1 ? 1 : 0;

512 
	}
}

530 
	$©h5k_hw_gë_i§
(
©h5k_hw
 *
ah
, 
©h5k_öt
 *
öãºu±_mask
)

532 
u32
 
d©a
;

538 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
) {

539 
d©a
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_ISR
);

540 i‡(
	`u∆ikñy
(
d©a
 =
AR5K_INT_NOCARD
)) {

541 *
öãºu±_mask
 = 
d©a
;

542  -
ENODEV
;

551 
d©a
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_RAC_PISR
);

552 i‡(
	`u∆ikñy
(
d©a
 =
AR5K_INT_NOCARD
)) {

553 *
öãºu±_mask
 = 
d©a
;

554  -
ENODEV
;

561 *
öãºu±_mask
 = (
d©a
 & 
AR5K_INT_COMMON
Ë& 
ah
->
ah_imr
;

563 i‡(
ah
->
ah_vîsi⁄
 !
AR5K_AR5210
) {

564 
u32
 
si§2
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_RAC_SISR2
);

567 i‡(
	`u∆ikñy
(
d©a
 & (
AR5K_ISR_HIUERR
)))

568 *
öãºu±_mask
 |
AR5K_INT_FATAL
;

571 i‡(
	`u∆ikñy
(
d©a
 & (
AR5K_ISR_BNR
)))

572 *
öãºu±_mask
 |
AR5K_INT_BNR
;

574 i‡(
	`u∆ikñy
(
si§2
 & (
AR5K_SISR2_SSERR
 |

575 
AR5K_SISR2_DPERR
 |

576 
AR5K_SISR2_MCABT
)))

577 *
öãºu±_mask
 |
AR5K_INT_FATAL
;

579 i‡(
d©a
 & 
AR5K_ISR_TIM
)

580 *
öãºu±_mask
 |
AR5K_INT_TIM
;

582 i‡(
d©a
 & 
AR5K_ISR_BCNMISC
) {

583 i‡(
si§2
 & 
AR5K_SISR2_TIM
)

584 *
öãºu±_mask
 |
AR5K_INT_TIM
;

585 i‡(
si§2
 & 
AR5K_SISR2_DTIM
)

586 *
öãºu±_mask
 |
AR5K_INT_DTIM
;

587 i‡(
si§2
 & 
AR5K_SISR2_DTIM_SYNC
)

588 *
öãºu±_mask
 |
AR5K_INT_DTIM_SYNC
;

589 i‡(
si§2
 & 
AR5K_SISR2_BCN_TIMEOUT
)

590 *
öãºu±_mask
 |
AR5K_INT_BCN_TIMEOUT
;

591 i‡(
si§2
 & 
AR5K_SISR2_CAB_TIMEOUT
)

592 *
öãºu±_mask
 |
AR5K_INT_CAB_TIMEOUT
;

595 i‡(
d©a
 & 
AR5K_ISR_RXDOPPLER
)

596 *
öãºu±_mask
 |
AR5K_INT_RX_DOPPLER
;

597 i‡(
d©a
 & 
AR5K_ISR_QCBRORN
) {

598 *
öãºu±_mask
 |
AR5K_INT_QCBRORN
;

599 
ah
->
ah_txq_i§
 |
	`AR5K_REG_MS
(

600 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_RAC_SISR3
),

601 
AR5K_SISR3_QCBRORN
);

603 i‡(
d©a
 & 
AR5K_ISR_QCBRURN
) {

604 *
öãºu±_mask
 |
AR5K_INT_QCBRURN
;

605 
ah
->
ah_txq_i§
 |
	`AR5K_REG_MS
(

606 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_RAC_SISR3
),

607 
AR5K_SISR3_QCBRURN
);

609 i‡(
d©a
 & 
AR5K_ISR_QTRIG
) {

610 *
öãºu±_mask
 |
AR5K_INT_QTRIG
;

611 
ah
->
ah_txq_i§
 |
	`AR5K_REG_MS
(

612 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_RAC_SISR4
),

613 
AR5K_SISR4_QTRIG
);

616 i‡(
d©a
 & 
AR5K_ISR_TXOK
)

617 
ah
->
ah_txq_i§
 |
	`AR5K_REG_MS
(

618 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_RAC_SISR0
),

619 
AR5K_SISR0_QCU_TXOK
);

621 i‡(
d©a
 & 
AR5K_ISR_TXDESC
)

622 
ah
->
ah_txq_i§
 |
	`AR5K_REG_MS
(

623 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_RAC_SISR0
),

624 
AR5K_SISR0_QCU_TXDESC
);

626 i‡(
d©a
 & 
AR5K_ISR_TXERR
)

627 
ah
->
ah_txq_i§
 |
	`AR5K_REG_MS
(

628 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_RAC_SISR1
),

629 
AR5K_SISR1_QCU_TXERR
);

631 i‡(
d©a
 & 
AR5K_ISR_TXEOL
)

632 
ah
->
ah_txq_i§
 |
	`AR5K_REG_MS
(

633 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_RAC_SISR1
),

634 
AR5K_SISR1_QCU_TXEOL
);

636 i‡(
d©a
 & 
AR5K_ISR_TXURN
)

637 
ah
->
ah_txq_i§
 |
	`AR5K_REG_MS
(

638 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_RAC_SISR2
),

639 
AR5K_SISR2_QCU_TXURN
);

641 i‡(
	`u∆ikñy
(
d©a
 & (
AR5K_ISR_SSERR
 | 
AR5K_ISR_MCABT


642 | 
AR5K_ISR_HIUERR
 | 
AR5K_ISR_DPERR
)))

643 *
öãºu±_mask
 |
AR5K_INT_FATAL
;

658 i‡(
	`u∆ikñy
(*
öãºu±_mask
 =0 && 
	`√t_øãlimô
()))

659 
	`ATH5K_PRINTF
("ISR: 0x%08x IMR: 0x%08x\n", 
d©a
, 
ah
->
ah_imr
);

662 
	}
}

674 
©h5k_öt
 
	$©h5k_hw_£t_imr
(
©h5k_hw
 *
ah
, 
©h5k_öt
 
√w_mask
)

676 
©h5k_öt
 
ﬁd_mask
, 
öt_mask
;

678 
ﬁd_mask
 = 
ah
->
ah_imr
;

685 i‡(
ﬁd_mask
 & 
AR5K_INT_GLOBAL
) {

686 
	`©h5k_hw_ªg_wrôe
(
ah
, 
AR5K_IER_DISABLE
, 
AR5K_IER
);

687 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_IER
);

694 
öt_mask
 = 
√w_mask
 & 
AR5K_INT_COMMON
;

696 i‡(
ah
->
ah_vîsi⁄
 !
AR5K_AR5210
) {

698 
u32
 
simr2
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_SIMR2
)

699 & 
AR5K_SIMR2_QCU_TXURN
;

701 i‡(
√w_mask
 & 
AR5K_INT_FATAL
) {

702 
öt_mask
 |
AR5K_IMR_HIUERR
;

703 
simr2
 |(
AR5K_SIMR2_MCABT
 | 
AR5K_SIMR2_SSERR


704 | 
AR5K_SIMR2_DPERR
);

708 i‡(
√w_mask
 & 
AR5K_INT_BNR
)

709 
öt_mask
 |
AR5K_INT_BNR
;

711 i‡(
√w_mask
 & 
AR5K_INT_TIM
)

712 
öt_mask
 |
AR5K_IMR_TIM
;

714 i‡(
√w_mask
 & 
AR5K_INT_TIM
)

715 
simr2
 |
AR5K_SISR2_TIM
;

716 i‡(
√w_mask
 & 
AR5K_INT_DTIM
)

717 
simr2
 |
AR5K_SISR2_DTIM
;

718 i‡(
√w_mask
 & 
AR5K_INT_DTIM_SYNC
)

719 
simr2
 |
AR5K_SISR2_DTIM_SYNC
;

720 i‡(
√w_mask
 & 
AR5K_INT_BCN_TIMEOUT
)

721 
simr2
 |
AR5K_SISR2_BCN_TIMEOUT
;

722 i‡(
√w_mask
 & 
AR5K_INT_CAB_TIMEOUT
)

723 
simr2
 |
AR5K_SISR2_CAB_TIMEOUT
;

725 i‡(
√w_mask
 & 
AR5K_INT_RX_DOPPLER
)

726 
öt_mask
 |
AR5K_IMR_RXDOPPLER
;

730 
	`©h5k_hw_ªg_wrôe
(
ah
, 
öt_mask
, 
AR5K_PIMR
);

731 
	`©h5k_hw_ªg_wrôe
(
ah
, 
simr2
, 
AR5K_SIMR2
);

734 i‡(
√w_mask
 & 
AR5K_INT_FATAL
)

735 
öt_mask
 |(
AR5K_IMR_SSERR
 | 
AR5K_IMR_MCABT


736 | 
AR5K_IMR_HIUERR
 | 
AR5K_IMR_DPERR
);

738 
	`©h5k_hw_ªg_wrôe
(
ah
, 
öt_mask
, 
AR5K_IMR
);

743 i‡(!(
√w_mask
 & 
AR5K_INT_RXNOFRM
))

744 
	`©h5k_hw_ªg_wrôe
(
ah
, 0, 
AR5K_RXNOFRM
);

747 
ah
->
ah_imr
 = 
√w_mask
;

750 i‡(
√w_mask
 & 
AR5K_INT_GLOBAL
) {

751 
	`©h5k_hw_ªg_wrôe
(
ah
, 
AR5K_IER_ENABLE
, 
AR5K_IER
);

752 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_IER
);

755  
ﬁd_mask
;

756 
	}
}

774 
	$©h5k_hw_dma_öô
(
©h5k_hw
 *
ah
)

789 i‡(
ah
->
ah_vîsi⁄
 !
AR5K_AR5210
) {

790 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_TXCFG
,

791 
AR5K_TXCFG_SDMAMR
, 
AR5K_DMASIZE_128B
);

792 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_RXCFG
,

793 
AR5K_RXCFG_SDMAMW
, 
AR5K_DMASIZE_128B
);

797 i‡(
ah
->
ah_vîsi⁄
 !
AR5K_AR5210
)

798 
	`©h5k_hw_£t_imr
(
ah
,áh->
ah_imr
);

800 
	}
}

814 
	$©h5k_hw_dma_°›
(
©h5k_hw
 *
ah
)

816 
i
, 
qmax
, 
îr
;

817 
îr
 = 0;

820 
	`©h5k_hw_£t_imr
(
ah
, 0);

823 
îr
 = 
	`©h5k_hw_°›_rx_dma
(
ah
);

824 i‡(
îr
)

825  
îr
;

829 i‡(
ah
->
ah_vîsi⁄
 !
AR5K_AR5210
) {

830 
	`©h5k_hw_ªg_wrôe
(
ah
, 0xffffffff, 
AR5K_PISR
);

831 
qmax
 = 
AR5K_NUM_TX_QUEUES
;

834 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_ISR
);

835 
qmax
 = 
AR5K_NUM_TX_QUEUES_NOQCU
;

838 
i
 = 0; i < 
qmax
; i++) {

839 
îr
 = 
	`©h5k_hw_°›_tx_dma
(
ah
, 
i
);

841 i‡(
îr
 &&Éº !-
EINVAL
)

842  
îr
;

846 
	}
}

	@ath5k/eeprom.c

24 
	~<löux/¶ab.h
>

26 
	~"©h5k.h
"

27 
	~"ªg.h
"

28 
	~"debug.h
"

29 
	~"ba£.h
"

39 
u16
 
	$©h5k_ì¥om_bö2‰eq
(
©h5k_ì¥om_öfo
 *
ì
, 
u16
 
bö
,

40 
mode
)

42 
u16
 
vÆ
;

44 i‡(
bö
 =
AR5K_EEPROM_CHANNEL_DIS
)

45  
bö
;

47 i‡(
mode
 =
AR5K_EEPROM_MODE_11A
) {

48 i‡(
ì
->
ì_vîsi⁄
 > 
AR5K_EEPROM_VERSION_3_2
)

49 
vÆ
 = (5 * 
bö
) + 4800;

51 
vÆ
 = 
bö
 > 62 ? (10 * 62) + (5 * (bin - 62)) + 5100 :

52 (
bö
 * 10) + 5100;

54 i‡(
ì
->
ì_vîsi⁄
 > 
AR5K_EEPROM_VERSION_3_2
)

55 
vÆ
 = 
bö
 + 2300;

57 
vÆ
 = 
bö
 + 2400;

60  
vÆ
;

61 
	}
}

72 
	$©h5k_ì¥om_öô_hódî
(
©h5k_hw
 *
ah
)

74 
©h5k_ì¥om_öfo
 *
ì
 = &
ah
->
ah_ˇ∑bûôõs
.
ˇp_ì¥om
;

75 
u16
 
vÆ
;

76 
u32
 
cksum
, 
off£t
, 
ìp_max
 = 
AR5K_EEPROM_INFO_MAX
;

81 
	`AR5K_EEPROM_READ_HDR
(
AR5K_EEPROM_MAGIC
, 
ì_magic
);

82 
	`AR5K_EEPROM_READ_HDR
(
AR5K_EEPROM_PROTECT
, 
ì_¥Ÿe˘
);

83 
	`AR5K_EEPROM_READ_HDR
(
AR5K_EEPROM_REG_DOMAIN
, 
ì_ªgdomaö
);

84 
	`AR5K_EEPROM_READ_HDR
(
AR5K_EEPROM_VERSION
, 
ì_vîsi⁄
);

85 
	`AR5K_EEPROM_READ_HDR
(
AR5K_EEPROM_HDR
, 
ì_hódî
);

88 i‡(
ah
->
ah_ì_vîsi⁄
 < 
AR5K_EEPROM_VERSION_3_0
)

95 
	`AR5K_EEPROM_READ
(
AR5K_EEPROM_SIZE_UPPER
, 
vÆ
);

96 i‡(
vÆ
) {

97 
ìp_max
 = (
vÆ
 & 
AR5K_EEPROM_SIZE_UPPER_MASK
) <<

98 
AR5K_EEPROM_SIZE_ENDLOC_SHIFT
;

99 
	`AR5K_EEPROM_READ
(
AR5K_EEPROM_SIZE_LOWER
, 
vÆ
);

100 
ìp_max
 = (ìp_max | 
vÆ
Ë- 
AR5K_EEPROM_INFO_BASE
;

107 i‡(
ìp_max
 > (3 * 
AR5K_EEPROM_INFO_MAX
)) {

108 
	`ATH5K_ERR
(
ah
, "Invalid max custom EEPROM size: "

110 
ìp_max
,Éep_max,

111 3 * 
AR5K_EEPROM_INFO_MAX
,

112 3 * 
AR5K_EEPROM_INFO_MAX
);

113  -
EIO
;

117 
cksum
 = 0, 
off£t
 = 0; off£à< 
ìp_max
; offset++) {

118 
	`AR5K_EEPROM_READ
(
	`AR5K_EEPROM_INFO
(
off£t
), 
vÆ
);

119 
cksum
 ^
vÆ
;

121 i‡(
cksum
 !
AR5K_EEPROM_INFO_CKSUM
) {

122 
	`ATH5K_ERR
(
ah
, "Invalid EEPROM "

124 
cksum
, 
ìp_max
,

125 
ìp_max
 =
AR5K_EEPROM_INFO_MAX
 ?

127  -
EIO
;

130 
	`AR5K_EEPROM_READ_HDR
(
	`AR5K_EEPROM_ANT_GAIN
(
ah
->
ah_ì_vîsi⁄
),

131 
ì_™t_gaö
);

133 i‡(
ah
->
ah_ì_vîsi⁄
 >
AR5K_EEPROM_VERSION_4_0
) {

134 
	`AR5K_EEPROM_READ_HDR
(
AR5K_EEPROM_MISC0
, 
ì_misc0
);

135 
	`AR5K_EEPROM_READ_HDR
(
AR5K_EEPROM_MISC1
, 
ì_misc1
);

138 
	`AR5K_EEPROM_READ_HDR
(
AR5K_EEPROM_MISC2
, 
ì_misc2
);

140 i‡(
ì
->
ì_vîsi⁄
 >
AR5K_EEPROM_VERSION_4_3
)

141 
	`AR5K_EEPROM_READ_HDR
(
AR5K_EEPROM_MISC3
, 
ì_misc3
);

143 i‡(
ì
->
ì_vîsi⁄
 >
AR5K_EEPROM_VERSION_5_0
) {

144 
	`AR5K_EEPROM_READ_HDR
(
AR5K_EEPROM_MISC4
, 
ì_misc4
);

145 
	`AR5K_EEPROM_READ_HDR
(
AR5K_EEPROM_MISC5
, 
ì_misc5
);

146 
	`AR5K_EEPROM_READ_HDR
(
AR5K_EEPROM_MISC6
, 
ì_misc6
);

150 i‡(
ah
->
ah_ì_vîsi⁄
 < 
AR5K_EEPROM_VERSION_3_3
) {

151 
	`AR5K_EEPROM_READ
(
AR5K_EEPROM_OBDB0_2GHZ
, 
vÆ
);

152 
ì
->
ì_ob
[
AR5K_EEPROM_MODE_11B
][0] = 
vÆ
 & 0x7;

153 
ì
->
ì_db
[
AR5K_EEPROM_MODE_11B
][0] = (
vÆ
 >> 3) & 0x7;

155 
	`AR5K_EEPROM_READ
(
AR5K_EEPROM_OBDB1_2GHZ
, 
vÆ
);

156 
ì
->
ì_ob
[
AR5K_EEPROM_MODE_11G
][0] = 
vÆ
 & 0x7;

157 
ì
->
ì_db
[
AR5K_EEPROM_MODE_11G
][0] = (
vÆ
 >> 3) & 0x7;

160 
	`AR5K_EEPROM_READ
(
AR5K_EEPROM_IS_HB63
, 
vÆ
);

162 i‡((
ah
->
ah_mac_vîsi⁄
 =(
AR5K_SREV_AR2425
 >> 4)Ë&& 
vÆ
)

163 
ì
->
ì_is_hb63
 = 
åue
;

165 
ì
->
ì_is_hb63
 = 
Ál£
;

167 
	`AR5K_EEPROM_READ
(
AR5K_EEPROM_RFKILL
, 
vÆ
);

168 
ì
->
ì_rfkûl_pö
 = (
u8
Ë
	`AR5K_REG_MS
(
vÆ
, 
AR5K_EEPROM_RFKILL_GPIO_SEL
);

169 
ì
->
ì_rfkûl_pﬁ
 = 
vÆ
 & 
AR5K_EEPROM_RFKILL_POLARITY
 ? 
åue
 : 
Ál£
;

177 
	`AR5K_EEPROM_READ
(
AR5K_EEPROM_PCIE_OFFSET
, 
vÆ
);

178 
ì
->
ì_£rdes
 = (
vÆ
 =
AR5K_EEPROM_PCIE_SERDES_SECTION
) ?

179 
åue
 : 
Ál£
;

182 
	}
}

188 
	$©h5k_ì¥om_ªad_™ts
(
©h5k_hw
 *
ah
, 
u32
 *
off£t
,

189 
mode
)

191 
©h5k_ì¥om_öfo
 *
ì
 = &
ah
->
ah_ˇ∑bûôõs
.
ˇp_ì¥om
;

192 
u32
 
o
 = *
off£t
;

193 
u16
 
vÆ
;

194 
i
 = 0;

196 
	`AR5K_EEPROM_READ
(
o
++, 
vÆ
);

197 
ì
->
ì_swôch_£âlög
[
mode
] = (
vÆ
 >> 8) & 0x7f;

198 
ì
->
ì_©n_tx_rx
[
mode
] = (
vÆ
 >> 2) & 0x3f;

199 
ì
->
ì_™t_c⁄åﬁ
[
mode
][
i
] = (
vÆ
 << 4) & 0x3f;

201 
	`AR5K_EEPROM_READ
(
o
++, 
vÆ
);

202 
ì
->
ì_™t_c⁄åﬁ
[
mode
][
i
++] |(
vÆ
 >> 12) & 0xf;

203 
ì
->
ì_™t_c⁄åﬁ
[
mode
][
i
++] = (
vÆ
 >> 6) & 0x3f;

204 
ì
->
ì_™t_c⁄åﬁ
[
mode
][
i
++] = 
vÆ
 & 0x3f;

206 
	`AR5K_EEPROM_READ
(
o
++, 
vÆ
);

207 
ì
->
ì_™t_c⁄åﬁ
[
mode
][
i
++] = (
vÆ
 >> 10) & 0x3f;

208 
ì
->
ì_™t_c⁄åﬁ
[
mode
][
i
++] = (
vÆ
 >> 4) & 0x3f;

209 
ì
->
ì_™t_c⁄åﬁ
[
mode
][
i
] = (
vÆ
 << 2) & 0x3f;

211 
	`AR5K_EEPROM_READ
(
o
++, 
vÆ
);

212 
ì
->
ì_™t_c⁄åﬁ
[
mode
][
i
++] |(
vÆ
 >> 14) & 0x3;

213 
ì
->
ì_™t_c⁄åﬁ
[
mode
][
i
++] = (
vÆ
 >> 8) & 0x3f;

214 
ì
->
ì_™t_c⁄åﬁ
[
mode
][
i
++] = (
vÆ
 >> 2) & 0x3f;

215 
ì
->
ì_™t_c⁄åﬁ
[
mode
][
i
] = (
vÆ
 << 4) & 0x3f;

217 
	`AR5K_EEPROM_READ
(
o
++, 
vÆ
);

218 
ì
->
ì_™t_c⁄åﬁ
[
mode
][
i
++] |(
vÆ
 >> 12) & 0xf;

219 
ì
->
ì_™t_c⁄åﬁ
[
mode
][
i
++] = (
vÆ
 >> 6) & 0x3f;

220 
ì
->
ì_™t_c⁄åﬁ
[
mode
][
i
++] = 
vÆ
 & 0x3f;

223 
ah
->
ah_™t_˘l
[
mode
][
AR5K_ANT_CTL
] =

224 (
ì
->
ì_™t_c⁄åﬁ
[
mode
][0] << 4);

225 
ah
->
ah_™t_˘l
[
mode
][
AR5K_ANT_SWTABLE_A
] =

226 
ì
->
ì_™t_c⁄åﬁ
[
mode
][1] |

227 (
ì
->
ì_™t_c⁄åﬁ
[
mode
][2] << 6) |

228 (
ì
->
ì_™t_c⁄åﬁ
[
mode
][3] << 12) |

229 (
ì
->
ì_™t_c⁄åﬁ
[
mode
][4] << 18) |

230 (
ì
->
ì_™t_c⁄åﬁ
[
mode
][5] << 24);

231 
ah
->
ah_™t_˘l
[
mode
][
AR5K_ANT_SWTABLE_B
] =

232 
ì
->
ì_™t_c⁄åﬁ
[
mode
][6] |

233 (
ì
->
ì_™t_c⁄åﬁ
[
mode
][7] << 6) |

234 (
ì
->
ì_™t_c⁄åﬁ
[
mode
][8] << 12) |

235 (
ì
->
ì_™t_c⁄åﬁ
[
mode
][9] << 18) |

236 (
ì
->
ì_™t_c⁄åﬁ
[
mode
][10] << 24);

239 *
off£t
 = 
o
;

242 
	}
}

248 
	$©h5k_ì¥om_ªad_modes
(
©h5k_hw
 *
ah
, 
u32
 *
off£t
,

249 
mode
)

251 
©h5k_ì¥om_öfo
 *
ì
 = &
ah
->
ah_ˇ∑bûôõs
.
ˇp_ì¥om
;

252 
u32
 
o
 = *
off£t
;

253 
u16
 
vÆ
;

255 
ì
->
ì_n_põrs
[
mode
] = 0;

256 
	`AR5K_EEPROM_READ
(
o
++, 
vÆ
);

257 
ì
->
ì_adc_desúed_size
[
mode
] = (
s8
)((
vÆ
 >> 8) & 0xff);

258 
mode
) {

259 
AR5K_EEPROM_MODE_11A
:

260 
ì
->
ì_ob
[
mode
][3] = (
vÆ
 >> 5) & 0x7;

261 
ì
->
ì_db
[
mode
][3] = (
vÆ
 >> 2) & 0x7;

262 
ì
->
ì_ob
[
mode
][2] = (
vÆ
 << 1) & 0x7;

264 
	`AR5K_EEPROM_READ
(
o
++, 
vÆ
);

265 
ì
->
ì_ob
[
mode
][2] |(
vÆ
 >> 15) & 0x1;

266 
ì
->
ì_db
[
mode
][2] = (
vÆ
 >> 12) & 0x7;

267 
ì
->
ì_ob
[
mode
][1] = (
vÆ
 >> 9) & 0x7;

268 
ì
->
ì_db
[
mode
][1] = (
vÆ
 >> 6) & 0x7;

269 
ì
->
ì_ob
[
mode
][0] = (
vÆ
 >> 3) & 0x7;

270 
ì
->
ì_db
[
mode
][0] = 
vÆ
 & 0x7;

272 
AR5K_EEPROM_MODE_11G
:

273 
AR5K_EEPROM_MODE_11B
:

274 
ì
->
ì_ob
[
mode
][1] = (
vÆ
 >> 4) & 0x7;

275 
ì
->
ì_db
[
mode
][1] = 
vÆ
 & 0x7;

279 
	`AR5K_EEPROM_READ
(
o
++, 
vÆ
);

280 
ì
->
ì_tx_íd2x a_íabÀ
[
mode
] = (
vÆ
 >> 8) & 0xff;

281 
ì
->
ì_thr_62
[
mode
] = 
vÆ
 & 0xff;

283 i‡(
ah
->
ah_ì_vîsi⁄
 <
AR5K_EEPROM_VERSION_3_2
)

284 
ì
->
ì_thr_62
[
mode
] = modê=
AR5K_EEPROM_MODE_11A
 ? 15 : 28;

286 
	`AR5K_EEPROM_READ
(
o
++, 
vÆ
);

287 
ì
->
ì_tx_íd2x∑_dißbÀ
[
mode
] = (
vÆ
 >> 8) & 0xff;

288 
ì
->
ì_tx_‰m2x∑_íabÀ
[
mode
] = 
vÆ
 & 0xff;

290 
	`AR5K_EEPROM_READ
(
o
++, 
vÆ
);

291 
ì
->
ì_pga_desúed_size
[
mode
] = (
vÆ
 >> 8) & 0xff;

293 i‡((
vÆ
 & 0xff) & 0x80)

294 
ì
->
ì_noi£_Êo‹_thr
[
mode
] = -((((
vÆ
 & 0xff) ^ 0xff)) + 1);

296 
ì
->
ì_noi£_Êo‹_thr
[
mode
] = 
vÆ
 & 0xff;

298 i‡(
ah
->
ah_ì_vîsi⁄
 <
AR5K_EEPROM_VERSION_3_2
)

299 
ì
->
ì_noi£_Êo‹_thr
[
mode
] =

300 
mode
 =
AR5K_EEPROM_MODE_11A
 ? -54 : -1;

302 
	`AR5K_EEPROM_READ
(
o
++, 
vÆ
);

303 
ì
->
ì_x a_gaö
[
mode
] = (
vÆ
 >> 5) & 0xff;

304 
ì
->
ì_x_gaö
[
mode
] = (
vÆ
 >> 1) & 0xf;

305 
ì
->
ì_xpd
[
mode
] = 
vÆ
 & 0x1;

307 i‡(
ah
->
ah_ì_vîsi⁄
 >
AR5K_EEPROM_VERSION_4_0
 &&

308 
mode
 !
AR5K_EEPROM_MODE_11B
)

309 
ì
->
ì_fixed_büs
[
mode
] = (
vÆ
 >> 13) & 0x1;

311 i‡(
ah
->
ah_ì_vîsi⁄
 >
AR5K_EEPROM_VERSION_3_3
) {

312 
	`AR5K_EEPROM_READ
(
o
++, 
vÆ
);

313 
ì
->
ì_Ál£_dëe˘
[
mode
] = (
vÆ
 >> 6) & 0x7f;

315 i‡(
mode
 =
AR5K_EEPROM_MODE_11A
)

316 
ì
->
ì_xr_powî
[
mode
] = 
vÆ
 & 0x3f;

319 
ì
->
ì_ob
[
mode
][0] = 
vÆ
 & 0x7;

320 
ì
->
ì_db
[
mode
][0] = (
vÆ
 >> 3) & 0x7;

324 i‡(
ah
->
ah_ì_vîsi⁄
 < 
AR5K_EEPROM_VERSION_3_4
) {

325 
ì
->
ì_i_gaö
[
mode
] = 
AR5K_EEPROM_I_GAIN
;

326 
ì
->
ì_cck_ofdm_powî_dñè
 = 
AR5K_EEPROM_CCK_OFDM_DELTA
;

328 
ì
->
ì_i_gaö
[
mode
] = (
vÆ
 >> 13) & 0x7;

330 
	`AR5K_EEPROM_READ
(
o
++, 
vÆ
);

331 
ì
->
ì_i_gaö
[
mode
] |(
vÆ
 << 3) & 0x38;

333 i‡(
mode
 =
AR5K_EEPROM_MODE_11G
) {

334 
ì
->
ì_cck_ofdm_powî_dñè
 = (
vÆ
 >> 3) & 0xff;

335 i‡(
ah
->
ah_ì_vîsi⁄
 >
AR5K_EEPROM_VERSION_4_6
)

336 
ì
->
ì_sˇÀd_cck_dñè
 = (
vÆ
 >> 11) & 0x1f;

340 i‡(
ah
->
ah_ì_vîsi⁄
 >
AR5K_EEPROM_VERSION_4_0
 &&

341 
mode
 =
AR5K_EEPROM_MODE_11A
) {

342 
ì
->
ì_i_ˇl
[
mode
] = (
vÆ
 >> 8) & 0x3f;

343 
ì
->
ì_q_ˇl
[
mode
] = (
vÆ
 >> 3) & 0x1f;

346 i‡(
ah
->
ah_ì_vîsi⁄
 < 
AR5K_EEPROM_VERSION_4_0
)

347 
d⁄e
;

352 
mode
) {

353 
AR5K_EEPROM_MODE_11A
:

354 i‡(
ah
->
ah_ì_vîsi⁄
 < 
AR5K_EEPROM_VERSION_4_1
)

357 
	`AR5K_EEPROM_READ
(
o
++, 
vÆ
);

358 
ì
->
ì_m¨gö_tx_rx
[
mode
] = 
vÆ
 & 0x3f;

360 
AR5K_EEPROM_MODE_11B
:

361 
	`AR5K_EEPROM_READ
(
o
++, 
vÆ
);

363 
ì
->
ì_pwr_ˇl_b
[0].
‰eq
 =

364 
	`©h5k_ì¥om_bö2‰eq
(
ì
, 
vÆ
 & 0xff, 
mode
);

365 i‡(
ì
->
ì_pwr_ˇl_b
[0].
‰eq
 !
AR5K_EEPROM_CHANNEL_DIS
)

366 
ì
->
ì_n_põrs
[
mode
]++;

368 
ì
->
ì_pwr_ˇl_b
[1].
‰eq
 =

369 
	`©h5k_ì¥om_bö2‰eq
(
ì
, (
vÆ
 >> 8Ë& 0xff, 
mode
);

370 i‡(
ì
->
ì_pwr_ˇl_b
[1].
‰eq
 !
AR5K_EEPROM_CHANNEL_DIS
)

371 
ì
->
ì_n_põrs
[
mode
]++;

373 
	`AR5K_EEPROM_READ
(
o
++, 
vÆ
);

374 
ì
->
ì_pwr_ˇl_b
[2].
‰eq
 =

375 
	`©h5k_ì¥om_bö2‰eq
(
ì
, 
vÆ
 & 0xff, 
mode
);

376 i‡(
ì
->
ì_pwr_ˇl_b
[2].
‰eq
 !
AR5K_EEPROM_CHANNEL_DIS
)

377 
ì
->
ì_n_põrs
[
mode
]++;

379 i‡(
ah
->
ah_ì_vîsi⁄
 >
AR5K_EEPROM_VERSION_4_1
)

380 
ì
->
ì_m¨gö_tx_rx
[
mode
] = (
vÆ
 >> 8) & 0x3f;

382 
AR5K_EEPROM_MODE_11G
:

383 
	`AR5K_EEPROM_READ
(
o
++, 
vÆ
);

385 
ì
->
ì_pwr_ˇl_g
[0].
‰eq
 =

386 
	`©h5k_ì¥om_bö2‰eq
(
ì
, 
vÆ
 & 0xff, 
mode
);

387 i‡(
ì
->
ì_pwr_ˇl_g
[0].
‰eq
 !
AR5K_EEPROM_CHANNEL_DIS
)

388 
ì
->
ì_n_põrs
[
mode
]++;

390 
ì
->
ì_pwr_ˇl_g
[1].
‰eq
 =

391 
	`©h5k_ì¥om_bö2‰eq
(
ì
, (
vÆ
 >> 8Ë& 0xff, 
mode
);

392 i‡(
ì
->
ì_pwr_ˇl_g
[1].
‰eq
 !
AR5K_EEPROM_CHANNEL_DIS
)

393 
ì
->
ì_n_põrs
[
mode
]++;

395 
	`AR5K_EEPROM_READ
(
o
++, 
vÆ
);

396 
ì
->
ì_turbo_max_powî
[
mode
] = 
vÆ
 & 0x7f;

397 
ì
->
ì_xr_powî
[
mode
] = (
vÆ
 >> 7) & 0x3f;

399 
	`AR5K_EEPROM_READ
(
o
++, 
vÆ
);

400 
ì
->
ì_pwr_ˇl_g
[2].
‰eq
 =

401 
	`©h5k_ì¥om_bö2‰eq
(
ì
, 
vÆ
 & 0xff, 
mode
);

402 i‡(
ì
->
ì_pwr_ˇl_g
[2].
‰eq
 !
AR5K_EEPROM_CHANNEL_DIS
)

403 
ì
->
ì_n_põrs
[
mode
]++;

405 i‡(
ah
->
ah_ì_vîsi⁄
 >
AR5K_EEPROM_VERSION_4_1
)

406 
ì
->
ì_m¨gö_tx_rx
[
mode
] = (
vÆ
 >> 8) & 0x3f;

408 
	`AR5K_EEPROM_READ
(
o
++, 
vÆ
);

409 
ì
->
ì_i_ˇl
[
mode
] = (
vÆ
 >> 5) & 0x3f;

410 
ì
->
ì_q_ˇl
[
mode
] = 
vÆ
 & 0x1f;

412 i‡(
ah
->
ah_ì_vîsi⁄
 >
AR5K_EEPROM_VERSION_4_2
) {

413 
	`AR5K_EEPROM_READ
(
o
++, 
vÆ
);

414 
ì
->
ì_cck_ofdm_gaö_dñè
 = 
vÆ
 & 0xff;

422 i‡(
ì
->
ì_vîsi⁄
 < 
AR5K_EEPROM_VERSION_5_0
)

423 
d⁄e
;

425 
mode
) {

426 
AR5K_EEPROM_MODE_11A
:

427 
ì
->
ì_swôch_£âlög_turbo
[
mode
] = (
vÆ
 >> 6) & 0x7f;

429 
ì
->
ì_©n_tx_rx_turbo
[
mode
] = (
vÆ
 >> 13) & 0x7;

430 
	`AR5K_EEPROM_READ
(
o
++, 
vÆ
);

431 
ì
->
ì_©n_tx_rx_turbo
[
mode
] |(
vÆ
 & 0x7) << 3;

432 
ì
->
ì_m¨gö_tx_rx_turbo
[
mode
] = (
vÆ
 >> 3) & 0x3f;

434 
ì
->
ì_adc_desúed_size_turbo
[
mode
] = (
vÆ
 >> 9) & 0x7f;

435 
	`AR5K_EEPROM_READ
(
o
++, 
vÆ
);

436 
ì
->
ì_adc_desúed_size_turbo
[
mode
] |(
vÆ
 & 0x1) << 7;

437 
ì
->
ì_pga_desúed_size_turbo
[
mode
] = (
vÆ
 >> 1) & 0xff;

439 i‡(
	`AR5K_EEPROM_EEMAP
(
ì
->
ì_misc0
) >= 2)

440 
ì
->
ì_pd_gaö_ovîœp
 = (
vÆ
 >> 9) & 0xf;

442 
AR5K_EEPROM_MODE_11G
:

443 
ì
->
ì_swôch_£âlög_turbo
[
mode
] = (
vÆ
 >> 8) & 0x7f;

445 
ì
->
ì_©n_tx_rx_turbo
[
mode
] = (
vÆ
 >> 15) & 0x7;

446 
	`AR5K_EEPROM_READ
(
o
++, 
vÆ
);

447 
ì
->
ì_©n_tx_rx_turbo
[
mode
] |(
vÆ
 & 0x1f) << 1;

448 
ì
->
ì_m¨gö_tx_rx_turbo
[
mode
] = (
vÆ
 >> 5) & 0x3f;

450 
ì
->
ì_adc_desúed_size_turbo
[
mode
] = (
vÆ
 >> 11) & 0x7f;

451 
	`AR5K_EEPROM_READ
(
o
++, 
vÆ
);

452 
ì
->
ì_adc_desúed_size_turbo
[
mode
] |(
vÆ
 & 0x7) << 5;

453 
ì
->
ì_pga_desúed_size_turbo
[
mode
] = (
vÆ
 >> 3) & 0xff;

457 
d⁄e
:

459 *
off£t
 = 
o
;

462 
	}
}

466 
	$©h5k_ì¥om_öô_modes
(
©h5k_hw
 *
ah
)

468 
©h5k_ì¥om_öfo
 *
ì
 = &
ah
->
ah_ˇ∑bûôõs
.
ˇp_ì¥om
;

469 
u32
 
mode_off£t
[3];

470 
mode
;

471 
u32
 
off£t
;

472 
ªt
;

477 
mode_off£t
[
AR5K_EEPROM_MODE_11A
] = 
	`AR5K_EEPROM_MODES_11A
(
ah
->
ah_ì_vîsi⁄
);

478 
mode_off£t
[
AR5K_EEPROM_MODE_11B
] = 
	`AR5K_EEPROM_MODES_11B
(
ah
->
ah_ì_vîsi⁄
);

479 
mode_off£t
[
AR5K_EEPROM_MODE_11G
] = 
	`AR5K_EEPROM_MODES_11G
(
ah
->
ah_ì_vîsi⁄
);

481 
ì
->
ì_turbo_max_powî
[
AR5K_EEPROM_MODE_11A
] =

482 
	`AR5K_EEPROM_HDR_T_5GHZ_DBM
(
ì
->
ì_hódî
);

484 
mode
 = 
AR5K_EEPROM_MODE_11A
; modê<
AR5K_EEPROM_MODE_11G
; mode++) {

485 
off£t
 = 
mode_off£t
[
mode
];

487 
ªt
 = 
	`©h5k_ì¥om_ªad_™ts
(
ah
, &
off£t
, 
mode
);

488 i‡(
ªt
)

489  
ªt
;

491 
ªt
 = 
	`©h5k_ì¥om_ªad_modes
(
ah
, &
off£t
, 
mode
);

492 i‡(
ªt
)

493  
ªt
;

497 i‡(
ah
->
ah_ì_vîsi⁄
 <
AR5K_EEPROM_VERSION_3_2
) {

498 
ì
->
ì_thr_62
[
AR5K_EEPROM_MODE_11A
] = 15;

499 
ì
->
ì_thr_62
[
AR5K_EEPROM_MODE_11B
] = 28;

500 
ì
->
ì_thr_62
[
AR5K_EEPROM_MODE_11G
] = 28;

504 
	}
}

508 
ölöe
 

509 
	$©h5k_ì¥om_ªad_‰eq_li°
(
©h5k_hw
 *
ah
, *
off£t
, 
max
,

510 
©h5k_ch™_pˇl_öfo
 *
pc
, 
mode
)

512 
©h5k_ì¥om_öfo
 *
ì
 = &
ah
->
ah_ˇ∑bûôõs
.
ˇp_ì¥om
;

513 
o
 = *
off£t
;

514 
i
 = 0;

515 
u8
 
‰eq1
, 
‰eq2
;

516 
u16
 
vÆ
;

518 
ì
->
ì_n_põrs
[
mode
] = 0;

519 
i
 < 
max
) {

520 
	`AR5K_EEPROM_READ
(
o
++, 
vÆ
);

522 
‰eq1
 = 
vÆ
 & 0xff;

523 i‡(!
‰eq1
)

526 
pc
[
i
++].
‰eq
 = 
	`©h5k_ì¥om_bö2‰eq
(
ì
,

527 
‰eq1
, 
mode
);

528 
ì
->
ì_n_põrs
[
mode
]++;

530 
‰eq2
 = (
vÆ
 >> 8) & 0xff;

531 i‡(!
‰eq2
)

534 
pc
[
i
++].
‰eq
 = 
	`©h5k_ì¥om_bö2‰eq
(
ì
,

535 
‰eq2
, 
mode
);

536 
ì
->
ì_n_põrs
[
mode
]++;

540 *
off£t
 = 
o
;

543 
	}
}

547 
	$©h5k_ì¥om_öô_11a_pˇl_‰eq
(
©h5k_hw
 *
ah
, 
off£t
)

549 
©h5k_ì¥om_öfo
 *
ì
 = &
ah
->
ah_ˇ∑bûôõs
.
ˇp_ì¥om
;

550 
©h5k_ch™_pˇl_öfo
 *
pˇl
 = 
ì
->
ì_pwr_ˇl_a
;

551 
i
;

552 
u16
 
vÆ
;

553 
u8
 
mask
;

555 i‡(
ì
->
ì_vîsi⁄
 >
AR5K_EEPROM_VERSION_3_3
) {

556 
	`©h5k_ì¥om_ªad_‰eq_li°
(
ah
, &
off£t
,

557 
AR5K_EEPROM_N_5GHZ_CHAN
, 
pˇl
,

558 
AR5K_EEPROM_MODE_11A
);

560 
mask
 = 
	`AR5K_EEPROM_FREQ_M
(
ah
->
ah_ì_vîsi⁄
);

562 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

563 
pˇl
[0].
‰eq
 = (
vÆ
 >> 9Ë& 
mask
;

564 
pˇl
[1].
‰eq
 = (
vÆ
 >> 2Ë& 
mask
;

565 
pˇl
[2].
‰eq
 = (
vÆ
 << 5Ë& 
mask
;

567 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

568 
pˇl
[2].
‰eq
 |(
vÆ
 >> 11) & 0x1f;

569 
pˇl
[3].
‰eq
 = (
vÆ
 >> 4Ë& 
mask
;

570 
pˇl
[4].
‰eq
 = (
vÆ
 << 3Ë& 
mask
;

572 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

573 
pˇl
[4].
‰eq
 |(
vÆ
 >> 13) & 0x7;

574 
pˇl
[5].
‰eq
 = (
vÆ
 >> 6Ë& 
mask
;

575 
pˇl
[6].
‰eq
 = (
vÆ
 << 1Ë& 
mask
;

577 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

578 
pˇl
[6].
‰eq
 |(
vÆ
 >> 15) & 0x1;

579 
pˇl
[7].
‰eq
 = (
vÆ
 >> 8Ë& 
mask
;

580 
pˇl
[8].
‰eq
 = (
vÆ
 >> 1Ë& 
mask
;

581 
pˇl
[9].
‰eq
 = (
vÆ
 << 6Ë& 
mask
;

583 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

584 
pˇl
[9].
‰eq
 |(
vÆ
 >> 10) & 0x3f;

587 
ì
->
ì_n_põrs
[
AR5K_EEPROM_MODE_11A
] = 10;

589 
i
 = 0; i < 
AR5K_EEPROM_N_5GHZ_CHAN
; i++) {

590 
pˇl
[
i
].
‰eq
 = 
	`©h5k_ì¥om_bö2‰eq
(
ì
,

591 
pˇl
[
i
].
‰eq
, 
AR5K_EEPROM_MODE_11A
);

596 
	}
}

599 
ölöe
 

600 
	$©h5k_ì¥om_öô_11bg_2413
(
©h5k_hw
 *
ah
, 
mode
, 
off£t
)

602 
©h5k_ì¥om_öfo
 *
ì
 = &
ah
->
ah_ˇ∑bûôõs
.
ˇp_ì¥om
;

603 
©h5k_ch™_pˇl_öfo
 *
pˇl
;

605 
mode
) {

606 
AR5K_EEPROM_MODE_11B
:

607 
pˇl
 = 
ì
->
ì_pwr_ˇl_b
;

609 
AR5K_EEPROM_MODE_11G
:

610 
pˇl
 = 
ì
->
ì_pwr_ˇl_g
;

613  -
EINVAL
;

616 
	`©h5k_ì¥om_ªad_‰eq_li°
(
ah
, &
off£t
,

617 
AR5K_EEPROM_N_2GHZ_CHAN_2413
, 
pˇl
,

618 
mode
);

621 
	}
}

644 
ölöe
 

645 
	$©h5k_gë_pcdac_öãr˚±s
(
©h5k_hw
 *
ah
, 
u8
 
mö
, u8 
max
, u8 *
vp
)

647 c⁄° 
u16
 
öãr˚±s3
[] = {

650 c⁄° 
u16
 
öãr˚±s3_2
[] = {

653 c⁄° 
u16
 *
ù
;

654 
i
;

656 i‡(
ah
->
ah_ì_vîsi⁄
 >
AR5K_EEPROM_VERSION_3_2
)

657 
ù
 = 
öãr˚±s3_2
;

659 
ù
 = 
öãr˚±s3
;

661 
i
 = 0; i < 
	`ARRAY_SIZE
(
öãr˚±s3
); i++)

662 
vp
[
i
] = (
ù
[i] * 
max
 + (100 - ip[i]Ë* 
mö
) / 100;

663 
	}
}

666 
	$©h5k_ì¥om_‰ì_pˇl_öfo
(
©h5k_hw
 *
ah
, 
mode
)

668 
©h5k_ì¥om_öfo
 *
ì
 = &
ah
->
ah_ˇ∑bûôõs
.
ˇp_ì¥om
;

669 
©h5k_ch™_pˇl_öfo
 *
chöfo
;

670 
u8
 
põr
, 
pdg
;

672 
mode
) {

673 
AR5K_EEPROM_MODE_11A
:

674 i‡(!
	`AR5K_EEPROM_HDR_11A
(
ì
->
ì_hódî
))

676 
chöfo
 = 
ì
->
ì_pwr_ˇl_a
;

678 
AR5K_EEPROM_MODE_11B
:

679 i‡(!
	`AR5K_EEPROM_HDR_11B
(
ì
->
ì_hódî
))

681 
chöfo
 = 
ì
->
ì_pwr_ˇl_b
;

683 
AR5K_EEPROM_MODE_11G
:

684 i‡(!
	`AR5K_EEPROM_HDR_11G
(
ì
->
ì_hódî
))

686 
chöfo
 = 
ì
->
ì_pwr_ˇl_g
;

689  -
EINVAL
;

692 
põr
 = 0;Öõ∏< 
ì
->
ì_n_põrs
[
mode
];Öier++) {

693 i‡(!
chöfo
[
põr
].
pd_curves
)

696 
pdg
 = 0;Ödg < 
AR5K_EEPROM_N_PD_CURVES
;Ödg++) {

697 
©h5k_pdgaö_öfo
 *
pd
 =

698 &
chöfo
[
põr
].
pd_curves
[
pdg
];

700 
	`k‰ì
(
pd
->
pd_°ï
);

701 
	`k‰ì
(
pd
->
pd_pwr
);

704 
	`k‰ì
(
chöfo
[
põr
].
pd_curves
);

708 
	}
}

713 
	$©h5k_ì¥om_c⁄vît_pˇl_öfo_5111
(
©h5k_hw
 *
ah
, 
mode
,

714 
©h5k_ch™_pˇl_öfo
 *
chöfo
)

716 
©h5k_ì¥om_öfo
 *
ì
 = &
ah
->
ah_ˇ∑bûôõs
.
ˇp_ì¥om
;

717 
©h5k_ch™_pˇl_öfo_rf5111
 *
pcöfo
;

718 
©h5k_pdgaö_öfo
 *
pd
;

719 
u8
 
põr
, 
poöt
, 
idx
;

720 
u8
 *
pdgaö_idx
 = 
ì
->
ì_pdc_to_idx
[
mode
];

723 
põr
 = 0;Öõ∏< 
ì
->
ì_n_põrs
[
mode
];Öier++) {

725 
pcöfo
 = &
chöfo
[
põr
].
rf5111_öfo
;

728 
chöfo
[
põr
].
pd_curves
 =

729 
	`kˇŒoc
(
AR5K_EEPROM_N_PD_CURVES
,

730 (
©h5k_pdgaö_öfo
),

731 
GFP_KERNEL
);

733 i‡(!
chöfo
[
põr
].
pd_curves
)

734 
îr_out
;

740 
idx
 = 0; idx < 
AR5K_EEPROM_N_PD_CURVES
; idx++) {

742 i‡(!((
ì
->
ì_x_gaö
[
mode
] >> 
idx
) & 0x1)) {

743 
pdgaö_idx
[0] = 
idx
;

748 
ì
->
ì_pd_gaös
[
mode
] = 1;

750 
pd
 = &
chöfo
[
põr
].
pd_curves
[
idx
];

752 
pd
->
pd_poöts
 = 
AR5K_EEPROM_N_PWR_POINTS_5111
;

755 
pd
->
pd_°ï
 = 
	`kˇŒoc
(
AR5K_EEPROM_N_PWR_POINTS_5111
,

756 (
u8
), 
GFP_KERNEL
);

757 i‡(!
pd
->
pd_°ï
)

758 
îr_out
;

760 
pd
->
pd_pwr
 = 
	`kˇŒoc
(
AR5K_EEPROM_N_PWR_POINTS_5111
,

761 (
s16
), 
GFP_KERNEL
);

762 i‡(!
pd
->
pd_pwr
)

763 
îr_out
;

768 
poöt
 = 0;Öoöà< 
pd
->
pd_poöts
;Öoint++) {

771 
pd
->
pd_pwr
[
poöt
] = 2 * 
pcöfo
->
pwr
[point];

774 
pd
->
pd_°ï
[
poöt
] = 
pcöfo
->
pcdac
[point];

778 
chöfo
[
põr
].
mö_pwr
 = 
pd
->
pd_pwr
[0];

779 
chöfo
[
põr
].
max_pwr
 = 
pd
->
pd_pwr
[10];

785 
îr_out
:

786 
	`©h5k_ì¥om_‰ì_pˇl_öfo
(
ah
, 
mode
);

787  -
ENOMEM
;

788 
	}
}

792 
	$©h5k_ì¥om_ªad_pˇl_öfo_5111
(
©h5k_hw
 *
ah
, 
mode
)

794 
©h5k_ì¥om_öfo
 *
ì
 = &
ah
->
ah_ˇ∑bûôõs
.
ˇp_ì¥om
;

795 
©h5k_ch™_pˇl_öfo
 *
pˇl
;

796 
off£t
, 
ªt
;

797 
i
;

798 
u16
 
vÆ
;

800 
off£t
 = 
	`AR5K_EEPROM_GROUPS_START
(
ì
->
ì_vîsi⁄
);

801 
mode
) {

802 
AR5K_EEPROM_MODE_11A
:

803 i‡(!
	`AR5K_EEPROM_HDR_11A
(
ì
->
ì_hódî
))

806 
ªt
 = 
	`©h5k_ì¥om_öô_11a_pˇl_‰eq
(
ah
,

807 
off£t
 + 
AR5K_EEPROM_GROUP1_OFFSET
);

808 i‡(
ªt
 < 0)

809  
ªt
;

811 
off£t
 +
AR5K_EEPROM_GROUP2_OFFSET
;

812 
pˇl
 = 
ì
->
ì_pwr_ˇl_a
;

814 
AR5K_EEPROM_MODE_11B
:

815 i‡(!
	`AR5K_EEPROM_HDR_11B
(
ì
->
ì_hódî
) &&

816 !
	`AR5K_EEPROM_HDR_11G
(
ì
->
ì_hódî
))

819 
pˇl
 = 
ì
->
ì_pwr_ˇl_b
;

820 
off£t
 +
AR5K_EEPROM_GROUP3_OFFSET
;

823 
pˇl
[0].
‰eq
 = 2412;

824 
pˇl
[1].
‰eq
 = 2447;

825 
pˇl
[2].
‰eq
 = 2484;

826 
ì
->
ì_n_põrs
[
mode
] = 3;

828 
AR5K_EEPROM_MODE_11G
:

829 i‡(!
	`AR5K_EEPROM_HDR_11G
(
ì
->
ì_hódî
))

832 
pˇl
 = 
ì
->
ì_pwr_ˇl_g
;

833 
off£t
 +
AR5K_EEPROM_GROUP4_OFFSET
;

836 
pˇl
[0].
‰eq
 = 2312;

837 
pˇl
[1].
‰eq
 = 2412;

838 
pˇl
[2].
‰eq
 = 2484;

839 
ì
->
ì_n_põrs
[
mode
] = 3;

842  -
EINVAL
;

845 
i
 = 0; i < 
ì
->
ì_n_põrs
[
mode
]; i++) {

846 
©h5k_ch™_pˇl_öfo_rf5111
 *
cd©a
 =

847 &
pˇl
[
i
].
rf5111_öfo
;

849 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

850 
cd©a
->
pcdac_max
 = ((
vÆ
 >> 10Ë& 
AR5K_EEPROM_PCDAC_M
);

851 
cd©a
->
pcdac_mö
 = ((
vÆ
 >> 4Ë& 
AR5K_EEPROM_PCDAC_M
);

852 
cd©a
->
pwr
[0] = ((
vÆ
 << 2Ë& 
AR5K_EEPROM_POWER_M
);

854 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

855 
cd©a
->
pwr
[0] |((
vÆ
 >> 14) & 0x3);

856 
cd©a
->
pwr
[1] = ((
vÆ
 >> 8Ë& 
AR5K_EEPROM_POWER_M
);

857 
cd©a
->
pwr
[2] = ((
vÆ
 >> 2Ë& 
AR5K_EEPROM_POWER_M
);

858 
cd©a
->
pwr
[3] = ((
vÆ
 << 4Ë& 
AR5K_EEPROM_POWER_M
);

860 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

861 
cd©a
->
pwr
[3] |((
vÆ
 >> 12) & 0xf);

862 
cd©a
->
pwr
[4] = ((
vÆ
 >> 6Ë& 
AR5K_EEPROM_POWER_M
);

863 
cd©a
->
pwr
[5] = (
vÆ
 & 
AR5K_EEPROM_POWER_M
);

865 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

866 
cd©a
->
pwr
[6] = ((
vÆ
 >> 10Ë& 
AR5K_EEPROM_POWER_M
);

867 
cd©a
->
pwr
[7] = ((
vÆ
 >> 4Ë& 
AR5K_EEPROM_POWER_M
);

868 
cd©a
->
pwr
[8] = ((
vÆ
 << 2Ë& 
AR5K_EEPROM_POWER_M
);

870 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

871 
cd©a
->
pwr
[8] |((
vÆ
 >> 14) & 0x3);

872 
cd©a
->
pwr
[9] = ((
vÆ
 >> 8Ë& 
AR5K_EEPROM_POWER_M
);

873 
cd©a
->
pwr
[10] = ((
vÆ
 >> 2Ë& 
AR5K_EEPROM_POWER_M
);

875 
	`©h5k_gë_pcdac_öãr˚±s
(
ah
, 
cd©a
->
pcdac_mö
,

876 
cd©a
->
pcdac_max
, cd©a->
pcdac
);

879  
	`©h5k_ì¥om_c⁄vît_pˇl_öfo_5111
(
ah
, 
mode
, 
pˇl
);

880 
	}
}

901 
	$©h5k_ì¥om_c⁄vît_pˇl_öfo_5112
(
©h5k_hw
 *
ah
, 
mode
,

902 
©h5k_ch™_pˇl_öfo
 *
chöfo
)

904 
©h5k_ì¥om_öfo
 *
ì
 = &
ah
->
ah_ˇ∑bûôõs
.
ˇp_ì¥om
;

905 
©h5k_ch™_pˇl_öfo_rf5112
 *
pcöfo
;

906 
u8
 *
pdgaö_idx
 = 
ì
->
ì_pdc_to_idx
[
mode
];

907 
põr
, 
pdg
, 
poöt
;

910 
põr
 = 0;Öõ∏< 
ì
->
ì_n_põrs
[
mode
];Öier++) {

912 
pcöfo
 = &
chöfo
[
põr
].
rf5112_öfo
;

915 
chöfo
[
põr
].
pd_curves
 =

916 
	`kˇŒoc
(
AR5K_EEPROM_N_PD_CURVES
,

917 (
©h5k_pdgaö_öfo
),

918 
GFP_KERNEL
);

920 i‡(!
chöfo
[
põr
].
pd_curves
)

921 
îr_out
;

924 
pdg
 = 0;Ödg < 
ì
->
ì_pd_gaös
[
mode
];Ödg++) {

926 
u8
 
idx
 = 
pdgaö_idx
[
pdg
];

927 
©h5k_pdgaö_öfo
 *
pd
 =

928 &
chöfo
[
põr
].
pd_curves
[
idx
];

931 i‡(
pdg
 == 0) {

933 
pd
->
pd_poöts
 = 
AR5K_EEPROM_N_XPD0_POINTS
;

936 
pd
->
pd_°ï
 = 
	`kˇŒoc
’d->
pd_poöts
,

937 (
u8
), 
GFP_KERNEL
);

939 i‡(!
pd
->
pd_°ï
)

940 
îr_out
;

942 
pd
->
pd_pwr
 = 
	`kˇŒoc
’d->
pd_poöts
,

943 (
s16
), 
GFP_KERNEL
);

945 i‡(!
pd
->
pd_pwr
)

946 
îr_out
;

950 
pd
->
pd_°ï
[0] = 
pcöfo
->
pcdac_x0
[0];

951 
pd
->
pd_pwr
[0] = 
pcöfo
->
pwr_x0
[0];

953 
poöt
 = 1;Öoöà< 
pd
->
pd_poöts
;

954 
poöt
++) {

956 
pd
->
pd_pwr
[
poöt
] =

957 
pcöfo
->
pwr_x0
[
poöt
];

960 
pd
->
pd_°ï
[
poöt
] =

961 
pd
->
pd_°ï
[
poöt
 - 1] +

962 
pcöfo
->
pcdac_x0
[
poöt
];

966 
chöfo
[
põr
].
mö_pwr
 = 
pd
->
pd_pwr
[0];

969 } i‡(
pdg
 == 1) {

971 
pd
->
pd_poöts
 = 
AR5K_EEPROM_N_XPD3_POINTS
;

974 
pd
->
pd_°ï
 = 
	`kˇŒoc
’d->
pd_poöts
,

975 (
u8
), 
GFP_KERNEL
);

977 i‡(!
pd
->
pd_°ï
)

978 
îr_out
;

980 
pd
->
pd_pwr
 = 
	`kˇŒoc
’d->
pd_poöts
,

981 (
s16
), 
GFP_KERNEL
);

983 i‡(!
pd
->
pd_pwr
)

984 
îr_out
;

988 
poöt
 = 0;Öoöà< 
pd
->
pd_poöts
;

989 
poöt
++) {

991 
pd
->
pd_pwr
[
poöt
] =

992 
pcöfo
->
pwr_x3
[
poöt
];

995 
pd
->
pd_°ï
[
poöt
] =

996 
pcöfo
->
pcdac_x3
[
poöt
];

1001 
chöfo
[
põr
].
mö_pwr
 = 
pd
->
pd_pwr
[0];

1008 
îr_out
:

1009 
	`©h5k_ì¥om_‰ì_pˇl_öfo
(
ah
, 
mode
);

1010  -
ENOMEM
;

1011 
	}
}

1015 
	$©h5k_ì¥om_ªad_pˇl_öfo_5112
(
©h5k_hw
 *
ah
, 
mode
)

1017 
©h5k_ì¥om_öfo
 *
ì
 = &
ah
->
ah_ˇ∑bûôõs
.
ˇp_ì¥om
;

1018 
©h5k_ch™_pˇl_öfo_rf5112
 *
ch™_pˇl_öfo
;

1019 
©h5k_ch™_pˇl_öfo
 *
gí_ch™_öfo
;

1020 
u8
 *
pdgaö_idx
 = 
ì
->
ì_pdc_to_idx
[
mode
];

1021 
u32
 
off£t
;

1022 
u8
 
i
, 
c
;

1023 
u16
 
vÆ
;

1024 
u8
 
pd_gaös
 = 0;

1031 
i
 = 0; i < 
AR5K_EEPROM_N_PD_CURVES
; i++) {

1033 i‡((
ì
->
ì_x_gaö
[
mode
] >> 
i
) & 0x1)

1034 
pdgaö_idx
[
pd_gaös
++] = 
i
;

1036 
ì
->
ì_pd_gaös
[
mode
] = 
pd_gaös
;

1038 i‡(
pd_gaös
 == 0 ||Öd_gains > 2)

1039  -
EINVAL
;

1041 
mode
) {

1042 
AR5K_EEPROM_MODE_11A
:

1046 
off£t
 = 
	`AR5K_EEPROM_GROUPS_START
(
ì
->
ì_vîsi⁄
);

1047 
	`©h5k_ì¥om_öô_11a_pˇl_‰eq
(
ah
, 
off£t
);

1049 
off£t
 +
AR5K_EEPROM_GROUP2_OFFSET
;

1050 
gí_ch™_öfo
 = 
ì
->
ì_pwr_ˇl_a
;

1052 
AR5K_EEPROM_MODE_11B
:

1053 
off£t
 = 
	`AR5K_EEPROM_GROUPS_START
(
ì
->
ì_vîsi⁄
);

1054 i‡(
	`AR5K_EEPROM_HDR_11A
(
ì
->
ì_hódî
))

1055 
off£t
 +
AR5K_EEPROM_GROUP3_OFFSET
;

1058 
gí_ch™_öfo
 = 
ì
->
ì_pwr_ˇl_b
;

1060 
AR5K_EEPROM_MODE_11G
:

1061 
off£t
 = 
	`AR5K_EEPROM_GROUPS_START
(
ì
->
ì_vîsi⁄
);

1062 i‡(
	`AR5K_EEPROM_HDR_11A
(
ì
->
ì_hódî
))

1063 
off£t
 +
AR5K_EEPROM_GROUP4_OFFSET
;

1064 i‡(
	`AR5K_EEPROM_HDR_11B
(
ì
->
ì_hódî
))

1065 
off£t
 +
AR5K_EEPROM_GROUP2_OFFSET
;

1068 
gí_ch™_öfo
 = 
ì
->
ì_pwr_ˇl_g
;

1071  -
EINVAL
;

1074 
i
 = 0; i < 
ì
->
ì_n_põrs
[
mode
]; i++) {

1075 
ch™_pˇl_öfo
 = &
gí_ch™_öfo
[
i
].
rf5112_öfo
;

1080 
c
 = 0; c < 
AR5K_EEPROM_N_XPD0_POINTS
; c++) {

1081 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

1082 
ch™_pˇl_öfo
->
pwr_x0
[
c
] = (
s8
Ë(
vÆ
 & 0xff);

1083 
ch™_pˇl_öfo
->
pwr_x0
[++
c
] = (
s8
Ë((
vÆ
 >> 8) & 0xff);

1089 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

1090 
ch™_pˇl_öfo
->
pcdac_x0
[1] = (
vÆ
 & 0x1f);

1091 
ch™_pˇl_öfo
->
pcdac_x0
[2] = ((
vÆ
 >> 5) & 0x1f);

1092 
ch™_pˇl_öfo
->
pcdac_x0
[3] = ((
vÆ
 >> 10) & 0x1f);

1097 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

1098 
ch™_pˇl_öfo
->
pwr_x3
[0] = (
s8
Ë(
vÆ
 & 0xff);

1099 
ch™_pˇl_öfo
->
pwr_x3
[1] = (
s8
Ë((
vÆ
 >> 8) & 0xff);

1101 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

1102 
ch™_pˇl_öfo
->
pwr_x3
[2] = (
vÆ
 & 0xff);

1107 
ch™_pˇl_öfo
->
pcdac_x3
[0] = 20;

1108 
ch™_pˇl_öfo
->
pcdac_x3
[1] = 35;

1109 
ch™_pˇl_öfo
->
pcdac_x3
[2] = 63;

1111 i‡(
ì
->
ì_vîsi⁄
 >
AR5K_EEPROM_VERSION_4_3
) {

1112 
ch™_pˇl_öfo
->
pcdac_x0
[0] = ((
vÆ
 >> 8) & 0x3f);

1115 
gí_ch™_öfo
[
i
].
max_pwr
 = 
ch™_pˇl_öfo
->
pwr_x0
[3];

1117 
ch™_pˇl_öfo
->
pcdac_x0
[0] = 1;

1118 
gí_ch™_öfo
[
i
].
max_pwr
 = (
s8
Ë((
vÆ
 >> 8) & 0xff);

1123  
	`©h5k_ì¥om_c⁄vît_pˇl_öfo_5112
(
ah
, 
mode
, 
gí_ch™_öfo
);

1124 
	}
}

1149 
ölöe
 

1150 
	$©h5k_pdgaös_size_2413
(
©h5k_ì¥om_öfo
 *
ì
, 
mode
)

1152 c⁄° 
pdgaös_size
[] = { 4, 6, 9, 12 };

1153 
sz
;

1155 
sz
 = 
pdgaös_size
[
ì
->
ì_pd_gaös
[
mode
] - 1];

1156 
sz
 *
ì
->
ì_n_põrs
[
mode
];

1158  
sz
;

1159 
	}
}

1164 
	$©h5k_ˇl_d©a_off£t_2413
(
©h5k_ì¥om_öfo
 *
ì
, 
mode
)

1166 
u32
 
off£t
 = 
	`AR5K_EEPROM_CAL_DATA_START
(
ì
->
ì_misc4
);

1168 
mode
) {

1169 
AR5K_EEPROM_MODE_11G
:

1170 i‡(
	`AR5K_EEPROM_HDR_11B
(
ì
->
ì_hódî
))

1171 
off£t
 +
	`©h5k_pdgaös_size_2413
(
ì
,

1172 
AR5K_EEPROM_MODE_11B
) +

1173 
AR5K_EEPROM_N_2GHZ_CHAN_2413
 / 2;

1175 
AR5K_EEPROM_MODE_11B
:

1176 i‡(
	`AR5K_EEPROM_HDR_11A
(
ì
->
ì_hódî
))

1177 
off£t
 +
	`©h5k_pdgaös_size_2413
(
ì
,

1178 
AR5K_EEPROM_MODE_11A
) +

1179 
AR5K_EEPROM_N_5GHZ_CHAN
 / 2;

1181 
AR5K_EEPROM_MODE_11A
:

1187  
off£t
;

1188 
	}
}

1193 
	$©h5k_ì¥om_c⁄vît_pˇl_öfo_2413
(
©h5k_hw
 *
ah
, 
mode
,

1194 
©h5k_ch™_pˇl_öfo
 *
chöfo
)

1196 
©h5k_ì¥om_öfo
 *
ì
 = &
ah
->
ah_ˇ∑bûôõs
.
ˇp_ì¥om
;

1197 
©h5k_ch™_pˇl_öfo_rf2413
 *
pcöfo
;

1198 
u8
 *
pdgaö_idx
 = 
ì
->
ì_pdc_to_idx
[
mode
];

1199 
põr
, 
pdg
, 
poöt
;

1202 
põr
 = 0;Öõ∏< 
ì
->
ì_n_põrs
[
mode
];Öier++) {

1204 
pcöfo
 = &
chöfo
[
põr
].
rf2413_öfo
;

1207 
chöfo
[
põr
].
pd_curves
 =

1208 
	`kˇŒoc
(
AR5K_EEPROM_N_PD_CURVES
,

1209 (
©h5k_pdgaö_öfo
),

1210 
GFP_KERNEL
);

1212 i‡(!
chöfo
[
põr
].
pd_curves
)

1213 
îr_out
;

1216 
pdg
 = 0;Ödg < 
ì
->
ì_pd_gaös
[
mode
];Ödg++) {

1218 
u8
 
idx
 = 
pdgaö_idx
[
pdg
];

1219 
©h5k_pdgaö_öfo
 *
pd
 =

1220 &
chöfo
[
põr
].
pd_curves
[
idx
];

1224 i‡(
pdg
 =
ì
->
ì_pd_gaös
[
mode
] - 1)

1225 
pd
->
pd_poöts
 = 
AR5K_EEPROM_N_PD_POINTS
;

1227 
pd
->
pd_poöts
 = 
AR5K_EEPROM_N_PD_POINTS
 - 1;

1230 
pd
->
pd_°ï
 = 
	`kˇŒoc
’d->
pd_poöts
,

1231 (
u8
), 
GFP_KERNEL
);

1233 i‡(!
pd
->
pd_°ï
)

1234 
îr_out
;

1236 
pd
->
pd_pwr
 = 
	`kˇŒoc
’d->
pd_poöts
,

1237 (
s16
), 
GFP_KERNEL
);

1239 i‡(!
pd
->
pd_pwr
)

1240 
îr_out
;

1245 
pd
->
pd_°ï
[0] = 
pcöfo
->
pddac_i
[
pdg
];

1246 
pd
->
pd_pwr
[0] = 4 * 
pcöfo
->
pwr_i
[
pdg
];

1248 
poöt
 = 1;Öoöà< 
pd
->
pd_poöts
;Öoint++) {

1250 
pd
->
pd_pwr
[
poöt
] =Öd->pd_pwr[point - 1] +

1251 2 * 
pcöfo
->
pwr
[
pdg
][
poöt
 - 1];

1253 
pd
->
pd_°ï
[
poöt
] =Öd->pd_step[point - 1] +

1254 
pcöfo
->
pddac
[
pdg
][
poöt
 - 1];

1259 i‡(
pdg
 == 0)

1260 
chöfo
[
põr
].
mö_pwr
 = 
pd
->
pd_pwr
[0];

1263 i‡(
pdg
 =
ì
->
ì_pd_gaös
[
mode
] - 1)

1264 
chöfo
[
põr
].
max_pwr
 =

1265 
pd
->
pd_pwr
[pd->
pd_poöts
 - 1];

1271 
îr_out
:

1272 
	`©h5k_ì¥om_‰ì_pˇl_öfo
(
ah
, 
mode
);

1273  -
ENOMEM
;

1274 
	}
}

1278 
	$©h5k_ì¥om_ªad_pˇl_öfo_2413
(
©h5k_hw
 *
ah
, 
mode
)

1280 
©h5k_ì¥om_öfo
 *
ì
 = &
ah
->
ah_ˇ∑bûôõs
.
ˇp_ì¥om
;

1281 
©h5k_ch™_pˇl_öfo_rf2413
 *
pcöfo
;

1282 
©h5k_ch™_pˇl_öfo
 *
chöfo
;

1283 
u8
 *
pdgaö_idx
 = 
ì
->
ì_pdc_to_idx
[
mode
];

1284 
u32
 
off£t
;

1285 
idx
, 
i
;

1286 
u16
 
vÆ
;

1287 
u8
 
pd_gaös
 = 0;

1294 
idx
 = 
AR5K_EEPROM_N_PD_CURVES
 - 1; idx >= 0; idx--) {

1296 i‡((
ì
->
ì_x_gaö
[
mode
] >> 
idx
) & 0x1)

1297 
pdgaö_idx
[
pd_gaös
++] = 
idx
;

1300 
ì
->
ì_pd_gaös
[
mode
] = 
pd_gaös
;

1302 i‡(
pd_gaös
 == 0)

1303  -
EINVAL
;

1305 
off£t
 = 
	`©h5k_ˇl_d©a_off£t_2413
(
ì
, 
mode
);

1306 
mode
) {

1307 
AR5K_EEPROM_MODE_11A
:

1308 i‡(!
	`AR5K_EEPROM_HDR_11A
(
ì
->
ì_hódî
))

1311 
	`©h5k_ì¥om_öô_11a_pˇl_‰eq
(
ah
, 
off£t
);

1312 
off£t
 +
AR5K_EEPROM_N_5GHZ_CHAN
 / 2;

1313 
chöfo
 = 
ì
->
ì_pwr_ˇl_a
;

1315 
AR5K_EEPROM_MODE_11B
:

1316 i‡(!
	`AR5K_EEPROM_HDR_11B
(
ì
->
ì_hódî
))

1319 
	`©h5k_ì¥om_öô_11bg_2413
(
ah
, 
mode
, 
off£t
);

1320 
off£t
 +
AR5K_EEPROM_N_2GHZ_CHAN_2413
 / 2;

1321 
chöfo
 = 
ì
->
ì_pwr_ˇl_b
;

1323 
AR5K_EEPROM_MODE_11G
:

1324 i‡(!
	`AR5K_EEPROM_HDR_11G
(
ì
->
ì_hódî
))

1327 
	`©h5k_ì¥om_öô_11bg_2413
(
ah
, 
mode
, 
off£t
);

1328 
off£t
 +
AR5K_EEPROM_N_2GHZ_CHAN_2413
 / 2;

1329 
chöfo
 = 
ì
->
ì_pwr_ˇl_g
;

1332  -
EINVAL
;

1335 
i
 = 0; i < 
ì
->
ì_n_põrs
[
mode
]; i++) {

1336 
pcöfo
 = &
chöfo
[
i
].
rf2413_öfo
;

1342 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

1343 
pcöfo
->
pwr_i
[0] = 
vÆ
 & 0x1f;

1344 
pcöfo
->
pddac_i
[0] = (
vÆ
 >> 5) & 0x7f;

1345 
pcöfo
->
pwr
[0][0] = (
vÆ
 >> 12) & 0xf;

1347 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

1348 
pcöfo
->
pddac
[0][0] = 
vÆ
 & 0x3f;

1349 
pcöfo
->
pwr
[0][1] = (
vÆ
 >> 6) & 0xf;

1350 
pcöfo
->
pddac
[0][1] = (
vÆ
 >> 10) & 0x3f;

1352 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

1353 
pcöfo
->
pwr
[0][2] = 
vÆ
 & 0xf;

1354 
pcöfo
->
pddac
[0][2] = (
vÆ
 >> 4) & 0x3f;

1356 
pcöfo
->
pwr
[0][3] = 0;

1357 
pcöfo
->
pddac
[0][3] = 0;

1359 i‡(
pd_gaös
 > 1) {

1365 
pcöfo
->
pwr_i
[1] = (
vÆ
 >> 10) & 0x1f;

1367 
pcöfo
->
pddac_i
[1] = (
vÆ
 >> 15) & 0x1;

1368 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

1369 
pcöfo
->
pddac_i
[1] |(
vÆ
 & 0x3F) << 1;

1371 
pcöfo
->
pwr
[1][0] = (
vÆ
 >> 6) & 0xf;

1372 
pcöfo
->
pddac
[1][0] = (
vÆ
 >> 10) & 0x3f;

1374 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

1375 
pcöfo
->
pwr
[1][1] = 
vÆ
 & 0xf;

1376 
pcöfo
->
pddac
[1][1] = (
vÆ
 >> 4) & 0x3f;

1377 
pcöfo
->
pwr
[1][2] = (
vÆ
 >> 10) & 0xf;

1379 
pcöfo
->
pddac
[1][2] = (
vÆ
 >> 14) & 0x3;

1380 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

1381 
pcöfo
->
pddac
[1][2] |(
vÆ
 & 0xF) << 2;

1383 
pcöfo
->
pwr
[1][3] = 0;

1384 
pcöfo
->
pddac
[1][3] = 0;

1385 } i‡(
pd_gaös
 == 1) {

1390 
pcöfo
->
pwr
[0][3] = (
vÆ
 >> 10) & 0xf;

1392 
pcöfo
->
pddac
[0][3] = (
vÆ
 >> 14) & 0x3;

1393 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

1394 
pcöfo
->
pddac
[0][3] |(
vÆ
 & 0xF) << 2;

1401 i‡(
pd_gaös
 > 2) {

1402 
pcöfo
->
pwr_i
[2] = (
vÆ
 >> 4) & 0x1f;

1403 
pcöfo
->
pddac_i
[2] = (
vÆ
 >> 9) & 0x7f;

1405 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

1406 
pcöfo
->
pwr
[2][0] = (
vÆ
 >> 0) & 0xf;

1407 
pcöfo
->
pddac
[2][0] = (
vÆ
 >> 4) & 0x3f;

1408 
pcöfo
->
pwr
[2][1] = (
vÆ
 >> 10) & 0xf;

1410 
pcöfo
->
pddac
[2][1] = (
vÆ
 >> 14) & 0x3;

1411 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

1412 
pcöfo
->
pddac
[2][1] |(
vÆ
 & 0xF) << 2;

1414 
pcöfo
->
pwr
[2][2] = (
vÆ
 >> 4) & 0xf;

1415 
pcöfo
->
pddac
[2][2] = (
vÆ
 >> 8) & 0x3f;

1417 
pcöfo
->
pwr
[2][3] = 0;

1418 
pcöfo
->
pddac
[2][3] = 0;

1419 } i‡(
pd_gaös
 == 2) {

1420 
pcöfo
->
pwr
[1][3] = (
vÆ
 >> 4) & 0xf;

1421 
pcöfo
->
pddac
[1][3] = (
vÆ
 >> 8) & 0x3f;

1424 i‡(
pd_gaös
 > 3) {

1425 
pcöfo
->
pwr_i
[3] = (
vÆ
 >> 14) & 0x3;

1426 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

1427 
pcöfo
->
pwr_i
[3] |((
vÆ
 >> 0) & 0x7) << 2;

1429 
pcöfo
->
pddac_i
[3] = (
vÆ
 >> 3) & 0x7f;

1430 
pcöfo
->
pwr
[3][0] = (
vÆ
 >> 10) & 0xf;

1431 
pcöfo
->
pddac
[3][0] = (
vÆ
 >> 14) & 0x3;

1433 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

1434 
pcöfo
->
pddac
[3][0] |(
vÆ
 & 0xF) << 2;

1435 
pcöfo
->
pwr
[3][1] = (
vÆ
 >> 4) & 0xf;

1436 
pcöfo
->
pddac
[3][1] = (
vÆ
 >> 8) & 0x3f;

1438 
pcöfo
->
pwr
[3][2] = (
vÆ
 >> 14) & 0x3;

1439 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

1440 
pcöfo
->
pwr
[3][2] |((
vÆ
 >> 0) & 0x3) << 2;

1442 
pcöfo
->
pddac
[3][2] = (
vÆ
 >> 2) & 0x3f;

1443 
pcöfo
->
pwr
[3][3] = (
vÆ
 >> 8) & 0xf;

1445 
pcöfo
->
pddac
[3][3] = (
vÆ
 >> 12) & 0xF;

1446 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

1447 
pcöfo
->
pddac
[3][3] |((
vÆ
 >> 0) & 0x3) << 4;

1448 } i‡(
pd_gaös
 == 3) {

1449 
pcöfo
->
pwr
[2][3] = (
vÆ
 >> 14) & 0x3;

1450 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

1451 
pcöfo
->
pwr
[2][3] |((
vÆ
 >> 0) & 0x3) << 2;

1453 
pcöfo
->
pddac
[2][3] = (
vÆ
 >> 2) & 0x3f;

1457  
	`©h5k_ì¥om_c⁄vît_pˇl_öfo_2413
(
ah
, 
mode
, 
chöfo
);

1458 
	}
}

1469 
	$©h5k_ì¥om_ªad_èrgë_øã_pwr_öfo
(
©h5k_hw
 *
ah
, 
mode
)

1471 
©h5k_ì¥om_öfo
 *
ì
 = &
ah
->
ah_ˇ∑bûôõs
.
ˇp_ì¥om
;

1472 
©h5k_øã_pˇl_öfo
 *
øã_pˇl_öfo
;

1473 
u8
 *
øã_èrgë_pwr_num
;

1474 
u32
 
off£t
;

1475 
u16
 
vÆ
;

1476 
i
;

1478 
off£t
 = 
	`AR5K_EEPROM_TARGET_PWRSTART
(
ì
->
ì_misc1
);

1479 
øã_èrgë_pwr_num
 = &
ì
->
ì_øã_èrgë_pwr_num
[
mode
];

1480 
mode
) {

1481 
AR5K_EEPROM_MODE_11A
:

1482 
off£t
 +
	`AR5K_EEPROM_TARGET_PWR_OFF_11A
(
ì
->
ì_vîsi⁄
);

1483 
øã_pˇl_öfo
 = 
ì
->
ì_øã_çwr_a
;

1484 
ì
->
ì_øã_èrgë_pwr_num
[
mode
] = 
AR5K_EEPROM_N_5GHZ_CHAN
;

1486 
AR5K_EEPROM_MODE_11B
:

1487 
off£t
 +
	`AR5K_EEPROM_TARGET_PWR_OFF_11B
(
ì
->
ì_vîsi⁄
);

1488 
øã_pˇl_öfo
 = 
ì
->
ì_øã_çwr_b
;

1489 
ì
->
ì_øã_èrgë_pwr_num
[
mode
] = 2;

1491 
AR5K_EEPROM_MODE_11G
:

1492 
off£t
 +
	`AR5K_EEPROM_TARGET_PWR_OFF_11G
(
ì
->
ì_vîsi⁄
);

1493 
øã_pˇl_öfo
 = 
ì
->
ì_øã_çwr_g
;

1494 
ì
->
ì_øã_èrgë_pwr_num
[
mode
] = 
AR5K_EEPROM_N_2GHZ_CHAN
;

1497  -
EINVAL
;

1501 i‡(
ì
->
ì_vîsi⁄
 <
AR5K_EEPROM_VERSION_3_2
) {

1502 
i
 = 0; i < (*
øã_èrgë_pwr_num
); i++) {

1503 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

1504 
øã_pˇl_öfo
[
i
].
‰eq
 =

1505 
	`©h5k_ì¥om_bö2‰eq
(
ì
, (
vÆ
 >> 9Ë& 0x7f, 
mode
);

1507 
øã_pˇl_öfo
[
i
].
èrgë_powî_6to24
 = ((
vÆ
 >> 3) & 0x3f);

1508 
øã_pˇl_öfo
[
i
].
èrgë_powî_36
 = (
vÆ
 << 3) & 0x3f;

1510 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

1512 i‡(
øã_pˇl_öfo
[
i
].
‰eq
 =
AR5K_EEPROM_CHANNEL_DIS
 ||

1513 
vÆ
 == 0) {

1514 (*
øã_èrgë_pwr_num
Ë
i
;

1518 
øã_pˇl_öfo
[
i
].
èrgë_powî_36
 |((
vÆ
 >> 13) & 0x7);

1519 
øã_pˇl_öfo
[
i
].
èrgë_powî_48
 = ((
vÆ
 >> 7) & 0x3f);

1520 
øã_pˇl_öfo
[
i
].
èrgë_powî_54
 = ((
vÆ
 >> 1) & 0x3f);

1523 
i
 = 0; i < (*
øã_èrgë_pwr_num
); i++) {

1524 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

1525 
øã_pˇl_öfo
[
i
].
‰eq
 =

1526 
	`©h5k_ì¥om_bö2‰eq
(
ì
, (
vÆ
 >> 8Ë& 0xff, 
mode
);

1528 
øã_pˇl_öfo
[
i
].
èrgë_powî_6to24
 = ((
vÆ
 >> 2) & 0x3f);

1529 
øã_pˇl_öfo
[
i
].
èrgë_powî_36
 = (
vÆ
 << 4) & 0x3f;

1531 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

1533 i‡(
øã_pˇl_öfo
[
i
].
‰eq
 =
AR5K_EEPROM_CHANNEL_DIS
 ||

1534 
vÆ
 == 0) {

1535 (*
øã_èrgë_pwr_num
Ë
i
;

1539 
øã_pˇl_öfo
[
i
].
èrgë_powî_36
 |(
vÆ
 >> 12) & 0xf;

1540 
øã_pˇl_öfo
[
i
].
èrgë_powî_48
 = ((
vÆ
 >> 6) & 0x3f);

1541 
øã_pˇl_öfo
[
i
].
èrgë_powî_54
 = (
vÆ
 & 0x3f);

1546 
	}
}

1564 
	$©h5k_ì¥om_ªad_pˇl_öfo
(
©h5k_hw
 *
ah
)

1566 
©h5k_ì¥om_öfo
 *
ì
 = &
ah
->
ah_ˇ∑bûôõs
.
ˇp_ì¥om
;

1567 (*
ªad_pˇl
)(
©h5k_hw
 *
hw
, 
mode
);

1568 
mode
;

1569 
îr
;

1571 i‡((
ah
->
ah_ì_vîsi⁄
 >
AR5K_EEPROM_VERSION_4_0
) &&

1572 (
	`AR5K_EEPROM_EEMAP
(
ì
->
ì_misc0
) == 1))

1573 
ªad_pˇl
 = 
©h5k_ì¥om_ªad_pˇl_öfo_5112
;

1574 i‡((
ah
->
ah_ì_vîsi⁄
 >
AR5K_EEPROM_VERSION_5_0
) &&

1575 (
	`AR5K_EEPROM_EEMAP
(
ì
->
ì_misc0
) == 2))

1576 
ªad_pˇl
 = 
©h5k_ì¥om_ªad_pˇl_öfo_2413
;

1578 
ªad_pˇl
 = 
©h5k_ì¥om_ªad_pˇl_öfo_5111
;

1581 
mode
 = 
AR5K_EEPROM_MODE_11A
; modê<
AR5K_EEPROM_MODE_11G
;

1582 
mode
++) {

1583 
îr
 = 
	`ªad_pˇl
(
ah
, 
mode
);

1584 i‡(
îr
)

1585  
îr
;

1587 
îr
 = 
	`©h5k_ì¥om_ªad_èrgë_øã_pwr_öfo
(
ah
, 
mode
);

1588 i‡(
îr
 < 0)

1589  
îr
;

1593 
	}
}

1597 
	$©h5k_ì¥om_ªad_˘l_öfo
(
©h5k_hw
 *
ah
)

1599 
©h5k_ì¥om_öfo
 *
ì
 = &
ah
->
ah_ˇ∑bûôõs
.
ˇp_ì¥om
;

1600 
©h5k_edge_powî
 *
ªp
;

1601 
fmask
, 
pmask
;

1602 
˘l_mode
;

1603 
i
, 
j
;

1604 
u32
 
off£t
;

1605 
u16
 
vÆ
;

1607 
pmask
 = 
AR5K_EEPROM_POWER_M
;

1608 
fmask
 = 
	`AR5K_EEPROM_FREQ_M
(
ì
->
ì_vîsi⁄
);

1609 
off£t
 = 
	`AR5K_EEPROM_CTL
(
ì
->
ì_vîsi⁄
);

1610 
ì
->
ì_˘ls
 = 
	`AR5K_EEPROM_N_CTLS
”e->
ì_vîsi⁄
);

1611 
i
 = 0; i < 
ì
->
ì_˘ls
; i += 2) {

1612 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

1613 
ì
->
ì_˘l
[
i
] = (
vÆ
 >> 8) & 0xff;

1614 
ì
->
ì_˘l
[
i
 + 1] = 
vÆ
 & 0xff;

1617 
off£t
 = 
AR5K_EEPROM_GROUP8_OFFSET
;

1618 i‡(
ì
->
ì_vîsi⁄
 >
AR5K_EEPROM_VERSION_4_0
)

1619 
off£t
 +
	`AR5K_EEPROM_TARGET_PWRSTART
(
ì
->
ì_misc1
) -

1620 
AR5K_EEPROM_GROUP5_OFFSET
;

1622 
off£t
 +
	`AR5K_EEPROM_GROUPS_START
(
ì
->
ì_vîsi⁄
);

1624 
ªp
 = 
ì
->
ì_˘l_pwr
;

1625 
i
 = 0; i < 
ì
->
ì_˘ls
; i++) {

1626 
ì
->
ì_˘l
[
i
] & 
AR5K_CTL_MODE_M
) {

1627 
AR5K_CTL_11A
:

1628 
AR5K_CTL_TURBO
:

1629 
˘l_mode
 = 
AR5K_EEPROM_MODE_11A
;

1632 
˘l_mode
 = 
AR5K_EEPROM_MODE_11G
;

1635 i‡(
ì
->
ì_˘l
[
i
] == 0) {

1636 i‡(
ì
->
ì_vîsi⁄
 >
AR5K_EEPROM_VERSION_3_3
)

1637 
off£t
 += 8;

1639 
off£t
 += 7;

1640 
ªp
 +
AR5K_EEPROM_N_EDGES
;

1643 i‡(
ì
->
ì_vîsi⁄
 >
AR5K_EEPROM_VERSION_3_3
) {

1644 
j
 = 0; j < 
AR5K_EEPROM_N_EDGES
; j += 2) {

1645 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

1646 
ªp
[
j
].
‰eq
 = (
vÆ
 >> 8Ë& 
fmask
;

1647 
ªp
[
j
 + 1].
‰eq
 = 
vÆ
 & 
fmask
;

1649 
j
 = 0; j < 
AR5K_EEPROM_N_EDGES
; j += 2) {

1650 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

1651 
ªp
[
j
].
edge
 = (
vÆ
 >> 8Ë& 
pmask
;

1652 
ªp
[
j
].
Êag
 = (
vÆ
 >> 14) & 1;

1653 
ªp
[
j
 + 1].
edge
 = 
vÆ
 & 
pmask
;

1654 
ªp
[
j
 + 1].
Êag
 = (
vÆ
 >> 6) & 1;

1657 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

1658 
ªp
[0].
‰eq
 = (
vÆ
 >> 9Ë& 
fmask
;

1659 
ªp
[1].
‰eq
 = (
vÆ
 >> 2Ë& 
fmask
;

1660 
ªp
[2].
‰eq
 = (
vÆ
 << 5Ë& 
fmask
;

1662 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

1663 
ªp
[2].
‰eq
 |(
vÆ
 >> 11) & 0x1f;

1664 
ªp
[3].
‰eq
 = (
vÆ
 >> 4Ë& 
fmask
;

1665 
ªp
[4].
‰eq
 = (
vÆ
 << 3Ë& 
fmask
;

1667 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

1668 
ªp
[4].
‰eq
 |(
vÆ
 >> 13) & 0x7;

1669 
ªp
[5].
‰eq
 = (
vÆ
 >> 6Ë& 
fmask
;

1670 
ªp
[6].
‰eq
 = (
vÆ
 << 1Ë& 
fmask
;

1672 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

1673 
ªp
[6].
‰eq
 |(
vÆ
 >> 15) & 0x1;

1674 
ªp
[7].
‰eq
 = (
vÆ
 >> 8Ë& 
fmask
;

1676 
ªp
[0].
edge
 = (
vÆ
 >> 2Ë& 
pmask
;

1677 
ªp
[1].
edge
 = (
vÆ
 << 4Ë& 
pmask
;

1679 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

1680 
ªp
[1].
edge
 |(
vÆ
 >> 12) & 0xf;

1681 
ªp
[2].
edge
 = (
vÆ
 >> 6Ë& 
pmask
;

1682 
ªp
[3].
edge
 = 
vÆ
 & 
pmask
;

1684 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

1685 
ªp
[4].
edge
 = (
vÆ
 >> 10Ë& 
pmask
;

1686 
ªp
[5].
edge
 = (
vÆ
 >> 4Ë& 
pmask
;

1687 
ªp
[6].
edge
 = (
vÆ
 << 2Ë& 
pmask
;

1689 
	`AR5K_EEPROM_READ
(
off£t
++, 
vÆ
);

1690 
ªp
[6].
edge
 |(
vÆ
 >> 14) & 0x3;

1691 
ªp
[7].
edge
 = (
vÆ
 >> 8Ë& 
pmask
;

1693 
j
 = 0; j < 
AR5K_EEPROM_N_EDGES
; j++) {

1694 
ªp
[
j
].
‰eq
 = 
	`©h5k_ì¥om_bö2‰eq
(
ì
,

1695 
ªp
[
j
].
‰eq
, 
˘l_mode
);

1697 
ªp
 +
AR5K_EEPROM_N_EDGES
;

1701 
	}
}

1704 
	$©h5k_ì¥om_ªad_•ur_ch™s
(
©h5k_hw
 *
ah
)

1706 
©h5k_ì¥om_öfo
 *
ì
 = &
ah
->
ah_ˇ∑bûôõs
.
ˇp_ì¥om
;

1707 
u32
 
off£t
;

1708 
u16
 
vÆ
;

1709 
ªt
 = 0, 
i
;

1711 
off£t
 = 
	`AR5K_EEPROM_CTL
(
ì
->
ì_vîsi⁄
) +

1712 
	`AR5K_EEPROM_N_CTLS
(
ì
->
ì_vîsi⁄
);

1714 i‡(
ì
->
ì_vîsi⁄
 < 
AR5K_EEPROM_VERSION_5_3
) {

1716 
ì
->
ì_•ur_ch™s
[0][0] = 
AR5K_EEPROM_NO_SPUR
;

1718 
ì
->
ì_•ur_ch™s
[0][1] = 
AR5K_EEPROM_5413_SPUR_CHAN_1
;

1719 
ì
->
ì_•ur_ch™s
[1][1] = 
AR5K_EEPROM_5413_SPUR_CHAN_2
;

1720 
ì
->
ì_•ur_ch™s
[2][1] = 
AR5K_EEPROM_NO_SPUR
;

1721 } i‡(
ì
->
ì_vîsi⁄
 >
AR5K_EEPROM_VERSION_5_3
) {

1722 
i
 = 0; i < 
AR5K_EEPROM_N_SPUR_CHANS
; i++) {

1723 
	`AR5K_EEPROM_READ
(
off£t
, 
vÆ
);

1724 
ì
->
ì_•ur_ch™s
[
i
][0] = 
vÆ
;

1725 
	`AR5K_EEPROM_READ
(
off£t
 + 
AR5K_EEPROM_N_SPUR_CHANS
,

1726 
vÆ
);

1727 
ì
->
ì_•ur_ch™s
[
i
][1] = 
vÆ
;

1728 
off£t
++;

1732  
ªt
;

1733 
	}
}

1744 
	$©h5k_ì¥om_öô
(
©h5k_hw
 *
ah
)

1746 
îr
;

1748 
îr
 = 
	`©h5k_ì¥om_öô_hódî
(
ah
);

1749 i‡(
îr
 < 0)

1750  
îr
;

1752 
îr
 = 
	`©h5k_ì¥om_öô_modes
(
ah
);

1753 i‡(
îr
 < 0)

1754  
îr
;

1756 
îr
 = 
	`©h5k_ì¥om_ªad_pˇl_öfo
(
ah
);

1757 i‡(
îr
 < 0)

1758  
îr
;

1760 
îr
 = 
	`©h5k_ì¥om_ªad_˘l_öfo
(
ah
);

1761 i‡(
îr
 < 0)

1762  
îr
;

1764 
îr
 = 
	`©h5k_ì¥om_ªad_•ur_ch™s
(
ah
);

1765 i‡(
îr
 < 0)

1766  
îr
;

1769 
	}
}

1772 
	$©h5k_ì¥om_dëach
(
©h5k_hw
 *
ah
)

1774 
u8
 
mode
;

1776 
mode
 = 
AR5K_EEPROM_MODE_11A
; modê<
AR5K_EEPROM_MODE_11G
; mode++)

1777 
	`©h5k_ì¥om_‰ì_pˇl_öfo
(
ah
, 
mode
);

1778 
	}
}

1781 
	$©h5k_ì¥om_mode_‰om_ch™√l
(
õì80211_ch™√l
 *
ch™√l
)

1783 
ch™√l
->
hw_vÆue
 & 
CHANNEL_MODES
) {

1784 
CHANNEL_A
:

1785 
CHANNEL_XR
:

1786  
AR5K_EEPROM_MODE_11A
;

1787 
CHANNEL_G
:

1788  
AR5K_EEPROM_MODE_11G
;

1789 
CHANNEL_B
:

1790  
AR5K_EEPROM_MODE_11B
;

1794 
	}
}

	@ath5k/eeprom.h

22 
	#AR5K_EEPROM_PCIE_OFFSET
 0x02

	)

23 
	#AR5K_EEPROM_PCIE_SERDES_SECTION
 0x40

	)

25 
	#AR5K_EEPROM_MAGIC
 0x003d

	)

26 
	#AR5K_EEPROM_MAGIC_VALUE
 0x5Ø5

	)

28 
	#AR5K_EEPROM_IS_HB63
 0x000b

	)

30 
	#AR5K_EEPROM_RFKILL
 0x0f

	)

31 
	#AR5K_EEPROM_RFKILL_GPIO_SEL
 0x0000001c

	)

32 
	#AR5K_EEPROM_RFKILL_GPIO_SEL_S
 2

	)

33 
	#AR5K_EEPROM_RFKILL_POLARITY
 0x00000002

	)

34 
	#AR5K_EEPROM_RFKILL_POLARITY_S
 1

	)

36 
	#AR5K_EEPROM_REG_DOMAIN
 0x00b‡

	)

39 
	#AR5K_EEPROM_SIZE_LOWER
 0x1b

	)

40 
	#AR5K_EEPROM_SIZE_UPPER
 0x1¯

	)

41 
	#AR5K_EEPROM_SIZE_UPPER_MASK
 0xfff0

	)

42 
	#AR5K_EEPROM_SIZE_UPPER_SHIFT
 4

	)

43 
	#AR5K_EEPROM_SIZE_ENDLOC_SHIFT
 12

	)

45 
	#AR5K_EEPROM_CHECKSUM
 0x00c0

	)

46 
	#AR5K_EEPROM_INFO_BASE
 0x00c0

	)

47 
	#AR5K_EEPROM_INFO_MAX
 (0x400 - 
AR5K_EEPROM_INFO_BASE
)

	)

48 
	#AR5K_EEPROM_INFO_CKSUM
 0xffff

	)

49 
	#AR5K_EEPROM_INFO
(
_n
Ë(
AR5K_EEPROM_INFO_BASE
 + (_n))

	)

51 
	#AR5K_EEPROM_VERSION
 
	`AR5K_EEPROM_INFO
(1Ë

	)

52 
	#AR5K_EEPROM_VERSION_3_0
 0x3000

	)

53 
	#AR5K_EEPROM_VERSION_3_1
 0x3001

	)

54 
	#AR5K_EEPROM_VERSION_3_2
 0x3002

	)

55 
	#AR5K_EEPROM_VERSION_3_3
 0x3003

	)

56 
	#AR5K_EEPROM_VERSION_3_4
 0x3004

	)

57 
	#AR5K_EEPROM_VERSION_4_0
 0x4000

	)

58 
	#AR5K_EEPROM_VERSION_4_1
 0x4001

	)

59 
	#AR5K_EEPROM_VERSION_4_2
 0x4002

	)

60 
	#AR5K_EEPROM_VERSION_4_3
 0x4003

	)

61 
	#AR5K_EEPROM_VERSION_4_4
 0x4004

	)

62 
	#AR5K_EEPROM_VERSION_4_5
 0x4005

	)

63 
	#AR5K_EEPROM_VERSION_4_6
 0x4006

	)

64 
	#AR5K_EEPROM_VERSION_4_7
 0x3007

	)

65 
	#AR5K_EEPROM_VERSION_4_9
 0x4009

	)

66 
	#AR5K_EEPROM_VERSION_5_0
 0x5000

	)

67 
	#AR5K_EEPROM_VERSION_5_1
 0x5001

	)

68 
	#AR5K_EEPROM_VERSION_5_3
 0x5003

	)

70 
	#AR5K_EEPROM_MODE_11A
 0

	)

71 
	#AR5K_EEPROM_MODE_11B
 1

	)

72 
	#AR5K_EEPROM_MODE_11G
 2

	)

74 
	#AR5K_EEPROM_HDR
 
	`AR5K_EEPROM_INFO
(2Ë

	)

75 
	#AR5K_EEPROM_HDR_11A
(
_v
Ë(((_vË>> 
AR5K_EEPROM_MODE_11A
Ë& 0x1)

	)

76 
	#AR5K_EEPROM_HDR_11B
(
_v
Ë(((_vË>> 
AR5K_EEPROM_MODE_11B
Ë& 0x1)

	)

77 
	#AR5K_EEPROM_HDR_11G
(
_v
Ë(((_vË>> 
AR5K_EEPROM_MODE_11G
Ë& 0x1)

	)

78 
	#AR5K_EEPROM_HDR_T_2GHZ_DIS
(
_v
Ë(((_vË>> 3Ë& 0x1Ë

	)

79 
	#AR5K_EEPROM_HDR_T_5GHZ_DBM
(
_v
Ë(((_vË>> 4Ë& 0x7fË

	)

80 
	#AR5K_EEPROM_HDR_DEVICE
(
_v
Ë(((_vË>> 11Ë& 0x7Ë

	)

81 
	#AR5K_EEPROM_HDR_RFKILL
(
_v
Ë(((_vË>> 14Ë& 0x1Ë

	)

82 
	#AR5K_EEPROM_HDR_T_5GHZ_DIS
(
_v
Ë(((_vË>> 15Ë& 0x1Ë

	)

85 
	#AR5K_EEPROM_OFF
(
_v
, 
_v3_0
, 
_v3_3
) \

86 (((
_v
Ë>
AR5K_EEPROM_VERSION_3_3
Ë? 
_v3_3
 : 
_v3_0
)

	)

88 
	#AR5K_EEPROM_ANT_GAIN
(
_v
Ë
	`AR5K_EEPROM_OFF
(_v, 0x00c4, 0x00c3)

	)

89 
	#AR5K_EEPROM_ANT_GAIN_5GHZ
(
_v
Ë((
s8
)(((_vË>> 8Ë& 0xff))

	)

90 
	#AR5K_EEPROM_ANT_GAIN_2GHZ
(
_v
Ë((
s8
)((_vË& 0xff))

	)

93 
	#AR5K_EEPROM_MISC0
 
	`AR5K_EEPROM_INFO
(4)

	)

94 
	#AR5K_EEPROM_EARSTART
(
_v
Ë((_vË& 0xfff)

	)

95 
	#AR5K_EEPROM_HDR_XR2_DIS
(
_v
Ë(((_vË>> 12Ë& 0x1)

	)

96 
	#AR5K_EEPROM_HDR_XR5_DIS
(
_v
Ë(((_vË>> 13Ë& 0x1)

	)

97 
	#AR5K_EEPROM_EEMAP
(
_v
Ë(((_vË>> 14Ë& 0x3)

	)

99 
	#AR5K_EEPROM_MISC1
 
	`AR5K_EEPROM_INFO
(5)

	)

100 
	#AR5K_EEPROM_TARGET_PWRSTART
(
_v
Ë((_vË& 0xfff)

	)

101 
	#AR5K_EEPROM_HAS32KHZCRYSTAL
(
_v
Ë(((_vË>> 14Ë& 0x1Ë

	)

102 
	#AR5K_EEPROM_HAS32KHZCRYSTAL_OLD
(
_v
Ë(((_vË>> 15Ë& 0x1)

	)

104 
	#AR5K_EEPROM_MISC2
 
	`AR5K_EEPROM_INFO
(6)

	)

105 
	#AR5K_EEPROM_EEP_FILE_VERSION
(
_v
Ë(((_vË>> 8Ë& 0xff)

	)

106 
	#AR5K_EEPROM_EAR_FILE_VERSION
(
_v
Ë((_vË& 0xff)

	)

108 
	#AR5K_EEPROM_MISC3
 
	`AR5K_EEPROM_INFO
(7)

	)

109 
	#AR5K_EEPROM_ART_BUILD_NUM
(
_v
Ë(((_vË>> 10Ë& 0x3f)

	)

110 
	#AR5K_EEPROM_EAR_FILE_ID
(
_v
Ë((_vË& 0xff)

	)

112 
	#AR5K_EEPROM_MISC4
 
	`AR5K_EEPROM_INFO
(8)

	)

113 
	#AR5K_EEPROM_CAL_DATA_START
(
_v
Ë(((_vË>> 4Ë& 0xfff)

	)

114 
	#AR5K_EEPROM_MASK_R0
(
_v
Ë(((_vË>> 2Ë& 0x3Ë

	)

115 
	#AR5K_EEPROM_MASK_R1
(
_v
Ë((_vË& 0x3Ë

	)

117 
	#AR5K_EEPROM_MISC5
 
	`AR5K_EEPROM_INFO
(9)

	)

118 
	#AR5K_EEPROM_COMP_DIS
(
_v
Ë((_vË& 0x1Ë

	)

119 
	#AR5K_EEPROM_AES_DIS
(
_v
Ë(((_vË>> 1Ë& 0x1Ë

	)

120 
	#AR5K_EEPROM_FF_DIS
(
_v
Ë(((_vË>> 2Ë& 0x1Ë

	)

121 
	#AR5K_EEPROM_BURST_DIS
(
_v
Ë(((_vË>> 3Ë& 0x1Ë

	)

122 
	#AR5K_EEPROM_MAX_QCU
(
_v
Ë(((_vË>> 4Ë& 0xfË

	)

123 
	#AR5K_EEPROM_HEAVY_CLIP_EN
(
_v
Ë(((_vË>> 8Ë& 0x1Ë

	)

124 
	#AR5K_EEPROM_KEY_CACHE_SIZE
(
_v
Ë(((_vË>> 12Ë& 0xfË

	)

126 
	#AR5K_EEPROM_MISC6
 
	`AR5K_EEPROM_INFO
(10)

	)

127 
	#AR5K_EEPROM_TX_CHAIN_DIS
 ((
_v
Ë& 0x7Ë

	)

128 
	#AR5K_EEPROM_RX_CHAIN_DIS
 (((
_v
Ë>> 3Ë& 0x7Ë

	)

129 
	#AR5K_EEPROM_FCC_MID_EN
 (((
_v
Ë>> 6Ë& 0x1Ë

	)

130 
	#AR5K_EEPROM_JAP_U1EVEN_EN
 (((
_v
Ë>> 7Ë& 0x1Ë

	)

131 
	#AR5K_EEPROM_JAP_U2_EN
 (((
_v
Ë>> 8Ë& 0x1Ë

	)

132 
	#AR5K_EEPROM_JAP_MID_EN
 (((
_v
Ë>> 9Ë& 0x1Ë

	)

133 
	#AR5K_EEPROM_JAP_U1ODD_EN
 (((
_v
Ë>> 10Ë& 0x1Ë

	)

134 
	#AR5K_EEPROM_JAP_11A_NEW_EN
 (((
_v
Ë>> 11Ë& 0x1Ë

	)

137 
	#AR5K_EEPROM_MODES_11A
(
_v
Ë
	`AR5K_EEPROM_OFF
(_v, 0x00c5, 0x00d4)

	)

138 
	#AR5K_EEPROM_MODES_11B
(
_v
Ë
	`AR5K_EEPROM_OFF
(_v, 0x00d0, 0x00f2)

	)

139 
	#AR5K_EEPROM_MODES_11G
(
_v
Ë
	`AR5K_EEPROM_OFF
(_v, 0x00da, 0x010d)

	)

140 
	#AR5K_EEPROM_CTL
(
_v
Ë
	`AR5K_EEPROM_OFF
(_v, 0x00e4, 0x0128Ë

	)

141 
	#AR5K_EEPROM_GROUPS_START
(
_v
Ë
	`AR5K_EEPROM_OFF
(_v, 0x0100, 0x0150Ë

	)

142 
	#AR5K_EEPROM_GROUP1_OFFSET
 0x0

	)

143 
	#AR5K_EEPROM_GROUP2_OFFSET
 0x5

	)

144 
	#AR5K_EEPROM_GROUP3_OFFSET
 0x37

	)

145 
	#AR5K_EEPROM_GROUP4_OFFSET
 0x46

	)

146 
	#AR5K_EEPROM_GROUP5_OFFSET
 0x55

	)

147 
	#AR5K_EEPROM_GROUP6_OFFSET
 0x65

	)

148 
	#AR5K_EEPROM_GROUP7_OFFSET
 0x69

	)

149 
	#AR5K_EEPROM_GROUP8_OFFSET
 0x6f

	)

151 
	#AR5K_EEPROM_TARGET_PWR_OFF_11A
(
_v
Ë
	`AR5K_EEPROM_OFF
(_v, 
	`AR5K_EEPROM_GROUPS_START
(_v) + \

152 
AR5K_EEPROM_GROUP5_OFFSET
, 0x0000)

	)

153 
	#AR5K_EEPROM_TARGET_PWR_OFF_11B
(
_v
Ë
	`AR5K_EEPROM_OFF
(_v, 
	`AR5K_EEPROM_GROUPS_START
(_v) + \

154 
AR5K_EEPROM_GROUP6_OFFSET
, 0x0010)

	)

155 
	#AR5K_EEPROM_TARGET_PWR_OFF_11G
(
_v
Ë
	`AR5K_EEPROM_OFF
(_v, 
	`AR5K_EEPROM_GROUPS_START
(_v) + \

156 
AR5K_EEPROM_GROUP7_OFFSET
, 0x0014)

	)

159 
	#AR5K_EEPROM_OBDB0_2GHZ
 0x00ec

	)

160 
	#AR5K_EEPROM_OBDB1_2GHZ
 0x00ed

	)

162 
	#AR5K_EEPROM_PROTECT
 0x003‡

	)

163 
	#AR5K_EEPROM_PROTECT_RD_0_31
 0x0001

	)

164 
	#AR5K_EEPROM_PROTECT_WR_0_31
 0x0002

	)

165 
	#AR5K_EEPROM_PROTECT_RD_32_63
 0x0004

	)

166 
	#AR5K_EEPROM_PROTECT_WR_32_63
 0x0008

	)

167 
	#AR5K_EEPROM_PROTECT_RD_64_127
 0x0010

	)

168 
	#AR5K_EEPROM_PROTECT_WR_64_127
 0x0020

	)

169 
	#AR5K_EEPROM_PROTECT_RD_128_191
 0x0040

	)

170 
	#AR5K_EEPROM_PROTECT_WR_128_191
 0x0080

	)

171 
	#AR5K_EEPROM_PROTECT_RD_192_207
 0x0100

	)

172 
	#AR5K_EEPROM_PROTECT_WR_192_207
 0x0200

	)

173 
	#AR5K_EEPROM_PROTECT_RD_208_223
 0x0400

	)

174 
	#AR5K_EEPROM_PROTECT_WR_208_223
 0x0800

	)

175 
	#AR5K_EEPROM_PROTECT_RD_224_239
 0x1000

	)

176 
	#AR5K_EEPROM_PROTECT_WR_224_239
 0x2000

	)

177 
	#AR5K_EEPROM_PROTECT_RD_240_255
 0x4000

	)

178 
	#AR5K_EEPROM_PROTECT_WR_240_255
 0x8000

	)

181 
	#AR5K_EEPROM_EEP_SCALE
 100

	)

182 
	#AR5K_EEPROM_EEP_DELTA
 10

	)

183 
	#AR5K_EEPROM_N_MODES
 3

	)

184 
	#AR5K_EEPROM_N_5GHZ_CHAN
 10

	)

185 
	#AR5K_EEPROM_N_2GHZ_CHAN
 3

	)

186 
	#AR5K_EEPROM_N_2GHZ_CHAN_2413
 4

	)

187 
	#AR5K_EEPROM_N_2GHZ_CHAN_MAX
 4

	)

188 
	#AR5K_EEPROM_MAX_CHAN
 10

	)

189 
	#AR5K_EEPROM_N_PWR_POINTS_5111
 11

	)

190 
	#AR5K_EEPROM_N_PCDAC
 11

	)

191 
	#AR5K_EEPROM_N_PHASE_CAL
 5

	)

192 
	#AR5K_EEPROM_N_TEST_FREQ
 8

	)

193 
	#AR5K_EEPROM_N_EDGES
 8

	)

194 
	#AR5K_EEPROM_N_INTERCEPTS
 11

	)

195 
	#AR5K_EEPROM_FREQ_M
(
_v
Ë
	`AR5K_EEPROM_OFF
(_v, 0x7f, 0xff)

	)

196 
	#AR5K_EEPROM_PCDAC_M
 0x3f

	)

197 
	#AR5K_EEPROM_PCDAC_START
 1

	)

198 
	#AR5K_EEPROM_PCDAC_STOP
 63

	)

199 
	#AR5K_EEPROM_PCDAC_STEP
 1

	)

200 
	#AR5K_EEPROM_NON_EDGE_M
 0x40

	)

201 
	#AR5K_EEPROM_CHANNEL_POWER
 8

	)

202 
	#AR5K_EEPROM_N_OBDB
 4

	)

203 
	#AR5K_EEPROM_OBDB_DIS
 0xffff

	)

204 
	#AR5K_EEPROM_CHANNEL_DIS
 0xff

	)

205 
	#AR5K_EEPROM_SCALE_OC_DELTA
(
_x
Ë(((_xË* 2Ë/ 10)

	)

206 
	#AR5K_EEPROM_N_CTLS
(
_v
Ë
	`AR5K_EEPROM_OFF
(_v, 16, 32)

	)

207 
	#AR5K_EEPROM_MAX_CTLS
 32

	)

208 
	#AR5K_EEPROM_N_PD_CURVES
 4

	)

209 
	#AR5K_EEPROM_N_XPD0_POINTS
 4

	)

210 
	#AR5K_EEPROM_N_XPD3_POINTS
 3

	)

211 
	#AR5K_EEPROM_N_PD_GAINS
 4

	)

212 
	#AR5K_EEPROM_N_PD_POINTS
 5

	)

213 
	#AR5K_EEPROM_N_INTERCEPT_10_2GHZ
 35

	)

214 
	#AR5K_EEPROM_N_INTERCEPT_10_5GHZ
 55

	)

215 
	#AR5K_EEPROM_POWER_M
 0x3f

	)

216 
	#AR5K_EEPROM_POWER_MIN
 0

	)

217 
	#AR5K_EEPROM_POWER_MAX
 3150

	)

218 
	#AR5K_EEPROM_POWER_STEP
 50

	)

219 
	#AR5K_EEPROM_POWER_TABLE_SIZE
 64

	)

220 
	#AR5K_EEPROM_N_POWER_LOC_11B
 4

	)

221 
	#AR5K_EEPROM_N_POWER_LOC_11G
 6

	)

222 
	#AR5K_EEPROM_I_GAIN
 10

	)

223 
	#AR5K_EEPROM_CCK_OFDM_DELTA
 15

	)

224 
	#AR5K_EEPROM_N_IQ_CAL
 2

	)

226 
	e©h5k_ì¥om_‰eq_b™ds
 {

227 
	mAR5K_EEPROM_BAND_5GHZ
 = 0,

228 
	mAR5K_EEPROM_BAND_2GHZ
 = 1,

229 
	mAR5K_EEPROM_N_FREQ_BANDS
,

232 
	#AR5K_EEPROM_N_SPUR_CHANS
 5

	)

234 
	#AR5K_EEPROM_5413_SPUR_CHAN_1
 1640

	)

236 
	#AR5K_EEPROM_5413_SPUR_CHAN_2
 1200

	)

237 
	#AR5K_EEPROM_SPUR_CHAN_MASK
 0x3FFF

	)

238 
	#AR5K_EEPROM_NO_SPUR
 0x8000

	)

239 
	#AR5K_SPUR_CHAN_WIDTH
 87

	)

240 
	#AR5K_SPUR_SYMBOL_WIDTH_BASE_100Hz
 3125

	)

241 
	#AR5K_SPUR_SYMBOL_WIDTH_TURBO_100Hz
 6250

	)

243 
	#AR5K_EEPROM_READ
(
_o
, 
_v
) do { \

244 i‡(!
	`©h5k_hw_nvøm_ªad
(
ah
, (
_o
), &(
_v
))) \

245  -
EIO
; \

246 } 0)

	)

248 
	#AR5K_EEPROM_READ_HDR
(
_o
, 
_v
) \

249 
	`AR5K_EEPROM_READ
(
_o
, 
ah
->
ah_ˇ∑bûôõs
.
ˇp_ì¥om
.
_v
); \

250 

	)

251 
	e©h5k_™t_èbÀ
 {

252 
	mAR5K_ANT_CTL
 = 0,

253 
	mAR5K_ANT_SWTABLE_A
 = 1,

254 
	mAR5K_ANT_SWTABLE_B
 = 2,

255 
	mAR5K_ANT_MAX
,

258 
	e©h5k_˘l_mode
 {

259 
	mAR5K_CTL_11A
 = 0,

260 
	mAR5K_CTL_11B
 = 1,

261 
	mAR5K_CTL_11G
 = 2,

262 
	mAR5K_CTL_TURBO
 = 3,

263 
	mAR5K_CTL_TURBOG
 = 4,

264 
	mAR5K_CTL_2GHT20
 = 5,

265 
	mAR5K_CTL_5GHT20
 = 6,

266 
	mAR5K_CTL_2GHT40
 = 7,

267 
	mAR5K_CTL_5GHT40
 = 8,

268 
	mAR5K_CTL_MODE_M
 = 15,

272 
	s©h5k_ch™_pˇl_öfo_rf5111
 {

275 
u8
 
	mpwr
[
AR5K_EEPROM_N_PWR_POINTS_5111
];

278 
u8
 
	mpcdac
[
AR5K_EEPROM_N_PWR_POINTS_5111
];

280 
u8
 
	mpcdac_mö
;

282 
u8
 
	mpcdac_max
;

285 
	s©h5k_ch™_pˇl_öfo_rf5112
 {

289 
s8
 
	mpwr_x0
[
AR5K_EEPROM_N_XPD0_POINTS
];

290 
s8
 
	mpwr_x3
[
AR5K_EEPROM_N_XPD3_POINTS
];

293 
u8
 
	mpcdac_x0
[
AR5K_EEPROM_N_XPD0_POINTS
];

294 
u8
 
	mpcdac_x3
[
AR5K_EEPROM_N_XPD3_POINTS
];

297 
	s©h5k_ch™_pˇl_öfo_rf2413
 {

299 
s8
 
	mpwr_i
[
AR5K_EEPROM_N_PD_GAINS
];

300 
u8
 
	mpddac_i
[
AR5K_EEPROM_N_PD_GAINS
];

303 
s8
 
	mpwr
[
AR5K_EEPROM_N_PD_GAINS
]

304 [
AR5K_EEPROM_N_PD_POINTS
];

305 
u8
 
	mpddac
[
AR5K_EEPROM_N_PD_GAINS
]

306 [
AR5K_EEPROM_N_PD_POINTS
];

309 
	e©h5k_powîèbÀ_ty≥
 {

310 
	mAR5K_PWRTABLE_PWR_TO_PCDAC
 = 0,

311 
	mAR5K_PWRTABLE_LINEAR_PCDAC
 = 1,

312 
	mAR5K_PWRTABLE_PWR_TO_PDADC
 = 2,

315 
	s©h5k_pdgaö_öfo
 {

316 
u8
 
	mpd_poöts
;

317 
u8
 *
	mpd_°ï
;

320 
s16
 *
	mpd_pwr
;

323 
	s©h5k_ch™_pˇl_öfo
 {

325 
u16
 
	m‰eq
;

327 
s16
 
	mmax_pwr
;

328 
s16
 
	mmö_pwr
;

330 
©h5k_ch™_pˇl_öfo_rf5111
 
	mrf5111_öfo
;

331 
©h5k_ch™_pˇl_öfo_rf5112
 
	mrf5112_öfo
;

332 
©h5k_ch™_pˇl_öfo_rf2413
 
	mrf2413_öfo
;

337 
©h5k_pdgaö_öfo
 *
	mpd_curves
;

343 
	s©h5k_øã_pˇl_öfo
 {

344 
u16
 
	m‰eq
;

347 
u16
 
	mèrgë_powî_6to24
;

350 
u16
 
	mèrgë_powî_36
;

353 
u16
 
	mèrgë_powî_48
;

356 
u16
 
	mèrgë_powî_54
;

360 
	s©h5k_edge_powî
 {

361 
u16
 
	m‰eq
;

362 
u16
 
	medge
;

363 
boﬁ
 
	mÊag
;

409 
	s©h5k_ì¥om_öfo
 {

412 
u16
 
	mì_magic
;

413 
u16
 
	mì_¥Ÿe˘
;

414 
u16
 
	mì_ªgdomaö
;

415 
u16
 
	mì_vîsi⁄
;

416 
u16
 
	mì_hódî
;

417 
u16
 
	mì_™t_gaö
;

418 
u8
 
	mì_rfkûl_pö
;

419 
boﬁ
 
	mì_rfkûl_pﬁ
;

420 
boﬁ
 
	mì_is_hb63
;

421 
boﬁ
 
	mì_£rdes
;

422 
u16
 
	mì_misc0
;

423 
u16
 
	mì_misc1
;

424 
u16
 
	mì_misc2
;

425 
u16
 
	mì_misc3
;

426 
u16
 
	mì_misc4
;

427 
u16
 
	mì_misc5
;

428 
u16
 
	mì_misc6
;

429 
u16
 
	mì_cck_ofdm_gaö_dñè
;

430 
u16
 
	mì_cck_ofdm_powî_dñè
;

431 
u16
 
	mì_sˇÀd_cck_dñè
;

434 
u16
 
	mì_i_ˇl
[
AR5K_EEPROM_N_MODES
];

435 
u16
 
	mì_q_ˇl
[
AR5K_EEPROM_N_MODES
];

436 
u16
 
	mì_fixed_büs
[
AR5K_EEPROM_N_MODES
];

437 
u16
 
	mì_turbo_max_powî
[
AR5K_EEPROM_N_MODES
];

438 
u16
 
	mì_xr_powî
[
AR5K_EEPROM_N_MODES
];

439 
u16
 
	mì_swôch_£âlög
[
AR5K_EEPROM_N_MODES
];

440 
u16
 
	mì_©n_tx_rx
[
AR5K_EEPROM_N_MODES
];

441 
u16
 
	mì_™t_c⁄åﬁ
[
AR5K_EEPROM_N_MODES
][
AR5K_EEPROM_N_PCDAC
];

442 
u16
 
	mì_ob
[
AR5K_EEPROM_N_MODES
][
AR5K_EEPROM_N_OBDB
];

443 
u16
 
	mì_db
[
AR5K_EEPROM_N_MODES
][
AR5K_EEPROM_N_OBDB
];

444 
u16
 
	mì_tx_íd2x a_íabÀ
[
AR5K_EEPROM_N_MODES
];

445 
u16
 
	mì_tx_íd2x∑_dißbÀ
[
AR5K_EEPROM_N_MODES
];

446 
u16
 
	mì_tx_‰m2x∑_íabÀ
[
AR5K_EEPROM_N_MODES
];

447 
u16
 
	mì_thr_62
[
AR5K_EEPROM_N_MODES
];

448 
u16
 
	mì_x a_gaö
[
AR5K_EEPROM_N_MODES
];

449 
u16
 
	mì_xpd
[
AR5K_EEPROM_N_MODES
];

450 
u16
 
	mì_x_gaö
[
AR5K_EEPROM_N_MODES
];

451 
u16
 
	mì_i_gaö
[
AR5K_EEPROM_N_MODES
];

452 
u16
 
	mì_m¨gö_tx_rx
[
AR5K_EEPROM_N_MODES
];

453 
u16
 
	mì_swôch_£âlög_turbo
[
AR5K_EEPROM_N_MODES
];

454 
u16
 
	mì_m¨gö_tx_rx_turbo
[
AR5K_EEPROM_N_MODES
];

455 
u16
 
	mì_©n_tx_rx_turbo
[
AR5K_EEPROM_N_MODES
];

458 
u16
 
	mì_Ál£_dëe˘
[
AR5K_EEPROM_N_MODES
];

461 
u8
 
	mì_pd_gaös
[
AR5K_EEPROM_N_MODES
];

463 
u8
 
	mì_pdc_to_idx
[
AR5K_EEPROM_N_MODES
][
AR5K_EEPROM_N_PD_GAINS
];

465 
u8
 
	mì_n_põrs
[
AR5K_EEPROM_N_MODES
];

466 
©h5k_ch™_pˇl_öfo
 
	mì_pwr_ˇl_a
[
AR5K_EEPROM_N_5GHZ_CHAN
];

467 
©h5k_ch™_pˇl_öfo
 
	mì_pwr_ˇl_b
[
AR5K_EEPROM_N_2GHZ_CHAN_MAX
];

468 
©h5k_ch™_pˇl_öfo
 
	mì_pwr_ˇl_g
[
AR5K_EEPROM_N_2GHZ_CHAN_MAX
];

471 
u8
 
	mì_øã_èrgë_pwr_num
[
AR5K_EEPROM_N_MODES
];

472 
©h5k_øã_pˇl_öfo
 
	mì_øã_çwr_a
[
AR5K_EEPROM_N_5GHZ_CHAN
];

473 
©h5k_øã_pˇl_öfo
 
	mì_øã_çwr_b
[
AR5K_EEPROM_N_2GHZ_CHAN_MAX
];

474 
©h5k_øã_pˇl_öfo
 
	mì_øã_çwr_g
[
AR5K_EEPROM_N_2GHZ_CHAN_MAX
];

477 
u8
 
	mì_˘ls
;

478 
u8
 
	mì_˘l
[
AR5K_EEPROM_MAX_CTLS
];

479 
©h5k_edge_powî
 
	mì_˘l_pwr
[
AR5K_EEPROM_N_EDGES
 * 
AR5K_EEPROM_MAX_CTLS
];

482 
s16
 
	mì_noi£_Êo‹_thr
[
AR5K_EEPROM_N_MODES
];

483 
s8
 
	mì_adc_desúed_size
[
AR5K_EEPROM_N_MODES
];

484 
s8
 
	mì_pga_desúed_size
[
AR5K_EEPROM_N_MODES
];

485 
s8
 
	mì_adc_desúed_size_turbo
[
AR5K_EEPROM_N_MODES
];

486 
s8
 
	mì_pga_desúed_size_turbo
[
AR5K_EEPROM_N_MODES
];

487 
s8
 
	mì_pd_gaö_ovîœp
;

490 
u16
 
	mì_•ur_ch™s
[
AR5K_EEPROM_N_SPUR_CHANS
][
AR5K_EEPROM_N_FREQ_BANDS
];

493 
u32
 
	mì_™ã¬a
[
AR5K_EEPROM_N_MODES
][
AR5K_ANT_MAX
];

497 
©h5k_ì¥om_mode_‰om_ch™√l
(
õì80211_ch™√l
 *
ch™√l
);

	@ath5k/gpio.c

23 
	~"©h5k.h
"

24 
	~"ªg.h
"

25 
	~"debug.h
"

26 
	~"ba£.h
"

31 
	$©h5k_hw_£t_Àd°©e
(
©h5k_hw
 *
ah
, 
°©e
)

33 
u32
 
Àd
;

35 
u32
 
Àd_5210
;

38 i‡(
ah
->
ah_vîsi⁄
 !
AR5K_AR5210
)

39 
	`AR5K_REG_DISABLE_BITS
(
ah
, 
AR5K_PCICFG
,

40 
AR5K_PCICFG_LEDMODE
 | 
AR5K_PCICFG_LED
);

42 
	`AR5K_REG_DISABLE_BITS
(
ah
, 
AR5K_PCICFG
, 
AR5K_PCICFG_LED
);

47 
°©e
) {

48 
AR5K_LED_SCAN
:

49 
AR5K_LED_AUTH
:

50 
Àd
 = 
AR5K_PCICFG_LEDMODE_PROP
 | 
AR5K_PCICFG_LED_PEND
;

51 
Àd_5210
 = 
AR5K_PCICFG_LED_PEND
 | 
AR5K_PCICFG_LED_BCTL
;

54 
AR5K_LED_INIT
:

55 
Àd
 = 
AR5K_PCICFG_LEDMODE_PROP
 | 
AR5K_PCICFG_LED_NONE
;

56 
Àd_5210
 = 
AR5K_PCICFG_LED_PEND
;

59 
AR5K_LED_ASSOC
:

60 
AR5K_LED_RUN
:

61 
Àd
 = 
AR5K_PCICFG_LEDMODE_PROP
 | 
AR5K_PCICFG_LED_ASSOC
;

62 
Àd_5210
 = 
AR5K_PCICFG_LED_ASSOC
;

66 
Àd
 = 
AR5K_PCICFG_LEDMODE_PROM
 | 
AR5K_PCICFG_LED_NONE
;

67 
Àd_5210
 = 
AR5K_PCICFG_LED_PEND
;

72 i‡(
ah
->
ah_vîsi⁄
 !
AR5K_AR5210
)

73 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_PCICFG
, 
Àd
);

75 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_PCICFG
, 
Àd_5210
);

76 
	}
}

81 
	$©h5k_hw_£t_gpio_öput
(
©h5k_hw
 *
ah
, 
u32
 
gpio
)

83 i‡(
gpio
 >
AR5K_NUM_GPIO
)

84  -
EINVAL
;

86 
	`©h5k_hw_ªg_wrôe
(
ah
,

87 (
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_GPIOCR
Ë& ~
	`AR5K_GPIOCR_OUT
(
gpio
))

88 | 
	`AR5K_GPIOCR_IN
(
gpio
), 
AR5K_GPIOCR
);

91 
	}
}

96 
	$©h5k_hw_£t_gpio_ouçut
(
©h5k_hw
 *
ah
, 
u32
 
gpio
)

98 i‡(
gpio
 >
AR5K_NUM_GPIO
)

99  -
EINVAL
;

101 
	`©h5k_hw_ªg_wrôe
(
ah
,

102 (
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_GPIOCR
Ë& ~
	`AR5K_GPIOCR_OUT
(
gpio
))

103 | 
	`AR5K_GPIOCR_OUT
(
gpio
), 
AR5K_GPIOCR
);

106 
	}
}

111 
u32
 
	$©h5k_hw_gë_gpio
(
©h5k_hw
 *
ah
, 
u32
 
gpio
)

113 i‡(
gpio
 >
AR5K_NUM_GPIO
)

117  ((
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_GPIODI
Ë& 
AR5K_GPIODI_M
Ë>> 
gpio
) &

119 
	}
}

124 
	$©h5k_hw_£t_gpio
(
©h5k_hw
 *
ah
, 
u32
 
gpio
, u32 
vÆ
)

126 
u32
 
d©a
;

128 i‡(
gpio
 >
AR5K_NUM_GPIO
)

129  -
EINVAL
;

132 
d©a
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_GPIODO
);

134 
d©a
 &~(1 << 
gpio
);

135 
d©a
 |(
vÆ
 & 1Ë<< 
gpio
;

137 
	`©h5k_hw_ªg_wrôe
(
ah
, 
d©a
, 
AR5K_GPIODO
);

140 
	}
}

145 
	$©h5k_hw_£t_gpio_öå
(
©h5k_hw
 *
ah
, 
gpio
,

146 
u32
 
öãºu±_Àvñ
)

148 
u32
 
d©a
;

150 i‡(
gpio
 >
AR5K_NUM_GPIO
)

156 
d©a
 = (
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_GPIOCR
) &

157 ~(
	`AR5K_GPIOCR_INT_SEL
(
gpio
Ë| 
AR5K_GPIOCR_INT_SELH
 |

158 
AR5K_GPIOCR_INT_ENA
 | 
	`AR5K_GPIOCR_OUT
(
gpio
))) |

159 (
	`AR5K_GPIOCR_INT_SEL
(
gpio
Ë| 
AR5K_GPIOCR_INT_ENA
);

161 
	`©h5k_hw_ªg_wrôe
(
ah
, 
öãºu±_Àvñ
 ? 
d©a
 :

162 (
d©a
 | 
AR5K_GPIOCR_INT_SELH
), 
AR5K_GPIOCR
);

164 
ah
->
ah_imr
 |
AR5K_IMR_GPIO
;

167 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_PIMR
, 
AR5K_IMR_GPIO
);

168 
	}
}

	@ath5k/initvals.c

22 
	~"©h5k.h
"

23 
	~"ªg.h
"

24 
	~"debug.h
"

25 
	~"ba£.h
"

31 
	s©h5k_öi
 {

32 
u16
 
	möi_ªgi°î
;

33 
u32
 
	möi_vÆue
;

36 
	mAR5K_INI_WRITE
 = 0,

37 
	mAR5K_INI_READ
 = 1,

38 } 
	möi_mode
;

45 
	s©h5k_öi_mode
 {

46 
u16
 
	mmode_ªgi°î
;

47 
u32
 
	mmode_vÆue
[3];

51 c⁄° 
©h5k_öi
 
	g¨5210_öi
[] = {

53 { 
AR5K_NOQCU_TXDP0
, 0 },

54 { 
AR5K_NOQCU_TXDP1
, 0 },

55 { 
AR5K_RXDP
, 0 },

56 { 
AR5K_CR
, 0 },

57 { 
AR5K_ISR
, 0, 
AR5K_INI_READ
 },

58 { 
AR5K_IMR
, 0 },

59 { 
AR5K_IER
, 
AR5K_IER_DISABLE
 },

60 { 
AR5K_BSR
, 0, 
AR5K_INI_READ
 },

61 { 
AR5K_TXCFG
, 
AR5K_DMASIZE_128B
 },

62 { 
AR5K_RXCFG
, 
AR5K_DMASIZE_128B
 },

63 { 
AR5K_CFG
, 
AR5K_INIT_CFG
 },

64 { 
AR5K_TOPS
, 8 },

65 { 
AR5K_RXNOFRM
, 8 },

66 { 
AR5K_RPGTO
, 0 },

67 { 
AR5K_TXNOFRM
, 0 },

68 { 
AR5K_SFR
, 0 },

69 { 
AR5K_MIBC
, 0 },

70 { 
AR5K_MISC
, 0 },

71 { 
AR5K_RX_FILTER_5210
, 0 },

72 { 
AR5K_MCAST_FILTER0_5210
, 0 },

73 { 
AR5K_MCAST_FILTER1_5210
, 0 },

74 { 
AR5K_TX_MASK0
, 0 },

75 { 
AR5K_TX_MASK1
, 0 },

76 { 
AR5K_CLR_TMASK
, 0 },

77 { 
AR5K_TRIG_LVL
, 
AR5K_TUNE_MIN_TX_FIFO_THRES
 },

78 { 
AR5K_DIAG_SW_5210
, 0 },

79 { 
AR5K_RSSI_THR
, 
AR5K_TUNE_RSSI_THRES
 },

80 { 
AR5K_TSF_L32_5210
, 0 },

81 { 
AR5K_TIMER0_5210
, 0 },

82 { 
AR5K_TIMER1_5210
, 0xffffffff },

83 { 
AR5K_TIMER2_5210
, 0xffffffff },

84 { 
AR5K_TIMER3_5210
, 1 },

85 { 
AR5K_CFP_DUR_5210
, 0 },

86 { 
AR5K_CFP_PERIOD_5210
, 0 },

88 { 
AR5K_PHY
(0), 0x00000047 },

89 { 
AR5K_PHY_AGC
, 0x00000000 },

90 { 
AR5K_PHY
(3), 0x09848ea6 },

91 { 
AR5K_PHY
(4), 0x3d32e000 },

92 { 
AR5K_PHY
(5), 0x0000076b },

93 { 
AR5K_PHY_ACT
, 
AR5K_PHY_ACT_DISABLE
 },

94 { 
AR5K_PHY
(8), 0x02020200 },

95 { 
AR5K_PHY
(9), 0x00000e0e },

96 { 
AR5K_PHY
(10), 0x0a020201 },

97 { 
AR5K_PHY
(11), 0x00036ffc },

98 { 
AR5K_PHY
(12), 0x00000000 },

99 { 
AR5K_PHY
(13), 0x00000e0e },

100 { 
AR5K_PHY
(14), 0x00000007 },

101 { 
AR5K_PHY
(15), 0x00020100 },

102 { 
AR5K_PHY
(16), 0x89630000 },

103 { 
AR5K_PHY
(17), 0x1372169c },

104 { 
AR5K_PHY
(18), 0x0018b633 },

105 { 
AR5K_PHY
(19), 0x1284613c },

106 { 
AR5K_PHY
(20), 0x0de8b8e0 },

107 { 
AR5K_PHY
(21), 0x00074859 },

108 { 
AR5K_PHY
(22), 0x7e80beba },

109 { 
AR5K_PHY
(23), 0x313a665e },

110 { 
AR5K_PHY_AGCCTL
, 0x00001d08 },

111 { 
AR5K_PHY
(25), 0x0001ce00 },

112 { 
AR5K_PHY
(26), 0x409a4190 },

113 { 
AR5K_PHY
(28), 0x0000000f },

114 { 
AR5K_PHY
(29), 0x00000080 },

115 { 
AR5K_PHY
(30), 0x00000004 },

116 { 
AR5K_PHY
(31), 0x00000018 },

117 { 
AR5K_PHY
(64), 0x00000000 },

118 { 
AR5K_PHY
(65), 0x00000000 },

119 { 
AR5K_PHY
(66), 0x00000000 },

120 { 
AR5K_PHY
(67), 0x00800000 },

121 { 
AR5K_PHY
(68), 0x00000003 },

123 { 
AR5K_BB_GAIN
(0), 0x00000000 },

124 { 
AR5K_BB_GAIN
(1), 0x00000020 },

125 { 
AR5K_BB_GAIN
(2), 0x00000010 },

126 { 
AR5K_BB_GAIN
(3), 0x00000030 },

127 { 
AR5K_BB_GAIN
(4), 0x00000008 },

128 { 
AR5K_BB_GAIN
(5), 0x00000028 },

129 { 
AR5K_BB_GAIN
(6), 0x00000028 },

130 { 
AR5K_BB_GAIN
(7), 0x00000004 },

131 { 
AR5K_BB_GAIN
(8), 0x00000024 },

132 { 
AR5K_BB_GAIN
(9), 0x00000014 },

133 { 
AR5K_BB_GAIN
(10), 0x00000034 },

134 { 
AR5K_BB_GAIN
(11), 0x0000000c },

135 { 
AR5K_BB_GAIN
(12), 0x0000002c },

136 { 
AR5K_BB_GAIN
(13), 0x00000002 },

137 { 
AR5K_BB_GAIN
(14), 0x00000022 },

138 { 
AR5K_BB_GAIN
(15), 0x00000012 },

139 { 
AR5K_BB_GAIN
(16), 0x00000032 },

140 { 
AR5K_BB_GAIN
(17), 0x0000000a },

141 { 
AR5K_BB_GAIN
(18), 0x0000002a },

142 { 
AR5K_BB_GAIN
(19), 0x00000001 },

143 { 
AR5K_BB_GAIN
(20), 0x00000021 },

144 { 
AR5K_BB_GAIN
(21), 0x00000011 },

145 { 
AR5K_BB_GAIN
(22), 0x00000031 },

146 { 
AR5K_BB_GAIN
(23), 0x00000009 },

147 { 
AR5K_BB_GAIN
(24), 0x00000029 },

148 { 
AR5K_BB_GAIN
(25), 0x00000005 },

149 { 
AR5K_BB_GAIN
(26), 0x00000025 },

150 { 
AR5K_BB_GAIN
(27), 0x00000015 },

151 { 
AR5K_BB_GAIN
(28), 0x00000035 },

152 { 
AR5K_BB_GAIN
(29), 0x0000000d },

153 { 
AR5K_BB_GAIN
(30), 0x0000002d },

154 { 
AR5K_BB_GAIN
(31), 0x00000003 },

155 { 
AR5K_BB_GAIN
(32), 0x00000023 },

156 { 
AR5K_BB_GAIN
(33), 0x00000013 },

157 { 
AR5K_BB_GAIN
(34), 0x00000033 },

158 { 
AR5K_BB_GAIN
(35), 0x0000000b },

159 { 
AR5K_BB_GAIN
(36), 0x0000002b },

160 { 
AR5K_BB_GAIN
(37), 0x00000007 },

161 { 
AR5K_BB_GAIN
(38), 0x00000027 },

162 { 
AR5K_BB_GAIN
(39), 0x00000017 },

163 { 
AR5K_BB_GAIN
(40), 0x00000037 },

164 { 
AR5K_BB_GAIN
(41), 0x0000000f },

165 { 
AR5K_BB_GAIN
(42), 0x0000002f },

166 { 
AR5K_BB_GAIN
(43), 0x0000002f },

167 { 
AR5K_BB_GAIN
(44), 0x0000002f },

168 { 
AR5K_BB_GAIN
(45), 0x0000002f },

169 { 
AR5K_BB_GAIN
(46), 0x0000002f },

170 { 
AR5K_BB_GAIN
(47), 0x0000002f },

171 { 
AR5K_BB_GAIN
(48), 0x0000002f },

172 { 
AR5K_BB_GAIN
(49), 0x0000002f },

173 { 
AR5K_BB_GAIN
(50), 0x0000002f },

174 { 
AR5K_BB_GAIN
(51), 0x0000002f },

175 { 
AR5K_BB_GAIN
(52), 0x0000002f },

176 { 
AR5K_BB_GAIN
(53), 0x0000002f },

177 { 
AR5K_BB_GAIN
(54), 0x0000002f },

178 { 
AR5K_BB_GAIN
(55), 0x0000002f },

179 { 
AR5K_BB_GAIN
(56), 0x0000002f },

180 { 
AR5K_BB_GAIN
(57), 0x0000002f },

181 { 
AR5K_BB_GAIN
(58), 0x0000002f },

182 { 
AR5K_BB_GAIN
(59), 0x0000002f },

183 { 
AR5K_BB_GAIN
(60), 0x0000002f },

184 { 
AR5K_BB_GAIN
(61), 0x0000002f },

185 { 
AR5K_BB_GAIN
(62), 0x0000002f },

186 { 
AR5K_BB_GAIN
(63), 0x0000002f },

188 { 
AR5K_RF_GAIN
(0), 0x0000001d },

189 { 
AR5K_RF_GAIN
(1), 0x0000005d },

190 { 
AR5K_RF_GAIN
(2), 0x0000009d },

191 { 
AR5K_RF_GAIN
(3), 0x000000dd },

192 { 
AR5K_RF_GAIN
(4), 0x0000011d },

193 { 
AR5K_RF_GAIN
(5), 0x00000021 },

194 { 
AR5K_RF_GAIN
(6), 0x00000061 },

195 { 
AR5K_RF_GAIN
(7), 0x000000a1 },

196 { 
AR5K_RF_GAIN
(8), 0x000000e1 },

197 { 
AR5K_RF_GAIN
(9), 0x00000031 },

198 { 
AR5K_RF_GAIN
(10), 0x00000071 },

199 { 
AR5K_RF_GAIN
(11), 0x000000b1 },

200 { 
AR5K_RF_GAIN
(12), 0x0000001c },

201 { 
AR5K_RF_GAIN
(13), 0x0000005c },

202 { 
AR5K_RF_GAIN
(14), 0x00000029 },

203 { 
AR5K_RF_GAIN
(15), 0x00000069 },

204 { 
AR5K_RF_GAIN
(16), 0x000000a9 },

205 { 
AR5K_RF_GAIN
(17), 0x00000020 },

206 { 
AR5K_RF_GAIN
(18), 0x00000019 },

207 { 
AR5K_RF_GAIN
(19), 0x00000059 },

208 { 
AR5K_RF_GAIN
(20), 0x00000099 },

209 { 
AR5K_RF_GAIN
(21), 0x00000030 },

210 { 
AR5K_RF_GAIN
(22), 0x00000005 },

211 { 
AR5K_RF_GAIN
(23), 0x00000025 },

212 { 
AR5K_RF_GAIN
(24), 0x00000065 },

213 { 
AR5K_RF_GAIN
(25), 0x000000a5 },

214 { 
AR5K_RF_GAIN
(26), 0x00000028 },

215 { 
AR5K_RF_GAIN
(27), 0x00000068 },

216 { 
AR5K_RF_GAIN
(28), 0x0000001f },

217 { 
AR5K_RF_GAIN
(29), 0x0000001e },

218 { 
AR5K_RF_GAIN
(30), 0x00000018 },

219 { 
AR5K_RF_GAIN
(31), 0x00000058 },

220 { 
AR5K_RF_GAIN
(32), 0x00000098 },

221 { 
AR5K_RF_GAIN
(33), 0x00000003 },

222 { 
AR5K_RF_GAIN
(34), 0x00000004 },

223 { 
AR5K_RF_GAIN
(35), 0x00000044 },

224 { 
AR5K_RF_GAIN
(36), 0x00000084 },

225 { 
AR5K_RF_GAIN
(37), 0x00000013 },

226 { 
AR5K_RF_GAIN
(38), 0x00000012 },

227 { 
AR5K_RF_GAIN
(39), 0x00000052 },

228 { 
AR5K_RF_GAIN
(40), 0x00000092 },

229 { 
AR5K_RF_GAIN
(41), 0x000000d2 },

230 { 
AR5K_RF_GAIN
(42), 0x0000002b },

231 { 
AR5K_RF_GAIN
(43), 0x0000002a },

232 { 
AR5K_RF_GAIN
(44), 0x0000006a },

233 { 
AR5K_RF_GAIN
(45), 0x000000aa },

234 { 
AR5K_RF_GAIN
(46), 0x0000001b },

235 { 
AR5K_RF_GAIN
(47), 0x0000001a },

236 { 
AR5K_RF_GAIN
(48), 0x0000005a },

237 { 
AR5K_RF_GAIN
(49), 0x0000009a },

238 { 
AR5K_RF_GAIN
(50), 0x000000da },

239 { 
AR5K_RF_GAIN
(51), 0x00000006 },

240 { 
AR5K_RF_GAIN
(52), 0x00000006 },

241 { 
AR5K_RF_GAIN
(53), 0x00000006 },

242 { 
AR5K_RF_GAIN
(54), 0x00000006 },

243 { 
AR5K_RF_GAIN
(55), 0x00000006 },

244 { 
AR5K_RF_GAIN
(56), 0x00000006 },

245 { 
AR5K_RF_GAIN
(57), 0x00000006 },

246 { 
AR5K_RF_GAIN
(58), 0x00000006 },

247 { 
AR5K_RF_GAIN
(59), 0x00000006 },

248 { 
AR5K_RF_GAIN
(60), 0x00000006 },

249 { 
AR5K_RF_GAIN
(61), 0x00000006 },

250 { 
AR5K_RF_GAIN
(62), 0x00000006 },

251 { 
AR5K_RF_GAIN
(63), 0x00000006 },

253 { 
AR5K_PHY
(53), 0x00000020 },

254 { 
AR5K_PHY
(51), 0x00000004 },

255 { 
AR5K_PHY
(50), 0x00060106 },

256 { 
AR5K_PHY
(39), 0x0000006d },

257 { 
AR5K_PHY
(48), 0x00000000 },

258 { 
AR5K_PHY
(52), 0x00000014 },

259 { 
AR5K_PHY_ACT
, 
AR5K_PHY_ACT_ENABLE
 },

263 c⁄° 
©h5k_öi
 
	g¨5211_öi
[] = {

264 { 
AR5K_RXDP
, 0x00000000 },

265 { 
AR5K_RTSD0
, 0x84849c9c },

266 { 
AR5K_RTSD1
, 0x7c7c7c7c },

267 { 
AR5K_RXCFG
, 0x00000005 },

268 { 
AR5K_MIBC
, 0x00000000 },

269 { 
AR5K_TOPS
, 0x00000008 },

270 { 
AR5K_RXNOFRM
, 0x00000008 },

271 { 
AR5K_TXNOFRM
, 0x00000010 },

272 { 
AR5K_RPGTO
, 0x00000000 },

273 { 
AR5K_RFCNT
, 0x0000001f },

274 { 
AR5K_QUEUE_TXDP
(0), 0x00000000 },

275 { 
AR5K_QUEUE_TXDP
(1), 0x00000000 },

276 { 
AR5K_QUEUE_TXDP
(2), 0x00000000 },

277 { 
AR5K_QUEUE_TXDP
(3), 0x00000000 },

278 { 
AR5K_QUEUE_TXDP
(4), 0x00000000 },

279 { 
AR5K_QUEUE_TXDP
(5), 0x00000000 },

280 { 
AR5K_QUEUE_TXDP
(6), 0x00000000 },

281 { 
AR5K_QUEUE_TXDP
(7), 0x00000000 },

282 { 
AR5K_QUEUE_TXDP
(8), 0x00000000 },

283 { 
AR5K_QUEUE_TXDP
(9), 0x00000000 },

284 { 
AR5K_DCU_FP
, 0x00000000 },

285 { 
AR5K_STA_ID1
, 0x00000000 },

286 { 
AR5K_BSS_ID0
, 0x00000000 },

287 { 
AR5K_BSS_ID1
, 0x00000000 },

288 { 
AR5K_RSSI_THR
, 0x00000000 },

289 { 
AR5K_CFP_PERIOD_5211
, 0x00000000 },

290 { 
AR5K_TIMER0_5211
, 0x00000030 },

291 { 
AR5K_TIMER1_5211
, 0x0007ffff },

292 { 
AR5K_TIMER2_5211
, 0x01ffffff },

293 { 
AR5K_TIMER3_5211
, 0x00000031 },

294 { 
AR5K_CFP_DUR_5211
, 0x00000000 },

295 { 
AR5K_RX_FILTER_5211
, 0x00000000 },

296 { 
AR5K_MCAST_FILTER0_5211
, 0x00000000 },

297 { 
AR5K_MCAST_FILTER1_5211
, 0x00000002 },

298 { 
AR5K_DIAG_SW_5211
, 0x00000000 },

299 { 
AR5K_ADDAC_TEST
, 0x00000000 },

300 { 
AR5K_DEFAULT_ANTENNA
, 0x00000000 },

302 { 
AR5K_PHY_AGC
, 0x00000000 },

303 { 
AR5K_PHY
(3), 0x2d849093 },

304 { 
AR5K_PHY
(4), 0x7d32e000 },

305 { 
AR5K_PHY
(5), 0x00000f6b },

306 { 
AR5K_PHY_ACT
, 0x00000000 },

307 { 
AR5K_PHY
(11), 0x00026ffe },

308 { 
AR5K_PHY
(12), 0x00000000 },

309 { 
AR5K_PHY
(15), 0x00020100 },

310 { 
AR5K_PHY
(16), 0x206a017a },

311 { 
AR5K_PHY
(19), 0x1284613c },

312 { 
AR5K_PHY
(21), 0x00000859 },

313 { 
AR5K_PHY
(26), 0x409a4190 },

314 { 
AR5K_PHY
(27), 0x050cb081 },

315 { 
AR5K_PHY
(28), 0x0000000f },

316 { 
AR5K_PHY
(29), 0x00000080 },

317 { 
AR5K_PHY
(30), 0x0000000c },

318 { 
AR5K_PHY
(64), 0x00000000 },

319 { 
AR5K_PHY
(65), 0x00000000 },

320 { 
AR5K_PHY
(66), 0x00000000 },

321 { 
AR5K_PHY
(67), 0x00800000 },

322 { 
AR5K_PHY
(68), 0x00000001 },

323 { 
AR5K_PHY
(71), 0x0000092a },

324 { 
AR5K_PHY_IQ
, 0x00000000 },

325 { 
AR5K_PHY
(73), 0x00058a05 },

326 { 
AR5K_PHY
(74), 0x00000001 },

327 { 
AR5K_PHY
(75), 0x00000000 },

328 { 
AR5K_PHY_PAPD_PROBE
, 0x00000000 },

329 { 
AR5K_PHY
(77), 0x00000000 },

330 { 
AR5K_PHY
(78), 0x00000000 },

331 { 
AR5K_PHY
(79), 0x0000003f },

332 { 
AR5K_PHY
(80), 0x00000004 },

333 { 
AR5K_PHY
(82), 0x00000000 },

334 { 
AR5K_PHY
(83), 0x00000000 },

335 { 
AR5K_PHY
(84), 0x00000000 },

336 { 
AR5K_PHY_RADAR
, 0x5d50f14c },

337 { 
AR5K_PHY
(86), 0x00000018 },

338 { 
AR5K_PHY
(87), 0x004b6a8e },

344 { 
AR5K_PHY_PCDAC_TXPOWER
(1), 0x06ff05ff },

345 { 
AR5K_PHY_PCDAC_TXPOWER
(2), 0x07ff07ff },

346 { 
AR5K_PHY_PCDAC_TXPOWER
(3), 0x08ff08ff },

347 { 
AR5K_PHY_PCDAC_TXPOWER
(4), 0x09ff09ff },

348 { 
AR5K_PHY_PCDAC_TXPOWER
(5), 0x0aff0aff },

349 { 
AR5K_PHY_PCDAC_TXPOWER
(6), 0x0bff0bff },

350 { 
AR5K_PHY_PCDAC_TXPOWER
(7), 0x0cff0cff },

351 { 
AR5K_PHY_PCDAC_TXPOWER
(8), 0x0dff0dff },

352 { 
AR5K_PHY_PCDAC_TXPOWER
(9), 0x0fff0eff },

353 { 
AR5K_PHY_PCDAC_TXPOWER
(10), 0x12ff12ff },

354 { 
AR5K_PHY_PCDAC_TXPOWER
(11), 0x14ff13ff },

355 { 
AR5K_PHY_PCDAC_TXPOWER
(12), 0x16ff15ff },

356 { 
AR5K_PHY_PCDAC_TXPOWER
(13), 0x19ff17ff },

357 { 
AR5K_PHY_PCDAC_TXPOWER
(14), 0x1bff1aff },

358 { 
AR5K_PHY_PCDAC_TXPOWER
(15), 0x1eff1dff },

359 { 
AR5K_PHY_PCDAC_TXPOWER
(16), 0x23ff20ff },

360 { 
AR5K_PHY_PCDAC_TXPOWER
(17), 0x27ff25ff },

361 { 
AR5K_PHY_PCDAC_TXPOWER
(18), 0x2cff29ff },

362 { 
AR5K_PHY_PCDAC_TXPOWER
(19), 0x31ff2fff },

363 { 
AR5K_PHY_PCDAC_TXPOWER
(20), 0x37ff34ff },

364 { 
AR5K_PHY_PCDAC_TXPOWER
(21), 0x3aff3aff },

365 { 
AR5K_PHY_PCDAC_TXPOWER
(22), 0x3aff3aff },

366 { 
AR5K_PHY_PCDAC_TXPOWER
(23), 0x3aff3aff },

367 { 
AR5K_PHY_PCDAC_TXPOWER
(24), 0x3aff3aff },

368 { 
AR5K_PHY_PCDAC_TXPOWER
(25), 0x3aff3aff },

369 { 
AR5K_PHY_PCDAC_TXPOWER
(26), 0x3aff3aff },

370 { 
AR5K_PHY_PCDAC_TXPOWER
(27), 0x3aff3aff },

371 { 
AR5K_PHY_PCDAC_TXPOWER
(28), 0x3aff3aff },

372 { 
AR5K_PHY_PCDAC_TXPOWER
(29), 0x3aff3aff },

373 { 
AR5K_PHY_PCDAC_TXPOWER
(30), 0x3aff3aff },

374 { 
AR5K_PHY_PCDAC_TXPOWER
(31), 0x3aff3aff },

375 { 
AR5K_PHY_CCKTXCTL
, 0x00000000 },

376 { 
AR5K_PHY
(642), 0x503e4646 },

377 { 
AR5K_PHY_GAIN_2GHZ
, 0x6480416c },

378 { 
AR5K_PHY
(644), 0x0199a003 },

379 { 
AR5K_PHY
(645), 0x044cd610 },

380 { 
AR5K_PHY
(646), 0x13800040 },

381 { 
AR5K_PHY
(647), 0x1be00060 },

382 { 
AR5K_PHY
(648), 0x0c53800a },

383 { 
AR5K_PHY
(649), 0x0014df3b },

384 { 
AR5K_PHY
(650), 0x000001b5 },

385 { 
AR5K_PHY
(651), 0x00000020 },

392 c⁄° 
©h5k_öi_mode
 
	g¨5211_öi_mode
[] = {

393 { 
AR5K_TXCFG
,

396 { 
AR5K_QUEUE_DFS_LOCAL_IFS
(0),

398 { 
AR5K_QUEUE_DFS_LOCAL_IFS
(1),

400 { 
AR5K_QUEUE_DFS_LOCAL_IFS
(2),

402 { 
AR5K_QUEUE_DFS_LOCAL_IFS
(3),

404 { 
AR5K_QUEUE_DFS_LOCAL_IFS
(4),

406 { 
AR5K_QUEUE_DFS_LOCAL_IFS
(5),

408 { 
AR5K_QUEUE_DFS_LOCAL_IFS
(6),

410 { 
AR5K_QUEUE_DFS_LOCAL_IFS
(7),

412 { 
AR5K_QUEUE_DFS_LOCAL_IFS
(8),

414 { 
AR5K_QUEUE_DFS_LOCAL_IFS
(9),

416 { 
AR5K_DCU_GBL_IFS_SLOT
,

418 { 
AR5K_DCU_GBL_IFS_SIFS
,

420 { 
AR5K_DCU_GBL_IFS_EIFS
,

422 { 
AR5K_DCU_GBL_IFS_MISC
,

424 { 
AR5K_TIME_OUT
,

426 { 
AR5K_USEC_5211
,

428 { 
AR5K_PHY
(8),

430 { 
AR5K_PHY_RF_CTL2
,

432 { 
AR5K_PHY_RF_CTL3
,

434 { 
AR5K_PHY_RF_CTL4
,

436 { 
AR5K_PHY_PA_CTL
,

438 { 
AR5K_PHY_SETTLING
,

440 { 
AR5K_PHY_GAIN
,

442 { 
AR5K_PHY_DESIRED_SIZE
,

444 { 
AR5K_PHY_SIG
,

446 { 
AR5K_PHY_AGCCOARSE
,

448 { 
AR5K_PHY_AGCCTL
,

450 { 
AR5K_PHY_NF
,

452 { 
AR5K_PHY_RX_DELAY
,

454 { 
AR5K_PHY
(70),

456 { 
AR5K_PHY_FRAME_CTL_5211
,

458 { 
AR5K_PHY_PCDAC_TXPOWER_BASE
,

460 { 
AR5K_RF_BUFFER_CONTROL_4
,

465 c⁄° 
©h5k_öi
 
	g¨5212_öi_comm⁄_°¨t
[] = {

466 { 
AR5K_RXDP
, 0x00000000 },

467 { 
AR5K_RXCFG
, 0x00000005 },

468 { 
AR5K_MIBC
, 0x00000000 },

469 { 
AR5K_TOPS
, 0x00000008 },

470 { 
AR5K_RXNOFRM
, 0x00000008 },

471 { 
AR5K_TXNOFRM
, 0x00000010 },

472 { 
AR5K_RPGTO
, 0x00000000 },

473 { 
AR5K_RFCNT
, 0x0000001f },

474 { 
AR5K_QUEUE_TXDP
(0), 0x00000000 },

475 { 
AR5K_QUEUE_TXDP
(1), 0x00000000 },

476 { 
AR5K_QUEUE_TXDP
(2), 0x00000000 },

477 { 
AR5K_QUEUE_TXDP
(3), 0x00000000 },

478 { 
AR5K_QUEUE_TXDP
(4), 0x00000000 },

479 { 
AR5K_QUEUE_TXDP
(5), 0x00000000 },

480 { 
AR5K_QUEUE_TXDP
(6), 0x00000000 },

481 { 
AR5K_QUEUE_TXDP
(7), 0x00000000 },

482 { 
AR5K_QUEUE_TXDP
(8), 0x00000000 },

483 { 
AR5K_QUEUE_TXDP
(9), 0x00000000 },

484 { 
AR5K_DCU_FP
, 0x00000000 },

485 { 
AR5K_DCU_TXP
, 0x00000000 },

487 { 
AR5K_DCU_TX_FILTER_0
(0), 0x00000000 },

488 { 
AR5K_DCU_TX_FILTER_0
(1), 0x00000000 },

489 { 
AR5K_DCU_TX_FILTER_0
(2), 0x00000000 },

490 { 
AR5K_DCU_TX_FILTER_0
(3), 0x00000000 },

491 { 
AR5K_DCU_TX_FILTER_0
(4), 0x00000000 },

492 { 
AR5K_DCU_TX_FILTER_0
(5), 0x00000000 },

493 { 
AR5K_DCU_TX_FILTER_0
(6), 0x00000000 },

494 { 
AR5K_DCU_TX_FILTER_0
(7), 0x00000000 },

495 { 
AR5K_DCU_TX_FILTER_0
(8), 0x00000000 },

496 { 
AR5K_DCU_TX_FILTER_0
(9), 0x00000000 },

497 { 
AR5K_DCU_TX_FILTER_0
(10), 0x00000000 },

498 { 
AR5K_DCU_TX_FILTER_0
(11), 0x00000000 },

499 { 
AR5K_DCU_TX_FILTER_0
(12), 0x00000000 },

500 { 
AR5K_DCU_TX_FILTER_0
(13), 0x00000000 },

501 { 
AR5K_DCU_TX_FILTER_0
(14), 0x00000000 },

502 { 
AR5K_DCU_TX_FILTER_0
(15), 0x00000000 },

503 { 
AR5K_DCU_TX_FILTER_0
(16), 0x00000000 },

504 { 
AR5K_DCU_TX_FILTER_0
(17), 0x00000000 },

505 { 
AR5K_DCU_TX_FILTER_0
(18), 0x00000000 },

506 { 
AR5K_DCU_TX_FILTER_0
(19), 0x00000000 },

507 { 
AR5K_DCU_TX_FILTER_0
(20), 0x00000000 },

508 { 
AR5K_DCU_TX_FILTER_0
(21), 0x00000000 },

509 { 
AR5K_DCU_TX_FILTER_0
(22), 0x00000000 },

510 { 
AR5K_DCU_TX_FILTER_0
(23), 0x00000000 },

511 { 
AR5K_DCU_TX_FILTER_0
(24), 0x00000000 },

512 { 
AR5K_DCU_TX_FILTER_0
(25), 0x00000000 },

513 { 
AR5K_DCU_TX_FILTER_0
(26), 0x00000000 },

514 { 
AR5K_DCU_TX_FILTER_0
(27), 0x00000000 },

515 { 
AR5K_DCU_TX_FILTER_0
(28), 0x00000000 },

516 { 
AR5K_DCU_TX_FILTER_0
(29), 0x00000000 },

517 { 
AR5K_DCU_TX_FILTER_0
(30), 0x00000000 },

518 { 
AR5K_DCU_TX_FILTER_0
(31), 0x00000000 },

520 { 
AR5K_DCU_TX_FILTER_1
(0), 0x00000000 },

521 { 
AR5K_DCU_TX_FILTER_1
(1), 0x00000000 },

522 { 
AR5K_DCU_TX_FILTER_1
(2), 0x00000000 },

523 { 
AR5K_DCU_TX_FILTER_1
(3), 0x00000000 },

524 { 
AR5K_DCU_TX_FILTER_1
(4), 0x00000000 },

525 { 
AR5K_DCU_TX_FILTER_1
(5), 0x00000000 },

526 { 
AR5K_DCU_TX_FILTER_1
(6), 0x00000000 },

527 { 
AR5K_DCU_TX_FILTER_1
(7), 0x00000000 },

528 { 
AR5K_DCU_TX_FILTER_1
(8), 0x00000000 },

529 { 
AR5K_DCU_TX_FILTER_1
(9), 0x00000000 },

530 { 
AR5K_DCU_TX_FILTER_1
(10), 0x00000000 },

531 { 
AR5K_DCU_TX_FILTER_1
(11), 0x00000000 },

532 { 
AR5K_DCU_TX_FILTER_1
(12), 0x00000000 },

533 { 
AR5K_DCU_TX_FILTER_1
(13), 0x00000000 },

534 { 
AR5K_DCU_TX_FILTER_1
(14), 0x00000000 },

535 { 
AR5K_DCU_TX_FILTER_1
(15), 0x00000000 },

536 { 
AR5K_DCU_TX_FILTER_CLR
, 0x00000000 },

537 { 
AR5K_DCU_TX_FILTER_SET
, 0x00000000 },

538 { 
AR5K_STA_ID1
, 0x00000000 },

539 { 
AR5K_BSS_ID0
, 0x00000000 },

540 { 
AR5K_BSS_ID1
, 0x00000000 },

541 { 
AR5K_BEACON_5211
, 0x00000000 },

542 { 
AR5K_CFP_PERIOD_5211
, 0x00000000 },

543 { 
AR5K_TIMER0_5211
, 0x00000030 },

544 { 
AR5K_TIMER1_5211
, 0x0007ffff },

545 { 
AR5K_TIMER2_5211
, 0x01ffffff },

546 { 
AR5K_TIMER3_5211
, 0x00000031 },

547 { 
AR5K_CFP_DUR_5211
, 0x00000000 },

548 { 
AR5K_RX_FILTER_5211
, 0x00000000 },

549 { 
AR5K_DIAG_SW_5211
, 0x00000000 },

550 { 
AR5K_ADDAC_TEST
, 0x00000000 },

551 { 
AR5K_DEFAULT_ANTENNA
, 0x00000000 },

552 { 
AR5K_FRAME_CTL_QOSM
, 0x000fc78f },

553 { 
AR5K_XRMODE
, 0x2a82301a },

554 { 
AR5K_XRDELAY
, 0x05dc01e0 },

555 { 
AR5K_XRTIMEOUT
, 0x1f402710 },

556 { 
AR5K_XRCHIRP
, 0x01f40000 },

557 { 
AR5K_XRSTOMP
, 0x00001e1c },

558 { 
AR5K_SLEEP0
, 0x0002aaaa },

559 { 
AR5K_SLEEP1
, 0x02005555 },

560 { 
AR5K_SLEEP2
, 0x00000000 },

561 { 
AR_BSSMSKL
, 0xffffffff },

562 { 
AR_BSSMSKU
, 0x0000ffff },

563 { 
AR5K_TXPC
, 0x00000000 },

564 { 
AR5K_PROFCNT_TX
, 0x00000000 },

565 { 
AR5K_PROFCNT_RX
, 0x00000000 },

566 { 
AR5K_PROFCNT_RXCLR
, 0x00000000 },

567 { 
AR5K_PROFCNT_CYCLE
, 0x00000000 },

568 { 
AR5K_QUIET_CTL1
, 0x00000088 },

570 { 
AR5K_RATE_DUR
(0), 0x00000000 },

571 { 
AR5K_RATE_DUR
(1), 0x0000008c },

572 { 
AR5K_RATE_DUR
(2), 0x000000e4 },

573 { 
AR5K_RATE_DUR
(3), 0x000002d5 },

574 { 
AR5K_RATE_DUR
(4), 0x00000000 },

575 { 
AR5K_RATE_DUR
(5), 0x00000000 },

576 { 
AR5K_RATE_DUR
(6), 0x000000a0 },

577 { 
AR5K_RATE_DUR
(7), 0x000001c9 },

578 { 
AR5K_RATE_DUR
(8), 0x0000002c },

579 { 
AR5K_RATE_DUR
(9), 0x0000002c },

580 { 
AR5K_RATE_DUR
(10), 0x00000030 },

581 { 
AR5K_RATE_DUR
(11), 0x0000003c },

582 { 
AR5K_RATE_DUR
(12), 0x0000002c },

583 { 
AR5K_RATE_DUR
(13), 0x0000002c },

584 { 
AR5K_RATE_DUR
(14), 0x00000030 },

585 { 
AR5K_RATE_DUR
(15), 0x0000003c },

586 { 
AR5K_RATE_DUR
(16), 0x00000000 },

587 { 
AR5K_RATE_DUR
(17), 0x00000000 },

588 { 
AR5K_RATE_DUR
(18), 0x00000000 },

589 { 
AR5K_RATE_DUR
(19), 0x00000000 },

590 { 
AR5K_RATE_DUR
(20), 0x00000000 },

591 { 
AR5K_RATE_DUR
(21), 0x00000000 },

592 { 
AR5K_RATE_DUR
(22), 0x00000000 },

593 { 
AR5K_RATE_DUR
(23), 0x00000000 },

594 { 
AR5K_RATE_DUR
(24), 0x000000d5 },

595 { 
AR5K_RATE_DUR
(25), 0x000000df },

596 { 
AR5K_RATE_DUR
(26), 0x00000102 },

597 { 
AR5K_RATE_DUR
(27), 0x0000013a },

598 { 
AR5K_RATE_DUR
(28), 0x00000075 },

599 { 
AR5K_RATE_DUR
(29), 0x0000007f },

600 { 
AR5K_RATE_DUR
(30), 0x000000a2 },

601 { 
AR5K_RATE_DUR
(31), 0x00000000 },

602 { 
AR5K_QUIET_CTL2
, 0x00010002 },

603 { 
AR5K_TSF_PARM
, 0x00000001 },

604 { 
AR5K_QOS_NOACK
, 0x000000c0 },

605 { 
AR5K_PHY_ERR_FIL
, 0x00000000 },

606 { 
AR5K_XRLAT_TX
, 0x00000168 },

607 { 
AR5K_ACKSIFS
, 0x00000000 },

610 { 
AR5K_RATE2DB
(0), 0x03020100 },

611 { 
AR5K_RATE2DB
(1), 0x07060504 },

612 { 
AR5K_RATE2DB
(2), 0x0b0a0908 },

613 { 
AR5K_RATE2DB
(3), 0x0f0e0d0c },

614 { 
AR5K_RATE2DB
(4), 0x13121110 },

615 { 
AR5K_RATE2DB
(5), 0x17161514 },

616 { 
AR5K_RATE2DB
(6), 0x1b1a1918 },

617 { 
AR5K_RATE2DB
(7), 0x1f1e1d1c },

619 { 
AR5K_DB2RATE
(0), 0x03020100 },

620 { 
AR5K_DB2RATE
(1), 0x07060504 },

621 { 
AR5K_DB2RATE
(2), 0x0b0a0908 },

622 { 
AR5K_DB2RATE
(3), 0x0f0e0d0c },

623 { 
AR5K_DB2RATE
(4), 0x13121110 },

624 { 
AR5K_DB2RATE
(5), 0x17161514 },

625 { 
AR5K_DB2RATE
(6), 0x1b1a1918 },

626 { 
AR5K_DB2RATE
(7), 0x1f1e1d1c },

629 { 
AR5K_PHY
(3), 0xad848e19 },

630 { 
AR5K_PHY
(4), 0x7d28e000 },

631 { 
AR5K_PHY_TIMING_3
, 0x9c0a9f6b },

632 { 
AR5K_PHY_ACT
, 0x00000000 },

633 { 
AR5K_PHY
(16), 0x206a017a },

634 { 
AR5K_PHY
(21), 0x00000859 },

635 { 
AR5K_PHY_BIN_MASK_1
, 0x00000000 },

636 { 
AR5K_PHY_BIN_MASK_2
, 0x00000000 },

637 { 
AR5K_PHY_BIN_MASK_3
, 0x00000000 },

638 { 
AR5K_PHY_BIN_MASK_CTL
, 0x00800000 },

639 { 
AR5K_PHY_ANT_CTL
, 0x00000001 },

641 { 
AR5K_PHY_MAX_RX_LEN
, 0x00000c80 },

642 { 
AR5K_PHY_IQ
, 0x05100000 },

643 { 
AR5K_PHY_WARM_RESET
, 0x00000001 },

644 { 
AR5K_PHY_CTL
, 0x00000004 },

645 { 
AR5K_PHY_TXPOWER_RATE1
, 0x1e1f2022 },

646 { 
AR5K_PHY_TXPOWER_RATE2
, 0x0a0b0c0d },

647 { 
AR5K_PHY_TXPOWER_RATE_MAX
, 0x0000003f },

648 { 
AR5K_PHY
(82), 0x9280b212 },

649 { 
AR5K_PHY_RADAR
, 0x5d50e188 },

651 { 
AR5K_PHY
(87), 0x004b6a8e },

652 { 
AR5K_PHY_NFTHRES
, 0x000003ce },

653 { 
AR5K_PHY_RESTART
, 0x192fb515 },

654 { 
AR5K_PHY
(94), 0x00000001 },

655 { 
AR5K_PHY_RFBUS_REQ
, 0x00000000 },

658 { 
AR5K_PHY
(644), 0x00806333 },

659 { 
AR5K_PHY
(645), 0x00106c10 },

660 { 
AR5K_PHY
(646), 0x009c4060 },

663 { 
AR5K_PHY
(648), 0x018830c6 },

664 { 
AR5K_PHY
(649), 0x00000400 },

666 { 
AR5K_PHY
(651), 0x00000000 },

667 { 
AR5K_PHY_TXPOWER_RATE3
, 0x20202020 },

668 { 
AR5K_PHY_TXPOWER_RATE4
, 0x20202020 },

670 { 
AR5K_PHY
(656), 0x38490a20 },

671 { 
AR5K_PHY
(657), 0x00007bb6 },

672 { 
AR5K_PHY
(658), 0x0fff3ffc },

676 c⁄° 
©h5k_öi_mode
 
	g¨5212_öi_mode_°¨t
[] = {

677 { 
AR5K_QUEUE_DFS_LOCAL_IFS
(0),

680 { 
AR5K_QUEUE_DFS_LOCAL_IFS
(1),

682 { 
AR5K_QUEUE_DFS_LOCAL_IFS
(2),

684 { 
AR5K_QUEUE_DFS_LOCAL_IFS
(3),

686 { 
AR5K_QUEUE_DFS_LOCAL_IFS
(4),

688 { 
AR5K_QUEUE_DFS_LOCAL_IFS
(5),

690 { 
AR5K_QUEUE_DFS_LOCAL_IFS
(6),

692 { 
AR5K_QUEUE_DFS_LOCAL_IFS
(7),

694 { 
AR5K_QUEUE_DFS_LOCAL_IFS
(8),

696 { 
AR5K_QUEUE_DFS_LOCAL_IFS
(9),

698 { 
AR5K_DCU_GBL_IFS_SIFS
,

700 { 
AR5K_DCU_GBL_IFS_SLOT
,

702 { 
AR5K_DCU_GBL_IFS_EIFS
,

704 { 
AR5K_DCU_GBL_IFS_MISC
,

706 { 
AR5K_TIME_OUT
,

708 { 
AR5K_PHY
(8),

710 { 
AR5K_PHY_RF_CTL2
,

712 { 
AR5K_PHY_SETTLING
,

714 { 
AR5K_PHY_AGCCTL
,

716 { 
AR5K_PHY_NF
,

718 { 
AR5K_PHY_WEAK_OFDM_HIGH_THR
,

720 { 
AR5K_PHY
(70),

722 { 
AR5K_PHY_OFDM_SELFCORR
,

729 c⁄° 
©h5k_öi_mode
 
	grf5111_öi_mode_íd
[] = {

730 { 
AR5K_TXCFG
,

733 { 
AR5K_USEC_5211
,

735 { 
AR5K_PHY_RF_CTL3
,

737 { 
AR5K_PHY_RF_CTL4
,

739 { 
AR5K_PHY_PA_CTL
,

741 { 
AR5K_PHY_GAIN
,

743 { 
AR5K_PHY_DESIRED_SIZE
,

745 { 
AR5K_PHY_SIG
,

747 { 
AR5K_PHY_AGCCOARSE
,

749 { 
AR5K_PHY_WEAK_OFDM_LOW_THR
,

751 { 
AR5K_PHY_RX_DELAY
,

753 { 
AR5K_PHY_FRAME_CTL_5211
,

755 { 
AR5K_PHY_GAIN_2GHZ
,

757 { 
AR5K_PHY_CCK_RX_CTL_4
,

761 c⁄° 
©h5k_öi
 
	grf5111_öi_comm⁄_íd
[] = {

762 { 
AR5K_DCU_FP
, 0x00000000 },

763 { 
AR5K_PHY_AGC
, 0x00000000 },

764 { 
AR5K_PHY_ADC_CTL
, 0x00022ffe },

766 { 
AR5K_PHY_GAIN_OFFSET
, 0x1284613c },

767 { 
AR5K_PHY_PAPD_PROBE
, 0x00004883 },

771 { 
AR5K_PHY_SPENDING
, 0x00000018 },

772 { 
AR5K_PHY_CCKTXCTL
, 0x00000000 },

773 { 
AR5K_PHY_CCK_CROSSCORR
, 0xd03e6788 },

774 { 
AR5K_PHY_DAG_CCK_CTL
, 0x000001b5 },

779 c⁄° 
©h5k_öi_mode
 
	grf5112_öi_mode_íd
[] = {

780 { 
AR5K_TXCFG
,

783 { 
AR5K_USEC_5211
,

785 { 
AR5K_PHY_RF_CTL3
,

787 { 
AR5K_PHY_RF_CTL4
,

789 { 
AR5K_PHY_PA_CTL
,

791 { 
AR5K_PHY_GAIN
,

793 { 
AR5K_PHY_DESIRED_SIZE
,

795 { 
AR5K_PHY_SIG
,

797 { 
AR5K_PHY_AGCCOARSE
,

799 { 
AR5K_PHY_WEAK_OFDM_LOW_THR
,

801 { 
AR5K_PHY_RX_DELAY
,

803 { 
AR5K_PHY_FRAME_CTL_5211
,

805 { 
AR5K_PHY_CCKTXCTL
,

807 { 
AR5K_PHY_CCK_CROSSCORR
,

809 { 
AR5K_PHY_GAIN_2GHZ
,

811 { 
AR5K_PHY_CCK_RX_CTL_4
,

815 c⁄° 
©h5k_öi
 
	grf5112_öi_comm⁄_íd
[] = {

816 { 
AR5K_DCU_FP
, 0x00000000 },

817 { 
AR5K_PHY_AGC
, 0x00000000 },

818 { 
AR5K_PHY_ADC_CTL
, 0x00022ffe },

820 { 
AR5K_PHY_GAIN_OFFSET
, 0x1284613c },

821 { 
AR5K_PHY_PAPD_PROBE
, 0x00004882 },

825 { 
AR5K_PHY_DAG_CCK_CTL
, 0x000001b5 },

830 c⁄° 
©h5k_öi_mode
 
	grf5413_öi_mode_íd
[] = {

831 { 
AR5K_TXCFG
,

834 { 
AR5K_USEC_5211
,

836 { 
AR5K_PHY_RF_CTL3
,

838 { 
AR5K_PHY_RF_CTL4
,

840 { 
AR5K_PHY_PA_CTL
,

842 { 
AR5K_PHY_GAIN
,

844 { 
AR5K_PHY_DESIRED_SIZE
,

846 { 
AR5K_PHY_SIG
,

848 { 
AR5K_PHY_AGCCOARSE
,

850 { 
AR5K_PHY_WEAK_OFDM_LOW_THR
,

852 { 
AR5K_PHY_RX_DELAY
,

854 { 
AR5K_PHY_FRAME_CTL_5211
,

856 { 
AR5K_PHY_CCKTXCTL
,

858 { 
AR5K_PHY_CCK_CROSSCORR
,

860 { 
AR5K_PHY_GAIN_2GHZ
,

862 { 
AR5K_PHY_CCK_RX_CTL_4
,

894 c⁄° 
©h5k_öi
 
	grf5413_öi_comm⁄_íd
[] = {

895 { 
AR5K_DCU_FP
, 0x000003e0 },

896 { 
AR5K_5414_CBCFG
, 0x00000010 },

897 { 
AR5K_SEQ_MASK
, 0x0000000f },

900 { 
AR5K_MIC_QOS_CTL
, 0x00000000 },

901 { 
AR5K_MIC_QOS_SEL
, 0x00000000 },

902 { 
AR5K_MISC_MODE
, 0x00000000 },

903 { 
AR5K_OFDM_FIL_CNT
, 0x00000000 },

904 { 
AR5K_CCK_FIL_CNT
, 0x00000000 },

905 { 
AR5K_PHYERR_CNT1
, 0x00000000 },

906 { 
AR5K_PHYERR_CNT1_MASK
, 0x00000000 },

907 { 
AR5K_PHYERR_CNT2
, 0x00000000 },

908 { 
AR5K_PHYERR_CNT2_MASK
, 0x00000000 },

909 { 
AR5K_TSF_THRES
, 0x00000000 },

912 { 
AR5K_PHY_AGC
, 0x00000000 },

913 { 
AR5K_PHY_ADC_CTL
, 0x0000a000 },

915 { 
AR5K_PHY_GAIN_OFFSET
, 0x1284233c },

916 { 
AR5K_PHY_SCR
, 0x0000001f },

917 { 
AR5K_PHY_SLMT
, 0x00000080 },

918 { 
AR5K_PHY_SCAL
, 0x0000000e },

920 { 
AR5K_PHY_TIMING_7
, 0x00000000 },

921 { 
AR5K_PHY_TIMING_8
, 0x02800000 },

922 { 
AR5K_PHY_TIMING_11
, 0x00000000 },

923 { 
AR5K_PHY_HEAVY_CLIP_ENABLE
, 0x00000000 },

927 { 
AR5K_PHY_SCLOCK
, 0x0000000c },

928 { 
AR5K_PHY_SDELAY
, 0x000000ff },

929 { 
AR5K_PHY_SPENDING
, 0x00000014 },

930 { 
AR5K_PHY_DAG_CCK_CTL
, 0x000009b5 },

932 { 
AR5K_PHY_FAST_ADC
, 0x00000001 },

934 { 
AR5K_PHY_BLUETOOTH
, 0x00000000 },

935 { 
AR5K_PHY_TPC_RG1
, 0x0cc75380 },

940 { 
AR5K_PHY_TPC_RG5
, 0x0c30c16a },

969 c⁄° 
©h5k_öi_mode
 
	grf2413_öi_mode_íd
[] = {

970 { 
AR5K_TXCFG
,

973 { 
AR5K_USEC_5211
,

975 { 
AR5K_PHY_RF_CTL3
,

977 { 
AR5K_PHY_RF_CTL4
,

979 { 
AR5K_PHY_PA_CTL
,

981 { 
AR5K_PHY_GAIN
,

983 { 
AR5K_PHY_DESIRED_SIZE
,

985 { 
AR5K_PHY_SIG
,

987 { 
AR5K_PHY_AGCCOARSE
,

989 { 
AR5K_PHY_WEAK_OFDM_LOW_THR
,

991 { 
AR5K_PHY_RX_DELAY
,

993 { 
AR5K_PHY_FRAME_CTL_5211
,

995 { 
AR5K_PHY_CCKTXCTL
,

997 { 
AR5K_PHY_CCK_CROSSCORR
,

999 { 
AR5K_PHY_GAIN_2GHZ
,

1001 { 
AR5K_PHY_CCK_RX_CTL_4
,

1005 c⁄° 
©h5k_öi
 
	grf2413_öi_comm⁄_íd
[] = {

1006 { 
AR5K_DCU_FP
, 0x000003e0 },

1007 { 
AR5K_SEQ_MASK
, 0x0000000f },

1008 { 
AR5K_MIC_QOS_CTL
, 0x00000000 },

1009 { 
AR5K_MIC_QOS_SEL
, 0x00000000 },

1010 { 
AR5K_MISC_MODE
, 0x00000000 },

1011 { 
AR5K_OFDM_FIL_CNT
, 0x00000000 },

1012 { 
AR5K_CCK_FIL_CNT
, 0x00000000 },

1013 { 
AR5K_PHYERR_CNT1
, 0x00000000 },

1014 { 
AR5K_PHYERR_CNT1_MASK
, 0x00000000 },

1015 { 
AR5K_PHYERR_CNT2
, 0x00000000 },

1016 { 
AR5K_PHYERR_CNT2_MASK
, 0x00000000 },

1017 { 
AR5K_TSF_THRES
, 0x00000000 },

1020 { 
AR5K_PHY_AGC
, 0x00000000 },

1021 { 
AR5K_PHY_ADC_CTL
, 0x0000a000 },

1023 { 
AR5K_PHY_GAIN_OFFSET
, 0x1284233c },

1024 { 
AR5K_PHY_SCR
, 0x0000001f },

1025 { 
AR5K_PHY_SLMT
, 0x00000080 },

1026 { 
AR5K_PHY_SCAL
, 0x0000000e },

1028 { 
AR5K_PHY_TIMING_7
, 0x00000000 },

1029 { 
AR5K_PHY_TIMING_8
, 0x02800000 },

1030 { 
AR5K_PHY_TIMING_11
, 0x00000000 },

1031 { 
AR5K_PHY_HEAVY_CLIP_ENABLE
, 0x00000000 },

1035 { 
AR5K_PHY_SCLOCK
, 0x0000000c },

1036 { 
AR5K_PHY_SDELAY
, 0x000000ff },

1037 { 
AR5K_PHY_SPENDING
, 0x00000014 },

1038 { 
AR5K_PHY_DAG_CCK_CTL
, 0x000009b5 },

1040 { 
AR5K_PHY_FAST_ADC
, 0x00000001 },

1042 { 
AR5K_PHY_BLUETOOTH
, 0x00000000 },

1043 { 
AR5K_PHY_TPC_RG1
, 0x0cc75380 },

1048 { 
AR5K_PHY_TPC_RG5
, 0x0c30c16a },

1091 c⁄° 
©h5k_öi_mode
 
	grf2425_öi_mode_íd
[] = {

1092 { 
AR5K_TXCFG
,

1095 { 
AR5K_USEC_5211
,

1097 { 
AR5K_PHY_RF_CTL3
,

1099 { 
AR5K_PHY_RF_CTL4
,

1101 { 
AR5K_PHY_PA_CTL
,

1103 { 
AR5K_PHY_SETTLING
,

1105 { 
AR5K_PHY_GAIN
,

1107 { 
AR5K_PHY_DESIRED_SIZE
,

1109 { 
AR5K_PHY_SIG
,

1111 { 
AR5K_PHY_AGCCOARSE
,

1113 { 
AR5K_PHY_WEAK_OFDM_LOW_THR
,

1115 { 
AR5K_PHY_RX_DELAY
,

1117 { 
AR5K_PHY_FRAME_CTL_5211
,

1119 { 
AR5K_PHY_CCKTXCTL
,

1121 { 
AR5K_PHY_CCK_CROSSCORR
,

1123 { 
AR5K_PHY_GAIN_2GHZ
,

1125 { 
AR5K_PHY_CCK_RX_CTL_4
,

1139 c⁄° 
©h5k_öi
 
	grf2425_öi_comm⁄_íd
[] = {

1140 { 
AR5K_DCU_FP
, 0x000003e0 },

1141 { 
AR5K_SEQ_MASK
, 0x0000000f },

1144 { 
AR5K_MIC_QOS_CTL
, 0x00000000 },

1145 { 
AR5K_MIC_QOS_SEL
, 0x00000000 },

1146 { 
AR5K_MISC_MODE
, 0x00000000 },

1147 { 
AR5K_OFDM_FIL_CNT
, 0x00000000 },

1148 { 
AR5K_CCK_FIL_CNT
, 0x00000000 },

1149 { 
AR5K_PHYERR_CNT1
, 0x00000000 },

1150 { 
AR5K_PHYERR_CNT1_MASK
, 0x00000000 },

1151 { 
AR5K_PHYERR_CNT2
, 0x00000000 },

1152 { 
AR5K_PHYERR_CNT2_MASK
, 0x00000000 },

1153 { 
AR5K_TSF_THRES
, 0x00000000 },

1156 { 
AR5K_PHY_AGC
, 0x00000000 },

1157 { 
AR5K_PHY_ADC_CTL
, 0x0000a000 },

1159 { 
AR5K_PHY_GAIN_OFFSET
, 0x1284233c },

1160 { 
AR5K_PHY_SCR
, 0x0000001f },

1161 { 
AR5K_PHY_SLMT
, 0x00000080 },

1162 { 
AR5K_PHY_SCAL
, 0x0000000e },

1164 { 
AR5K_PHY_TIMING_7
, 0x00000000 },

1165 { 
AR5K_PHY_TIMING_8
, 0x02800000 },

1166 { 
AR5K_PHY_TIMING_11
, 0x00000000 },

1168 { 
AR5K_PHY_HEAVY_CLIP_ENABLE
, 0x00000000 },

1172 { 
AR5K_PHY_SCLOCK
, 0x0000000c },

1173 { 
AR5K_PHY_SDELAY
, 0x000000ff },

1174 { 
AR5K_PHY_SPENDING
, 0x00000014 },

1175 { 
AR5K_PHY_DAG_CCK_CTL
, 0x000009b5 },

1176 { 
AR5K_PHY_TXPOWER_RATE3
, 0x20202020 },

1177 { 
AR5K_PHY_TXPOWER_RATE4
, 0x20202020 },

1179 { 
AR5K_PHY_FAST_ADC
, 0x00000001 },

1181 { 
AR5K_PHY_BLUETOOTH
, 0x00000000 },

1182 { 
AR5K_PHY_TPC_RG1
, 0x0cc75380 },

1187 { 
AR5K_PHY_TPC_RG5
, 0x0c30c166 },

1225 c⁄° 
©h5k_öi
 
	grf5111_öi_bbgaö
[] = {

1226 { 
AR5K_BB_GAIN
(0), 0x00000000 },

1227 { 
AR5K_BB_GAIN
(1), 0x00000020 },

1228 { 
AR5K_BB_GAIN
(2), 0x00000010 },

1229 { 
AR5K_BB_GAIN
(3), 0x00000030 },

1230 { 
AR5K_BB_GAIN
(4), 0x00000008 },

1231 { 
AR5K_BB_GAIN
(5), 0x00000028 },

1232 { 
AR5K_BB_GAIN
(6), 0x00000004 },

1233 { 
AR5K_BB_GAIN
(7), 0x00000024 },

1234 { 
AR5K_BB_GAIN
(8), 0x00000014 },

1235 { 
AR5K_BB_GAIN
(9), 0x00000034 },

1236 { 
AR5K_BB_GAIN
(10), 0x0000000c },

1237 { 
AR5K_BB_GAIN
(11), 0x0000002c },

1238 { 
AR5K_BB_GAIN
(12), 0x00000002 },

1239 { 
AR5K_BB_GAIN
(13), 0x00000022 },

1240 { 
AR5K_BB_GAIN
(14), 0x00000012 },

1241 { 
AR5K_BB_GAIN
(15), 0x00000032 },

1242 { 
AR5K_BB_GAIN
(16), 0x0000000a },

1243 { 
AR5K_BB_GAIN
(17), 0x0000002a },

1244 { 
AR5K_BB_GAIN
(18), 0x00000006 },

1245 { 
AR5K_BB_GAIN
(19), 0x00000026 },

1246 { 
AR5K_BB_GAIN
(20), 0x00000016 },

1247 { 
AR5K_BB_GAIN
(21), 0x00000036 },

1248 { 
AR5K_BB_GAIN
(22), 0x0000000e },

1249 { 
AR5K_BB_GAIN
(23), 0x0000002e },

1250 { 
AR5K_BB_GAIN
(24), 0x00000001 },

1251 { 
AR5K_BB_GAIN
(25), 0x00000021 },

1252 { 
AR5K_BB_GAIN
(26), 0x00000011 },

1253 { 
AR5K_BB_GAIN
(27), 0x00000031 },

1254 { 
AR5K_BB_GAIN
(28), 0x00000009 },

1255 { 
AR5K_BB_GAIN
(29), 0x00000029 },

1256 { 
AR5K_BB_GAIN
(30), 0x00000005 },

1257 { 
AR5K_BB_GAIN
(31), 0x00000025 },

1258 { 
AR5K_BB_GAIN
(32), 0x00000015 },

1259 { 
AR5K_BB_GAIN
(33), 0x00000035 },

1260 { 
AR5K_BB_GAIN
(34), 0x0000000d },

1261 { 
AR5K_BB_GAIN
(35), 0x0000002d },

1262 { 
AR5K_BB_GAIN
(36), 0x00000003 },

1263 { 
AR5K_BB_GAIN
(37), 0x00000023 },

1264 { 
AR5K_BB_GAIN
(38), 0x00000013 },

1265 { 
AR5K_BB_GAIN
(39), 0x00000033 },

1266 { 
AR5K_BB_GAIN
(40), 0x0000000b },

1267 { 
AR5K_BB_GAIN
(41), 0x0000002b },

1268 { 
AR5K_BB_GAIN
(42), 0x0000002b },

1269 { 
AR5K_BB_GAIN
(43), 0x0000002b },

1270 { 
AR5K_BB_GAIN
(44), 0x0000002b },

1271 { 
AR5K_BB_GAIN
(45), 0x0000002b },

1272 { 
AR5K_BB_GAIN
(46), 0x0000002b },

1273 { 
AR5K_BB_GAIN
(47), 0x0000002b },

1274 { 
AR5K_BB_GAIN
(48), 0x0000002b },

1275 { 
AR5K_BB_GAIN
(49), 0x0000002b },

1276 { 
AR5K_BB_GAIN
(50), 0x0000002b },

1277 { 
AR5K_BB_GAIN
(51), 0x0000002b },

1278 { 
AR5K_BB_GAIN
(52), 0x0000002b },

1279 { 
AR5K_BB_GAIN
(53), 0x0000002b },

1280 { 
AR5K_BB_GAIN
(54), 0x0000002b },

1281 { 
AR5K_BB_GAIN
(55), 0x0000002b },

1282 { 
AR5K_BB_GAIN
(56), 0x0000002b },

1283 { 
AR5K_BB_GAIN
(57), 0x0000002b },

1284 { 
AR5K_BB_GAIN
(58), 0x0000002b },

1285 { 
AR5K_BB_GAIN
(59), 0x0000002b },

1286 { 
AR5K_BB_GAIN
(60), 0x0000002b },

1287 { 
AR5K_BB_GAIN
(61), 0x0000002b },

1288 { 
AR5K_BB_GAIN
(62), 0x00000002 },

1289 { 
AR5K_BB_GAIN
(63), 0x00000016 },

1293 c⁄° 
©h5k_öi
 
	grf5112_öi_bbgaö
[] = {

1294 { 
AR5K_BB_GAIN
(0), 0x00000000 },

1295 { 
AR5K_BB_GAIN
(1), 0x00000001 },

1296 { 
AR5K_BB_GAIN
(2), 0x00000002 },

1297 { 
AR5K_BB_GAIN
(3), 0x00000003 },

1298 { 
AR5K_BB_GAIN
(4), 0x00000004 },

1299 { 
AR5K_BB_GAIN
(5), 0x00000005 },

1300 { 
AR5K_BB_GAIN
(6), 0x00000008 },

1301 { 
AR5K_BB_GAIN
(7), 0x00000009 },

1302 { 
AR5K_BB_GAIN
(8), 0x0000000a },

1303 { 
AR5K_BB_GAIN
(9), 0x0000000b },

1304 { 
AR5K_BB_GAIN
(10), 0x0000000c },

1305 { 
AR5K_BB_GAIN
(11), 0x0000000d },

1306 { 
AR5K_BB_GAIN
(12), 0x00000010 },

1307 { 
AR5K_BB_GAIN
(13), 0x00000011 },

1308 { 
AR5K_BB_GAIN
(14), 0x00000012 },

1309 { 
AR5K_BB_GAIN
(15), 0x00000013 },

1310 { 
AR5K_BB_GAIN
(16), 0x00000014 },

1311 { 
AR5K_BB_GAIN
(17), 0x00000015 },

1312 { 
AR5K_BB_GAIN
(18), 0x00000018 },

1313 { 
AR5K_BB_GAIN
(19), 0x00000019 },

1314 { 
AR5K_BB_GAIN
(20), 0x0000001a },

1315 { 
AR5K_BB_GAIN
(21), 0x0000001b },

1316 { 
AR5K_BB_GAIN
(22), 0x0000001c },

1317 { 
AR5K_BB_GAIN
(23), 0x0000001d },

1318 { 
AR5K_BB_GAIN
(24), 0x00000020 },

1319 { 
AR5K_BB_GAIN
(25), 0x00000021 },

1320 { 
AR5K_BB_GAIN
(26), 0x00000022 },

1321 { 
AR5K_BB_GAIN
(27), 0x00000023 },

1322 { 
AR5K_BB_GAIN
(28), 0x00000024 },

1323 { 
AR5K_BB_GAIN
(29), 0x00000025 },

1324 { 
AR5K_BB_GAIN
(30), 0x00000028 },

1325 { 
AR5K_BB_GAIN
(31), 0x00000029 },

1326 { 
AR5K_BB_GAIN
(32), 0x0000002a },

1327 { 
AR5K_BB_GAIN
(33), 0x0000002b },

1328 { 
AR5K_BB_GAIN
(34), 0x0000002c },

1329 { 
AR5K_BB_GAIN
(35), 0x0000002d },

1330 { 
AR5K_BB_GAIN
(36), 0x00000030 },

1331 { 
AR5K_BB_GAIN
(37), 0x00000031 },

1332 { 
AR5K_BB_GAIN
(38), 0x00000032 },

1333 { 
AR5K_BB_GAIN
(39), 0x00000033 },

1334 { 
AR5K_BB_GAIN
(40), 0x00000034 },

1335 { 
AR5K_BB_GAIN
(41), 0x00000035 },

1336 { 
AR5K_BB_GAIN
(42), 0x00000035 },

1337 { 
AR5K_BB_GAIN
(43), 0x00000035 },

1338 { 
AR5K_BB_GAIN
(44), 0x00000035 },

1339 { 
AR5K_BB_GAIN
(45), 0x00000035 },

1340 { 
AR5K_BB_GAIN
(46), 0x00000035 },

1341 { 
AR5K_BB_GAIN
(47), 0x00000035 },

1342 { 
AR5K_BB_GAIN
(48), 0x00000035 },

1343 { 
AR5K_BB_GAIN
(49), 0x00000035 },

1344 { 
AR5K_BB_GAIN
(50), 0x00000035 },

1345 { 
AR5K_BB_GAIN
(51), 0x00000035 },

1346 { 
AR5K_BB_GAIN
(52), 0x00000035 },

1347 { 
AR5K_BB_GAIN
(53), 0x00000035 },

1348 { 
AR5K_BB_GAIN
(54), 0x00000035 },

1349 { 
AR5K_BB_GAIN
(55), 0x00000035 },

1350 { 
AR5K_BB_GAIN
(56), 0x00000035 },

1351 { 
AR5K_BB_GAIN
(57), 0x00000035 },

1352 { 
AR5K_BB_GAIN
(58), 0x00000035 },

1353 { 
AR5K_BB_GAIN
(59), 0x00000035 },

1354 { 
AR5K_BB_GAIN
(60), 0x00000035 },

1355 { 
AR5K_BB_GAIN
(61), 0x00000035 },

1356 { 
AR5K_BB_GAIN
(62), 0x00000010 },

1357 { 
AR5K_BB_GAIN
(63), 0x0000001a },

1364 
	$©h5k_hw_öi_ªgi°îs
(
©h5k_hw
 *
ah
, 
size
,

1365 c⁄° 
©h5k_öi
 *
öi_ªgs
, 
boﬁ
 
skù_pcu
)

1367 
i
;

1370 
i
 = 0; i < 
size
; i++) {

1373 i‡(
skù_pcu
 &&

1374 
öi_ªgs
[
i
].
öi_ªgi°î
 >
AR5K_PCU_MIN
 &&

1375 
öi_ªgs
[
i
].
öi_ªgi°î
 <
AR5K_PCU_MAX
)

1378 
öi_ªgs
[
i
].
öi_mode
) {

1379 
AR5K_INI_READ
:

1381 
	`©h5k_hw_ªg_ªad
(
ah
, 
öi_ªgs
[
i
].
öi_ªgi°î
);

1383 
AR5K_INI_WRITE
:

1385 
	`AR5K_REG_WAIT
(
i
);

1386 
	`©h5k_hw_ªg_wrôe
(
ah
, 
öi_ªgs
[
i
].
öi_vÆue
,

1387 
öi_ªgs
[
i
].
öi_ªgi°î
);

1390 
	}
}

1392 
	$©h5k_hw_öi_mode_ªgi°îs
(
©h5k_hw
 *
ah
,

1393 
size
, c⁄° 
©h5k_öi_mode
 *
öi_mode
,

1394 
u8
 
mode
)

1396 
i
;

1398 
i
 = 0; i < 
size
; i++) {

1399 
	`AR5K_REG_WAIT
(
i
);

1400 
	`©h5k_hw_ªg_wrôe
(
ah
, 
öi_mode
[
i
].
mode_vÆue
[
mode
],

1401 (
u32
)
öi_mode
[
i
].
mode_ªgi°î
);

1404 
	}
}

1406 
	$©h5k_hw_wrôe_öôvÆs
(
©h5k_hw
 *
ah
, 
u8
 
mode
, 
boﬁ
 
skù_pcu
)

1413 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5212
) {

1416 
	`©h5k_hw_öi_mode_ªgi°îs
(
ah
,

1417 
	`ARRAY_SIZE
(
¨5212_öi_mode_°¨t
),

1418 
¨5212_öi_mode_°¨t
, 
mode
);

1423 
	`©h5k_hw_öi_ªgi°îs
(
ah
, 
	`ARRAY_SIZE
(
¨5212_öi_comm⁄_°¨t
),

1424 
¨5212_öi_comm⁄_°¨t
, 
skù_pcu
);

1427 
ah
->
ah_ødio
) {

1428 
AR5K_RF5111
:

1430 
	`©h5k_hw_öi_mode_ªgi°îs
(
ah
,

1431 
	`ARRAY_SIZE
(
rf5111_öi_mode_íd
),

1432 
rf5111_öi_mode_íd
, 
mode
);

1434 
	`©h5k_hw_öi_ªgi°îs
(
ah
,

1435 
	`ARRAY_SIZE
(
rf5111_öi_comm⁄_íd
),

1436 
rf5111_öi_comm⁄_íd
, 
skù_pcu
);

1439 
	`©h5k_hw_öi_ªgi°îs
(
ah
,

1440 
	`ARRAY_SIZE
(
rf5111_öi_bbgaö
),

1441 
rf5111_öi_bbgaö
, 
skù_pcu
);

1444 
AR5K_RF5112
:

1446 
	`©h5k_hw_öi_mode_ªgi°îs
(
ah
,

1447 
	`ARRAY_SIZE
(
rf5112_öi_mode_íd
),

1448 
rf5112_öi_mode_íd
, 
mode
);

1450 
	`©h5k_hw_öi_ªgi°îs
(
ah
,

1451 
	`ARRAY_SIZE
(
rf5112_öi_comm⁄_íd
),

1452 
rf5112_öi_comm⁄_íd
, 
skù_pcu
);

1454 
	`©h5k_hw_öi_ªgi°îs
(
ah
,

1455 
	`ARRAY_SIZE
(
rf5112_öi_bbgaö
),

1456 
rf5112_öi_bbgaö
, 
skù_pcu
);

1459 
AR5K_RF5413
:

1461 
	`©h5k_hw_öi_mode_ªgi°îs
(
ah
,

1462 
	`ARRAY_SIZE
(
rf5413_öi_mode_íd
),

1463 
rf5413_öi_mode_íd
, 
mode
);

1465 
	`©h5k_hw_öi_ªgi°îs
(
ah
,

1466 
	`ARRAY_SIZE
(
rf5413_öi_comm⁄_íd
),

1467 
rf5413_öi_comm⁄_íd
, 
skù_pcu
);

1469 
	`©h5k_hw_öi_ªgi°îs
(
ah
,

1470 
	`ARRAY_SIZE
(
rf5112_öi_bbgaö
),

1471 
rf5112_öi_bbgaö
, 
skù_pcu
);

1474 
AR5K_RF2316
:

1475 
AR5K_RF2413
:

1477 
	`©h5k_hw_öi_mode_ªgi°îs
(
ah
,

1478 
	`ARRAY_SIZE
(
rf2413_öi_mode_íd
),

1479 
rf2413_öi_mode_íd
, 
mode
);

1481 
	`©h5k_hw_öi_ªgi°îs
(
ah
,

1482 
	`ARRAY_SIZE
(
rf2413_öi_comm⁄_íd
),

1483 
rf2413_öi_comm⁄_íd
, 
skù_pcu
);

1486 i‡(
ah
->
ah_ødio
 =
AR5K_RF2316
) {

1487 
	`©h5k_hw_ªg_wrôe
(
ah
, 0x00004000,

1488 
AR5K_PHY_AGC
);

1489 
	`©h5k_hw_ªg_wrôe
(
ah
, 0x081b7caa,

1493 
	`©h5k_hw_öi_ªgi°îs
(
ah
,

1494 
	`ARRAY_SIZE
(
rf5112_öi_bbgaö
),

1495 
rf5112_öi_bbgaö
, 
skù_pcu
);

1497 
AR5K_RF2317
:

1499 
	`©h5k_hw_öi_mode_ªgi°îs
(
ah
,

1500 
	`ARRAY_SIZE
(
rf2413_öi_mode_íd
),

1501 
rf2413_öi_mode_íd
, 
mode
);

1503 
	`©h5k_hw_öi_ªgi°îs
(
ah
,

1504 
	`ARRAY_SIZE
(
rf2425_öi_comm⁄_íd
),

1505 
rf2425_öi_comm⁄_íd
, 
skù_pcu
);

1508 
	`©h5k_hw_ªg_wrôe
(
ah
, 0x00180a65, 
AR5K_PHY_GAIN
);

1511 
	`©h5k_hw_ªg_wrôe
(
ah
, 0x00004000, 
AR5K_PHY_AGC
);

1512 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_TPC_RG5
,

1513 
AR5K_PHY_TPC_RG5_PD_GAIN_OVERLAP
, 0xa);

1514 
	`©h5k_hw_ªg_wrôe
(
ah
, 0x800000a8, 0x8140);

1515 
	`©h5k_hw_ªg_wrôe
(
ah
, 0x000000ff, 0x9958);

1517 
	`©h5k_hw_öi_ªgi°îs
(
ah
,

1518 
	`ARRAY_SIZE
(
rf5112_öi_bbgaö
),

1519 
rf5112_öi_bbgaö
, 
skù_pcu
);

1521 
AR5K_RF2425
:

1523 
	`©h5k_hw_öi_mode_ªgi°îs
(
ah
,

1524 
	`ARRAY_SIZE
(
rf2425_öi_mode_íd
),

1525 
rf2425_öi_mode_íd
, 
mode
);

1527 
	`©h5k_hw_öi_ªgi°îs
(
ah
,

1528 
	`ARRAY_SIZE
(
rf2425_öi_comm⁄_íd
),

1529 
rf2425_öi_comm⁄_íd
, 
skù_pcu
);

1531 
	`©h5k_hw_öi_ªgi°îs
(
ah
,

1532 
	`ARRAY_SIZE
(
rf5112_öi_bbgaö
),

1533 
rf5112_öi_bbgaö
, 
skù_pcu
);

1536  -
EINVAL
;

1541 } i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5211
) {

1544 i‡(
mode
 > 2) {

1545 
	`ATH5K_ERR
(
ah
,

1546 "unsuµ‹ãd ch™√»mode: %d\n", 
mode
);

1547  -
EINVAL
;

1551 
	`©h5k_hw_öi_mode_ªgi°îs
(
ah
, 
	`ARRAY_SIZE
(
¨5211_öi_mode
),

1552 
¨5211_öi_mode
, 
mode
);

1557 
	`©h5k_hw_öi_ªgi°îs
(
ah
, 
	`ARRAY_SIZE
(
¨5211_öi
),

1558 
¨5211_öi
, 
skù_pcu
);

1563 
	`©h5k_hw_öi_ªgi°îs
(
ah
, 
	`ARRAY_SIZE
(
rf5111_öi_bbgaö
),

1564 
rf5111_öi_bbgaö
, 
skù_pcu
);

1566 } i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
) {

1567 
	`©h5k_hw_öi_ªgi°îs
(
ah
, 
	`ARRAY_SIZE
(
¨5210_öi
),

1568 
¨5210_öi
, 
skù_pcu
);

1572 
	}
}

	@ath5k/led.c

42 
	~<löux/pci.h
>

43 
	~"©h5k.h
"

44 
	~"ba£.h
"

46 
	#ATH_SDEVICE
(
subv
, 
subd
) \

47 .
víd‹
 = 
PCI_ANY_ID
, .
devi˚
 = PCI_ANY_ID, \

48 .
subvíd‹
 = (
subv
), .
subdevi˚
 = (
subd
)

	)

50 
	#ATH_LED
(
pö
, 
pﬁ¨ôy
Ë.
drivî_d©a
 = ((’öË<< 8Ë| (pﬁ¨ôy))

	)

51 
	#ATH_PIN
(
d©a
Ë((d©aË>> 8)

	)

52 
	#ATH_POLARITY
(
d©a
Ë((d©aË& 0xff)

	)

55 
DEFINE_PCI_DEVICE_TABLE
(
©h5k_Àd_devi˚s
) = {

57 { 
PCI_VDEVICE
(
ATHEROS
, 
PCI_DEVICE_ID_ATHEROS_AR5211
), 
ATH_LED
(0, 0) },

59 { 
ATH_SDEVICE
(
PCI_VENDOR_ID_COMPAQ
, 
PCI_ANY_ID
), 
ATH_LED
(1, 1) },

61 { 
ATH_SDEVICE
(
PCI_VENDOR_ID_FOXCONN
, 0xe008), 
ATH_LED
(3, 0) },

63 { 
ATH_SDEVICE
(
PCI_VENDOR_ID_FOXCONN
, 0xe00d), 
ATH_LED
(3, 0) },

65 { 
ATH_SDEVICE
(
PCI_VENDOR_ID_AMBIT
, 0x0422), 
ATH_LED
(1, 1) },

67 { 
ATH_SDEVICE
(
PCI_VENDOR_ID_AMBIT
, 0x0428), 
ATH_LED
(3, 0) },

69 { 
ATH_SDEVICE
(
PCI_VENDOR_ID_QMI
, 0x0100), 
ATH_LED
(1, 0) },

71 { 
ATH_SDEVICE
(
PCI_VENDOR_ID_QMI
, 0x0105), 
ATH_LED
(3, 0) },

73 { 
ATH_SDEVICE
(
PCI_VENDOR_ID_AZWAVE
, 0x1026), 
ATH_LED
(3, 0) },

75 { 
ATH_SDEVICE
(
PCI_VENDOR_ID_IBM
, 0x058a), 
ATH_LED
(1, 0) },

77 { 
ATH_SDEVICE
(
PCI_VENDOR_ID_HP
, 0x0137a), 
ATH_LED
(3, 1) },

79 { 
ATH_SDEVICE
(
PCI_VENDOR_ID_HP
, 0x0137b), 
ATH_LED
(3, 1) },

81 { 
ATH_SDEVICE
(
PCI_VENDOR_ID_ATHEROS
, 0x3067), 
ATH_LED
(3, 0) },

83 { 
PCI_VDEVICE
(
ATHEROS
, 
PCI_DEVICE_ID_ATHEROS_AR5212_IBM
), 
ATH_LED
(0, 0) },

85 { 
ATH_SDEVICE
(
PCI_VENDOR_ID_QMI
, 0x0112), 
ATH_LED
(3, 0) },

89 
	$©h5k_Àd_íabÀ
(
©h5k_hw
 *
ah
)

91 i‡(
	`ã°_bô
(
ATH_STAT_LEDSOFT
, 
ah
->
°©us
)) {

92 
	`©h5k_hw_£t_gpio_ouçut
(
ah
,áh->
Àd_pö
);

93 
	`©h5k_Àd_off
(
ah
);

95 
	}
}

97 
	$©h5k_Àd_⁄
(
©h5k_hw
 *
ah
)

99 i‡(!
	`ã°_bô
(
ATH_STAT_LEDSOFT
, 
ah
->
°©us
))

101 
	`©h5k_hw_£t_gpio
(
ah
,áh->
Àd_pö
,áh->
Àd_⁄
);

102 
	}
}

104 
	$©h5k_Àd_off
(
©h5k_hw
 *
ah
)

106 i‡(!
	`ã°_bô
(
ATH_STAT_LEDSOFT
, 
ah
->
°©us
))

108 
	`©h5k_hw_£t_gpio
(
ah
,áh->
Àd_pö
, !ah->
Àd_⁄
);

109 
	}
}

112 
	$©h5k_Àd_brighäess_£t
(
Àd_˛assdev
 *
Àd_dev
,

113 
Àd_brighäess
 
brighäess
)

115 
©h5k_Àd
 *
Àd
 = 
	`c⁄èöî_of
(
Àd_dev
, ath5k_led,

116 
Àd_dev
);

118 i‡(
brighäess
 =
LED_OFF
)

119 
	`©h5k_Àd_off
(
Àd
->
ah
);

121 
	`©h5k_Àd_⁄
(
Àd
->
ah
);

122 
	}
}

125 
	$©h5k_ªgi°î_Àd
(
©h5k_hw
 *
ah
, 
©h5k_Àd
 *
Àd
,

126 c⁄° *
«me
, *
åiggî
)

128 
îr
;

130 
Àd
->
ah
 =áh;

131 
	`°∫˝y
(
Àd
->
«me
,Çame, (led->name));

132 
Àd
->
Àd_dev
.
«me
 =Üed->name;

133 
Àd
->
Àd_dev
.
deÁu…_åiggî
 = 
åiggî
;

134 
Àd
->
Àd_dev
.
brighäess_£t
 = 
©h5k_Àd_brighäess_£t
;

136 
îr
 = 
	`Àd_˛assdev_ªgi°î
(
ah
->
dev
, &
Àd
->
Àd_dev
);

137 i‡(
îr
) {

138 
	`ATH5K_WARN
(
ah
, "couldÇŸÑegi°î LED %s\n", 
«me
);

139 
Àd
->
ah
 = 
NULL
;

141  
îr
;

142 
	}
}

145 
	$©h5k_uƒegi°î_Àd
(
©h5k_Àd
 *
Àd
)

147 i‡(!
Àd
->
ah
)

149 
	`Àd_˛assdev_uƒegi°î
(&
Àd
->
Àd_dev
);

150 
	`©h5k_Àd_off
(
Àd
->
ah
);

151 
Àd
->
ah
 = 
NULL
;

152 
	}
}

154 
	$©h5k_uƒegi°î_Àds
(
©h5k_hw
 *
ah
)

156 
	`©h5k_uƒegi°î_Àd
(&
ah
->
rx_Àd
);

157 
	`©h5k_uƒegi°î_Àd
(&
ah
->
tx_Àd
);

158 
	}
}

160 
__devöô
 
	$©h5k_öô_Àds
(
©h5k_hw
 *
ah
)

162 
ªt
 = 0;

163 
õì80211_hw
 *
hw
 = 
ah
->hw;

164 #i‚de‡
CONFIG_ATHEROS_AR231X


165 
pci_dev
 *
pdev
 = 
ah
->pdev;

167 
«me
[
ATH5K_LED_MAX_NAME_LEN
 + 1];

168 c⁄° 
pci_devi˚_id
 *
m©ch
;

170 i‡(!
ah
->
pdev
)

173 #ifde‡
CONFIG_ATHEROS_AR231X


174 
m©ch
 = 
NULL
;

176 
m©ch
 = 
	`pci_m©ch_id
(&
©h5k_Àd_devi˚s
[0], 
pdev
);

178 i‡(
m©ch
) {

179 
	`__£t_bô
(
ATH_STAT_LEDSOFT
, 
ah
->
°©us
);

180 
ah
->
Àd_pö
 = 
	`ATH_PIN
(
m©ch
->
drivî_d©a
);

181 
ah
->
Àd_⁄
 = 
	`ATH_POLARITY
(
m©ch
->
drivî_d©a
);

184 i‡(!
	`ã°_bô
(
ATH_STAT_LEDSOFT
, 
ah
->
°©us
))

185 
out
;

187 
	`©h5k_Àd_íabÀ
(
ah
);

189 
	`¢¥ötf
(
«me
, “ame), "©h5k-%s::rx", 
	`wùhy_«me
(
hw
->
wùhy
));

190 
ªt
 = 
	`©h5k_ªgi°î_Àd
(
ah
, &ah->
rx_Àd
, 
«me
,

191 
	`õì80211_gë_rx_Àd_«me
(
hw
));

192 i‡(
ªt
)

193 
out
;

195 
	`¢¥ötf
(
«me
, “ame), "©h5k-%s::tx", 
	`wùhy_«me
(
hw
->
wùhy
));

196 
ªt
 = 
	`©h5k_ªgi°î_Àd
(
ah
, &ah->
tx_Àd
, 
«me
,

197 
	`õì80211_gë_tx_Àd_«me
(
hw
));

198 
out
:

199  
ªt
;

200 
	}
}

	@ath5k/mac80211-ops.c

44 
	~<asm/u«lig√d.h
>

46 
	~"ba£.h
"

47 
	~"ªg.h
"

54 
	$©h5k_tx
(
õì80211_hw
 *
hw
, 
sk_buff
 *
skb
)

56 
©h5k_hw
 *
ah
 = 
hw
->
¥iv
;

57 
u16
 
qnum
 = 
	`skb_gë_queue_m≠pög
(
skb
);

59 i‡(
	`WARN_ON
(
qnum
 >
ah
->
ah_ˇ∑bûôõs
.
ˇp_queues
.
q_tx_num
)) {

60 
	`dev_k‰ì_skb_™y
(
skb
);

64 
	`©h5k_tx_queue
(
hw
, 
skb
, &
ah
->
txqs
[
qnum
]);

65 
	}
}

69 
	$©h5k_add_öãrÁ˚
(
õì80211_hw
 *
hw
, 
õì80211_vif
 *
vif
)

71 
©h5k_hw
 *
ah
 = 
hw
->
¥iv
;

72 
ªt
;

73 
©h5k_vif
 *
avf
 = (*)
vif
->
drv_¥iv
;

75 
	`muãx_lock
(&
ah
->
lock
);

77 i‡((
vif
->
ty≥
 =
NL80211_IFTYPE_AP
 ||

78 
vif
->
ty≥
 =
NL80211_IFTYPE_ADHOC
)

79 && (
ah
->
num_≠_vifs
 +áh->
num_adhoc_vifs
Ë>
ATH_BCBUF
) {

80 
ªt
 = -
ELNRNG
;

81 
íd
;

89 i‡(
ah
->
num_adhoc_vifs
 ||

90 (
ah
->
nvifs
 && 
vif
->
ty≥
 =
NL80211_IFTYPE_ADHOC
)) {

91 
	`ATH5K_ERR
(
ah
, "Only one singleád-hoc interface isállowed.\n");

92 
ªt
 = -
ELNRNG
;

93 
íd
;

96 
vif
->
ty≥
) {

97 
NL80211_IFTYPE_AP
:

98 
NL80211_IFTYPE_STATION
:

99 
NL80211_IFTYPE_ADHOC
:

100 
NL80211_IFTYPE_MESH_POINT
:

101 
avf
->
›mode
 = 
vif
->
ty≥
;

104 
ªt
 = -
EOPNOTSUPP
;

105 
íd
;

108 
ah
->
nvifs
++;

109 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_MODE
, "add i¡îÁ˚ modê%d\n", 
avf
->
›mode
);

112 i‡((
avf
->
›mode
 =
NL80211_IFTYPE_AP
) ||

113 (
avf
->
›mode
 =
NL80211_IFTYPE_ADHOC
) ||

114 (
avf
->
›mode
 =
NL80211_IFTYPE_MESH_POINT
)) {

115 
¶Ÿ
;

117 
	`WARN_ON
(
	`li°_em±y
(&
ah
->
bcbuf
));

118 
avf
->
bbuf
 = 
	`li°_fú°_íåy
(&
ah
->
bcbuf
, 
©h5k_buf
,

119 
li°
);

120 
	`li°_dñ
(&
avf
->
bbuf
->
li°
);

122 
avf
->
b¶Ÿ
 = 0;

123 
¶Ÿ
 = 0; slŸ < 
ATH_BCBUF
; slot++) {

124 i‡(!
ah
->
b¶Ÿ
[
¶Ÿ
]) {

125 
avf
->
b¶Ÿ
 = 
¶Ÿ
;

129 
	`BUG_ON
(
ah
->
b¶Ÿ
[
avf
->b¶Ÿ] !
NULL
);

130 
ah
->
b¶Ÿ
[
avf
->b¶Ÿ] = 
vif
;

131 i‡(
avf
->
›mode
 =
NL80211_IFTYPE_AP
)

132 
ah
->
num_≠_vifs
++;

133 i‡(
avf
->
›mode
 =
NL80211_IFTYPE_ADHOC
)

134 
ah
->
num_adhoc_vifs
++;

140 
	`mem˝y
(&
ah
->
Œaddr
, 
vif
->
addr
, 
ETH_ALEN
);

141 
	`©h5k_hw_£t_Œaddr
(
ah
, 
vif
->
addr
);

143 
	`mem˝y
(&
avf
->
Œaddr
, 
vif
->
addr
, 
ETH_ALEN
);

145 
	`©h5k_upd©e_bssid_mask_™d_›mode
(
ah
, 
vif
);

146 
ªt
 = 0;

147 
íd
:

148 
	`muãx_u∆ock
(&
ah
->
lock
);

149  
ªt
;

150 
	}
}

154 
	$©h5k_ªmove_öãrÁ˚
(
õì80211_hw
 *
hw
,

155 
õì80211_vif
 *
vif
)

157 
©h5k_hw
 *
ah
 = 
hw
->
¥iv
;

158 
©h5k_vif
 *
avf
 = (*)
vif
->
drv_¥iv
;

159 
i
;

161 
	`muãx_lock
(&
ah
->
lock
);

162 
ah
->
nvifs
--;

164 i‡(
avf
->
bbuf
) {

165 
	`©h5k_txbuf_‰ì_skb
(
ah
, 
avf
->
bbuf
);

166 
	`li°_add_èû
(&
avf
->
bbuf
->
li°
, &
ah
->
bcbuf
);

167 
i
 = 0; i < 
ATH_BCBUF
; i++) {

168 i‡(
ah
->
b¶Ÿ
[
i
] =
vif
) {

169 
ah
->
b¶Ÿ
[
i
] = 
NULL
;

173 
avf
->
bbuf
 = 
NULL
;

175 i‡(
avf
->
›mode
 =
NL80211_IFTYPE_AP
)

176 
ah
->
num_≠_vifs
--;

177 i‡(
avf
->
›mode
 =
NL80211_IFTYPE_ADHOC
)

178 
ah
->
num_adhoc_vifs
--;

180 
	`©h5k_upd©e_bssid_mask_™d_›mode
(
ah
, 
NULL
);

181 
	`muãx_u∆ock
(&
ah
->
lock
);

182 
	}
}

189 
	$©h5k_c⁄fig
(
õì80211_hw
 *
hw
, 
u32
 
ch™ged
)

191 
©h5k_hw
 *
ah
 = 
hw
->
¥iv
;

192 
õì80211_c⁄f
 *
c⁄f
 = &
hw
->conf;

193 
ªt
 = 0;

194 
i
;

196 
	`muãx_lock
(&
ah
->
lock
);

198 i‡(
ch™ged
 & 
IEEE80211_CONF_CHANGE_CHANNEL
) {

199 
ªt
 = 
	`©h5k_ch™_£t
(
ah
, 
c⁄f
->
ch™√l
);

200 i‡(
ªt
 < 0)

201 
u∆ock
;

204 i‡((
ch™ged
 & 
IEEE80211_CONF_CHANGE_POWER
) &&

205 (
ah
->
powî_Àvñ
 !
c⁄f
->power_level)) {

206 
	`¥ötk
("VANET-debug:ÅxÖowî ch™ged, c⁄f->powî_Àvñ=%d dBm\n", 
c⁄f
->
powî_Àvñ
);

207 
ah
->
powî_Àvñ
 = 
c⁄f
->power_level;

210 
	`©h5k_hw_£t_txpowî_limô
(
ah
, (
c⁄f
->
powî_Àvñ
 * 2));

213 i‡(
ch™ged
 & 
IEEE80211_CONF_CHANGE_RETRY_LIMITS
) {

214 
ah
->
ah_ªåy_l⁄g
 = 
c⁄f
->
l⁄g_‰ame_max_tx_cou¡
;

215 
ah
->
ah_ªåy_sh‹t
 = 
c⁄f
->
sh‹t_‰ame_max_tx_cou¡
;

217 
i
 = 0; i < 
ah
->
ah_ˇ∑bûôõs
.
ˇp_queues
.
q_tx_num
; i++)

218 
	`©h5k_hw_£t_tx_ªåy_limôs
(
ah
, 
i
);

238 
	`©h5k_hw_£t_™ã¬a_mode
(
ah
,áh->
ah_™t_mode
);

240 
u∆ock
:

241 
	`muãx_u∆ock
(&
ah
->
lock
);

242  
ªt
;

243 
	}
}

247 
	$©h5k_bss_öfo_ch™ged
(
õì80211_hw
 *
hw
, 
õì80211_vif
 *
vif
,

248 
õì80211_bss_c⁄f
 *
bss_c⁄f
, 
u32
 
ch™ges
)

250 
©h5k_vif
 *
avf
 = (*)
vif
->
drv_¥iv
;

251 
©h5k_hw
 *
ah
 = 
hw
->
¥iv
;

252 
©h_comm⁄
 *
comm⁄
 = 
	`©h5k_hw_comm⁄
(
ah
);

253 
Êags
;

255 
	`muãx_lock
(&
ah
->
lock
);

257 i‡(
ch™ges
 & 
BSS_CHANGED_BSSID
) {

259 
	`mem˝y
(
comm⁄
->
curbssid
, 
bss_c⁄f
->
bssid
, 
ETH_ALEN
);

260 
comm⁄
->
cuøid
 = 0;

261 
	`©h5k_hw_£t_bssid
(
ah
);

262 
	`mmiowb
();

265 i‡(
ch™ges
 & 
BSS_CHANGED_BEACON_INT
)

266 
ah
->
bötvÆ
 = 
bss_c⁄f
->
bóc⁄_öt
;

268 i‡(
ch™ges
 & 
BSS_CHANGED_ERP_SLOT
) {

269 
¶Ÿ_time
;

271 
ah
->
ah_sh‹t_¶Ÿ
 = 
bss_c⁄f
->
u£_sh‹t_¶Ÿ
;

272 
¶Ÿ_time
 = 
	`©h5k_hw_gë_deÁu…_¶Ÿtime
(
ah
) +

273 3 * 
ah
->
ah_covîage_˛ass
;

274 
	`©h5k_hw_£t_ifs_öãrvÆs
(
ah
, 
¶Ÿ_time
);

277 i‡(
ch™ges
 & 
BSS_CHANGED_ASSOC
) {

278 
avf
->
assoc
 = 
bss_c⁄f
->assoc;

279 i‡(
bss_c⁄f
->
assoc
)

280 
ah
->
assoc
 = 
bss_c⁄f
->assoc;

282 
ah
->
assoc
 = 
	`©h5k_™y_vif_assoc
(ah);

284 i‡(
ah
->
›mode
 =
NL80211_IFTYPE_STATION
)

285 
	`©h5k_£t_bóc⁄_fûãr
(
hw
, 
ah
->
assoc
);

286 
	`©h5k_hw_£t_Àd°©e
(
ah
,áh->
assoc
 ?

287 
AR5K_LED_ASSOC
 : 
AR5K_LED_INIT
);

288 i‡(
bss_c⁄f
->
assoc
) {

289 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_ANY
,

291 
bss_c⁄f
->
aid
, 
comm⁄
->
curbssid
);

292 
comm⁄
->
cuøid
 = 
bss_c⁄f
->
aid
;

293 
	`©h5k_hw_£t_bssid
(
ah
);

298 i‡(
ch™ges
 & 
BSS_CHANGED_BEACON
) {

299 
	`•ö_lock_úqßve
(&
ah
->
block
, 
Êags
);

300 
	`©h5k_bóc⁄_upd©e
(
hw
, 
vif
);

301 
	`•ö_u∆ock_úqª°‹e
(&
ah
->
block
, 
Êags
);

304 i‡(
ch™ges
 & 
BSS_CHANGED_BEACON_ENABLED
)

305 
ah
->
íabÀ_bóc⁄
 = 
bss_c⁄f
->enable_beacon;

307 i‡(
ch™ges
 & (
BSS_CHANGED_BEACON
 | 
BSS_CHANGED_BEACON_ENABLED
 |

308 
BSS_CHANGED_BEACON_INT
))

309 
	`©h5k_bóc⁄_c⁄fig
(
ah
);

311 
	`muãx_u∆ock
(&
ah
->
lock
);

312 
	}
}

315 
u64


316 
	$©h5k_¥ï¨e_mu…iˇ°
(
õì80211_hw
 *
hw
,

317 
√tdev_hw_addr_li°
 *
mc_li°
)

319 
u32
 
mfût
[2], 
vÆ
;

320 
u8
 
pos
;

321 
√tdev_hw_addr
 *
ha
;

323 
mfût
[0] = 0;

324 
mfût
[1] = 1;

326 
	`√tdev_hw_addr_li°_f‹_óch
(
ha
, 
mc_li°
) {

328 
vÆ
 = 
	`gë_u«lig√d_À32
(
ha
->
addr
 + 0);

329 
pos
 = (
vÆ
 >> 18) ^ (val >> 12) ^ (val >> 6) ^ val;

330 
vÆ
 = 
	`gë_u«lig√d_À32
(
ha
->
addr
 + 3);

331 
pos
 ^(
vÆ
 >> 18) ^ (val >> 12) ^ (val >> 6) ^ val;

332 
pos
 &= 0x3f;

333 
mfût
[
pos
 / 32] |= (1 << (pos % 32));

341  ((
u64
)(
mfût
[1]) << 32) | mfilt[0];

342 
	}
}

364 
	$©h5k_c⁄figuª_fûãr
(
õì80211_hw
 *
hw
, 
ch™ged_Êags
,

365 *
√w_Êags
, 
u64
 
mu…iˇ°
)

367 
	#SUPPORTED_FIF_FLAGS
 \

368 (
FIF_PROMISC_IN_BSS
 | 
FIF_ALLMULTI
 | 
FIF_FCSFAIL
 | \

369 
FIF_PLCPFAIL
 | 
FIF_CONTROL
 | 
FIF_OTHER_BSS
 | \

370 
FIF_BCN_PRBRESP_PROMISC
)

	)

372 
©h5k_hw
 *
ah
 = 
hw
->
¥iv
;

373 
u32
 
mfût
[2], 
rfût
;

374 
©h5k_vif_ôî_d©a
 
ôî_d©a
;

376 
	`muãx_lock
(&
ah
->
lock
);

378 
mfût
[0] = 
mu…iˇ°
;

379 
mfût
[1] = 
mu…iˇ°
 >> 32;

382 
ch™ged_Êags
 &
SUPPORTED_FIF_FLAGS
;

383 *
√w_Êags
 &
SUPPORTED_FIF_FLAGS
;

388 
rfût
 = (
	`©h5k_hw_gë_rx_fûãr
(
ah
Ë& (
AR5K_RX_FILTER_PHYERR
)) |

389 (
AR5K_RX_FILTER_UCAST
 | 
AR5K_RX_FILTER_BCAST
 |

390 
AR5K_RX_FILTER_MCAST
);

392 i‡(
ch™ged_Êags
 & (
FIF_PROMISC_IN_BSS
 | 
FIF_OTHER_BSS
)) {

393 i‡(*
√w_Êags
 & 
FIF_PROMISC_IN_BSS
)

394 
	`__£t_bô
(
ATH_STAT_PROMISC
, 
ah
->
°©us
);

396 
	`__˛ór_bô
(
ATH_STAT_PROMISC
, 
ah
->
°©us
);

399 i‡(
	`ã°_bô
(
ATH_STAT_PROMISC
, 
ah
->
°©us
))

400 
rfût
 |
AR5K_RX_FILTER_PROM
;

403 i‡(*
√w_Êags
 & 
FIF_ALLMULTI
) {

404 
mfût
[0] = ~0;

405 
mfût
[1] = ~0;

409 i‡(*
√w_Êags
 & (
FIF_FCSFAIL
 | 
FIF_PLCPFAIL
))

410 
rfût
 |
AR5K_RX_FILTER_PHYERR
;

414 i‡((*
√w_Êags
 & 
FIF_BCN_PRBRESP_PROMISC
Ë|| (
ah
->
nvifs
 > 1))

415 
rfût
 |
AR5K_RX_FILTER_BEACON
;

422 i‡(*
√w_Êags
 & 
FIF_CONTROL
)

423 
rfût
 |
AR5K_RX_FILTER_CONTROL
;

429 
ah
->
›mode
) {

430 
NL80211_IFTYPE_MESH_POINT
:

431 
rfût
 |
AR5K_RX_FILTER_CONTROL
 |

432 
AR5K_RX_FILTER_BEACON
 |

433 
AR5K_RX_FILTER_PROBEREQ
 |

434 
AR5K_RX_FILTER_PROM
;

436 
NL80211_IFTYPE_AP
:

437 
NL80211_IFTYPE_ADHOC
:

438 
rfût
 |
AR5K_RX_FILTER_PROBEREQ
 |

439 
AR5K_RX_FILTER_BEACON
;

441 
NL80211_IFTYPE_STATION
:

442 i‡(
ah
->
assoc
)

443 
rfût
 |
AR5K_RX_FILTER_BEACON
;

448 
ôî_d©a
.
hw_maˇddr
 = 
NULL
;

449 
ôî_d©a
.
n_°as
 = 0;

450 
ôî_d©a
.
√ed_£t_hw_addr
 = 
Ál£
;

451 
	`õì80211_ôî©e_a˘ive_öãrÁ˚s_©omic
(
ah
->
hw
, 
©h5k_vif_ôî
,

452 &
ôî_d©a
);

455 i‡(
ôî_d©a
.
n_°as
 > 1) {

460 
rfût
 |
AR5K_RX_FILTER_PROM
;

464 
	`©h5k_hw_£t_rx_fûãr
(
ah
, 
rfût
);

467 
	`©h5k_hw_£t_mˇ°_fûãr
(
ah
, 
mfût
[0], mfilt[1]);

470 
ah
->
fûãr_Êags
 = 
rfût
;

472 
	`muãx_u∆ock
(&
ah
->
lock
);

473 
	}
}

477 
	$©h5k_£t_key
(
õì80211_hw
 *
hw
, 
£t_key_cmd
 
cmd
,

478 
õì80211_vif
 *
vif
, 
õì80211_°a
 *
°a
,

479 
õì80211_key_c⁄f
 *
key
)

481 
©h5k_hw
 *
ah
 = 
hw
->
¥iv
;

482 
©h_comm⁄
 *
comm⁄
 = 
	`©h5k_hw_comm⁄
(
ah
);

483 
ªt
 = 0;

485 i‡(
©h5k_mod∑øm_nohw¸y±
)

486  -
EOPNOTSUPP
;

488 
key
->
cùhî
) {

489 
WLAN_CIPHER_SUITE_WEP40
:

490 
WLAN_CIPHER_SUITE_WEP104
:

491 
WLAN_CIPHER_SUITE_TKIP
:

493 
WLAN_CIPHER_SUITE_CCMP
:

494 i‡(
comm⁄
->
¸y±_ˇps
 & 
ATH_CRYPT_CAP_CIPHER_AESCCM
)

496  -
EOPNOTSUPP
;

498 
	`WARN_ON
(1);

499  -
EINVAL
;

502 
	`muãx_lock
(&
ah
->
lock
);

504 
cmd
) {

505 
SET_KEY
:

506 
ªt
 = 
	`©h_key_c⁄fig
(
comm⁄
, 
vif
, 
°a
, 
key
);

507 i‡(
ªt
 >= 0) {

508 
key
->
hw_key_idx
 = 
ªt
;

510 
key
->
Êags
 |
IEEE80211_KEY_FLAG_GENERATE_IV
;

511 i‡(
key
->
cùhî
 =
WLAN_CIPHER_SUITE_TKIP
)

512 
key
->
Êags
 |
IEEE80211_KEY_FLAG_GENERATE_MMIC
;

513 i‡(
key
->
cùhî
 =
WLAN_CIPHER_SUITE_CCMP
)

514 
key
->
Êags
 |
IEEE80211_KEY_FLAG_SW_MGMT
;

515 
ªt
 = 0;

518 
DISABLE_KEY
:

519 
	`©h_key_dñëe
(
comm⁄
, 
key
);

522 
ªt
 = -
EINVAL
;

525 
	`mmiowb
();

526 
	`muãx_u∆ock
(&
ah
->
lock
);

527  
ªt
;

528 
	}
}

532 
	$©h5k_sw_sˇn_°¨t
(
õì80211_hw
 *
hw
)

534 
©h5k_hw
 *
ah
 = 
hw
->
¥iv
;

535 i‡(!
ah
->
assoc
)

536 
	`©h5k_hw_£t_Àd°©e
(
ah
, 
AR5K_LED_SCAN
);

537 
	}
}

541 
	$©h5k_sw_sˇn_com∂ëe
(
õì80211_hw
 *
hw
)

543 
©h5k_hw
 *
ah
 = 
hw
->
¥iv
;

544 
	`©h5k_hw_£t_Àd°©e
(
ah
,áh->
assoc
 ?

545 
AR5K_LED_ASSOC
 : 
AR5K_LED_INIT
);

546 
	}
}

550 
	$©h5k_gë_°©s
(
õì80211_hw
 *
hw
,

551 
õì80211_low_Àvñ_°©s
 *
°©s
)

553 
©h5k_hw
 *
ah
 = 
hw
->
¥iv
;

556 
	`©h5k_hw_upd©e_mib_cou¡îs
(
ah
);

558 
°©s
->
dŸ11ACKFaûuªCou¡
 = 
ah
->°©s.
ack_Áû
;

559 
°©s
->
dŸ11RTSFaûuªCou¡
 = 
ah
->°©s.
πs_Áû
;

560 
°©s
->
dŸ11RTSSuc˚ssCou¡
 = 
ah
->°©s.
πs_ok
;

561 
°©s
->
dŸ11FCSEº‹Cou¡
 = 
ah
->°©s.
fcs_îr‹
;

564 
	}
}

568 
	$©h5k_c⁄f_tx
(
õì80211_hw
 *
hw
, 
u16
 
queue
,

569 c⁄° 
õì80211_tx_queue_∑øms
 *
∑øms
)

571 
©h5k_hw
 *
ah
 = 
hw
->
¥iv
;

572 
©h5k_txq_öfo
 
qi
;

573 
ªt
 = 0;

575 i‡(
queue
 >
ah
->
ah_ˇ∑bûôõs
.
ˇp_queues
.
q_tx_num
)

578 
	`muãx_lock
(&
ah
->
lock
);

580 
	`©h5k_hw_gë_tx_queuïr›s
(
ah
, 
queue
, &
qi
);

582 
qi
.
tqi_aifs
 = 
∑øms
->
aifs
;

583 
qi
.
tqi_cw_mö
 = 
∑øms
->
cw_mö
;

584 
qi
.
tqi_cw_max
 = 
∑øms
->
cw_max
;

585 
qi
.
tqi_bur°_time
 = 
∑øms
->
tx›
;

587 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_ANY
,

590 
queue
, 
∑øms
->
aifs
,Ö¨ams->
cw_mö
,

591 
∑øms
->
cw_max
,Ö¨ams->
tx›
);

593 i‡(
	`©h5k_hw_£t_tx_queuïr›s
(
ah
, 
queue
, &
qi
)) {

594 
	`ATH5K_ERR
(
ah
,

595 "U«bÀÅÿupd©êh¨dw¨êqueuê%u!\n", 
queue
);

596 
ªt
 = -
EIO
;

598 
	`©h5k_hw_ª£t_tx_queue
(
ah
, 
queue
);

600 
	`muãx_u∆ock
(&
ah
->
lock
);

602  
ªt
;

603 
	}
}

606 
u64


607 
	$©h5k_gë_tsf
(
õì80211_hw
 *
hw
)

609 
©h5k_hw
 *
ah
 = 
hw
->
¥iv
;

611  
	`©h5k_hw_gë_tsf64
(
ah
);

612 
	}
}

616 
	$©h5k_£t_tsf
(
õì80211_hw
 *
hw
, 
u64
 
tsf
)

618 
©h5k_hw
 *
ah
 = 
hw
->
¥iv
;

620 
	`©h5k_hw_£t_tsf64
(
ah
, 
tsf
);

621 
	}
}

625 
	$©h5k_ª£t_tsf
(
õì80211_hw
 *
hw
)

627 
©h5k_hw
 *
ah
 = 
hw
->
¥iv
;

633 i‡(
ah
->
›mode
 =
NL80211_IFTYPE_ADHOC
)

634 
	`©h5k_bóc⁄_upd©e_timîs
(
ah
, 0);

636 
	`©h5k_hw_ª£t_tsf
(
ah
);

637 
	}
}

641 
	$©h5k_gë_survey
(
õì80211_hw
 *
hw
, 
idx
, 
survey_öfo
 *
survey
)

643 
©h5k_hw
 *
ah
 = 
hw
->
¥iv
;

644 
õì80211_c⁄f
 *
c⁄f
 = &
hw
->conf;

645 
©h_comm⁄
 *
comm⁄
 = 
	`©h5k_hw_comm⁄
(
ah
);

646 
©h_cy˛e_cou¡îs
 *
cc
 = &
comm⁄
->
cc_survey
;

647 
div
 = 
comm⁄
->
˛ockøã
 * 1000;

649 i‡(
idx
 != 0)

650  -
ENOENT
;

652 
	`•ö_lock_bh
(&
comm⁄
->
cc_lock
);

653 
	`©h_hw_cy˛e_cou¡îs_upd©e
(
comm⁄
);

654 i‡(
cc
->
cy˛es
 > 0) {

655 
ah
->
survey
.
ch™√l_time
 +
cc
->
cy˛es
 / 
div
;

656 
ah
->
survey
.
ch™√l_time_busy
 +
cc
->
rx_busy
 / 
div
;

657 
ah
->
survey
.
ch™√l_time_rx
 +
cc
->
rx_‰ame
 / 
div
;

658 
ah
->
survey
.
ch™√l_time_tx
 +
cc
->
tx_‰ame
 / 
div
;

660 
	`mem£t
(
cc
, 0, (*cc));

661 
	`•ö_u∆ock_bh
(&
comm⁄
->
cc_lock
);

663 
	`mem˝y
(
survey
, &
ah
->survey, (*survey));

665 
survey
->
ch™√l
 = 
c⁄f
->channel;

666 
survey
->
noi£
 = 
ah
->
ah_noi£_Êo‹
;

667 
survey
->
fûÀd
 = 
SURVEY_INFO_NOISE_DBM
 |

668 
SURVEY_INFO_CHANNEL_TIME
 |

669 
SURVEY_INFO_CHANNEL_TIME_BUSY
 |

670 
SURVEY_INFO_CHANNEL_TIME_RX
 |

671 
SURVEY_INFO_CHANNEL_TIME_TX
;

674 
	}
}

688 
	$©h5k_£t_covîage_˛ass
(
õì80211_hw
 *
hw
, 
u8
 
covîage_˛ass
)

690 
©h5k_hw
 *
ah
 = 
hw
->
¥iv
;

692 
	`muãx_lock
(&
ah
->
lock
);

693 
	`©h5k_hw_£t_covîage_˛ass
(
ah
, 
covîage_˛ass
);

694 
	`muãx_u∆ock
(&
ah
->
lock
);

695 
	}
}

699 
	$©h5k_£t_™ã¬a
(
õì80211_hw
 *
hw
, 
u32
 
tx_™t
, u32 
rx_™t
)

701 
©h5k_hw
 *
ah
 = 
hw
->
¥iv
;

703 i‡(
tx_™t
 =1 && 
rx_™t
 == 1)

704 
	`©h5k_hw_£t_™ã¬a_mode
(
ah
, 
AR5K_ANTMODE_FIXED_A
);

705 i‡(
tx_™t
 =2 && 
rx_™t
 == 2)

706 
	`©h5k_hw_£t_™ã¬a_mode
(
ah
, 
AR5K_ANTMODE_FIXED_B
);

707 i‡((
tx_™t
 & 3Ë=3 && (
rx_™t
 & 3) == 3)

708 
	`©h5k_hw_£t_™ã¬a_mode
(
ah
, 
AR5K_ANTMODE_DEFAULT
);

710  -
EINVAL
;

712 
	}
}

716 
	$©h5k_gë_™ã¬a
(
õì80211_hw
 *
hw
, 
u32
 *
tx_™t
, u32 *
rx_™t
)

718 
©h5k_hw
 *
ah
 = 
hw
->
¥iv
;

720 
ah
->
ah_™t_mode
) {

721 
AR5K_ANTMODE_FIXED_A
:

722 *
tx_™t
 = 1; *
rx_™t
 = 1; ;

723 
AR5K_ANTMODE_FIXED_B
:

724 *
tx_™t
 = 2; *
rx_™t
 = 2; ;

725 
AR5K_ANTMODE_DEFAULT
:

726 *
tx_™t
 = 3; *
rx_™t
 = 3; ;

729 
	}
}

732 
	$©h5k_gë_rög∑øm
(
õì80211_hw
 *
hw
,

733 
u32
 *
tx
, u32 *
tx_max
, u32 *
rx
, u32 *
rx_max
)

735 
©h5k_hw
 *
ah
 = 
hw
->
¥iv
;

737 *
tx
 = 
ah
->
txqs
[
AR5K_TX_QUEUE_ID_DATA_MIN
].
txq_max
;

739 *
tx_max
 = 
ATH5K_TXQ_LEN_MAX
;

740 *
rx
 = *
rx_max
 = 
ATH_RXBUF
;

741 
	}
}

744 
	$©h5k_£t_rög∑øm
(
õì80211_hw
 *
hw
, 
u32
 
tx
, u32 
rx
)

746 
©h5k_hw
 *
ah
 = 
hw
->
¥iv
;

747 
u16
 
qnum
;

750 i‡(
rx
 !
ATH_RXBUF
)

751  -
EINVAL
;

754 i‡(!
tx
 ||Åx > 
ATH5K_TXQ_LEN_MAX
)

755  -
EINVAL
;

757 
qnum
 = 0; qnum < 
	`ARRAY_SIZE
(
ah
->
txqs
); qnum++) {

758 i‡(!
ah
->
txqs
[
qnum
].
£tup
)

760 i‡(
ah
->
txqs
[
qnum
].qnum < 
AR5K_TX_QUEUE_ID_DATA_MIN
 ||

761 
ah
->
txqs
[
qnum
].qnum > 
AR5K_TX_QUEUE_ID_DATA_MAX
)

764 
ah
->
txqs
[
qnum
].
txq_max
 = 
tx
;

765 i‡(
ah
->
txqs
[
qnum
].
txq_Àn
 >ah->txqs[qnum].
txq_max
)

766 
	`õì80211_°›_queue
(
hw
, 
ah
->
txqs
[
qnum
].qnum);

770 
	}
}

773 c⁄° 
õì80211_›s
 
	g©h5k_hw_›s
 = {

774 .
tx
 = 
©h5k_tx
,

775 .
	g°¨t
 = 
©h5k_°¨t
,

776 .
	g°›
 = 
©h5k_°›
,

777 .
	gadd_öãrÁ˚
 = 
©h5k_add_öãrÁ˚
,

779 .
	gªmove_öãrÁ˚
 = 
©h5k_ªmove_öãrÁ˚
,

780 .
	gc⁄fig
 = 
©h5k_c⁄fig
,

781 .
	gbss_öfo_ch™ged
 = 
©h5k_bss_öfo_ch™ged
,

782 .
	g¥ï¨e_mu…iˇ°
 = 
©h5k_¥ï¨e_mu…iˇ°
,

783 .
	gc⁄figuª_fûãr
 = 
©h5k_c⁄figuª_fûãr
,

785 .
	g£t_key
 = 
©h5k_£t_key
,

788 .
	gsw_sˇn_°¨t
 = 
©h5k_sw_sˇn_°¨t
,

789 .
	gsw_sˇn_com∂ëe
 = 
©h5k_sw_sˇn_com∂ëe
,

790 .
	ggë_°©s
 = 
©h5k_gë_°©s
,

797 .
	gc⁄f_tx
 = 
©h5k_c⁄f_tx
,

798 .
	ggë_tsf
 = 
©h5k_gë_tsf
,

799 .
	g£t_tsf
 = 
©h5k_£t_tsf
,

800 .
	gª£t_tsf
 = 
©h5k_ª£t_tsf
,

803 .
	ggë_survey
 = 
©h5k_gë_survey
,

804 .
	g£t_covîage_˛ass
 = 
©h5k_£t_covîage_˛ass
,

809 .
	g£t_™ã¬a
 = 
©h5k_£t_™ã¬a
,

810 .
	ggë_™ã¬a
 = 
©h5k_gë_™ã¬a
,

811 .
	g£t_rög∑øm
 = 
©h5k_£t_rög∑øm
,

812 .
	ggë_rög∑øm
 = 
©h5k_gë_rög∑øm
,

	@ath5k/pci.c

17 
	~<löux/∆80211.h
>

18 
	~<löux/pci.h
>

19 
	~<löux/pci-a•m.h
>

20 
	~<löux/ëhîdevi˚.h
>

21 
	~"../©h.h
"

22 
	~"©h5k.h
"

23 
	~"debug.h
"

24 
	~"ba£.h
"

25 
	~"ªg.h
"

28 
DEFINE_PCI_DEVICE_TABLE
(
©h5k_pci_id_èbÀ
) = {

29 { 
PCI_VDEVICE
(
ATHEROS
, 0x0207) },

30 { 
PCI_VDEVICE
(
ATHEROS
, 0x0007) },

31 { 
PCI_VDEVICE
(
ATHEROS
, 0x0011) },

32 { 
PCI_VDEVICE
(
ATHEROS
, 0x0012) },

33 { 
PCI_VDEVICE
(
ATHEROS
, 0x0013) },

34 { 
PCI_VDEVICE
(3C
OM_2
, 0x0013) },

35 { 
PCI_VDEVICE
(3C
OM
, 0x0013) },

36 { 
PCI_VDEVICE
(
ATHEROS
, 0x1014) },

37 { 
PCI_VDEVICE
(
ATHEROS
, 0x0014) },

38 { 
PCI_VDEVICE
(
ATHEROS
, 0x0015) },

39 { 
PCI_VDEVICE
(
ATHEROS
, 0x0016) },

40 { 
PCI_VDEVICE
(
ATHEROS
, 0x0017) },

41 { 
PCI_VDEVICE
(
ATHEROS
, 0x0018) },

42 { 
PCI_VDEVICE
(
ATHEROS
, 0x0019) },

43 { 
PCI_VDEVICE
(
ATHEROS
, 0x001a) },

44 { 
PCI_VDEVICE
(
ATHEROS
, 0x001b) },

45 { 
PCI_VDEVICE
(
ATHEROS
, 0x001c) },

46 { 
PCI_VDEVICE
(
ATHEROS
, 0x001d) },

49 
MODULE_DEVICE_TABLE
(
pci
, 
©h5k_pci_id_èbÀ
);

52 
	$©h5k_pci_ªad_ˇchesize
(
©h_comm⁄
 *
comm⁄
, *
csz
)

54 
©h5k_hw
 *
ah
 = (©h5k_hw *Ë
comm⁄
->
¥iv
;

55 
u8
 
u8tmp
;

57 
	`pci_ªad_c⁄fig_byã
(
ah
->
pdev
, 
PCI_CACHE_LINE_SIZE
, &
u8tmp
);

58 *
csz
 = ()
u8tmp
;

66 i‡(*
csz
 == 0)

67 *
csz
 = 
L1_CACHE_BYTES
 >> 2;

68 
	}
}

73 
boﬁ


74 
	$©h5k_pci_ì¥om_ªad
(
©h_comm⁄
 *
comm⁄
, 
u32
 
off£t
, 
u16
 *
d©a
)

76 
©h5k_hw
 *
ah
 = (©h5k_hw *Ë
comm⁄
->ah;

77 
u32
 
°©us
, 
timeout
;

82 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
) {

83 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_PCICFG
, 
AR5K_PCICFG_EEAE
);

84 ()
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_EEPROM_BASE
 + (4 * 
off£t
));

86 
	`©h5k_hw_ªg_wrôe
(
ah
, 
off£t
, 
AR5K_EEPROM_BASE
);

87 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_EEPROM_CMD
,

88 
AR5K_EEPROM_CMD_READ
);

91 
timeout
 = 
AR5K_TUNE_REGISTER_TIMEOUT
;Åimeout > 0;Åimeout--) {

92 
°©us
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_EEPROM_STATUS
);

93 i‡(
°©us
 & 
AR5K_EEPROM_STAT_RDDONE
) {

94 i‡(
°©us
 & 
AR5K_EEPROM_STAT_RDERR
)

95  
Ál£
;

96 *
d©a
 = (
u16
)(
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_EEPROM_DATA
) &

98  
åue
;

100 
	`udñay
(15);

103  
Ál£
;

104 
	}
}

106 
	$©h5k_hw_ªad_§ev
(
©h5k_hw
 *
ah
)

108 
ah
->
ah_mac_§ev
 = 
	`©h5k_hw_ªg_ªad
◊h, 
AR5K_SREV
);

110 
	}
}

115 
	$©h5k_pci_ì¥om_ªad_mac
(
©h5k_hw
 *
ah
, 
u8
 *
mac
)

117 
u8
 
mac_d
[
ETH_ALEN
] = {};

118 
u32
 
tŸÆ
, 
off£t
;

119 
u16
 
d©a
;

120 
o˘ë
;

122 
	`AR5K_EEPROM_READ
(0x20, 
d©a
);

124 
off£t
 = 0x1f, 
o˘ë
 = 0, 
tŸÆ
 = 0; offset >= 0x1d; offset--) {

125 
	`AR5K_EEPROM_READ
(
off£t
, 
d©a
);

127 
tŸÆ
 +
d©a
;

128 
mac_d
[
o˘ë
 + 1] = 
d©a
 & 0xff;

129 
mac_d
[
o˘ë
] = 
d©a
 >> 8;

130 
o˘ë
 += 2;

133 i‡(!
tŸÆ
 ||Åotal == 3 * 0xffff)

134  -
EINVAL
;

136 
	`mem˝y
(
mac
, 
mac_d
, 
ETH_ALEN
);

139 
	}
}

143 c⁄° 
©h_bus_›s
 
	g©h_pci_bus_›s
 = {

144 .
©h_bus_ty≥
 = 
ATH_PCI
,

145 .
	gªad_ˇchesize
 = 
©h5k_pci_ªad_ˇchesize
,

146 .
	gì¥om_ªad
 = 
©h5k_pci_ì¥om_ªad
,

147 .
	gì¥om_ªad_mac
 = 
©h5k_pci_ì¥om_ªad_mac
,

154 
__devöô


155 
	$©h5k_pci_¥obe
(
pci_dev
 *
pdev
,

156 c⁄° 
pci_devi˚_id
 *
id
)

158 
__iomem
 *
mem
;

159 
©h5k_hw
 *
ah
;

160 
õì80211_hw
 *
hw
;

161 
ªt
;

162 
u8
 
csz
;

182 
	`pci_dißbÀ_lök_°©e
(
pdev
, 
PCIE_LINK_STATE_L0S
);

184 
ªt
 = 
	`pci_íabÀ_devi˚
(
pdev
);

185 i‡(
ªt
) {

186 
	`dev_îr
(&
pdev
->
dev
, "can'tÉnable device\n");

187 
îr
;

191 
ªt
 = 
	`pci_£t_dma_mask
(
pdev
, 
	`DMA_BIT_MASK
(32));

192 i‡(
ªt
) {

193 
	`dev_îr
(&
pdev
->
dev
, "32-bit DMAÇotávailable\n");

194 
îr_dis
;

201 
	`pci_ªad_c⁄fig_byã
(
pdev
, 
PCI_CACHE_LINE_SIZE
, &
csz
);

202 i‡(
csz
 == 0) {

210 
csz
 = 
L1_CACHE_BYTES
 >> 2;

211 
	`pci_wrôe_c⁄fig_byã
(
pdev
, 
PCI_CACHE_LINE_SIZE
, 
csz
);

218 
	`pci_wrôe_c⁄fig_byã
(
pdev
, 
PCI_LATENCY_TIMER
, 0xa8);

221 
	`pci_£t_ma°î
(
pdev
);

227 
	`pci_wrôe_c⁄fig_byã
(
pdev
, 0x41, 0);

229 
ªt
 = 
	`pci_ªque°_ªgi⁄
(
pdev
, 0, "ath5k");

230 i‡(
ªt
) {

231 
	`dev_îr
(&
pdev
->
dev
, "cannotÑeserve PCI memoryÑegion\n");

232 
îr_dis
;

235 
mem
 = 
	`pci_iom≠
(
pdev
, 0, 0);

236 i‡(!
mem
) {

237 
	`dev_îr
(&
pdev
->
dev
, "cannotÑemap PCI memoryÑegion\n");

238 
ªt
 = -
EIO
;

239 
îr_ªg
;

246 
hw
 = 
	`õì80211_Æloc_hw
((*
ah
), &
©h5k_hw_›s
);

247 i‡(
hw
 =
NULL
) {

248 
	`dev_îr
(&
pdev
->
dev
, "cannotállocate ieee80211_hw\n");

249 
ªt
 = -
ENOMEM
;

250 
îr_m≠
;

253 
	`dev_öfo
(&
pdev
->
dev
, "ªgi°îedá†'%s'\n", 
	`wùhy_«me
(
hw
->
wùhy
));

255 
ah
 = 
hw
->
¥iv
;

256 
ah
->
hw
 = hw;

257 
ah
->
pdev
 =Ödev;

258 
ah
->
dev
 = &
pdev
->dev;

259 
ah
->
úq
 = 
pdev
->irq;

260 
ah
->
devid
 = 
id
->
devi˚
;

261 
ah
->
ioba£
 = 
mem
;

264 
ªt
 = 
	`©h5k_öô_so·c
(
ah
, &
©h_pci_bus_›s
);

265 i‡(
ªt
)

266 
îr_‰ì
;

269 
	`pci_£t_drvd©a
(
pdev
, 
hw
);

272 
îr_‰ì
:

273 
	`õì80211_‰ì_hw
(
hw
);

274 
îr_m≠
:

275 
	`pci_iounm≠
(
pdev
, 
mem
);

276 
îr_ªg
:

277 
	`pci_ªÀa£_ªgi⁄
(
pdev
, 0);

278 
îr_dis
:

279 
	`pci_dißbÀ_devi˚
(
pdev
);

280 
îr
:

281  
ªt
;

282 
	}
}

284 
__devexô


285 
	$©h5k_pci_ªmove
(
pci_dev
 *
pdev
)

287 
õì80211_hw
 *
hw
 = 
	`pci_gë_drvd©a
(
pdev
);

288 
©h5k_hw
 *
ah
 = 
hw
->
¥iv
;

290 
	`©h5k_deöô_so·c
(
ah
);

291 
	`pci_iounm≠
(
pdev
, 
ah
->
ioba£
);

292 
	`pci_ªÀa£_ªgi⁄
(
pdev
, 0);

293 
	`pci_dißbÀ_devi˚
(
pdev
);

294 
	`õì80211_‰ì_hw
(
hw
);

295 
	}
}

297 #ifde‡
CONFIG_PM_SLEEP


298 
	$©h5k_pci_su•íd
(
devi˚
 *
dev
)

300 
pci_dev
 *
pdev
 = 
	`to_pci_dev
(
dev
);

301 
õì80211_hw
 *
hw
 = 
	`pci_gë_drvd©a
(
pdev
);

302 
©h5k_hw
 *
ah
 = 
hw
->
¥iv
;

304 
	`©h5k_Àd_off
(
ah
);

306 
	}
}

308 
	$©h5k_pci_ªsume
(
devi˚
 *
dev
)

310 
pci_dev
 *
pdev
 = 
	`to_pci_dev
(
dev
);

311 
õì80211_hw
 *
hw
 = 
	`pci_gë_drvd©a
(
pdev
);

312 
©h5k_hw
 *
ah
 = 
hw
->
¥iv
;

319 
	`pci_wrôe_c⁄fig_byã
(
pdev
, 0x41, 0);

321 
	`©h5k_Àd_íabÀ
(
ah
);

323 
	}
}

325 
SIMPLE_DEV_PM_OPS
(
©h5k_pm_›s
, 
©h5k_pci_su•íd
, 
©h5k_pci_ªsume
);

326 
	#ATH5K_PM_OPS
 (&
©h5k_pm_›s
)

	)

328 
	#ATH5K_PM_OPS
 
NULL


	)

331 
pci_drivî
 
	g©h5k_pci_drivî
 = {

332 .
«me
 = 
KBUILD_MODNAME
,

333 .
	gid_èbÀ
 = 
©h5k_pci_id_èbÀ
,

334 .
	g¥obe
 = 
©h5k_pci_¥obe
,

335 .
	gªmove
 = 
__devexô_p
(
©h5k_pci_ªmove
),

336 .
	gdrivî
.
	gpm
 = 
ATH5K_PM_OPS
,

342 
__öô


343 
	$öô_©h5k_pci
()

345 
ªt
;

347 
ªt
 = 
	`pci_ªgi°î_drivî
(&
©h5k_pci_drivî
);

348 i‡(
ªt
) {

349 
	`¥ötk
(
KERN_ERR
 "ath5k_pci: can'tÑegisterÖci driver\n");

350  
ªt
;

354 
	}
}

356 
__exô


357 
	$exô_©h5k_pci
()

359 
	`pci_uƒegi°î_drivî
(&
©h5k_pci_drivî
);

360 
	}
}

362 
moduÀ_öô
(
öô_©h5k_pci
);

363 
moduÀ_exô
(
exô_©h5k_pci
);

	@ath5k/pcu.c

27 
	~<asm/u«lig√d.h
>

29 
	~"©h5k.h
"

30 
	~"ªg.h
"

31 
	~"debug.h
"

32 
	~"ba£.h
"

47 c⁄° 
	gack_øãs_high
[] =

77 
	$©h5k_hw_gë_‰ame_duøti⁄
(
©h5k_hw
 *
ah
,

78 
Àn
, 
õì80211_øã
 *
øã
, 
boﬁ
 
sh‹çª
)

80 
sifs
, 
¥ómbÀ
, 
∂˝_bôs
, 
sym_time
;

81 
bôøã
, 
bôs
, 
symbﬁs
, 
symbﬁ_bôs
;

82 
dur
;

85 i‡(!
ah
->
ah_bwmode
) {

86 
__À16
 
øw_dur
 = 
	`õì80211_gíîic_‰ame_duøti⁄
(
ah
->
hw
,

87 
NULL
, 
Àn
, 
øã
);

90 
dur
 = 
	`À16_to_˝u
(
øw_dur
);

91 i‡(
sh‹çª
)

92 
dur
 -= 96;

94  
dur
;

97 
bôøã
 = 
øã
->bitrate;

98 
¥ómbÀ
 = 
AR5K_INIT_OFDM_PREAMPLE_TIME
;

99 
∂˝_bôs
 = 
AR5K_INIT_OFDM_PLCP_BITS
;

100 
sym_time
 = 
AR5K_INIT_OFDM_SYMBOL_TIME
;

102 
ah
->
ah_bwmode
) {

103 
AR5K_BWMODE_40MHZ
:

104 
sifs
 = 
AR5K_INIT_SIFS_TURBO
;

105 
¥ómbÀ
 = 
AR5K_INIT_OFDM_PREAMBLE_TIME_MIN
;

107 
AR5K_BWMODE_10MHZ
:

108 
sifs
 = 
AR5K_INIT_SIFS_HALF_RATE
;

109 
¥ómbÀ
 *= 2;

110 
sym_time
 *= 2;

112 
AR5K_BWMODE_5MHZ
:

113 
sifs
 = 
AR5K_INIT_SIFS_QUARTER_RATE
;

114 
¥ómbÀ
 *= 4;

115 
sym_time
 *= 4;

118 
sifs
 = 
AR5K_INIT_SIFS_DEFAULT_BG
;

122 
bôs
 = 
∂˝_bôs
 + (
Àn
 << 3);

124 
symbﬁ_bôs
 = 
bôøã
 * 
sym_time
;

125 
symbﬁs
 = 
	`DIV_ROUND_UP
(
bôs
 * 10, 
symbﬁ_bôs
);

127 
dur
 = 
sifs
 + 
¥ómbÀ
 + (
sym_time
 * 
symbﬁs
);

129  
dur
;

130 
	}
}

137 
	$©h5k_hw_gë_deÁu…_¶Ÿtime
(
©h5k_hw
 *
ah
)

139 
õì80211_ch™√l
 *
ch™√l
 = 
ah
->
ah_cuºít_ch™√l
;

140 
¶Ÿ_time
;

142 
ah
->
ah_bwmode
) {

143 
AR5K_BWMODE_40MHZ
:

144 
¶Ÿ_time
 = 
AR5K_INIT_SLOT_TIME_TURBO
;

146 
AR5K_BWMODE_10MHZ
:

147 
¶Ÿ_time
 = 
AR5K_INIT_SLOT_TIME_HALF_RATE
;

149 
AR5K_BWMODE_5MHZ
:

150 
¶Ÿ_time
 = 
AR5K_INIT_SLOT_TIME_QUARTER_RATE
;

152 
AR5K_BWMODE_DEFAULT
:

154 
¶Ÿ_time
 = 
AR5K_INIT_SLOT_TIME_DEFAULT
;

155 i‡((
ch™√l
->
hw_vÆue
 & 
CHANNEL_CCK
Ë&& !
ah
->
ah_sh‹t_¶Ÿ
)

156 
¶Ÿ_time
 = 
AR5K_INIT_SLOT_TIME_B
;

160  
¶Ÿ_time
;

161 
	}
}

168 
	$©h5k_hw_gë_deÁu…_sifs
(
©h5k_hw
 *
ah
)

170 
õì80211_ch™√l
 *
ch™√l
 = 
ah
->
ah_cuºít_ch™√l
;

171 
sifs
;

173 
ah
->
ah_bwmode
) {

174 
AR5K_BWMODE_40MHZ
:

175 
sifs
 = 
AR5K_INIT_SIFS_TURBO
;

177 
AR5K_BWMODE_10MHZ
:

178 
sifs
 = 
AR5K_INIT_SIFS_HALF_RATE
;

180 
AR5K_BWMODE_5MHZ
:

181 
sifs
 = 
AR5K_INIT_SIFS_QUARTER_RATE
;

183 
AR5K_BWMODE_DEFAULT
:

184 
sifs
 = 
AR5K_INIT_SIFS_DEFAULT_BG
;

186 i‡(
ch™√l
->
hw_vÆue
 & 
CHANNEL_5GHZ
)

187 
sifs
 = 
AR5K_INIT_SIFS_DEFAULT_A
;

191  
sifs
;

192 
	}
}

205 
	$©h5k_hw_upd©e_mib_cou¡îs
(
©h5k_hw
 *
ah
)

207 
©h5k_°©i°ics
 *
°©s
 = &
ah
->stats;

210 
°©s
->
ack_Áû
 +
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_ACK_FAIL
);

211 
°©s
->
πs_Áû
 +
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_RTS_FAIL
);

212 
°©s
->
πs_ok
 +
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_RTS_OK
);

213 
°©s
->
fcs_îr‹
 +
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_FCS_FAIL
);

214 
°©s
->
bóc⁄s
 +
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_BEACON_CNT
);

215 
	}
}

240 
ölöe
 
	$©h5k_hw_wrôe_øã_duøti⁄
(
©h5k_hw
 *
ah
)

242 
õì80211_øã
 *
øã
;

243 
i
;

245 
u8
 
b™d
 = 
IEEE80211_BAND_2GHZ
;

248 
i
 = 0; i < 
ah
->
sb™ds
[
b™d
].
n_bôøãs
; i++) {

249 
u32
 
ªg
;

250 
u16
 
tx_time
;

252 i‡(
ah
->
ah_ack_bôøã_high
)

253 
øã
 = &
ah
->
sb™ds
[
b™d
].
bôøãs
[
ack_øãs_high
[
i
]];

255 i‡(
i
 < 4)

256 
øã
 = &
ah
->
sb™ds
[
b™d
].
bôøãs
[0];

259 
øã
 = &
ah
->
sb™ds
[
b™d
].
bôøãs
[4];

262 
ªg
 = 
	`AR5K_RATE_DUR
(
øã
->
hw_vÆue
);

270 
tx_time
 = 
	`©h5k_hw_gë_‰ame_duøti⁄
(
ah
, 10, 
øã
, 
Ál£
);

272 
	`©h5k_hw_ªg_wrôe
(
ah
, 
tx_time
, 
ªg
);

274 i‡(!(
øã
->
Êags
 & 
IEEE80211_RATE_SHORT_PREAMBLE
))

277 
tx_time
 = 
	`©h5k_hw_gë_‰ame_duøti⁄
(
ah
, 10, 
øã
, 
åue
);

278 
	`©h5k_hw_ªg_wrôe
(
ah
, 
tx_time
,

279 
ªg
 + (
AR5K_SET_SHORT_PREAMBLE
 << 2));

281 
	}
}

289 
	$©h5k_hw_£t_ack_timeout
(
©h5k_hw
 *
ah
, 
timeout
)

291 i‡(
	`©h5k_hw_˛ocktoh
(
ah
, 
	`AR5K_REG_MS
(0xffffffff, 
AR5K_TIME_OUT_ACK
))

292 <
timeout
)

293  -
EINVAL
;

295 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_TIME_OUT
, 
AR5K_TIME_OUT_ACK
,

296 
	`©h5k_hw_hto˛ock
(
ah
, 
timeout
));

299 
	}
}

307 
	$©h5k_hw_£t_˘s_timeout
(
©h5k_hw
 *
ah
, 
timeout
)

309 i‡(
	`©h5k_hw_˛ocktoh
(
ah
, 
	`AR5K_REG_MS
(0xffffffff, 
AR5K_TIME_OUT_CTS
))

310 <
timeout
)

311  -
EINVAL
;

313 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_TIME_OUT
, 
AR5K_TIME_OUT_CTS
,

314 
	`©h5k_hw_hto˛ock
(
ah
, 
timeout
));

317 
	}
}

332 
	$©h5k_hw_£t_Œaddr
(
©h5k_hw
 *
ah
, c⁄° 
u8
 *
mac
)

334 
©h_comm⁄
 *
comm⁄
 = 
	`©h5k_hw_comm⁄
(
ah
);

335 
u32
 
low_id
, 
high_id
;

336 
u32
 
pcu_ªg
;

339 
	`mem˝y
(
comm⁄
->
maˇddr
, 
mac
, 
ETH_ALEN
);

341 
pcu_ªg
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_STA_ID1
) & 0xffff0000;

343 
low_id
 = 
	`gë_u«lig√d_À32
(
mac
);

344 
high_id
 = 
	`gë_u«lig√d_À16
(
mac
 + 4);

346 
	`©h5k_hw_ªg_wrôe
(
ah
, 
low_id
, 
AR5K_STA_ID0
);

347 
	`©h5k_hw_ªg_wrôe
(
ah
, 
pcu_ªg
 | 
high_id
, 
AR5K_STA_ID1
);

350 
	}
}

360 
	$©h5k_hw_£t_bssid
(
©h5k_hw
 *
ah
)

362 
©h_comm⁄
 *
comm⁄
 = 
	`©h5k_hw_comm⁄
(
ah
);

363 
u16
 
tim_off£t
 = 0;

368 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5212
)

369 
	`©h_hw_£tbssidmask
(
comm⁄
);

374 
	`©h5k_hw_ªg_wrôe
(
ah
,

375 
	`gë_u«lig√d_À32
(
comm⁄
->
curbssid
),

376 
AR5K_BSS_ID0
);

377 
	`©h5k_hw_ªg_wrôe
(
ah
,

378 
	`gë_u«lig√d_À16
(
comm⁄
->
curbssid
 + 4) |

379 ((
comm⁄
->
cuøid
 & 0x3fffË<< 
AR5K_BSS_ID1_AID_S
),

380 
AR5K_BSS_ID1
);

382 i‡(
comm⁄
->
cuøid
 == 0) {

383 
	`©h5k_hw_dißbÀ_p•ﬁl
(
ah
);

387 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_BEACON
, 
AR5K_BEACON_TIM
,

388 
tim_off£t
 ?Åim_offset + 4 : 0);

390 
	`©h5k_hw_íabÀ_p•ﬁl
(
ah
, 
NULL
, 0);

391 
	}
}

393 
	$©h5k_hw_£t_bssid_mask
(
©h5k_hw
 *
ah
, c⁄° 
u8
 *
mask
)

395 
©h_comm⁄
 *
comm⁄
 = 
	`©h5k_hw_comm⁄
(
ah
);

399 
	`mem˝y
(
comm⁄
->
bssidmask
, 
mask
, 
ETH_ALEN
);

400 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5212
)

401 
	`©h_hw_£tbssidmask
(
comm⁄
);

402 
	}
}

407 
	$©h5k_hw_£t_mˇ°_fûãr
(
©h5k_hw
 *
ah
, 
u32
 
fûãr0
, u32 
fûãr1
)

409 
	`©h5k_hw_ªg_wrôe
(
ah
, 
fûãr0
, 
AR5K_MCAST_FILTER0
);

410 
	`©h5k_hw_ªg_wrôe
(
ah
, 
fûãr1
, 
AR5K_MCAST_FILTER1
);

411 
	}
}

424 
u32
 
	$©h5k_hw_gë_rx_fûãr
(
©h5k_hw
 *
ah
)

426 
u32
 
d©a
, 
fûãr
 = 0;

428 
fûãr
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_RX_FILTER
);

431 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5212
) {

432 
d©a
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PHY_ERR_FIL
);

434 i‡(
d©a
 & 
AR5K_PHY_ERR_FIL_RADAR
)

435 
fûãr
 |
AR5K_RX_FILTER_RADARERR
;

436 i‡(
d©a
 & (
AR5K_PHY_ERR_FIL_OFDM
 | 
AR5K_PHY_ERR_FIL_CCK
))

437 
fûãr
 |
AR5K_RX_FILTER_PHYERR
;

440  
fûãr
;

441 
	}
}

453 
	$©h5k_hw_£t_rx_fûãr
(
©h5k_hw
 *
ah
, 
u32
 
fûãr
)

455 
u32
 
d©a
 = 0;

458 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5212
) {

459 i‡(
fûãr
 & 
AR5K_RX_FILTER_RADARERR
)

460 
d©a
 |
AR5K_PHY_ERR_FIL_RADAR
;

461 i‡(
fûãr
 & 
AR5K_RX_FILTER_PHYERR
)

462 
d©a
 |
AR5K_PHY_ERR_FIL_OFDM
 | 
AR5K_PHY_ERR_FIL_CCK
;

468 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
 &&

469 (
fûãr
 & 
AR5K_RX_FILTER_RADARERR
)) {

470 
fûãr
 &~
AR5K_RX_FILTER_RADARERR
;

471 
fûãr
 |
AR5K_RX_FILTER_PROM
;

475 i‡(
d©a
)

476 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_RXCFG
, 
AR5K_RXCFG_ZLFDMA
);

478 
	`AR5K_REG_DISABLE_BITS
(
ah
, 
AR5K_RXCFG
, 
AR5K_RXCFG_ZLFDMA
);

481 
	`©h5k_hw_ªg_wrôe
(
ah
, 
fûãr
 & 0xff, 
AR5K_RX_FILTER
);

484 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5212
)

485 
	`©h5k_hw_ªg_wrôe
(
ah
, 
d©a
, 
AR5K_PHY_ERR_FIL
);

487 
	}
}

494 
	#ATH5K_MAX_TSF_READ
 10

	)

503 
u64
 
	$©h5k_hw_gë_tsf64
(
©h5k_hw
 *
ah
)

505 
u32
 
tsf_lowî
, 
tsf_uµî1
, 
tsf_uµî2
;

506 
i
;

507 
Êags
;

510 
	`loˇl_úq_ßve
(
Êags
);

524 
tsf_uµî1
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_TSF_U32
);

525 
i
 = 0; i < 
ATH5K_MAX_TSF_READ
; i++) {

526 
tsf_lowî
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_TSF_L32
);

527 
tsf_uµî2
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_TSF_U32
);

528 i‡(
tsf_uµî2
 =
tsf_uµî1
)

530 
tsf_uµî1
 = 
tsf_uµî2
;

533 
	`loˇl_úq_ª°‹e
(
Êags
);

535 
	`WARN_ON
(
i
 =
ATH5K_MAX_TSF_READ
);

537  ((
u64
)
tsf_uµî1
 << 32Ë| 
tsf_lowî
;

538 
	}
}

548 
	$©h5k_hw_£t_tsf64
(
©h5k_hw
 *
ah
, 
u64
 
tsf64
)

550 
	`©h5k_hw_ªg_wrôe
(
ah
, 
tsf64
 & 0xffffffff, 
AR5K_TSF_L32
);

551 
	`©h5k_hw_ªg_wrôe
(
ah
, (
tsf64
 >> 32Ë& 0xffffffff, 
AR5K_TSF_U32
);

552 
	}
}

561 
	$©h5k_hw_ª£t_tsf
(
©h5k_hw
 *
ah
)

563 
u32
 
vÆ
;

565 
vÆ
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_BEACON
Ë| 
AR5K_BEACON_RESET_TSF
;

573 
	`©h5k_hw_ªg_wrôe
(
ah
, 
vÆ
, 
AR5K_BEACON
);

574 
	`©h5k_hw_ªg_wrôe
(
ah
, 
vÆ
, 
AR5K_BEACON
);

575 
	}
}

580 
	$©h5k_hw_öô_bóc⁄
(
©h5k_hw
 *
ah
, 
u32
 
√xt_bóc⁄
, u32 
öãrvÆ
)

582 
u32
 
timî1
, 
timî2
, 
timî3
;

587 
ah
->
›mode
) {

588 
NL80211_IFTYPE_MONITOR
:

589 
NL80211_IFTYPE_STATION
:

594 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
) {

595 
timî1
 = 0xffffffff;

596 
timî2
 = 0xffffffff;

598 
timî1
 = 0x0000ffff;

599 
timî2
 = 0x0007ffff;

602 
	`AR5K_REG_DISABLE_BITS
(
ah
, 
AR5K_STA_ID1
, 
AR5K_STA_ID1_PCF
);

604 
NL80211_IFTYPE_ADHOC
:

605 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_TXCFG
, 
AR5K_TXCFG_ADHOC_BCN_ATIM
);

610 
timî1
 = (
√xt_bóc⁄
 - 
AR5K_TUNE_DMA_BEACON_RESP
) << 3;

611 
timî2
 = (
√xt_bóc⁄
 - 
AR5K_TUNE_SW_BEACON_RESP
) << 3;

618 
timî3
 = 
√xt_bóc⁄
 + 1;

624 i‡(
ah
->
›mode
 =
NL80211_IFTYPE_AP
 ||

625 
ah
->
›mode
 =
NL80211_IFTYPE_MESH_POINT
)

626 
	`©h5k_hw_ªg_wrôe
(
ah
, 0, 
AR5K_TIMER0
);

628 
	`©h5k_hw_ªg_wrôe
(
ah
, 
√xt_bóc⁄
, 
AR5K_TIMER0
);

629 
	`©h5k_hw_ªg_wrôe
(
ah
, 
timî1
, 
AR5K_TIMER1
);

630 
	`©h5k_hw_ªg_wrôe
(
ah
, 
timî2
, 
AR5K_TIMER2
);

631 
	`©h5k_hw_ªg_wrôe
(
ah
, 
timî3
, 
AR5K_TIMER3
);

634 i‡(
öãrvÆ
 & 
AR5K_BEACON_RESET_TSF
)

635 
	`©h5k_hw_ª£t_tsf
(
ah
);

637 
	`©h5k_hw_ªg_wrôe
(
ah
, 
öãrvÆ
 & (
AR5K_BEACON_PERIOD
 |

638 
AR5K_BEACON_ENABLE
),

639 
AR5K_BEACON
);

646 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
)

647 
	`©h5k_hw_ªg_wrôe
(
ah
, 
AR5K_ISR_BMISS
, 
AR5K_ISR
);

649 
	`©h5k_hw_ªg_wrôe
(
ah
, 
AR5K_ISR_BMISS
, 
AR5K_PISR
);

654 
	`AR5K_REG_DISABLE_BITS
(
ah
, 
AR5K_STA_ID1
, 
AR5K_STA_ID1_PWR_SV
);

656 
	}
}

672 
ölöe
 
boﬁ


673 
	$©h5k_check_timî_wö
(
a
, 
b
, 
wödow
, 
ötvÆ
)

681 i‡((
b
 - 
a
 =
wödow
) ||

682 (
a
 - 
b
 =
ötvÆ
 - 
wödow
) ||

683 ((
a
 | 0x10000Ë- 
b
 =
ötvÆ
 - 
wödow
) ||

684 ((
b
 | 0x10000Ë- 
a
 =
wödow
))

685  
åue
;

686  
Ál£
;

687 
	}
}

729 
boﬁ


730 
	$©h5k_hw_check_bóc⁄_timîs
(
©h5k_hw
 *
ah
, 
ötvÆ
)

732 
nbâ
, 
©im
, 
dma
;

734 
nbâ
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_TIMER0
);

735 
©im
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_TIMER3
);

736 
dma
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_TIMER1
) >> 3;

742 i‡(
	`©h5k_check_timî_wö
(
nbâ
, 
©im
, 1, 
ötvÆ
) &&

743 
	`©h5k_check_timî_wö
(
dma
, 
nbâ
, 
AR5K_TUNE_DMA_BEACON_RESP
,

744 
ötvÆ
))

745  
åue
;

746  
Ál£
;

747 
	}
}

757 
	$©h5k_hw_£t_covîage_˛ass
(
©h5k_hw
 *
ah
, 
u8
 
covîage_˛ass
)

760 
¶Ÿ_time
 = 
	`©h5k_hw_gë_deÁu…_¶Ÿtime
(
ah
Ë+ 3 * 
covîage_˛ass
;

761 
ack_timeout
 = 
	`©h5k_hw_gë_deÁu…_sifs
(
ah
Ë+ 
¶Ÿ_time
;

762 
˘s_timeout
 = 
ack_timeout
;

764 
	`©h5k_hw_£t_ifs_öãrvÆs
(
ah
, 
¶Ÿ_time
);

765 
	`©h5k_hw_£t_ack_timeout
(
ah
, 
ack_timeout
);

766 
	`©h5k_hw_£t_˘s_timeout
(
ah
, 
˘s_timeout
);

768 
ah
->
ah_covîage_˛ass
 = 
covîage_˛ass
;

769 
	}
}

785 
	$©h5k_hw_°¨t_rx_pcu
(
©h5k_hw
 *
ah
)

787 
	`AR5K_REG_DISABLE_BITS
(
ah
, 
AR5K_DIAG_SW
, 
AR5K_DIAG_SW_DIS_RX
);

788 
	}
}

797 
	$©h5k_hw_°›_rx_pcu
(
©h5k_hw
 *
ah
)

799 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_DIAG_SW
, 
AR5K_DIAG_SW_DIS_RX
);

800 
	}
}

810 
	$©h5k_hw_£t_›mode
(
©h5k_hw
 *
ah
, 
∆80211_i·y≥
 
›_mode
)

812 
©h_comm⁄
 *
comm⁄
 = 
	`©h5k_hw_comm⁄
(
ah
);

813 
u32
 
pcu_ªg
, 
bóc⁄_ªg
, 
low_id
, 
high_id
;

815 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_MODE
, "modê%d\n", 
›_mode
);

818 
pcu_ªg
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_STA_ID1
) & 0xffff0000;

819 
pcu_ªg
 &~(
AR5K_STA_ID1_ADHOC
 | 
AR5K_STA_ID1_AP


820 | 
AR5K_STA_ID1_KEYSRCH_MODE


821 | (
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
 ?

822 (
AR5K_STA_ID1_PWR_SV
 | 
AR5K_STA_ID1_NO_PSPOLL
) : 0));

824 
bóc⁄_ªg
 = 0;

826 
›_mode
) {

827 
NL80211_IFTYPE_ADHOC
:

828 
pcu_ªg
 |
AR5K_STA_ID1_ADHOC
 | 
AR5K_STA_ID1_KEYSRCH_MODE
;

829 
bóc⁄_ªg
 |
AR5K_BCR_ADHOC
;

830 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
)

831 
pcu_ªg
 |
AR5K_STA_ID1_NO_PSPOLL
;

833 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_CFG
, 
AR5K_CFG_IBSS
);

836 
NL80211_IFTYPE_AP
:

837 
NL80211_IFTYPE_MESH_POINT
:

838 
pcu_ªg
 |
AR5K_STA_ID1_AP
 | 
AR5K_STA_ID1_KEYSRCH_MODE
;

839 
bóc⁄_ªg
 |
AR5K_BCR_AP
;

840 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
)

841 
pcu_ªg
 |
AR5K_STA_ID1_NO_PSPOLL
;

843 
	`AR5K_REG_DISABLE_BITS
(
ah
, 
AR5K_CFG
, 
AR5K_CFG_IBSS
);

846 
NL80211_IFTYPE_STATION
:

847 
pcu_ªg
 |
AR5K_STA_ID1_KEYSRCH_MODE


848 | (
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
 ?

849 
AR5K_STA_ID1_PWR_SV
 : 0);

850 
NL80211_IFTYPE_MONITOR
:

851 
pcu_ªg
 |
AR5K_STA_ID1_KEYSRCH_MODE


852 | (
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
 ?

853 
AR5K_STA_ID1_NO_PSPOLL
 : 0);

857  -
EINVAL
;

863 
low_id
 = 
	`gë_u«lig√d_À32
(
comm⁄
->
maˇddr
);

864 
high_id
 = 
	`gë_u«lig√d_À16
(
comm⁄
->
maˇddr
 + 4);

865 
	`©h5k_hw_ªg_wrôe
(
ah
, 
low_id
, 
AR5K_STA_ID0
);

866 
	`©h5k_hw_ªg_wrôe
(
ah
, 
pcu_ªg
 | 
high_id
, 
AR5K_STA_ID1
);

871 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
)

872 
	`©h5k_hw_ªg_wrôe
(
ah
, 
bóc⁄_ªg
, 
AR5K_BCR
);

875 
	}
}

877 
	$©h5k_hw_pcu_öô
(
©h5k_hw
 *
ah
, 
∆80211_i·y≥
 
›_mode
,

878 
u8
 
mode
)

881 
	`©h5k_hw_£t_bssid
(
ah
);

884 
	`©h5k_hw_£t_›mode
(
ah
, 
›_mode
);

890 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5212
 &&

891 
ah
->
nvifs
)

892 
	`©h5k_hw_wrôe_øã_duøti⁄
(
ah
);

902 
	`©h5k_hw_ªg_wrôe
(
ah
, (
AR5K_TUNE_RSSI_THRES
 |

903 
AR5K_TUNE_BMISS_THRES
 <<

904 
AR5K_RSSI_THR_BMISS_S
),

905 
AR5K_RSSI_THR
);

908 i‡(
ah
->
ah_mac_§ev
 >
AR5K_SREV_AR2413
) {

909 
	`©h5k_hw_ªg_wrôe
(
ah
, 0x000100Ø, 
AR5K_MIC_QOS_CTL
);

910 
	`©h5k_hw_ªg_wrôe
(
ah
, 0x00003210, 
AR5K_MIC_QOS_SEL
);

914 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5212
) {

915 
	`©h5k_hw_ªg_wrôe
(
ah
,

916 
	`AR5K_REG_SM
(2, 
AR5K_QOS_NOACK_2BIT_VALUES
) |

917 
	`AR5K_REG_SM
(5, 
AR5K_QOS_NOACK_BIT_OFFSET
) |

918 
	`AR5K_REG_SM
(0, 
AR5K_QOS_NOACK_BYTE_OFFSET
),

919 
AR5K_QOS_NOACK
);

923 i‡(
ah
->
ah_covîage_˛ass
 > 0)

924 
	`©h5k_hw_£t_covîage_˛ass
(
ah
,áh->
ah_covîage_˛ass
);

927 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5212
) {

928 
u32
 
vÆ
 = 
AR5K_STA_ID1_BASE_RATE_11B
 | 
AR5K_STA_ID1_ACKCTS_6MB
;

929 i‡(
ah
->
ah_ack_bôøã_high
)

930 
	`AR5K_REG_DISABLE_BITS
(
ah
, 
AR5K_STA_ID1
, 
vÆ
);

932 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_STA_ID1
, 
vÆ
);

935 
	}
}

	@ath5k/phy.c

23 
	~<löux/dñay.h
>

24 
	~<löux/¶ab.h
>

25 
	~<asm/u«lig√d.h
>

27 
	~"©h5k.h
"

28 
	~"ªg.h
"

29 
	~"ba£.h
"

30 
	~"rfbuf„r.h
"

31 
	~"rfgaö.h
"

41 
u16
 
	$©h5k_hw_ødio_ªvisi⁄
(
©h5k_hw
 *
ah
, 
ch™
)

43 
i
;

44 
u32
 
§ev
;

45 
u16
 
ªt
;

50 
ch™
) {

51 
CHANNEL_2GHZ
:

52 
	`©h5k_hw_ªg_wrôe
(
ah
, 
AR5K_PHY_SHIFT_2GHZ
, 
	`AR5K_PHY
(0));

54 
CHANNEL_5GHZ
:

55 
	`©h5k_hw_ªg_wrôe
(
ah
, 
AR5K_PHY_SHIFT_5GHZ
, 
	`AR5K_PHY
(0));

61 
	`mdñay
(2);

64 
	`©h5k_hw_ªg_wrôe
(
ah
, 0x00001c16, 
	`AR5K_PHY
(0x34));

66 
i
 = 0; i < 8; i++)

67 
	`©h5k_hw_ªg_wrôe
(
ah
, 0x00010000, 
	`AR5K_PHY
(0x20));

69 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
) {

70 
§ev
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
	`AR5K_PHY
(256) >> 28) & 0xf;

71 
ªt
 = (
u16
)
	`©h5k_hw_bôsw≠
(
§ev
, 4) + 1;

73 
§ev
 = (
	`©h5k_hw_ªg_ªad
(
ah
, 
	`AR5K_PHY
(0x100)) >> 24) & 0xff;

74 
ªt
 = (
u16
)
	`©h5k_hw_bôsw≠
(((
§ev
 & 0xf0) >> 4) |

75 ((
§ev
 & 0x0f) << 4), 8);

79 
	`©h5k_hw_ªg_wrôe
(
ah
, 
AR5K_PHY_SHIFT_5GHZ
, 
	`AR5K_PHY
(0));

81  
ªt
;

82 
	}
}

87 
boﬁ
 
	$©h5k_ch™√l_ok
(
©h5k_hw
 *
ah
, 
u16
 
‰eq
, 
Êags
)

90 i‡(
Êags
 & 
CHANNEL_2GHZ
) {

91 i‡((
‰eq
 >
ah
->
ah_ˇ∑bûôõs
.
ˇp_ønge
.
ønge_2ghz_mö
) &&

92 (
‰eq
 <
ah
->
ah_ˇ∑bûôõs
.
ˇp_ønge
.
ønge_2ghz_max
))

93  
åue
;

94 } i‡(
Êags
 & 
CHANNEL_5GHZ
)

95 i‡((
‰eq
 >
ah
->
ah_ˇ∑bûôõs
.
ˇp_ønge
.
ønge_5ghz_mö
) &&

96 (
‰eq
 <
ah
->
ah_ˇ∑bûôõs
.
ˇp_ønge
.
ønge_5ghz_max
))

97  
åue
;

99  
Ál£
;

100 
	}
}

102 
boﬁ
 
	$©h5k_hw_ch™_has_•ur_noi£
(
©h5k_hw
 *
ah
,

103 
õì80211_ch™√l
 *
ch™√l
)

105 
u8
 
ªf˛k_‰eq
;

107 i‡((
ah
->
ah_ødio
 =
AR5K_RF5112
) ||

108 (
ah
->
ah_ødio
 =
AR5K_RF5413
) ||

109 (
ah
->
ah_ødio
 =
AR5K_RF2413
) ||

110 (
ah
->
ah_mac_vîsi⁄
 =(
AR5K_SREV_AR2417
 >> 4)))

111 
ªf˛k_‰eq
 = 40;

113 
ªf˛k_‰eq
 = 32;

115 i‡((
ch™√l
->
˚¡î_‰eq
 % 
ªf˛k_‰eq
 != 0) &&

116 ((
ch™√l
->
˚¡î_‰eq
 % 
ªf˛k_‰eq
 < 10) ||

117 (
ch™√l
->
˚¡î_‰eq
 % 
ªf˛k_‰eq
 > 22)))

118  
åue
;

120  
Ál£
;

121 
	}
}

126 
	$©h5k_hw_rfb_›
(
©h5k_hw
 *
ah
,

127 c⁄° 
©h5k_rf_ªg
 *
rf_ªgs
,

128 
u32
 
vÆ
, 
u8
 
ªg_id
, 
boﬁ
 
£t
)

130 c⁄° 
©h5k_rf_ªg
 *
r‰eg
 = 
NULL
;

131 
u8
 
off£t
, 
b™k
, 
num_bôs
, 
cﬁ
, 
posôi⁄
;

132 
u16
 
íåy
;

133 
u32
 
mask
, 
d©a
, 
œ°_bô
, 
bôs_shi·ed
, 
fú°_bô
;

134 
u32
 *
rfb
;

135 
s32
 
bôs_À·
;

136 
i
;

138 
d©a
 = 0;

139 
rfb
 = 
ah
->
ah_rf_b™ks
;

141 
i
 = 0; i < 
ah
->
ah_rf_ªgs_cou¡
; i++) {

142 i‡(
rf_ªgs
[
i
].
ödex
 =
ªg_id
) {

143 
r‰eg
 = &
rf_ªgs
[
i
];

148 i‡(
rfb
 =
NULL
 || 
r‰eg
 == NULL) {

149 
	`ATH5K_PRINTF
("RfÑegisterÇot found!\n");

154 
b™k
 = 
r‰eg
->bank;

155 
num_bôs
 = 
r‰eg
->
fõld
.
Àn
;

156 
fú°_bô
 = 
r‰eg
->
fõld
.
pos
;

157 
cﬁ
 = 
r‰eg
->
fõld
.col;

163 
off£t
 = 
ah
->
ah_off£t
[
b™k
];

166 i‡(!(
cﬁ
 <3 && 
num_bôs
 <32 && 
fú°_bô
 +Çum_bits <= 319)) {

167 
	`ATH5K_PRINTF
("övÆid vÆue†© off£à%u\n", 
off£t
);

171 
íåy
 = ((
fú°_bô
 - 1Ë/ 8Ë+ 
off£t
;

172 
posôi⁄
 = (
fú°_bô
 - 1) % 8;

174 i‡(
£t
)

175 
d©a
 = 
	`©h5k_hw_bôsw≠
(
vÆ
, 
num_bôs
);

177 
bôs_shi·ed
 = 0, 
bôs_À·
 = 
num_bôs
; bits_left > 0;

178 
posôi⁄
 = 0, 
íåy
++) {

180 
œ°_bô
 = (
posôi⁄
 + 
bôs_À·
 > 8) ? 8 :

181 
posôi⁄
 + 
bôs_À·
;

183 
mask
 = (((1 << 
œ°_bô
Ë- 1Ë^ ((1 << 
posôi⁄
) - 1)) <<

184 (
cﬁ
 * 8);

186 i‡(
£t
) {

187 
rfb
[
íåy
] &~
mask
;

188 
rfb
[
íåy
] |((
d©a
 << 
posôi⁄
Ë<< (
cﬁ
 * 8)Ë& 
mask
;

189 
d©a
 >>(8 - 
posôi⁄
);

191 
d©a
 |(((
rfb
[
íåy
] & 
mask
Ë>> (
cﬁ
 * 8)Ë>> 
posôi⁄
)

192 << 
bôs_shi·ed
;

193 
bôs_shi·ed
 +
œ°_bô
 - 
posôi⁄
;

196 
bôs_À·
 -8 - 
posôi⁄
;

199 
d©a
 = 
£t
 ? 1 : 
	`©h5k_hw_bôsw≠
(d©a, 
num_bôs
);

201  
d©a
;

202 
	}
}

219 
ölöe
 
	$©h5k_hw_wrôe_ofdm_timögs
(
©h5k_hw
 *
ah
,

220 
õì80211_ch™√l
 *
ch™√l
)

223 
u32
 
c€f_sˇÀd
, 
c€f_exp
, 
c€f_m™
,

224 
ds_c€f_exp
, 
ds_c€f_m™
, 
˛ock
;

226 
	`BUG_ON
(!(
ah
->
ah_vîsi⁄
 =
AR5K_AR5212
) ||

227 !(
ch™√l
->
hw_vÆue
 & 
CHANNEL_OFDM
));

233 
ah
->
ah_bwmode
) {

234 
AR5K_BWMODE_40MHZ
:

235 
˛ock
 = 40 * 2;

237 
AR5K_BWMODE_10MHZ
:

238 
˛ock
 = 40 / 2;

240 
AR5K_BWMODE_5MHZ
:

241 
˛ock
 = 40 / 4;

244 
˛ock
 = 40;

247 
c€f_sˇÀd
 = ((5 * (
˛ock
 << 24)Ë/ 2Ë/ 
ch™√l
->
˚¡î_‰eq
;

251 
c€f_exp
 = 
	`ûog2
(
c€f_sˇÀd
);

254 i‡(!
c€f_sˇÀd
 || !
c€f_exp
)

255  -
EINVAL
;

258 
c€f_exp
 = 14 - (coef_exp - 24);

263 
c€f_m™
 = 
c€f_sˇÀd
 +

264 (1 << (24 - 
c€f_exp
 - 1));

268 
ds_c€f_m™
 = 
c€f_m™
 >> (24 - 
c€f_exp
);

269 
ds_c€f_exp
 = 
c€f_exp
 - 16;

271 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_TIMING_3
,

272 
AR5K_PHY_TIMING_3_DSC_MAN
, 
ds_c€f_m™
);

273 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_TIMING_3
,

274 
AR5K_PHY_TIMING_3_DSC_EXP
, 
ds_c€f_exp
);

277 
	}
}

279 
	$©h5k_hw_phy_dißbÀ
(
©h5k_hw
 *
ah
)

282 
	`©h5k_hw_ªg_wrôe
(
ah
, 
AR5K_PHY_ACT_DISABLE
, 
AR5K_PHY_ACT
);

285 
	}
}

290 
	$©h5k_hw_waô_f‹_sy¡h
(
©h5k_hw
 *
ah
,

291 
õì80211_ch™√l
 *
ch™√l
)

297 i‡(
ah
->
ah_vîsi⁄
 !
AR5K_AR5210
) {

298 
u32
 
dñay
;

299 
dñay
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PHY_RX_DELAY
) &

300 
AR5K_PHY_RX_DELAY_M
;

301 
dñay
 = (
ch™√l
->
hw_vÆue
 & 
CHANNEL_CCK
) ?

302 ((
dñay
 << 2) / 22) : (delay / 10);

303 i‡(
ah
->
ah_bwmode
 =
AR5K_BWMODE_10MHZ
)

304 
dñay
 = delay << 1;

305 i‡(
ah
->
ah_bwmode
 =
AR5K_BWMODE_5MHZ
)

306 
dñay
 = delay << 2;

309 
	`udñay
(100 + 
dñay
);

311 
	`mdñay
(1);

313 
	}
}

345 
	$©h5k_hw_rfgaö_›t_öô
(
©h5k_hw
 *
ah
)

348 
ah
->
ah_ødio
) {

349 
AR5K_RF5111
:

350 
ah
->
ah_gaö
.
g_°ï_idx
 = 
rfgaö_›t_5111
.
go_deÁu…
;

351 
ah
->
ah_gaö
.
g_low
 = 20;

352 
ah
->
ah_gaö
.
g_high
 = 35;

353 
ah
->
ah_gaö
.
g_°©e
 = 
AR5K_RFGAIN_ACTIVE
;

355 
AR5K_RF5112
:

356 
ah
->
ah_gaö
.
g_°ï_idx
 = 
rfgaö_›t_5112
.
go_deÁu…
;

357 
ah
->
ah_gaö
.
g_low
 = 20;

358 
ah
->
ah_gaö
.
g_high
 = 85;

359 
ah
->
ah_gaö
.
g_°©e
 = 
AR5K_RFGAIN_ACTIVE
;

362  -
EINVAL
;

366 
	}
}

378 
	$©h5k_hw_ªque°_rfgaö_¥obe
(
©h5k_hw
 *
ah
)

383 i‡(
ah
->
ah_gaö
.
g_°©e
 !
AR5K_RFGAIN_ACTIVE
)

388 
	`©h5k_hw_ªg_wrôe
(
ah
, 
	`AR5K_REG_SM
◊h->
ah_txpowî
.
txp_ofdm
 - 4,

389 
AR5K_PHY_PAPD_PROBE_TXPOWER
) |

390 
AR5K_PHY_PAPD_PROBE_TX_NEXT
, 
AR5K_PHY_PAPD_PROBE
);

392 
ah
->
ah_gaö
.
g_°©e
 = 
AR5K_RFGAIN_READ_REQUESTED
;

394 
	}
}

398 
u32
 
	$©h5k_hw_rf_gaöf_c‹r
(
©h5k_hw
 *
ah
)

400 
u32
 
mix
, 
°ï
;

401 
u32
 *
rf
;

402 c⁄° 
©h5k_gaö_›t
 *
go
;

403 c⁄° 
©h5k_gaö_›t_°ï
 *
g_°ï
;

404 c⁄° 
©h5k_rf_ªg
 *
rf_ªgs
;

407 i‡((
ah
->
ah_ødio
 !
AR5K_RF5112
) ||

408 (
ah
->
ah_ødio_5ghz_ªvisi⁄
 <
AR5K_SREV_RAD_5112A
))

411 
go
 = &
rfgaö_›t_5112
;

412 
rf_ªgs
 = 
rf_ªgs_5112a
;

413 
ah
->
ah_rf_ªgs_cou¡
 = 
	`ARRAY_SIZE
(
rf_ªgs_5112a
);

415 
g_°ï
 = &
go
->
go_°ï
[
ah
->
ah_gaö
.
g_°ï_idx
];

417 i‡(
ah
->
ah_rf_b™ks
 =
NULL
)

420 
rf
 = 
ah
->
ah_rf_b™ks
;

421 
ah
->
ah_gaö
.
g_f_c‹r
 = 0;

424 i‡(
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 0, 
AR5K_RF_MIXVGA_OVR
, 
Ál£
) != 1)

428 
°ï
 = 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 0, 
AR5K_RF_MIXGAIN_STEP
, 
Ál£
);

431 
mix
 = 
g_°ï
->
gos_∑øm
[0];

433 
mix
) {

435 
ah
->
ah_gaö
.
g_f_c‹r
 = 
°ï
 * 2;

438 
ah
->
ah_gaö
.
g_f_c‹r
 = (
°ï
 - 5) * 2;

441 
ah
->
ah_gaö
.
g_f_c‹r
 = 
°ï
;

444 
ah
->
ah_gaö
.
g_f_c‹r
 = 0;

448  
ah
->
ah_gaö
.
g_f_c‹r
;

449 
	}
}

455 
boﬁ
 
	$©h5k_hw_rf_check_gaöf_ªadback
(
©h5k_hw
 *
ah
)

457 c⁄° 
©h5k_rf_ªg
 *
rf_ªgs
;

458 
u32
 
°ï
, 
mix_ovr
, 
Àvñ
[4];

459 
u32
 *
rf
;

461 i‡(
ah
->
ah_rf_b™ks
 =
NULL
)

462  
Ál£
;

464 
rf
 = 
ah
->
ah_rf_b™ks
;

466 i‡(
ah
->
ah_ødio
 =
AR5K_RF5111
) {

468 
rf_ªgs
 = 
rf_ªgs_5111
;

469 
ah
->
ah_rf_ªgs_cou¡
 = 
	`ARRAY_SIZE
(
rf_ªgs_5111
);

471 
°ï
 = 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 0, 
AR5K_RF_RFGAIN_STEP
,

472 
Ál£
);

474 
Àvñ
[0] = 0;

475 
Àvñ
[1] = (
°ï
 == 63) ? 50 : step + 4;

476 
Àvñ
[2] = (
°ï
 != 63) ? 64 :Üevel[0];

477 
Àvñ
[3] =Üevel[2] + 50;

479 
ah
->
ah_gaö
.
g_high
 = 
Àvñ
[3] -

480 (
°ï
 =63 ? 
AR5K_GAIN_DYN_ADJUST_HI_MARGIN
 : -5);

481 
ah
->
ah_gaö
.
g_low
 = 
Àvñ
[0] +

482 (
°ï
 =63 ? 
AR5K_GAIN_DYN_ADJUST_LO_MARGIN
 : 0);

485 
rf_ªgs
 = 
rf_ªgs_5112
;

486 
ah
->
ah_rf_ªgs_cou¡
 = 
	`ARRAY_SIZE
(
rf_ªgs_5112
);

488 
mix_ovr
 = 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 0, 
AR5K_RF_MIXVGA_OVR
,

489 
Ál£
);

491 
Àvñ
[0] =Üevel[2] = 0;

493 i‡(
mix_ovr
 == 1) {

494 
Àvñ
[1] =Üevel[3] = 83;

496 
Àvñ
[1] =Üevel[3] = 107;

497 
ah
->
ah_gaö
.
g_high
 = 55;

501  (
ah
->
ah_gaö
.
g_cuºít
 >
Àvñ
[0] &&

502 
ah
->
ah_gaö
.
g_cuºít
 <
Àvñ
[1]) ||

503 (
ah
->
ah_gaö
.
g_cuºít
 >
Àvñ
[2] &&

504 
ah
->
ah_gaö
.
g_cuºít
 <
Àvñ
[3]);

505 
	}
}

509 
s8
 
	$©h5k_hw_rf_gaöf_adju°
(
©h5k_hw
 *
ah
)

511 c⁄° 
©h5k_gaö_›t
 *
go
;

512 c⁄° 
©h5k_gaö_›t_°ï
 *
g_°ï
;

513 
ªt
 = 0;

515 
ah
->
ah_ødio
) {

516 
AR5K_RF5111
:

517 
go
 = &
rfgaö_›t_5111
;

519 
AR5K_RF5112
:

520 
go
 = &
rfgaö_›t_5112
;

526 
g_°ï
 = &
go
->
go_°ï
[
ah
->
ah_gaö
.
g_°ï_idx
];

528 i‡(
ah
->
ah_gaö
.
g_cuºít
 >ah->ah_gaö.
g_high
) {

531 i‡(
ah
->
ah_gaö
.
g_°ï_idx
 == 0)

534 
ah
->
ah_gaö
.
g_èrgë
 =áh->ah_gaö.
g_cuºít
;

535 
ah
->
ah_gaö
.
g_èrgë
 >ah->ah_gaö.
g_high
 &&

536 
ah
->
ah_gaö
.
g_°ï_idx
 > 0;

537 
g_°ï
 = &
go
->
go_°ï
[
ah
->
ah_gaö
.
g_°ï_idx
])

538 
ah
->
ah_gaö
.
g_èrgë
 -= 2 *

539 (
go
->
go_°ï
[--(
ah
->
ah_gaö
.
g_°ï_idx
)].
gos_gaö
 -

540 
g_°ï
->
gos_gaö
);

542 
ªt
 = 1;

543 
d⁄e
;

546 i‡(
ah
->
ah_gaö
.
g_cuºít
 <ah->ah_gaö.
g_low
) {

549 i‡(
ah
->
ah_gaö
.
g_°ï_idx
 =(
go
->
go_°ïs_cou¡
 - 1))

552 
ah
->
ah_gaö
.
g_èrgë
 =áh->ah_gaö.
g_cuºít
;

553 
ah
->
ah_gaö
.
g_èrgë
 <ah->ah_gaö.
g_low
 &&

554 
ah
->
ah_gaö
.
g_°ï_idx
 < 
go
->
go_°ïs_cou¡
 - 1;

555 
g_°ï
 = &
go
->
go_°ï
[
ah
->
ah_gaö
.
g_°ï_idx
])

556 
ah
->
ah_gaö
.
g_èrgë
 -= 2 *

557 (
go
->
go_°ï
[++
ah
->
ah_gaö
.
g_°ï_idx
].
gos_gaö
 -

558 
g_°ï
->
gos_gaö
);

560 
ªt
 = 2;

561 
d⁄e
;

564 
d⁄e
:

565 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_CALIBRATE
,

567 
ªt
, 
ah
->
ah_gaö
.
g_°ï_idx
,áh->ah_gaö.
g_cuºít
,

568 
ah
->
ah_gaö
.
g_èrgë
);

570  
ªt
;

571 
	}
}

579 
©h5k_rfgaö
 
	$©h5k_hw_gaöf_ˇlibøã
(
©h5k_hw
 *
ah
)

581 
u32
 
d©a
, 
ty≥
;

582 
©h5k_ì¥om_öfo
 *
ì
 = &
ah
->
ah_ˇ∑bûôõs
.
ˇp_ì¥om
;

584 i‡(
ah
->
ah_rf_b™ks
 =
NULL
 ||

585 
ah
->
ah_gaö
.
g_°©e
 =
AR5K_RFGAIN_INACTIVE
)

586  
AR5K_RFGAIN_INACTIVE
;

590 i‡(
ah
->
ah_gaö
.
g_°©e
 !
AR5K_RFGAIN_READ_REQUESTED
)

591 
d⁄e
;

595 
d©a
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PHY_PAPD_PROBE
);

598 i‡(!(
d©a
 & 
AR5K_PHY_PAPD_PROBE_TX_NEXT
)) {

599 
ah
->
ah_gaö
.
g_cuºít
 = 
d©a
 >> 
AR5K_PHY_PAPD_PROBE_GAINF_S
;

600 
ty≥
 = 
	`AR5K_REG_MS
(
d©a
, 
AR5K_PHY_PAPD_PROBE_TYPE
);

604 i‡(
ty≥
 =
AR5K_PHY_PAPD_PROBE_TYPE_CCK
) {

605 i‡(
ah
->
ah_ødio_5ghz_ªvisi⁄
 >
AR5K_SREV_RAD_5112A
)

606 
ah
->
ah_gaö
.
g_cuºít
 +=

607 
ì
->
ì_cck_ofdm_gaö_dñè
;

609 
ah
->
ah_gaö
.
g_cuºít
 +=

610 
AR5K_GAIN_CCK_PROBE_CORR
;

615 i‡(
ah
->
ah_ødio_5ghz_ªvisi⁄
 >
AR5K_SREV_RAD_5112A
) {

616 
	`©h5k_hw_rf_gaöf_c‹r
(
ah
);

617 
ah
->
ah_gaö
.
g_cuºít
 =

618 
ah
->
ah_gaö
.
g_cuºít
 >ah->ah_gaö.
g_f_c‹r
 ?

619 (
ah
->
ah_gaö
.
g_cuºít
 -áh->ah_gaö.
g_f_c‹r
) :

626 i‡(
	`©h5k_hw_rf_check_gaöf_ªadback
(
ah
) &&

627 
	`AR5K_GAIN_CHECK_ADJUST
(&
ah
->
ah_gaö
) &&

628 
	`©h5k_hw_rf_gaöf_adju°
(
ah
)) {

629 
ah
->
ah_gaö
.
g_°©e
 = 
AR5K_RFGAIN_NEED_CHANGE
;

631 
ah
->
ah_gaö
.
g_°©e
 = 
AR5K_RFGAIN_ACTIVE
;

635 
d⁄e
:

636  
ah
->
ah_gaö
.
g_°©e
;

637 
	}
}

642 
	$©h5k_hw_rfgaö_öô
(
©h5k_hw
 *
ah
, 
õì80211_b™d
 
b™d
)

644 c⁄° 
©h5k_öi_rfgaö
 *
©h5k_rfg
;

645 
i
, 
size
, 
ödex
;

647 
ah
->
ah_ødio
) {

648 
AR5K_RF5111
:

649 
©h5k_rfg
 = 
rfgaö_5111
;

650 
size
 = 
	`ARRAY_SIZE
(
rfgaö_5111
);

652 
AR5K_RF5112
:

653 
©h5k_rfg
 = 
rfgaö_5112
;

654 
size
 = 
	`ARRAY_SIZE
(
rfgaö_5112
);

656 
AR5K_RF2413
:

657 
©h5k_rfg
 = 
rfgaö_2413
;

658 
size
 = 
	`ARRAY_SIZE
(
rfgaö_2413
);

660 
AR5K_RF2316
:

661 
©h5k_rfg
 = 
rfgaö_2316
;

662 
size
 = 
	`ARRAY_SIZE
(
rfgaö_2316
);

664 
AR5K_RF5413
:

665 
©h5k_rfg
 = 
rfgaö_5413
;

666 
size
 = 
	`ARRAY_SIZE
(
rfgaö_5413
);

668 
AR5K_RF2317
:

669 
AR5K_RF2425
:

670 
©h5k_rfg
 = 
rfgaö_2425
;

671 
size
 = 
	`ARRAY_SIZE
(
rfgaö_2425
);

674  -
EINVAL
;

677 
ödex
 = (
b™d
 =
IEEE80211_BAND_2GHZ
) ? 1 : 0;

679 
i
 = 0; i < 
size
; i++) {

680 
	`AR5K_REG_WAIT
(
i
);

681 
	`©h5k_hw_ªg_wrôe
(
ah
, 
©h5k_rfg
[
i
].
rfg_vÆue
[
ödex
],

682 (
u32
)
©h5k_rfg
[
i
].
rfg_ªgi°î
);

686 
	}
}

697 
	$©h5k_hw_r‰egs_öô
(
©h5k_hw
 *
ah
,

698 
õì80211_ch™√l
 *
ch™√l
, 
mode
)

700 c⁄° 
©h5k_rf_ªg
 *
rf_ªgs
;

701 c⁄° 
©h5k_öi_rfbuf„r
 *
öi_rfb
;

702 c⁄° 
©h5k_gaö_›t
 *
go
 = 
NULL
;

703 c⁄° 
©h5k_gaö_›t_°ï
 *
g_°ï
;

704 
©h5k_ì¥om_öfo
 *
ì
 = &
ah
->
ah_ˇ∑bûôõs
.
ˇp_ì¥om
;

705 
u8
 
ì_mode
 = 0;

706 
u32
 *
rfb
;

707 
i
, 
obdb
 = -1, 
b™k
 = -1;

709 
ah
->
ah_ødio
) {

710 
AR5K_RF5111
:

711 
rf_ªgs
 = 
rf_ªgs_5111
;

712 
ah
->
ah_rf_ªgs_cou¡
 = 
	`ARRAY_SIZE
(
rf_ªgs_5111
);

713 
öi_rfb
 = 
rfb_5111
;

714 
ah
->
ah_rf_b™ks_size
 = 
	`ARRAY_SIZE
(
rfb_5111
);

715 
go
 = &
rfgaö_›t_5111
;

717 
AR5K_RF5112
:

718 i‡(
ah
->
ah_ødio_5ghz_ªvisi⁄
 >
AR5K_SREV_RAD_5112A
) {

719 
rf_ªgs
 = 
rf_ªgs_5112a
;

720 
ah
->
ah_rf_ªgs_cou¡
 = 
	`ARRAY_SIZE
(
rf_ªgs_5112a
);

721 
öi_rfb
 = 
rfb_5112a
;

722 
ah
->
ah_rf_b™ks_size
 = 
	`ARRAY_SIZE
(
rfb_5112a
);

724 
rf_ªgs
 = 
rf_ªgs_5112
;

725 
ah
->
ah_rf_ªgs_cou¡
 = 
	`ARRAY_SIZE
(
rf_ªgs_5112
);

726 
öi_rfb
 = 
rfb_5112
;

727 
ah
->
ah_rf_b™ks_size
 = 
	`ARRAY_SIZE
(
rfb_5112
);

729 
go
 = &
rfgaö_›t_5112
;

731 
AR5K_RF2413
:

732 
rf_ªgs
 = 
rf_ªgs_2413
;

733 
ah
->
ah_rf_ªgs_cou¡
 = 
	`ARRAY_SIZE
(
rf_ªgs_2413
);

734 
öi_rfb
 = 
rfb_2413
;

735 
ah
->
ah_rf_b™ks_size
 = 
	`ARRAY_SIZE
(
rfb_2413
);

737 
AR5K_RF2316
:

738 
rf_ªgs
 = 
rf_ªgs_2316
;

739 
ah
->
ah_rf_ªgs_cou¡
 = 
	`ARRAY_SIZE
(
rf_ªgs_2316
);

740 
öi_rfb
 = 
rfb_2316
;

741 
ah
->
ah_rf_b™ks_size
 = 
	`ARRAY_SIZE
(
rfb_2316
);

743 
AR5K_RF5413
:

744 
rf_ªgs
 = 
rf_ªgs_5413
;

745 
ah
->
ah_rf_ªgs_cou¡
 = 
	`ARRAY_SIZE
(
rf_ªgs_5413
);

746 
öi_rfb
 = 
rfb_5413
;

747 
ah
->
ah_rf_b™ks_size
 = 
	`ARRAY_SIZE
(
rfb_5413
);

749 
AR5K_RF2317
:

750 
rf_ªgs
 = 
rf_ªgs_2425
;

751 
ah
->
ah_rf_ªgs_cou¡
 = 
	`ARRAY_SIZE
(
rf_ªgs_2425
);

752 
öi_rfb
 = 
rfb_2317
;

753 
ah
->
ah_rf_b™ks_size
 = 
	`ARRAY_SIZE
(
rfb_2317
);

755 
AR5K_RF2425
:

756 
rf_ªgs
 = 
rf_ªgs_2425
;

757 
ah
->
ah_rf_ªgs_cou¡
 = 
	`ARRAY_SIZE
(
rf_ªgs_2425
);

758 i‡(
ah
->
ah_mac_§ev
 < 
AR5K_SREV_AR2417
) {

759 
öi_rfb
 = 
rfb_2425
;

760 
ah
->
ah_rf_b™ks_size
 = 
	`ARRAY_SIZE
(
rfb_2425
);

762 
öi_rfb
 = 
rfb_2417
;

763 
ah
->
ah_rf_b™ks_size
 = 
	`ARRAY_SIZE
(
rfb_2417
);

767  -
EINVAL
;

773 i‡(
ah
->
ah_rf_b™ks
 =
NULL
) {

774 
ah
->
ah_rf_b™ks
 = 
	`kmÆloc
((
u32
Ë*áh->
ah_rf_b™ks_size
,

775 
GFP_KERNEL
);

776 i‡(
ah
->
ah_rf_b™ks
 =
NULL
) {

777 
	`ATH5K_ERR
(
ah
, "out of memory\n");

778  -
ENOMEM
;

783 
rfb
 = 
ah
->
ah_rf_b™ks
;

785 
i
 = 0; i < 
ah
->
ah_rf_b™ks_size
; i++) {

786 i‡(
öi_rfb
[
i
].
rfb_b™k
 >
AR5K_MAX_RF_BANKS
) {

787 
	`ATH5K_ERR
(
ah
, "invalid bank\n");

788  -
EINVAL
;

792 i‡(
b™k
 !
öi_rfb
[
i
].
rfb_b™k
) {

793 
b™k
 = 
öi_rfb
[
i
].
rfb_b™k
;

794 
ah
->
ah_off£t
[
b™k
] = 
i
;

797 
rfb
[
i
] = 
öi_rfb
[i].
rfb_mode_d©a
[
mode
];

801 i‡(
ch™√l
->
hw_vÆue
 & 
CHANNEL_2GHZ
) {

803 i‡(
ch™√l
->
hw_vÆue
 & 
CHANNEL_CCK
)

804 
ì_mode
 = 
AR5K_EEPROM_MODE_11B
;

806 
ì_mode
 = 
AR5K_EEPROM_MODE_11G
;

815 i‡((
ah
->
ah_ødio
 =
AR5K_RF5111
) ||

816 (
ah
->
ah_ødio
 =
AR5K_RF5112
))

817 
obdb
 = 0;

819 
obdb
 = 1;

821 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 
ì
->
ì_ob
[
ì_mode
][
obdb
],

822 
AR5K_RF_OB_2GHZ
, 
åue
);

824 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 
ì
->
ì_db
[
ì_mode
][
obdb
],

825 
AR5K_RF_DB_2GHZ
, 
åue
);

828 } i‡((
ch™√l
->
hw_vÆue
 & 
CHANNEL_5GHZ
) ||

829 (
ah
->
ah_ødio
 =
AR5K_RF5111
)) {

833 
ì_mode
 = 
AR5K_EEPROM_MODE_11A
;

834 
obdb
 = 
ch™√l
->
˚¡î_‰eq
 >= 5725 ? 3 :

835 (
ch™√l
->
˚¡î_‰eq
 >= 5500 ? 2 :

836 (
ch™√l
->
˚¡î_‰eq
 >= 5260 ? 1 :

837 (
ch™√l
->
˚¡î_‰eq
 > 4000 ? 0 : -1)));

839 i‡(
obdb
 < 0)

840  -
EINVAL
;

842 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 
ì
->
ì_ob
[
ì_mode
][
obdb
],

843 
AR5K_RF_OB_5GHZ
, 
åue
);

845 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 
ì
->
ì_db
[
ì_mode
][
obdb
],

846 
AR5K_RF_DB_5GHZ
, 
åue
);

849 
g_°ï
 = &
go
->
go_°ï
[
ah
->
ah_gaö
.
g_°ï_idx
];

852 i‡((
ah
->
ah_bwmode
 =
AR5K_BWMODE_40MHZ
) &&

853 (
ah
->
ah_ødio
 !
AR5K_RF5413
))

854 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 1, 
AR5K_RF_TURBO
, 
Ál£
);

857 i‡(
ah
->
ah_ødio
 =
AR5K_RF5111
) {

860 i‡(
ch™√l
->
hw_vÆue
 & 
CHANNEL_OFDM
) {

862 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_FRAME_CTL
,

863 
AR5K_PHY_FRAME_CTL_TX_CLIP
,

864 
g_°ï
->
gos_∑øm
[0]);

866 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 
g_°ï
->
gos_∑øm
[1],

867 
AR5K_RF_PWD_90
, 
åue
);

869 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 
g_°ï
->
gos_∑øm
[2],

870 
AR5K_RF_PWD_84
, 
åue
);

872 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 
g_°ï
->
gos_∑øm
[3],

873 
AR5K_RF_RFGAIN_SEL
, 
åue
);

877 
ah
->
ah_gaö
.
g_°©e
 = 
AR5K_RFGAIN_ACTIVE
;

883 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, !
ì
->
ì_xpd
[
ì_mode
],

884 
AR5K_RF_PWD_XPD
, 
åue
);

886 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 
ì
->
ì_x_gaö
[
ì_mode
],

887 
AR5K_RF_XPD_GAIN
, 
åue
);

889 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 
ì
->
ì_i_gaö
[
ì_mode
],

890 
AR5K_RF_GAIN_I
, 
åue
);

892 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 
ì
->
ì_xpd
[
ì_mode
],

893 
AR5K_RF_PLO_SEL
, 
åue
);

896 i‡(
ah
->
ah_bwmode
 =
AR5K_BWMODE_5MHZ
 ||

897 
ah
->
ah_bwmode
 =
AR5K_BWMODE_10MHZ
) {

898 
u8
 
waô_i
;

900 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 0x1f,

901 
AR5K_RF_WAIT_S
, 
åue
);

903 
waô_i
 = (
ah
->
ah_bwmode
 =
AR5K_BWMODE_5MHZ
) ?

906 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 
waô_i
,

907 
AR5K_RF_WAIT_I
, 
åue
);

908 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 3,

909 
AR5K_RF_MAX_TIME
, 
åue
);

914 i‡(
ah
->
ah_ødio
 =
AR5K_RF5112
) {

917 i‡(
ch™√l
->
hw_vÆue
 & 
CHANNEL_OFDM
) {

919 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 
g_°ï
->
gos_∑øm
[0],

920 
AR5K_RF_MIXGAIN_OVR
, 
åue
);

922 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 
g_°ï
->
gos_∑øm
[1],

923 
AR5K_RF_PWD_138
, 
åue
);

925 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 
g_°ï
->
gos_∑øm
[2],

926 
AR5K_RF_PWD_137
, 
åue
);

928 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 
g_°ï
->
gos_∑øm
[3],

929 
AR5K_RF_PWD_136
, 
åue
);

931 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 
g_°ï
->
gos_∑øm
[4],

932 
AR5K_RF_PWD_132
, 
åue
);

934 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 
g_°ï
->
gos_∑øm
[5],

935 
AR5K_RF_PWD_131
, 
åue
);

937 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 
g_°ï
->
gos_∑øm
[6],

938 
AR5K_RF_PWD_130
, 
åue
);

942 
ah
->
ah_gaö
.
g_°©e
 = 
AR5K_RFGAIN_ACTIVE
;

947 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 
ì
->
ì_xpd
[
ì_mode
],

948 
AR5K_RF_XPD_SEL
, 
åue
);

950 i‡(
ah
->
ah_ødio_5ghz_ªvisi⁄
 < 
AR5K_SREV_RAD_5112A
) {

952 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
,

953 
ì
->
ì_x_gaö
[
ì_mode
],

954 
AR5K_RF_XPD_GAIN
, 
åue
);

957 
u8
 *
pdg_curve_to_idx
 = 
ì
->
ì_pdc_to_idx
[
ì_mode
];

958 i‡(
ì
->
ì_pd_gaös
[
ì_mode
] > 1) {

959 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
,

960 
pdg_curve_to_idx
[0],

961 
AR5K_RF_PD_GAIN_LO
, 
åue
);

962 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
,

963 
pdg_curve_to_idx
[1],

964 
AR5K_RF_PD_GAIN_HI
, 
åue
);

966 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
,

967 
pdg_curve_to_idx
[0],

968 
AR5K_RF_PD_GAIN_LO
, 
åue
);

969 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
,

970 
pdg_curve_to_idx
[0],

971 
AR5K_RF_PD_GAIN_HI
, 
åue
);

975 i‡(
ah
->
ah_ødio
 =
AR5K_RF5112
 &&

976 (
ah
->
ah_ødio_5ghz_ªvisi⁄
 & 
AR5K_SREV_REV
) > 0) {

977 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 2,

978 
AR5K_RF_HIGH_VC_CP
, 
åue
);

980 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 2,

981 
AR5K_RF_MID_VC_CP
, 
åue
);

983 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 2,

984 
AR5K_RF_LOW_VC_CP
, 
åue
);

986 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 2,

987 
AR5K_RF_PUSH_UP
, 
åue
);

991 i‡(
ah
->
ah_phy_ªvisi⁄
 >
AR5K_SREV_PHY_5212A
) {

992 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 1,

993 
AR5K_RF_PAD2GND
, 
åue
);

995 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 1,

996 
AR5K_RF_XB2_LVL
, 
åue
);

998 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 1,

999 
AR5K_RF_XB5_LVL
, 
åue
);

1001 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 1,

1002 
AR5K_RF_PWD_167
, 
åue
);

1004 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 1,

1005 
AR5K_RF_PWD_166
, 
åue
);

1009 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 
ì
->
ì_i_gaö
[
ì_mode
],

1010 
AR5K_RF_GAIN_I
, 
åue
);

1013 i‡(
ah
->
ah_bwmode
 =
AR5K_BWMODE_5MHZ
 ||

1014 
ah
->
ah_bwmode
 =
AR5K_BWMODE_10MHZ
) {

1015 
u8
 
pd_dñay
;

1017 
pd_dñay
 = (
ah
->
ah_bwmode
 =
AR5K_BWMODE_5MHZ
) ?

1020 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 
pd_dñay
,

1021 
AR5K_RF_PD_PERIOD_A
, 
åue
);

1022 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 0xf,

1023 
AR5K_RF_PD_DELAY_A
, 
åue
);

1028 i‡(
ah
->
ah_ødio
 =
AR5K_RF5413
 &&

1029 
ch™√l
->
hw_vÆue
 & 
CHANNEL_2GHZ
) {

1031 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 1, 
AR5K_RF_DERBY_CHAN_SEL_MODE
,

1032 
åue
);

1035 i‡(
ah
->
ah_mac_§ev
 >
AR5K_SREV_AR5424
 &&

1036 
ah
->
ah_mac_§ev
 < 
AR5K_SREV_AR5413
)

1037 
	`©h5k_hw_rfb_›
(
ah
, 
rf_ªgs
, 
	`©h5k_hw_bôsw≠
(6, 3),

1038 
AR5K_RF_PWD_ICLOBUF_2G
, 
åue
);

1043 
i
 = 0; i < 
ah
->
ah_rf_b™ks_size
; i++) {

1044 
	`AR5K_REG_WAIT
(
i
);

1045 
	`©h5k_hw_ªg_wrôe
(
ah
, 
rfb
[
i
], 
öi_rfb
[i].
rfb_˘æ_ªgi°î
);

1049 
	}
}

1059 
u32
 
	$©h5k_hw_rf5110_ch™2©hch™
(
õì80211_ch™√l
 *
ch™√l
)

1061 
u32
 
©hch™
;

1069 
©hch™
 = (
	`©h5k_hw_bôsw≠
(

1070 (
	`õì80211_‰equícy_to_ch™√l
(

1071 
ch™√l
->
˚¡î_‰eq
) - 24) / 2, 5)

1073  
©hch™
;

1074 
	}
}

1079 
	$©h5k_hw_rf5110_ch™√l
(
©h5k_hw
 *
ah
,

1080 
õì80211_ch™√l
 *
ch™√l
)

1082 
u32
 
d©a
;

1087 
d©a
 = 
	`©h5k_hw_rf5110_ch™2©hch™
(
ch™√l
);

1088 
	`©h5k_hw_ªg_wrôe
(
ah
, 
d©a
, 
AR5K_RF_BUFFER
);

1089 
	`©h5k_hw_ªg_wrôe
(
ah
, 0, 
AR5K_RF_BUFFER_CONTROL_0
);

1090 
	`mdñay
(1);

1093 
	}
}

1098 
	$©h5k_hw_rf5111_ch™2©hch™
(
õì
,

1099 
©h5k_©hch™_2ghz
 *
©hch™
)

1101 
ch™√l
;

1104 
ch™√l
 = ()
õì
;

1109 i‡(
ch™√l
 <= 13) {

1110 
©hch™
->
a2_©hch™
 = 115 + 
ch™√l
;

1111 
©hch™
->
a2_Êags
 = 0x46;

1112 } i‡(
ch™√l
 == 14) {

1113 
©hch™
->
a2_©hch™
 = 124;

1114 
©hch™
->
a2_Êags
 = 0x44;

1115 } i‡(
ch™√l
 >= 15 && channel <= 26) {

1116 
©hch™
->
a2_©hch™
 = ((
ch™√l
 - 14) * 4) + 132;

1117 
©hch™
->
a2_Êags
 = 0x46;

1119  -
EINVAL
;

1122 
	}
}

1127 
	$©h5k_hw_rf5111_ch™√l
(
©h5k_hw
 *
ah
,

1128 
õì80211_ch™√l
 *
ch™√l
)

1130 
©h5k_©hch™_2ghz
 
©h5k_ch™√l_2ghz
;

1131 
©h5k_ch™√l
 =

1132 
	`õì80211_‰equícy_to_ch™√l
(
ch™√l
->
˚¡î_‰eq
);

1133 
u32
 
d©a0
, 
d©a1
, 
˛ock
;

1134 
ªt
;

1139 
d©a0
 = 
d©a1
 = 0;

1141 i‡(
ch™√l
->
hw_vÆue
 & 
CHANNEL_2GHZ
) {

1143 
ªt
 = 
	`©h5k_hw_rf5111_ch™2©hch™
(

1144 
	`õì80211_‰equícy_to_ch™√l
(
ch™√l
->
˚¡î_‰eq
),

1145 &
©h5k_ch™√l_2ghz
);

1146 i‡(
ªt
)

1147  
ªt
;

1149 
©h5k_ch™√l
 = 
©h5k_ch™√l_2ghz
.
a2_©hch™
;

1150 
d©a0
 = ((
	`©h5k_hw_bôsw≠
(
©h5k_ch™√l_2ghz
.
a2_Êags
, 8) & 0xff)

1154 i‡(
©h5k_ch™√l
 < 145 || !(ath5k_channel & 1)) {

1155 
˛ock
 = 1;

1156 
d©a1
 = ((
	`©h5k_hw_bôsw≠
(
©h5k_ch™√l
 - 24, 8) & 0xff) << 2) |

1157 (
˛ock
 << 1) | (1 << 10) | 1;

1159 
˛ock
 = 0;

1160 
d©a1
 = ((
	`©h5k_hw_bôsw≠
((
©h5k_ch™√l
 - 24) / 2, 8) & 0xff)

1161 << 2Ë| (
˛ock
 << 1) | (1 << 10) | 1;

1164 
	`©h5k_hw_ªg_wrôe
(
ah
, (
d©a1
 & 0xffË| ((
d©a0
 & 0xff) << 8),

1165 
AR5K_RF_BUFFER
);

1166 
	`©h5k_hw_ªg_wrôe
(
ah
, ((
d©a1
 >> 8Ë& 0xffË| (
d©a0
 & 0xff00),

1167 
AR5K_RF_BUFFER_CONTROL_3
);

1170 
	}
}

1175 
	$©h5k_hw_rf5112_ch™√l
(
©h5k_hw
 *
ah
,

1176 
õì80211_ch™√l
 *
ch™√l
)

1178 
u32
 
d©a
, 
d©a0
, 
d©a1
, 
d©a2
;

1179 
u16
 
c
;

1181 
d©a
 = 
d©a0
 = 
d©a1
 = 
d©a2
 = 0;

1182 
c
 = 
ch™√l
->
˚¡î_‰eq
;

1184 i‡(
c
 < 4800) {

1185 i‡(!((
c
 - 2224) % 5)) {

1186 
d©a0
 = ((2 * (
c
 - 704)) - 3040) / 10;

1187 
d©a1
 = 1;

1188 } i‡(!((
c
 - 2192) % 5)) {

1189 
d©a0
 = ((2 * (
c
 - 672)) - 3040) / 10;

1190 
d©a1
 = 0;

1192  -
EINVAL
;

1194 
d©a0
 = 
	`©h5k_hw_bôsw≠
((data0 << 2) & 0xff, 8);

1195 } i‡((
c
 % 5) != 2 || c > 5435) {

1196 i‡(!(
c
 % 20) && c >= 5120) {

1197 
d©a0
 = 
	`©h5k_hw_bôsw≠
(((
c
 - 4800) / 20 << 2), 8);

1198 
d©a2
 = 
	`©h5k_hw_bôsw≠
(3, 2);

1199 } i‡(!(
c
 % 10)) {

1200 
d©a0
 = 
	`©h5k_hw_bôsw≠
(((
c
 - 4800) / 10 << 1), 8);

1201 
d©a2
 = 
	`©h5k_hw_bôsw≠
(2, 2);

1202 } i‡(!(
c
 % 5)) {

1203 
d©a0
 = 
	`©h5k_hw_bôsw≠
((
c
 - 4800) / 5, 8);

1204 
d©a2
 = 
	`©h5k_hw_bôsw≠
(1, 2);

1206  -
EINVAL
;

1208 
d©a0
 = 
	`©h5k_hw_bôsw≠
((10 * (
c
 - 2 - 4800)) / 25 + 1, 8);

1209 
d©a2
 = 
	`©h5k_hw_bôsw≠
(0, 2);

1212 
d©a
 = (
d©a0
 << 4Ë| (
d©a1
 << 1Ë| (
d©a2
 << 2) | 0x1001;

1214 
	`©h5k_hw_ªg_wrôe
(
ah
, 
d©a
 & 0xff, 
AR5K_RF_BUFFER
);

1215 
	`©h5k_hw_ªg_wrôe
(
ah
, (
d©a
 >> 8Ë& 0x7f, 
AR5K_RF_BUFFER_CONTROL_5
);

1218 
	}
}

1223 
	$©h5k_hw_rf2425_ch™√l
(
©h5k_hw
 *
ah
,

1224 
õì80211_ch™√l
 *
ch™√l
)

1226 
u32
 
d©a
, 
d©a0
, 
d©a2
;

1227 
u16
 
c
;

1229 
d©a
 = 
d©a0
 = 
d©a2
 = 0;

1230 
c
 = 
ch™√l
->
˚¡î_‰eq
;

1232 i‡(
c
 < 4800) {

1233 
d©a0
 = 
	`©h5k_hw_bôsw≠
((
c
 - 2272), 8);

1234 
d©a2
 = 0;

1236 } i‡((
c
 % 5) != 2 || c > 5435) {

1237 i‡(!(
c
 % 20) && c < 5120)

1238 
d©a0
 = 
	`©h5k_hw_bôsw≠
(((
c
 - 4800) / 20 << 2), 8);

1239 i‡(!(
c
 % 10))

1240 
d©a0
 = 
	`©h5k_hw_bôsw≠
(((
c
 - 4800) / 10 << 1), 8);

1241 i‡(!(
c
 % 5))

1242 
d©a0
 = 
	`©h5k_hw_bôsw≠
((
c
 - 4800) / 5, 8);

1244  -
EINVAL
;

1245 
d©a2
 = 
	`©h5k_hw_bôsw≠
(1, 2);

1247 
d©a0
 = 
	`©h5k_hw_bôsw≠
((10 * (
c
 - 2 - 4800)) / 25 + 1, 8);

1248 
d©a2
 = 
	`©h5k_hw_bôsw≠
(0, 2);

1251 
d©a
 = (
d©a0
 << 4Ë| 
d©a2
 << 2 | 0x1001;

1253 
	`©h5k_hw_ªg_wrôe
(
ah
, 
d©a
 & 0xff, 
AR5K_RF_BUFFER
);

1254 
	`©h5k_hw_ªg_wrôe
(
ah
, (
d©a
 >> 8Ë& 0x7f, 
AR5K_RF_BUFFER_CONTROL_5
);

1257 
	}
}

1262 
	$©h5k_hw_ch™√l
(
©h5k_hw
 *
ah
,

1263 
õì80211_ch™√l
 *
ch™√l
)

1265 
ªt
;

1271 i‡(!
	`©h5k_ch™√l_ok
(
ah
, 
ch™√l
->
˚¡î_‰eq
, ch™√l->
hw_vÆue
)) {

1272 
	`ATH5K_ERR
(
ah
,

1275 
ch™√l
->
˚¡î_‰eq
);

1276  -
EINVAL
;

1282 
ah
->
ah_ødio
) {

1283 
AR5K_RF5110
:

1284 
ªt
 = 
	`©h5k_hw_rf5110_ch™√l
(
ah
, 
ch™√l
);

1286 
AR5K_RF5111
:

1287 
ªt
 = 
	`©h5k_hw_rf5111_ch™√l
(
ah
, 
ch™√l
);

1289 
AR5K_RF2317
:

1290 
AR5K_RF2425
:

1291 
ªt
 = 
	`©h5k_hw_rf2425_ch™√l
(
ah
, 
ch™√l
);

1294 
ªt
 = 
	`©h5k_hw_rf5112_ch™√l
(
ah
, 
ch™√l
);

1298 i‡(
ªt
)

1299  
ªt
;

1302 i‡(
ch™√l
->
˚¡î_‰eq
 == 2484) {

1303 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_PHY_CCKTXCTL
,

1304 
AR5K_PHY_CCKTXCTL_JAPAN
);

1306 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_PHY_CCKTXCTL
,

1307 
AR5K_PHY_CCKTXCTL_WORLD
);

1310 
ah
->
ah_cuºít_ch™√l
 = 
ch™√l
;

1313 
	}
}

1319 
s32
 
	$©h5k_hw_ªad_mósuªd_noi£_Êo‹
(
©h5k_hw
 *
ah
)

1321 
s32
 
vÆ
;

1323 
vÆ
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PHY_NF
);

1324  
	`sign_exãnd32
(
	`AR5K_REG_MS
(
vÆ
, 
AR5K_PHY_NF_MINCCA_PWR
), 8);

1325 
	}
}

1327 
	$©h5k_hw_öô_nfˇl_hi°
(
©h5k_hw
 *
ah
)

1329 
i
;

1331 
ah
->
ah_nfˇl_hi°
.
ödex
 = 0;

1332 
i
 = 0; i < 
ATH5K_NF_CAL_HIST_MAX
; i++)

1333 
ah
->
ah_nfˇl_hi°
.
nfvÆ
[
i
] = 
AR5K_TUNE_CCA_MAX_GOOD_VALUE
;

1334 
	}
}

1336 
	$©h5k_hw_upd©e_nfˇl_hi°
(
©h5k_hw
 *
ah
, 
s16
 
noi£_Êo‹
)

1338 
©h5k_nfˇl_hi°
 *
hi°
 = &
ah
->
ah_nfˇl_hi°
;

1339 
hi°
->
ödex
 = (hi°->ödex + 1Ë& (
ATH5K_NF_CAL_HIST_MAX
 - 1);

1340 
hi°
->
nfvÆ
[hi°->
ödex
] = 
noi£_Êo‹
;

1341 
	}
}

1343 
s16
 
	$©h5k_hw_gë_medün_noi£_Êo‹
(
©h5k_hw
 *
ah
)

1345 
s16
 
s‹t
[
ATH5K_NF_CAL_HIST_MAX
];

1346 
s16
 
tmp
;

1347 
i
, 
j
;

1349 
	`mem˝y
(
s‹t
, 
ah
->
ah_nfˇl_hi°
.
nfvÆ
, (sort));

1350 
i
 = 0; i < 
ATH5K_NF_CAL_HIST_MAX
 - 1; i++) {

1351 
j
 = 1; j < 
ATH5K_NF_CAL_HIST_MAX
 - 
i
; j++) {

1352 i‡(
s‹t
[
j
] > sort[j - 1]) {

1353 
tmp
 = 
s‹t
[
j
];

1354 
s‹t
[
j
] = sort[j - 1];

1355 
s‹t
[
j
 - 1] = 
tmp
;

1359 
i
 = 0; i < 
ATH5K_NF_CAL_HIST_MAX
; i++) {

1360 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_CALIBRATE
,

1361 "ˇ»%d:%d\n", 
i
, 
s‹t
[i]);

1363  
s‹t
[(
ATH5K_NF_CAL_HIST_MAX
 - 1) / 2];

1364 
	}
}

1377 
	$©h5k_hw_upd©e_noi£_Êo‹
(
©h5k_hw
 *
ah
)

1379 
©h5k_ì¥om_öfo
 *
ì
 = &
ah
->
ah_ˇ∑bûôõs
.
ˇp_ì¥om
;

1380 
u32
 
vÆ
;

1381 
s16
 
nf
, 
thªshﬁd
;

1382 
u8
 
ì_mode
;

1385 i‡(
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PHY_AGCCTL
Ë& 
AR5K_PHY_AGCCTL_NF
) {

1386 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_CALIBRATE
,

1392 
ì_mode
 = 
	`©h5k_ì¥om_mode_‰om_ch™√l
(
ah
->
ah_cuºít_ch™√l
);

1395 
nf
 = 
	`©h5k_hw_ªad_mósuªd_noi£_Êo‹
(
ah
);

1396 
thªshﬁd
 = 
ì
->
ì_noi£_Êo‹_thr
[
ì_mode
];

1398 i‡(
nf
 > 
thªshﬁd
) {

1399 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_CALIBRATE
,

1402 
nf
, 
thªshﬁd
);

1404 
nf
 = 
AR5K_TUNE_CCA_MAX_GOOD_VALUE
;

1407 
	`©h5k_hw_upd©e_nfˇl_hi°
(
ah
, 
nf
);

1408 
nf
 = 
	`©h5k_hw_gë_medün_noi£_Êo‹
(
ah
);

1411 
vÆ
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PHY_NF
Ë& ~
AR5K_PHY_NF_M
;

1412 
vÆ
 |(
nf
 * 2Ë& 
AR5K_PHY_NF_M
;

1413 
	`©h5k_hw_ªg_wrôe
(
ah
, 
vÆ
, 
AR5K_PHY_NF
);

1415 
	`AR5K_REG_MASKED_BITS
(
ah
, 
AR5K_PHY_AGCCTL
, 
AR5K_PHY_AGCCTL_NF
,

1416 ~(
AR5K_PHY_AGCCTL_NF_EN
 | 
AR5K_PHY_AGCCTL_NF_NOUPDATE
));

1418 
	`©h5k_hw_ªgi°î_timeout
(
ah
, 
AR5K_PHY_AGCCTL
, 
AR5K_PHY_AGCCTL_NF
,

1419 0, 
Ál£
);

1427 
vÆ
 = (vÆ & ~
AR5K_PHY_NF_M
) | ((-50 * 2) & AR5K_PHY_NF_M);

1428 
	`©h5k_hw_ªg_wrôe
(
ah
, 
vÆ
, 
AR5K_PHY_NF
);

1429 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_PHY_AGCCTL
,

1430 
AR5K_PHY_AGCCTL_NF_EN
 |

1431 
AR5K_PHY_AGCCTL_NF_NOUPDATE
 |

1432 
AR5K_PHY_AGCCTL_NF
);

1434 
ah
->
ah_noi£_Êo‹
 = 
nf
;

1436 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_CALIBRATE
,

1437 "noi£ flo‹ cÆibøãd: %d\n", 
nf
);

1438 
	}
}

1444 
	$©h5k_hw_rf5110_ˇlibøã
(
©h5k_hw
 *
ah
,

1445 
õì80211_ch™√l
 *
ch™√l
)

1447 
u32
 
phy_sig
, 
phy_agc
, 
phy_ßt
, 
bóc⁄
;

1448 
ªt
;

1453 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_DIAG_SW_5210
,

1454 
AR5K_DIAG_SW_DIS_TX_5210
 | 
AR5K_DIAG_SW_DIS_RX_5210
);

1455 
bóc⁄
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_BEACON_5210
);

1456 
	`©h5k_hw_ªg_wrôe
(
ah
, 
bóc⁄
 & ~
AR5K_BEACON_ENABLE
, 
AR5K_BEACON_5210
);

1458 
	`mdñay
(2);

1463 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_PHY_AGC
, 
AR5K_PHY_AGC_DISABLE
);

1464 
	`udñay
(10);

1465 
ªt
 = 
	`©h5k_hw_ch™√l
(
ah
, 
ch™√l
);

1470 
	`©h5k_hw_ªg_wrôe
(
ah
, 
AR5K_PHY_ACT_ENABLE
, 
AR5K_PHY_ACT
);

1471 
	`mdñay
(1);

1473 
	`AR5K_REG_DISABLE_BITS
(
ah
, 
AR5K_PHY_AGC
, 
AR5K_PHY_AGC_DISABLE
);

1475 i‡(
ªt
)

1476  
ªt
;

1483 
phy_sig
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PHY_SIG
);

1484 
phy_agc
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PHY_AGCCOARSE
);

1485 
phy_ßt
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PHY_ADCSAT
);

1488 
	`©h5k_hw_ªg_wrôe
(
ah
, (
phy_sig
 & ~(
AR5K_PHY_SIG_FIRPWR
)) |

1489 
	`AR5K_REG_SM
(-1, 
AR5K_PHY_SIG_FIRPWR
), 
AR5K_PHY_SIG
);

1491 
	`©h5k_hw_ªg_wrôe
(
ah
, (
phy_agc
 & ~(
AR5K_PHY_AGCCOARSE_HI
 |

1492 
AR5K_PHY_AGCCOARSE_LO
)) |

1493 
	`AR5K_REG_SM
(-1, 
AR5K_PHY_AGCCOARSE_HI
) |

1494 
	`AR5K_REG_SM
(-127, 
AR5K_PHY_AGCCOARSE_LO
), 
AR5K_PHY_AGCCOARSE
);

1496 
	`©h5k_hw_ªg_wrôe
(
ah
, (
phy_ßt
 & ~(
AR5K_PHY_ADCSAT_ICNT
 |

1497 
AR5K_PHY_ADCSAT_THR
)) |

1498 
	`AR5K_REG_SM
(2, 
AR5K_PHY_ADCSAT_ICNT
) |

1499 
	`AR5K_REG_SM
(12, 
AR5K_PHY_ADCSAT_THR
), 
AR5K_PHY_ADCSAT
);

1501 
	`udñay
(20);

1503 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_PHY_AGC
, 
AR5K_PHY_AGC_DISABLE
);

1504 
	`udñay
(10);

1505 
	`©h5k_hw_ªg_wrôe
(
ah
, 
AR5K_PHY_RFSTG_DISABLE
, 
AR5K_PHY_RFSTG
);

1506 
	`AR5K_REG_DISABLE_BITS
(
ah
, 
AR5K_PHY_AGC
, 
AR5K_PHY_AGC_DISABLE
);

1508 
	`mdñay
(1);

1513 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_PHY_AGCCTL
, 
AR5K_PHY_AGCCTL_CAL
);

1515 
ªt
 = 
	`©h5k_hw_ªgi°î_timeout
(
ah
, 
AR5K_PHY_AGCCTL
,

1516 
AR5K_PHY_AGCCTL_CAL
, 0, 
Ál£
);

1519 
	`©h5k_hw_ªg_wrôe
(
ah
, 
phy_sig
, 
AR5K_PHY_SIG
);

1520 
	`©h5k_hw_ªg_wrôe
(
ah
, 
phy_agc
, 
AR5K_PHY_AGCCOARSE
);

1521 
	`©h5k_hw_ªg_wrôe
(
ah
, 
phy_ßt
, 
AR5K_PHY_ADCSAT
);

1523 i‡(
ªt
) {

1524 
	`ATH5K_ERR
(
ah
, "calibrationÅimeout (%uMHz)\n",

1525 
ch™√l
->
˚¡î_‰eq
);

1526  
ªt
;

1532 
	`AR5K_REG_DISABLE_BITS
(
ah
, 
AR5K_DIAG_SW_5210
,

1533 
AR5K_DIAG_SW_DIS_TX_5210
 | 
AR5K_DIAG_SW_DIS_RX_5210
);

1534 
	`©h5k_hw_ªg_wrôe
(
ah
, 
bóc⁄
, 
AR5K_BEACON_5210
);

1537 
	}
}

1543 
	$©h5k_hw_rf511x_iq_ˇlibøã
(
©h5k_hw
 *
ah
)

1545 
u32
 
i_pwr
, 
q_pwr
;

1546 
s32
 
iq_c‹r
, 
i_coff
, 
i_coffd
, 
q_coff
, 
q_coffd
;

1547 
i
;

1549 i‡(!
ah
->
ah_ˇlibøti⁄
 ||

1550 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PHY_IQ
Ë& 
AR5K_PHY_IQ_RUN
)

1555 
i
 = 0; i <= 10; i++) {

1556 
iq_c‹r
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PHY_IQRES_CAL_CORR
);

1557 
i_pwr
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PHY_IQRES_CAL_PWR_I
);

1558 
q_pwr
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PHY_IQRES_CAL_PWR_Q
);

1559 
	`ATH5K_DBG_UNLIMIT
(
ah
, 
ATH5K_DEBUG_CALIBRATE
,

1560 "iq_c‹r:%x i_pwr:%x q_pwr:%x", 
iq_c‹r
, 
i_pwr
, 
q_pwr
);

1561 i‡(
i_pwr
 && 
q_pwr
)

1565 
i_coffd
 = ((
i_pwr
 >> 1Ë+ (
q_pwr
 >> 1)) >> 7;

1567 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5211
)

1568 
q_coffd
 = 
q_pwr
 >> 6;

1570 
q_coffd
 = 
q_pwr
 >> 7;

1573 i‡(
i_coffd
 =0 || 
q_coffd
 < 2)

1576 
i_coff
 = (-
iq_c‹r
Ë/ 
i_coffd
;

1577 
i_coff
 = 
	`˛amp
(i_coff, -32, 31);

1579 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5211
)

1580 
q_coff
 = (
i_pwr
 / 
q_coffd
) - 64;

1582 
q_coff
 = (
i_pwr
 / 
q_coffd
) - 128;

1583 
q_coff
 = 
	`˛amp
(q_coff, -16, 15);

1585 
	`ATH5K_DBG_UNLIMIT
(
ah
, 
ATH5K_DEBUG_CALIBRATE
,

1587 
i_coff
, 
q_coff
, 
i_coffd
, 
q_coffd
);

1590 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_IQ
, 
AR5K_PHY_IQ_CORR_Q_I_COFF
, 
i_coff
);

1591 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_IQ
, 
AR5K_PHY_IQ_CORR_Q_Q_COFF
, 
q_coff
);

1592 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_PHY_IQ
, 
AR5K_PHY_IQ_CORR_ENABLE
);

1596 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_IQ
,

1597 
AR5K_PHY_IQ_CAL_NUM_LOG_MAX
, 15);

1598 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_PHY_IQ
, 
AR5K_PHY_IQ_RUN
);

1601 
	}
}

1606 
	$©h5k_hw_phy_ˇlibøã
(
©h5k_hw
 *
ah
,

1607 
õì80211_ch™√l
 *
ch™√l
)

1609 
ªt
;

1611 i‡(
ah
->
ah_ødio
 =
AR5K_RF5110
)

1612  
	`©h5k_hw_rf5110_ˇlibøã
(
ah
, 
ch™√l
);

1614 
ªt
 = 
	`©h5k_hw_rf511x_iq_ˇlibøã
(
ah
);

1616 i‡((
ah
->
ah_ødio
 =
AR5K_RF5111
 ||áh->ah_ødiÿ=
AR5K_RF5112
) &&

1617 (
ch™√l
->
hw_vÆue
 & 
CHANNEL_OFDM
))

1618 
	`©h5k_hw_ªque°_rfgaö_¥obe
(
ah
);

1620  
ªt
;

1621 
	}
}

1629 
	$©h5k_hw_£t_•ur_môig©i⁄_fûãr
(
©h5k_hw
 *
ah
,

1630 
õì80211_ch™√l
 *
ch™√l
)

1632 
©h5k_ì¥om_öfo
 *
ì
 = &
ah
->
ah_ˇ∑bûôõs
.
ˇp_ì¥om
;

1633 
u32
 
mag_mask
[4] = {0, 0, 0, 0};

1634 
u32
 
pûŸ_mask
[2] = {0, 0};

1636 
u16
 
•ur_ch™_fbö
, 
ch™_fbö
, 
symbﬁ_width
, 
•ur_dëe˘i⁄_wödow
;

1637 
s32
 
•ur_dñè_pha£
, 
•ur_‰eq_sigma_dñè
;

1638 
s32
 
•ur_off£t
, 
num_symbﬁs_x16
;

1639 
u8
 
num_symbﬁ_off£ts
, 
i
, 
‰eq_b™d
;

1644 i‡(
ch™√l
->
hw_vÆue
 & 
CHANNEL_2GHZ
) {

1645 
ch™_fbö
 = (
ch™√l
->
˚¡î_‰eq
 - 2300) * 10;

1646 
‰eq_b™d
 = 
AR5K_EEPROM_BAND_2GHZ
;

1648 
ch™_fbö
 = (
ch™√l
->
˚¡î_‰eq
 - 4900) * 10;

1649 
‰eq_b™d
 = 
AR5K_EEPROM_BAND_5GHZ
;

1654 
•ur_ch™_fbö
 = 
AR5K_EEPROM_NO_SPUR
;

1655 
•ur_dëe˘i⁄_wödow
 = 
AR5K_SPUR_CHAN_WIDTH
;

1657 i‡(
ah
->
ah_bwmode
 =
AR5K_BWMODE_40MHZ
)

1658 
•ur_dëe˘i⁄_wödow
 *= 2;

1660 
i
 = 0; i < 
AR5K_EEPROM_N_SPUR_CHANS
; i++) {

1661 
•ur_ch™_fbö
 = 
ì
->
ì_•ur_ch™s
[
i
][
‰eq_b™d
];

1665 i‡(
•ur_ch™_fbö
 =
AR5K_EEPROM_NO_SPUR
) {

1666 
•ur_ch™_fbö
 &
AR5K_EEPROM_SPUR_CHAN_MASK
;

1670 i‡((
ch™_fbö
 - 
•ur_dëe˘i⁄_wödow
 <=

1671 (
•ur_ch™_fbö
 & 
AR5K_EEPROM_SPUR_CHAN_MASK
)) &&

1672 (
ch™_fbö
 + 
•ur_dëe˘i⁄_wödow
 >=

1673 (
•ur_ch™_fbö
 & 
AR5K_EEPROM_SPUR_CHAN_MASK
))) {

1674 
•ur_ch™_fbö
 &
AR5K_EEPROM_SPUR_CHAN_MASK
;

1680 i‡(
•ur_ch™_fbö
) {

1681 
•ur_off£t
 = 
•ur_ch™_fbö
 - 
ch™_fbö
;

1688 
ah
->
ah_bwmode
) {

1689 
AR5K_BWMODE_40MHZ
:

1691 
•ur_dñè_pha£
 = (
•ur_off£t
 << 16) / 25;

1692 
•ur_‰eq_sigma_dñè
 = (
•ur_dñè_pha£
 >> 10);

1693 
symbﬁ_width
 = 
AR5K_SPUR_SYMBOL_WIDTH_BASE_100Hz
 * 2;

1695 
AR5K_BWMODE_10MHZ
:

1697 
•ur_dñè_pha£
 = (
•ur_off£t
 << 18) / 25;

1698 
•ur_‰eq_sigma_dñè
 = (
•ur_dñè_pha£
 >> 10);

1699 
symbﬁ_width
 = 
AR5K_SPUR_SYMBOL_WIDTH_BASE_100Hz
 / 2;

1700 
AR5K_BWMODE_5MHZ
:

1702 
•ur_dñè_pha£
 = (
•ur_off£t
 << 19) / 25;

1703 
•ur_‰eq_sigma_dñè
 = (
•ur_dñè_pha£
 >> 10);

1704 
symbﬁ_width
 = 
AR5K_SPUR_SYMBOL_WIDTH_BASE_100Hz
 / 4;

1706 i‡(
ch™√l
->
hw_vÆue
 =
CHANNEL_A
) {

1708 
•ur_dñè_pha£
 = (
•ur_off£t
 << 17) / 25;

1709 
•ur_‰eq_sigma_dñè
 =

1710 (
•ur_dñè_pha£
 >> 10);

1711 
symbﬁ_width
 =

1712 
AR5K_SPUR_SYMBOL_WIDTH_BASE_100Hz
;

1716 
•ur_dñè_pha£
 = (
•ur_off£t
 << 17) / 25;

1717 
•ur_‰eq_sigma_dñè
 =

1718 (
•ur_off£t
 << 8) / 55;

1719 
symbﬁ_width
 =

1720 
AR5K_SPUR_SYMBOL_WIDTH_BASE_100Hz
;

1730 
num_symbﬁs_x16
 = ((
•ur_off£t
 * 1000Ë<< 4Ë/ 
symbﬁ_width
;

1733 i‡(!(
num_symbﬁs_x16
 & 0xF))

1735 
num_symbﬁ_off£ts
 = 3;

1738 
num_symbﬁ_off£ts
 = 4;

1740 
i
 = 0; i < 
num_symbﬁ_off£ts
; i++) {

1743 
s32
 
cuº_sym_off
 =

1744 (
num_symbﬁs_x16
 / 16Ë+ 
i
 + 25;

1751 
u8
 
∂t_mag_m≠
 =

1752 (
i
 =0 || i =(
num_symbﬁ_off£ts
 - 1))

1755 i‡(
cuº_sym_off
 >= 0 && curr_sym_off <= 32) {

1756 i‡(
cuº_sym_off
 <= 25)

1757 
pûŸ_mask
[0] |1 << 
cuº_sym_off
;

1758 i‡(
cuº_sym_off
 >= 27)

1759 
pûŸ_mask
[0] |1 << (
cuº_sym_off
 - 1);

1760 } i‡(
cuº_sym_off
 >= 33 && curr_sym_off <= 52)

1761 
pûŸ_mask
[1] |1 << (
cuº_sym_off
 - 33);

1764 i‡(
cuº_sym_off
 >= -1 && curr_sym_off <= 14)

1765 
mag_mask
[0] |=

1766 
∂t_mag_m≠
 << (
cuº_sym_off
 + 1) * 2;

1767 i‡(
cuº_sym_off
 >= 15 && curr_sym_off <= 30)

1768 
mag_mask
[1] |=

1769 
∂t_mag_m≠
 << (
cuº_sym_off
 - 15) * 2;

1770 i‡(
cuº_sym_off
 >= 31 && curr_sym_off <= 46)

1771 
mag_mask
[2] |=

1772 
∂t_mag_m≠
 << (
cuº_sym_off
 - 31) * 2;

1773 i‡(
cuº_sym_off
 >= 47 && curr_sym_off <= 53)

1774 
mag_mask
[3] |=

1775 
∂t_mag_m≠
 << (
cuº_sym_off
 - 47) * 2;

1780 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_BIN_MASK_CTL
,

1781 
AR5K_PHY_BIN_MASK_CTL_RATE
, 0xff);

1783 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_PHY_IQ
,

1784 
AR5K_PHY_IQ_PILOT_MASK_EN
 |

1785 
AR5K_PHY_IQ_CHAN_MASK_EN
 |

1786 
AR5K_PHY_IQ_SPUR_FILT_EN
);

1789 
	`©h5k_hw_ªg_wrôe
(
ah
,

1790 
	`AR5K_REG_SM
(
•ur_dñè_pha£
,

1791 
AR5K_PHY_TIMING_11_SPUR_DELTA_PHASE
) |

1792 
	`AR5K_REG_SM
(
•ur_‰eq_sigma_dñè
,

1793 
AR5K_PHY_TIMING_11_SPUR_FREQ_SD
) |

1794 
AR5K_PHY_TIMING_11_USE_SPUR_IN_AGC
,

1795 
AR5K_PHY_TIMING_11
);

1798 
	`©h5k_hw_ªg_wrôe
(
ah
, 
pûŸ_mask
[0], 
AR5K_PHY_TIMING_7
);

1799 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_TIMING_8
,

1800 
AR5K_PHY_TIMING_8_PILOT_MASK_2
,

1801 
pûŸ_mask
[1]);

1803 
	`©h5k_hw_ªg_wrôe
(
ah
, 
pûŸ_mask
[0], 
AR5K_PHY_TIMING_9
);

1804 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_TIMING_10
,

1805 
AR5K_PHY_TIMING_10_PILOT_MASK_2
,

1806 
pûŸ_mask
[1]);

1809 
	`©h5k_hw_ªg_wrôe
(
ah
, 
mag_mask
[0], 
AR5K_PHY_BIN_MASK_1
);

1810 
	`©h5k_hw_ªg_wrôe
(
ah
, 
mag_mask
[1], 
AR5K_PHY_BIN_MASK_2
);

1811 
	`©h5k_hw_ªg_wrôe
(
ah
, 
mag_mask
[2], 
AR5K_PHY_BIN_MASK_3
);

1812 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_BIN_MASK_CTL
,

1813 
AR5K_PHY_BIN_MASK_CTL_MASK_4
,

1814 
mag_mask
[3]);

1816 
	`©h5k_hw_ªg_wrôe
(
ah
, 
mag_mask
[0], 
AR5K_PHY_BIN_MASK2_1
);

1817 
	`©h5k_hw_ªg_wrôe
(
ah
, 
mag_mask
[1], 
AR5K_PHY_BIN_MASK2_2
);

1818 
	`©h5k_hw_ªg_wrôe
(
ah
, 
mag_mask
[2], 
AR5K_PHY_BIN_MASK2_3
);

1819 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_BIN_MASK2_4
,

1820 
AR5K_PHY_BIN_MASK2_4_MASK_4
,

1821 
mag_mask
[3]);

1823 } i‡(
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PHY_IQ
) &

1824 
AR5K_PHY_IQ_SPUR_FILT_EN
) {

1826 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_BIN_MASK_CTL
,

1827 
AR5K_PHY_BIN_MASK_CTL_RATE
, 0);

1828 
	`AR5K_REG_DISABLE_BITS
(
ah
, 
AR5K_PHY_IQ
,

1829 
AR5K_PHY_IQ_PILOT_MASK_EN
 |

1830 
AR5K_PHY_IQ_CHAN_MASK_EN
 |

1831 
AR5K_PHY_IQ_SPUR_FILT_EN
);

1832 
	`©h5k_hw_ªg_wrôe
(
ah
, 0, 
AR5K_PHY_TIMING_11
);

1835 
	`©h5k_hw_ªg_wrôe
(
ah
, 0, 
AR5K_PHY_TIMING_7
);

1836 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_TIMING_8
,

1837 
AR5K_PHY_TIMING_8_PILOT_MASK_2
,

1840 
	`©h5k_hw_ªg_wrôe
(
ah
, 0, 
AR5K_PHY_TIMING_9
);

1841 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_TIMING_10
,

1842 
AR5K_PHY_TIMING_10_PILOT_MASK_2
,

1846 
	`©h5k_hw_ªg_wrôe
(
ah
, 0, 
AR5K_PHY_BIN_MASK_1
);

1847 
	`©h5k_hw_ªg_wrôe
(
ah
, 0, 
AR5K_PHY_BIN_MASK_2
);

1848 
	`©h5k_hw_ªg_wrôe
(
ah
, 0, 
AR5K_PHY_BIN_MASK_3
);

1849 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_BIN_MASK_CTL
,

1850 
AR5K_PHY_BIN_MASK_CTL_MASK_4
,

1853 
	`©h5k_hw_ªg_wrôe
(
ah
, 0, 
AR5K_PHY_BIN_MASK2_1
);

1854 
	`©h5k_hw_ªg_wrôe
(
ah
, 0, 
AR5K_PHY_BIN_MASK2_2
);

1855 
	`©h5k_hw_ªg_wrôe
(
ah
, 0, 
AR5K_PHY_BIN_MASK2_3
);

1856 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_BIN_MASK2_4
,

1857 
AR5K_PHY_BIN_MASK2_4_MASK_4
,

1860 
	}
}

1868 
	$©h5k_hw_£t_def_™ã¬a
(
©h5k_hw
 *
ah
, 
u8
 
™t
)

1870 i‡(
ah
->
ah_vîsi⁄
 !
AR5K_AR5210
)

1871 
	`©h5k_hw_ªg_wrôe
(
ah
, 
™t
 & 0x7, 
AR5K_DEFAULT_ANTENNA
);

1872 
	}
}

1878 
	$©h5k_hw_£t_Á°_div
(
©h5k_hw
 *
ah
, 
u8
 
ì_mode
, 
boﬁ
 
íabÀ
)

1880 
ì_mode
) {

1881 
AR5K_EEPROM_MODE_11G
:

1884 
AR5K_EEPROM_MODE_11A
:

1885 i‡(
íabÀ
)

1886 
	`AR5K_REG_DISABLE_BITS
(
ah
, 
AR5K_PHY_AGCCTL
,

1887 
AR5K_PHY_AGCCTL_OFDM_DIV_DIS
);

1889 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_PHY_AGCCTL
,

1890 
AR5K_PHY_AGCCTL_OFDM_DIV_DIS
);

1892 
AR5K_EEPROM_MODE_11B
:

1893 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_PHY_AGCCTL
,

1894 
AR5K_PHY_AGCCTL_OFDM_DIV_DIS
);

1900 i‡(
íabÀ
) {

1901 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_RESTART
,

1902 
AR5K_PHY_RESTART_DIV_GC
, 4);

1904 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_PHY_FAST_ANT_DIV
,

1905 
AR5K_PHY_FAST_ANT_DIV_EN
);

1907 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_RESTART
,

1908 
AR5K_PHY_RESTART_DIV_GC
, 0);

1910 
	`AR5K_REG_DISABLE_BITS
(
ah
, 
AR5K_PHY_FAST_ANT_DIV
,

1911 
AR5K_PHY_FAST_ANT_DIV_EN
);

1913 
	}
}

1916 
	$©h5k_hw_£t_™ã¬a_swôch
(
©h5k_hw
 *
ah
, 
u8
 
ì_mode
)

1918 
u8
 
™t0
, 
™t1
;

1924 i‡(
ah
->
ah_™t_mode
 =
AR5K_ANTMODE_FIXED_A
)

1925 
™t0
 = 
™t1
 = 
AR5K_ANT_SWTABLE_A
;

1926 i‡(
ah
->
ah_™t_mode
 =
AR5K_ANTMODE_FIXED_B
)

1927 
™t0
 = 
™t1
 = 
AR5K_ANT_SWTABLE_B
;

1929 
™t0
 = 
AR5K_ANT_SWTABLE_A
;

1930 
™t1
 = 
AR5K_ANT_SWTABLE_B
;

1934 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_ANT_CTL
,

1935 
AR5K_PHY_ANT_CTL_SWTABLE_IDLE
,

1936 (
ah
->
ah_™t_˘l
[
ì_mode
][
AR5K_ANT_CTL
] |

1937 
AR5K_PHY_ANT_CTL_TXRX_EN
));

1940 
	`©h5k_hw_ªg_wrôe
(
ah
,áh->
ah_™t_˘l
[
ì_mode
][
™t0
],

1941 
AR5K_PHY_ANT_SWITCH_TABLE_0
);

1942 
	`©h5k_hw_ªg_wrôe
(
ah
,áh->
ah_™t_˘l
[
ì_mode
][
™t1
],

1943 
AR5K_PHY_ANT_SWITCH_TABLE_1
);

1944 
	}
}

1950 
	$©h5k_hw_£t_™ã¬a_mode
(
©h5k_hw
 *
ah
, 
u8
 
™t_mode
)

1952 
õì80211_ch™√l
 *
ch™√l
 = 
ah
->
ah_cuºít_ch™√l
;

1953 
boﬁ
 
u£_def_f‹_tx
, 
upd©e_def_⁄_tx
, 
u£_def_f‹_πs
, 
Á°_div
;

1954 
boﬁ
 
u£_def_f‹_sg
;

1955 
ì_mode
;

1956 
u8
 
def_™t
, 
tx_™t
;

1957 
u32
 
°a_id1
 = 0;

1961 i‡(
ch™√l
 =
NULL
) {

1962 
ah
->
ah_™t_mode
 = 
™t_mode
;

1966 
def_™t
 = 
ah
->
ah_def_™t
;

1968 
ì_mode
 = 
	`©h5k_ì¥om_mode_‰om_ch™√l
(
ch™√l
);

1969 i‡(
ì_mode
 < 0) {

1970 
	`ATH5K_ERR
(
ah
,

1971 "övÆid ch™√l: %d\n", 
ch™√l
->
˚¡î_‰eq
);

1975 
™t_mode
) {

1976 
AR5K_ANTMODE_DEFAULT
:

1977 
tx_™t
 = 0;

1978 
u£_def_f‹_tx
 = 
Ál£
;

1979 
upd©e_def_⁄_tx
 = 
Ál£
;

1980 
u£_def_f‹_πs
 = 
Ál£
;

1981 
u£_def_f‹_sg
 = 
Ál£
;

1982 
Á°_div
 = 
åue
;

1984 
AR5K_ANTMODE_FIXED_A
:

1985 
def_™t
 = 1;

1986 
tx_™t
 = 1;

1987 
u£_def_f‹_tx
 = 
åue
;

1988 
upd©e_def_⁄_tx
 = 
Ál£
;

1989 
u£_def_f‹_πs
 = 
åue
;

1990 
u£_def_f‹_sg
 = 
åue
;

1991 
Á°_div
 = 
Ál£
;

1993 
AR5K_ANTMODE_FIXED_B
:

1994 
def_™t
 = 2;

1995 
tx_™t
 = 2;

1996 
u£_def_f‹_tx
 = 
åue
;

1997 
upd©e_def_⁄_tx
 = 
Ál£
;

1998 
u£_def_f‹_πs
 = 
åue
;

1999 
u£_def_f‹_sg
 = 
åue
;

2000 
Á°_div
 = 
Ál£
;

2002 
AR5K_ANTMODE_SINGLE_AP
:

2003 
def_™t
 = 1;

2004 
tx_™t
 = 0;

2005 
u£_def_f‹_tx
 = 
åue
;

2006 
upd©e_def_⁄_tx
 = 
åue
;

2007 
u£_def_f‹_πs
 = 
åue
;

2008 
u£_def_f‹_sg
 = 
åue
;

2009 
Á°_div
 = 
åue
;

2011 
AR5K_ANTMODE_SECTOR_AP
:

2012 
tx_™t
 = 1;

2013 
u£_def_f‹_tx
 = 
Ál£
;

2014 
upd©e_def_⁄_tx
 = 
Ál£
;

2015 
u£_def_f‹_πs
 = 
åue
;

2016 
u£_def_f‹_sg
 = 
Ál£
;

2017 
Á°_div
 = 
Ál£
;

2019 
AR5K_ANTMODE_SECTOR_STA
:

2020 
tx_™t
 = 1;

2021 
u£_def_f‹_tx
 = 
åue
;

2022 
upd©e_def_⁄_tx
 = 
Ál£
;

2023 
u£_def_f‹_πs
 = 
åue
;

2024 
u£_def_f‹_sg
 = 
Ál£
;

2025 
Á°_div
 = 
åue
;

2027 
AR5K_ANTMODE_DEBUG
:

2028 
def_™t
 = 1;

2029 
tx_™t
 = 2;

2030 
u£_def_f‹_tx
 = 
Ál£
;

2031 
upd©e_def_⁄_tx
 = 
Ál£
;

2032 
u£_def_f‹_πs
 = 
Ál£
;

2033 
u£_def_f‹_sg
 = 
Ál£
;

2034 
Á°_div
 = 
Ál£
;

2040 
ah
->
ah_tx_™t
 = 
tx_™t
;

2041 
ah
->
ah_™t_mode
 = 
™t_mode
;

2042 
ah
->
ah_def_™t
 = 
def_™t
;

2044 
°a_id1
 |
u£_def_f‹_tx
 ? 
AR5K_STA_ID1_DEFAULT_ANTENNA
 : 0;

2045 
°a_id1
 |
upd©e_def_⁄_tx
 ? 
AR5K_STA_ID1_DESC_ANTENNA
 : 0;

2046 
°a_id1
 |
u£_def_f‹_πs
 ? 
AR5K_STA_ID1_RTS_DEF_ANTENNA
 : 0;

2047 
°a_id1
 |
u£_def_f‹_sg
 ? 
AR5K_STA_ID1_SELFGEN_DEF_ANT
 : 0;

2049 
	`AR5K_REG_DISABLE_BITS
(
ah
, 
AR5K_STA_ID1
, 
AR5K_STA_ID1_ANTENNA_SETTINGS
);

2051 i‡(
°a_id1
)

2052 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_STA_ID1
, 
°a_id1
);

2054 
	`©h5k_hw_£t_™ã¬a_swôch
(
ah
, 
ì_mode
);

2057 
	`©h5k_hw_£t_Á°_div
(
ah
, 
ì_mode
, 
Á°_div
);

2058 
	`©h5k_hw_£t_def_™ã¬a
(
ah
, 
def_™t
);

2059 
	}
}

2073 
s16


2074 
	$©h5k_gë_öãΩﬁ©ed_vÆue
(
s16
 
èrgë
, s16 
x_À·
, s16 
x_right
,

2075 
s16
 
y_À·
, s16 
y_right
)

2077 
s16
 
øtio
, 
ªsu…
;

2081 i‡((
x_À·
 =
x_right
Ë|| (
y_À·
 =
y_right
))

2082  
y_À·
;

2090 
øtio
 = ((100 * 
y_right
 - 100 * 
y_À·
Ë/ (
x_right
 - 
x_À·
));

2093 
ªsu…
 = 
y_À·
 + (
øtio
 * (
èrgë
 - 
x_À·
) / 100);

2095  
ªsu…
;

2096 
	}
}

2106 
s16


2107 
	$©h5k_gë_löór_pcdac_mö
(c⁄° 
u8
 *
°ïL
, c⁄° u8 *
°ïR
,

2108 c⁄° 
s16
 *
pwrL
, c⁄° s16 *
pwrR
)

2110 
s8
 
tmp
;

2111 
s16
 
mö_pwrL
, 
mö_pwrR
;

2112 
s16
 
pwr_i
;

2115 i‡(
°ïL
[0] =°ïL[1] || 
°ïR
[0] == stepR[1])

2116  
	`max
(
pwrL
[0], 
pwrR
[0]);

2118 i‡(
pwrL
[0] ==ÖwrL[1])

2119 
mö_pwrL
 = 
pwrL
[0];

2121 
pwr_i
 = 
pwrL
[0];

2123 
pwr_i
--;

2124 
tmp
 = (
s8
Ë
	`©h5k_gë_öãΩﬁ©ed_vÆue
(
pwr_i
,

2125 
pwrL
[0],ÖwrL[1],

2126 
°ïL
[0], stepL[1]);

2127 } 
tmp
 > 1);

2129 
mö_pwrL
 = 
pwr_i
;

2132 i‡(
pwrR
[0] ==ÖwrR[1])

2133 
mö_pwrR
 = 
pwrR
[0];

2135 
pwr_i
 = 
pwrR
[0];

2137 
pwr_i
--;

2138 
tmp
 = (
s8
Ë
	`©h5k_gë_öãΩﬁ©ed_vÆue
(
pwr_i
,

2139 
pwrR
[0],ÖwrR[1],

2140 
°ïR
[0], stepR[1]);

2141 } 
tmp
 > 1);

2143 
mö_pwrR
 = 
pwr_i
;

2147  
	`max
(
mö_pwrL
, 
mö_pwrR
);

2148 
	}
}

2163 
	$©h5k_¸óã_powî_curve
(
s16
 
pmö
, s16 
pmax
,

2164 c⁄° 
s16
 *
pwr
, c⁄° 
u8
 *
vpd
,

2165 
u8
 
num_poöts
,

2166 
u8
 *
vpd_èbÀ
, u8 
ty≥
)

2168 
u8
 
idx
[2] = { 0, 1 };

2169 
s16
 
pwr_i
 = 2 * 
pmö
;

2170 
i
;

2172 i‡(
num_poöts
 < 2)

2179 i‡(
ty≥
 =
AR5K_PWRTABLE_LINEAR_PCDAC
) {

2180 
pwr_i
 = 
pmö
;

2181 
pmö
 = 0;

2182 
pmax
 = 63;

2187 
i
 = 0; (ò<(
u16
Ë(
pmax
 - 
pmö
)) &&

2188 (
i
 < 
AR5K_EEPROM_POWER_TABLE_SIZE
); i++) {

2193 i‡((
pwr_i
 > 
pwr
[
idx
[1]]Ë&& (idx[1] < 
num_poöts
 - 1)) {

2194 
idx
[0]++;

2195 
idx
[1]++;

2198 
vpd_èbÀ
[
i
] = (
u8
Ë
	`©h5k_gë_öãΩﬁ©ed_vÆue
(
pwr_i
,

2199 
pwr
[
idx
[0]],Öwr[idx[1]],

2200 
vpd
[
idx
[0]], vpd[idx[1]]);

2204 
pwr_i
 += 2;

2206 
	}
}

2215 
	$©h5k_gë_ch™_pˇl_suºoundög_põrs
(
©h5k_hw
 *
ah
,

2216 
õì80211_ch™√l
 *
ch™√l
,

2217 
©h5k_ch™_pˇl_öfo
 **
pcöfo_l
,

2218 
©h5k_ch™_pˇl_öfo
 **
pcöfo_r
)

2220 
©h5k_ì¥om_öfo
 *
ì
 = &
ah
->
ah_ˇ∑bûôõs
.
ˇp_ì¥om
;

2221 
©h5k_ch™_pˇl_öfo
 *
pcöfo
;

2222 
u8
 
idx_l
, 
idx_r
;

2223 
u8
 
mode
, 
max
, 
i
;

2224 
u32
 
èrgë
 = 
ch™√l
->
˚¡î_‰eq
;

2226 
idx_l
 = 0;

2227 
idx_r
 = 0;

2229 i‡(!(
ch™√l
->
hw_vÆue
 & 
CHANNEL_OFDM
)) {

2230 
pcöfo
 = 
ì
->
ì_pwr_ˇl_b
;

2231 
mode
 = 
AR5K_EEPROM_MODE_11B
;

2232 } i‡(
ch™√l
->
hw_vÆue
 & 
CHANNEL_2GHZ
) {

2233 
pcöfo
 = 
ì
->
ì_pwr_ˇl_g
;

2234 
mode
 = 
AR5K_EEPROM_MODE_11G
;

2236 
pcöfo
 = 
ì
->
ì_pwr_ˇl_a
;

2237 
mode
 = 
AR5K_EEPROM_MODE_11A
;

2239 
max
 = 
ì
->
ì_n_põrs
[
mode
] - 1;

2244 i‡(
èrgë
 < 
pcöfo
[0].
‰eq
) {

2245 
idx_l
 = 
idx_r
 = 0;

2246 
d⁄e
;

2252 i‡(
èrgë
 > 
pcöfo
[
max
].
‰eq
) {

2253 
idx_l
 = 
idx_r
 = 
max
;

2254 
d⁄e
;

2261 
i
 = 0; i <
max
; i++) {

2266 i‡(
pcöfo
[
i
].
‰eq
 =
èrgë
) {

2267 
idx_l
 = 
idx_r
 = 
i
;

2268 
d⁄e
;

2274 i‡(
èrgë
 < 
pcöfo
[
i
].
‰eq
) {

2275 
idx_r
 = 
i
;

2276 
idx_l
 = 
idx_r
 - 1;

2277 
d⁄e
;

2281 
d⁄e
:

2282 *
pcöfo_l
 = &
pcöfo
[
idx_l
];

2283 *
pcöfo_r
 = &
pcöfo
[
idx_r
];

2284 
	}
}

2293 
	$©h5k_gë_øã_pˇl_d©a
(
©h5k_hw
 *
ah
,

2294 
õì80211_ch™√l
 *
ch™√l
,

2295 
©h5k_øã_pˇl_öfo
 *
øãs
)

2297 
©h5k_ì¥om_öfo
 *
ì
 = &
ah
->
ah_ˇ∑bûôõs
.
ˇp_ì¥om
;

2298 
©h5k_øã_pˇl_öfo
 *
Ωöfo
;

2299 
u8
 
idx_l
, 
idx_r
;

2300 
u8
 
mode
, 
max
, 
i
;

2301 
u32
 
èrgë
 = 
ch™√l
->
˚¡î_‰eq
;

2303 
idx_l
 = 0;

2304 
idx_r
 = 0;

2306 i‡(!(
ch™√l
->
hw_vÆue
 & 
CHANNEL_OFDM
)) {

2307 
Ωöfo
 = 
ì
->
ì_øã_çwr_b
;

2308 
mode
 = 
AR5K_EEPROM_MODE_11B
;

2309 } i‡(
ch™√l
->
hw_vÆue
 & 
CHANNEL_2GHZ
) {

2310 
Ωöfo
 = 
ì
->
ì_øã_çwr_g
;

2311 
mode
 = 
AR5K_EEPROM_MODE_11G
;

2313 
Ωöfo
 = 
ì
->
ì_øã_çwr_a
;

2314 
mode
 = 
AR5K_EEPROM_MODE_11A
;

2316 
max
 = 
ì
->
ì_øã_èrgë_pwr_num
[
mode
] - 1;

2320 i‡(
èrgë
 < 
Ωöfo
[0].
‰eq
) {

2321 
idx_l
 = 
idx_r
 = 0;

2322 
d⁄e
;

2325 i‡(
èrgë
 > 
Ωöfo
[
max
].
‰eq
) {

2326 
idx_l
 = 
idx_r
 = 
max
;

2327 
d⁄e
;

2330 
i
 = 0; i <
max
; i++) {

2332 i‡(
Ωöfo
[
i
].
‰eq
 =
èrgë
) {

2333 
idx_l
 = 
idx_r
 = 
i
;

2334 
d⁄e
;

2337 i‡(
èrgë
 < 
Ωöfo
[
i
].
‰eq
) {

2338 
idx_r
 = 
i
;

2339 
idx_l
 = 
idx_r
 - 1;

2340 
d⁄e
;

2344 
d⁄e
:

2346 
øãs
->
‰eq
 = 
èrgë
;

2348 
øãs
->
èrgë_powî_6to24
 =

2349 
	`©h5k_gë_öãΩﬁ©ed_vÆue
(
èrgë
, 
Ωöfo
[
idx_l
].
‰eq
,

2350 
Ωöfo
[
idx_r
].
‰eq
,

2351 
Ωöfo
[
idx_l
].
èrgë_powî_6to24
,

2352 
Ωöfo
[
idx_r
].
èrgë_powî_6to24
);

2354 
øãs
->
èrgë_powî_36
 =

2355 
	`©h5k_gë_öãΩﬁ©ed_vÆue
(
èrgë
, 
Ωöfo
[
idx_l
].
‰eq
,

2356 
Ωöfo
[
idx_r
].
‰eq
,

2357 
Ωöfo
[
idx_l
].
èrgë_powî_36
,

2358 
Ωöfo
[
idx_r
].
èrgë_powî_36
);

2360 
øãs
->
èrgë_powî_48
 =

2361 
	`©h5k_gë_öãΩﬁ©ed_vÆue
(
èrgë
, 
Ωöfo
[
idx_l
].
‰eq
,

2362 
Ωöfo
[
idx_r
].
‰eq
,

2363 
Ωöfo
[
idx_l
].
èrgë_powî_48
,

2364 
Ωöfo
[
idx_r
].
èrgë_powî_48
);

2366 
øãs
->
èrgë_powî_54
 =

2367 
	`©h5k_gë_öãΩﬁ©ed_vÆue
(
èrgë
, 
Ωöfo
[
idx_l
].
‰eq
,

2368 
Ωöfo
[
idx_r
].
‰eq
,

2369 
Ωöfo
[
idx_l
].
èrgë_powî_54
,

2370 
Ωöfo
[
idx_r
].
èrgë_powî_54
);

2371 
	}
}

2379 
	$©h5k_gë_max_˘l_powî
(
©h5k_hw
 *
ah
,

2380 
õì80211_ch™√l
 *
ch™√l
)

2382 
©h_ªguœt‹y
 *
ªguœt‹y
 = 
	`©h5k_hw_ªguœt‹y
(
ah
);

2383 
©h5k_ì¥om_öfo
 *
ì
 = &
ah
->
ah_ˇ∑bûôõs
.
ˇp_ì¥om
;

2384 
©h5k_edge_powî
 *
ªp
 = 
ì
->
ì_˘l_pwr
;

2385 
u8
 *
˘l_vÆ
 = 
ì
->
ì_˘l
;

2386 
s16
 
max_ch™_pwr
 = 
ah
->
ah_txpowî
.
txp_max_pwr
 / 4;

2387 
s16
 
edge_pwr
 = 0;

2388 
u8
 
ªp_idx
;

2389 
u8
 
i
, 
˘l_mode
;

2390 
u8
 
˘l_idx
 = 0xFF;

2391 
u32
 
èrgë
 = 
ch™√l
->
˚¡î_‰eq
;

2393 
˘l_mode
 = 
	`©h_ªgd_gë_b™d_˘l
(
ªguœt‹y
, 
ch™√l
->
b™d
);

2395 
ch™√l
->
hw_vÆue
 & 
CHANNEL_MODES
) {

2396 
CHANNEL_A
:

2397 i‡(
ah
->
ah_bwmode
 =
AR5K_BWMODE_40MHZ
)

2398 
˘l_mode
 |
AR5K_CTL_TURBO
;

2400 
˘l_mode
 |
AR5K_CTL_11A
;

2402 
CHANNEL_G
:

2403 i‡(
ah
->
ah_bwmode
 =
AR5K_BWMODE_40MHZ
)

2404 
˘l_mode
 |
AR5K_CTL_TURBOG
;

2406 
˘l_mode
 |
AR5K_CTL_11G
;

2408 
CHANNEL_B
:

2409 
˘l_mode
 |
AR5K_CTL_11B
;

2411 
CHANNEL_XR
:

2417 
i
 = 0; i < 
ì
->
ì_˘ls
; i++) {

2418 i‡(
˘l_vÆ
[
i
] =
˘l_mode
) {

2419 
˘l_idx
 = 
i
;

2426 i‡(
˘l_idx
 == 0xFF)

2432 
ªp_idx
 = 
˘l_idx
 * 
AR5K_EEPROM_N_EDGES
;

2440 
i
 = 0; i < 
AR5K_EEPROM_N_EDGES
; i++) {

2441 
ªp_idx
 +
i
;

2442 i‡(
èrgë
 <
ªp
[
ªp_idx
].
‰eq
)

2443 
edge_pwr
 = (
s16
Ë
ªp
[
ªp_idx
].
edge
;

2446 i‡(
edge_pwr
)

2447 
ah
->
ah_txpowî
.
txp_max_pwr
 = 4 * 
	`mö
(
edge_pwr
, 
max_ch™_pwr
);

2448 
	}
}

2463 
	$©h5k_fûl_pwr_to_pcdac_èbÀ
(
©h5k_hw
 *
ah
, 
s16
* 
èbÀ_mö
,

2464 
s16
 *
èbÀ_max
)

2466 
u8
 *
pcdac_out
 = 
ah
->
ah_txpowî
.
txp_pd_èbÀ
;

2467 
u8
 *
pcdac_tmp
 = 
ah
->
ah_txpowî
.
tmpL
[0];

2468 
u8
 
pcdac_0
, 
pcdac_n
, 
pcdac_i
, 
pwr_idx
, 
i
;

2469 
s16
 
mö_pwr
, 
max_pwr
;

2472 
mö_pwr
 = 
èbÀ_mö
[0];

2473 
pcdac_0
 = 
pcdac_tmp
[0];

2475 
max_pwr
 = 
èbÀ_max
[0];

2476 
pcdac_n
 = 
pcdac_tmp
[
èbÀ_max
[0] - 
èbÀ_mö
[0]];

2479 
pcdac_i
 = 0;

2480 
i
 = 0; i < 
mö_pwr
; i++)

2481 
pcdac_out
[
pcdac_i
++] = 
pcdac_0
;

2484 
pwr_idx
 = 
mö_pwr
;

2485 
i
 = 0; 
pwr_idx
 <
max_pwr
 &&

2486 
pcdac_i
 < 
AR5K_EEPROM_POWER_TABLE_SIZE
; 
i
++) {

2487 
pcdac_out
[
pcdac_i
++] = 
pcdac_tmp
[
i
];

2488 
pwr_idx
++;

2492 
pcdac_i
 < 
AR5K_EEPROM_POWER_TABLE_SIZE
)

2493 
pcdac_out
[
pcdac_i
++] = 
pcdac_n
;

2495 
	}
}

2509 
	$©h5k_comböe_löór_pcdac_curves
(
©h5k_hw
 *
ah
, 
s16
* 
èbÀ_mö
,

2510 
s16
 *
èbÀ_max
, 
u8
 
pdcurves
)

2512 
u8
 *
pcdac_out
 = 
ah
->
ah_txpowî
.
txp_pd_èbÀ
;

2513 
u8
 *
pcdac_low_pwr
;

2514 
u8
 *
pcdac_high_pwr
;

2515 
u8
 *
pcdac_tmp
;

2516 
u8
 
pwr
;

2517 
s16
 
max_pwr_idx
;

2518 
s16
 
mö_pwr_idx
;

2519 
s16
 
mid_pwr_idx
 = 0;

2526 
u8
 
edge_Êag
;

2527 
i
;

2533 i‡(
pdcurves
 > 1) {

2534 
pcdac_low_pwr
 = 
ah
->
ah_txpowî
.
tmpL
[1];

2535 
pcdac_high_pwr
 = 
ah
->
ah_txpowî
.
tmpL
[0];

2536 
mid_pwr_idx
 = 
èbÀ_max
[1] - 
èbÀ_mö
[1] - 1;

2537 
max_pwr_idx
 = (
èbÀ_max
[0] - 
èbÀ_mö
[0]) / 2;

2542 i‡(
èbÀ_max
[0] - 
èbÀ_mö
[1] > 126)

2543 
mö_pwr_idx
 = 
èbÀ_max
[0] - 126;

2545 
mö_pwr_idx
 = 
èbÀ_mö
[1];

2549 
pcdac_tmp
 = 
pcdac_high_pwr
;

2551 
edge_Êag
 = 0x40;

2553 
pcdac_low_pwr
 = 
ah
->
ah_txpowî
.
tmpL
[1];

2554 
pcdac_high_pwr
 = 
ah
->
ah_txpowî
.
tmpL
[0];

2555 
mö_pwr_idx
 = 
èbÀ_mö
[0];

2556 
max_pwr_idx
 = (
èbÀ_max
[0] - 
èbÀ_mö
[0]) / 2;

2557 
pcdac_tmp
 = 
pcdac_high_pwr
;

2558 
edge_Êag
 = 0;

2562 
ah
->
ah_txpowî
.
txp_mö_idx
 = 
mö_pwr_idx
 / 2;

2565 
pwr
 = 
max_pwr_idx
;

2566 
i
 = 63; i >= 0; i--) {

2570 i‡(
edge_Êag
 == 0x40 &&

2571 (2 * 
pwr
 <(
èbÀ_max
[1] - 
èbÀ_mö
[0]) ||Öwr == 0)) {

2572 
edge_Êag
 = 0x00;

2573 
pcdac_tmp
 = 
pcdac_low_pwr
;

2574 
pwr
 = 
mid_pwr_idx
 / 2;

2581 i‡(
pcdac_tmp
[
pwr
] < 1 && (
edge_Êag
 == 0x00)) {

2582 
i
 >= 0) {

2583 
pcdac_out
[
i
] =Öcdac_out[i + 1];

2584 
i
--;

2589 
pcdac_out
[
i
] = 
pcdac_tmp
[
pwr
] | 
edge_Êag
;

2594 i‡(
pcdac_out
[
i
] > 126)

2595 
pcdac_out
[
i
] = 126;

2598 
pwr
--;

2600 
	}
}

2604 
	$©h5k_wrôe_pcdac_èbÀ
(
©h5k_hw
 *
ah
)

2606 
u8
 *
pcdac_out
 = 
ah
->
ah_txpowî
.
txp_pd_èbÀ
;

2607 
i
;

2612 
i
 = 0; i < (
AR5K_EEPROM_POWER_TABLE_SIZE
 / 2); i++) {

2613 
	`©h5k_hw_ªg_wrôe
(
ah
,

2614 (((
pcdac_out
[2 * 
i
 + 0] << 8 | 0xff) & 0xffff) << 0) |

2615 (((
pcdac_out
[2 * 
i
 + 1] << 8 | 0xff) & 0xffff) << 16),

2616 
	`AR5K_PHY_PCDAC_TXPOWER
(
i
));

2618 
	}
}

2633 
	$©h5k_comböe_pwr_to_pdadc_curves
(
©h5k_hw
 *
ah
,

2634 
s16
 *
pwr_mö
, s16 *
pwr_max
, 
u8
 
pdcurves
)

2636 
u8
 
gaö_bound¨õs
[
AR5K_EEPROM_N_PD_GAINS
];

2637 
u8
 *
pdadc_out
 = 
ah
->
ah_txpowî
.
txp_pd_èbÀ
;

2638 
u8
 *
pdadc_tmp
;

2639 
s16
 
pdadc_0
;

2640 
u8
 
pdadc_i
, 
pdadc_n
, 
pwr_°ï
, 
pdg
, 
max_idx
, 
èbÀ_size
;

2641 
u8
 
pd_gaö_ovîœp
;

2646 
pd_gaö_ovîœp
 = (
u8
Ë
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PHY_TPC_RG5
) &

2647 
AR5K_PHY_TPC_RG5_PD_GAIN_OVERLAP
;

2650 
pdg
 = 0, 
pdadc_i
 = 0;Ödg < 
pdcurves
;Ödg++) {

2651 
pdadc_tmp
 = 
ah
->
ah_txpowî
.
tmpL
[
pdg
];

2653 i‡(
pdg
 =
pdcurves
 - 1)

2656 
gaö_bound¨õs
[
pdg
] = 
pwr_max
[pdg] + 4;

2660 
gaö_bound¨õs
[
pdg
] =

2661 (
pwr_max
[
pdg
] + 
pwr_mö
[pdg + 1]) / 2;

2665 i‡(
gaö_bound¨õs
[
pdg
] > 
AR5K_TUNE_MAX_TXPOWER
)

2666 
gaö_bound¨õs
[
pdg
] = 
AR5K_TUNE_MAX_TXPOWER
;

2670 i‡(
pdg
 == 0)

2671 
pdadc_0
 = 0;

2674 
pdadc_0
 = (
gaö_bound¨õs
[
pdg
 - 1] - 
pwr_mö
[pdg]) -

2675 
pd_gaö_ovîœp
;

2678 i‡((
pdadc_tmp
[1] -Ödadc_tmp[0]) > 1)

2679 
pwr_°ï
 = 
pdadc_tmp
[1] -Ödadc_tmp[0];

2681 
pwr_°ï
 = 1;

2685 (
pdadc_0
 < 0Ë&& (
pdadc_i
 < 128)) {

2686 
s16
 
tmp
 = 
pdadc_tmp
[0] + 
pdadc_0
 * 
pwr_°ï
;

2687 
pdadc_out
[
pdadc_i
++] = (
tmp
 < 0Ë? 0 : (
u8
)Åmp;

2688 
pdadc_0
++;

2692 
pdadc_n
 = 
gaö_bound¨õs
[
pdg
] + 
pd_gaö_ovîœp
 - 
pwr_mö
[pdg];

2694 
èbÀ_size
 = 
pwr_max
[
pdg
] - 
pwr_mö
[pdg];

2695 
max_idx
 = (
pdadc_n
 < 
èbÀ_size
) ?Ödadc_n :Åable_size;

2698 
pdadc_0
 < 
max_idx
 && 
pdadc_i
 < 128)

2699 
pdadc_out
[
pdadc_i
++] = 
pdadc_tmp
[
pdadc_0
++];

2702 i‡(
pdadc_n
 <
max_idx
)

2706 i‡((
pdadc_tmp
[
èbÀ_size
 - 1] -Ödadc_tmp[table_size - 2]) > 1)

2707 
pwr_°ï
 = 
pdadc_tmp
[
èbÀ_size
 - 1] -

2708 
pdadc_tmp
[
èbÀ_size
 - 2];

2710 
pwr_°ï
 = 1;

2713 (
pdadc_0
 < (
s16
Ë
pdadc_n
) &&

2714 (
pdadc_i
 < 
AR5K_EEPROM_POWER_TABLE_SIZE
 * 2)) {

2715 
s16
 
tmp
 = 
pdadc_tmp
[
èbÀ_size
 - 1] +

2716 (
pdadc_0
 - 
max_idx
Ë* 
pwr_°ï
;

2717 
pdadc_out
[
pdadc_i
++] = (
tmp
 > 127Ë? 127 : (
u8
)Åmp;

2718 
pdadc_0
++;

2722 
pdg
 < 
AR5K_EEPROM_N_PD_GAINS
) {

2723 
gaö_bound¨õs
[
pdg
] = gain_boundaries[pdg - 1];

2724 
pdg
++;

2727 
pdadc_i
 < 
AR5K_EEPROM_POWER_TABLE_SIZE
 * 2) {

2728 
pdadc_out
[
pdadc_i
] =Ödadc_out[pdadc_i - 1];

2729 
pdadc_i
++;

2733 
	`©h5k_hw_ªg_wrôe
(
ah
,

2734 
	`AR5K_REG_SM
(
pd_gaö_ovîœp
,

2735 
AR5K_PHY_TPC_RG5_PD_GAIN_OVERLAP
) |

2736 
	`AR5K_REG_SM
(
gaö_bound¨õs
[0],

2737 
AR5K_PHY_TPC_RG5_PD_GAIN_BOUNDARY_1
) |

2738 
	`AR5K_REG_SM
(
gaö_bound¨õs
[1],

2739 
AR5K_PHY_TPC_RG5_PD_GAIN_BOUNDARY_2
) |

2740 
	`AR5K_REG_SM
(
gaö_bound¨õs
[2],

2741 
AR5K_PHY_TPC_RG5_PD_GAIN_BOUNDARY_3
) |

2742 
	`AR5K_REG_SM
(
gaö_bound¨õs
[3],

2743 
AR5K_PHY_TPC_RG5_PD_GAIN_BOUNDARY_4
),

2744 
AR5K_PHY_TPC_RG5
);

2747 
ah
->
ah_txpowî
.
txp_mö_idx
 = 
pwr_mö
[0];

2749 
	}
}

2753 
	$©h5k_wrôe_pwr_to_pdadc_èbÀ
(
©h5k_hw
 *
ah
, 
u8
 
ì_mode
)

2755 
©h5k_ì¥om_öfo
 *
ì
 = &
ah
->
ah_ˇ∑bûôõs
.
ˇp_ì¥om
;

2756 
u8
 *
pdadc_out
 = 
ah
->
ah_txpowî
.
txp_pd_èbÀ
;

2757 
u8
 *
pdg_to_idx
 = 
ì
->
ì_pdc_to_idx
[
ì_mode
];

2758 
u8
 
pdcurves
 = 
ì
->
ì_pd_gaös
[
ì_mode
];

2759 
u32
 
ªg
;

2760 
u8
 
i
;

2765 
ªg
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PHY_TPC_RG1
);

2766 
ªg
 &~(
AR5K_PHY_TPC_RG1_PDGAIN_1
 |

2767 
AR5K_PHY_TPC_RG1_PDGAIN_2
 |

2768 
AR5K_PHY_TPC_RG1_PDGAIN_3
 |

2769 
AR5K_PHY_TPC_RG1_NUM_PD_GAIN
);

2779 
ªg
 |
	`AR5K_REG_SM
(
pdcurves
, 
AR5K_PHY_TPC_RG1_NUM_PD_GAIN
);

2781 
pdcurves
) {

2783 
ªg
 |
	`AR5K_REG_SM
(
pdg_to_idx
[2], 
AR5K_PHY_TPC_RG1_PDGAIN_3
);

2786 
ªg
 |
	`AR5K_REG_SM
(
pdg_to_idx
[1], 
AR5K_PHY_TPC_RG1_PDGAIN_2
);

2789 
ªg
 |
	`AR5K_REG_SM
(
pdg_to_idx
[0], 
AR5K_PHY_TPC_RG1_PDGAIN_1
);

2792 
	`©h5k_hw_ªg_wrôe
(
ah
, 
ªg
, 
AR5K_PHY_TPC_RG1
);

2797 
i
 = 0; i < (
AR5K_EEPROM_POWER_TABLE_SIZE
 / 2); i++) {

2798 
u32
 
vÆ
 = 
	`gë_u«lig√d_À32
(&
pdadc_out
[4 * 
i
]);

2799 
	`©h5k_hw_ªg_wrôe
(
ah
, 
vÆ
, 
	`AR5K_PHY_PDADC_TXPOWER
(
i
));

2801 
	}
}

2816 
	$©h5k_£tup_ch™√l_powîèbÀ
(
©h5k_hw
 *
ah
,

2817 
õì80211_ch™√l
 *
ch™√l
,

2818 
u8
 
ì_mode
, u8 
ty≥
)

2820 
©h5k_pdgaö_öfo
 *
pdg_L
, *
pdg_R
;

2821 
©h5k_ch™_pˇl_öfo
 *
pcöfo_L
;

2822 
©h5k_ch™_pˇl_öfo
 *
pcöfo_R
;

2823 
©h5k_ì¥om_öfo
 *
ì
 = &
ah
->
ah_ˇ∑bûôõs
.
ˇp_ì¥om
;

2824 
u8
 *
pdg_curve_to_idx
 = 
ì
->
ì_pdc_to_idx
[
ì_mode
];

2825 
s16
 
èbÀ_mö
[
AR5K_EEPROM_N_PD_GAINS
];

2826 
s16
 
èbÀ_max
[
AR5K_EEPROM_N_PD_GAINS
];

2827 
u8
 *
tmpL
;

2828 
u8
 *
tmpR
;

2829 
u32
 
èrgë
 = 
ch™√l
->
˚¡î_‰eq
;

2830 
pdg
, 
i
;

2833 
	`©h5k_gë_ch™_pˇl_suºoundög_põrs
(
ah
, 
ch™√l
,

2834 &
pcöfo_L
,

2835 &
pcöfo_R
);

2839 
pdg
 = 0;Ödg < 
ì
->
ì_pd_gaös
[
ì_mode
];Ödg++) {

2845 
u8
 
idx
 = 
pdg_curve_to_idx
[
pdg
];

2848 
pdg_L
 = &
pcöfo_L
->
pd_curves
[
idx
];

2849 
pdg_R
 = &
pcöfo_R
->
pd_curves
[
idx
];

2852 
tmpL
 = 
ah
->
ah_txpowî
.tmpL[
pdg
];

2853 
tmpR
 = 
ah
->
ah_txpowî
.tmpR[
pdg
];

2861 
èbÀ_mö
[
pdg
] = 
	`mö
(
pdg_L
->
pd_pwr
[0],

2862 
pdg_R
->
pd_pwr
[0]) / 2;

2864 
èbÀ_max
[
pdg
] = 
	`max
(
pdg_L
->
pd_pwr
[pdg_L->
pd_poöts
 - 1],

2865 
pdg_R
->
pd_pwr
[pdg_R->
pd_poöts
 - 1]) / 2;

2870 
ty≥
) {

2871 
AR5K_PWRTABLE_LINEAR_PCDAC
:

2874 
èbÀ_mö
[
pdg
] = 
	`mö
(
pdg_L
->
pd_pwr
[0],

2875 
pdg_R
->
pd_pwr
[0]);

2877 
èbÀ_max
[
pdg
] =

2878 
	`max
(
pdg_L
->
pd_pwr
[pdg_L->
pd_poöts
 - 1],

2879 
pdg_R
->
pd_pwr
[pdg_R->
pd_poöts
 - 1]);

2886 i‡(!(
ì
->
ì_pd_gaös
[
ì_mode
] > 1 && 
pdg
 == 0)) {

2888 
èbÀ_mö
[
pdg
] =

2889 
	`©h5k_gë_löór_pcdac_mö
(
pdg_L
->
pd_°ï
,

2890 
pdg_R
->
pd_°ï
,

2891 
pdg_L
->
pd_pwr
,

2892 
pdg_R
->
pd_pwr
);

2898 i‡(
èbÀ_max
[
pdg
] - 
èbÀ_mö
[pdg] > 126)

2899 
èbÀ_mö
[
pdg
] = 
èbÀ_max
[pdg] - 126;

2903 
AR5K_PWRTABLE_PWR_TO_PCDAC
:

2904 
AR5K_PWRTABLE_PWR_TO_PDADC
:

2906 
	`©h5k_¸óã_powî_curve
(
èbÀ_mö
[
pdg
],

2907 
èbÀ_max
[
pdg
],

2908 
pdg_L
->
pd_pwr
,

2909 
pdg_L
->
pd_°ï
,

2910 
pdg_L
->
pd_poöts
, 
tmpL
, 
ty≥
);

2915 i‡(
pcöfo_L
 =
pcöfo_R
)

2918 
	`©h5k_¸óã_powî_curve
(
èbÀ_mö
[
pdg
],

2919 
èbÀ_max
[
pdg
],

2920 
pdg_R
->
pd_pwr
,

2921 
pdg_R
->
pd_°ï
,

2922 
pdg_R
->
pd_poöts
, 
tmpR
, 
ty≥
);

2925  -
EINVAL
;

2933 
i
 = 0; (ò< (
u16
Ë(
èbÀ_max
[
pdg
] - 
èbÀ_mö
[pdg])) &&

2934 (
i
 < 
AR5K_EEPROM_POWER_TABLE_SIZE
); i++) {

2935 
tmpL
[
i
] = (
u8
Ë
	`©h5k_gë_öãΩﬁ©ed_vÆue
(
èrgë
,

2936 (
s16
Ë
pcöfo_L
->
‰eq
,

2937 (
s16
Ë
pcöfo_R
->
‰eq
,

2938 (
s16
Ë
tmpL
[
i
],

2939 (
s16
Ë
tmpR
[
i
]);

2954 
ah
->
ah_txpowî
.
txp_mö_pwr
 = 
	`©h5k_gë_öãΩﬁ©ed_vÆue
(
èrgë
,

2955 (
s16
Ë
pcöfo_L
->
‰eq
,

2956 (
s16
Ë
pcöfo_R
->
‰eq
,

2957 
pcöfo_L
->
mö_pwr
, 
pcöfo_R
->min_pwr);

2959 
ah
->
ah_txpowî
.
txp_max_pwr
 = 
	`©h5k_gë_öãΩﬁ©ed_vÆue
(
èrgë
,

2960 (
s16
Ë
pcöfo_L
->
‰eq
,

2961 (
s16
Ë
pcöfo_R
->
‰eq
,

2962 
pcöfo_L
->
max_pwr
, 
pcöfo_R
->max_pwr);

2965 
ty≥
) {

2966 
AR5K_PWRTABLE_LINEAR_PCDAC
:

2970 
	`©h5k_comböe_löór_pcdac_curves
(
ah
, 
èbÀ_mö
, 
èbÀ_max
,

2971 
ì
->
ì_pd_gaös
[
ì_mode
]);

2976 
ah
->
ah_txpowî
.
txp_off£t
 = 64 - (
èbÀ_max
[0] / 2);

2978 
AR5K_PWRTABLE_PWR_TO_PCDAC
:

2981 
	`©h5k_fûl_pwr_to_pcdac_èbÀ
(
ah
, 
èbÀ_mö
, 
èbÀ_max
);

2984 
ah
->
ah_txpowî
.
txp_mö_idx
 = 0;

2985 
ah
->
ah_txpowî
.
txp_off£t
 = 0;

2987 
AR5K_PWRTABLE_PWR_TO_PDADC
:

2990 
	`©h5k_comböe_pwr_to_pdadc_curves
(
ah
, 
èbÀ_mö
, 
èbÀ_max
,

2991 
ì
->
ì_pd_gaös
[
ì_mode
]);

2995 
ah
->
ah_txpowî
.
txp_off£t
 = 
èbÀ_mö
[0];

2998  -
EINVAL
;

3001 
ah
->
ah_txpowî
.
txp_£tup
 = 
åue
;

3004 
	}
}

3008 
	$©h5k_wrôe_ch™√l_powîèbÀ
(
©h5k_hw
 *
ah
, 
u8
 
ì_mode
, u8 
ty≥
)

3010 i‡(
ty≥
 =
AR5K_PWRTABLE_PWR_TO_PDADC
)

3011 
	`©h5k_wrôe_pwr_to_pdadc_èbÀ
(
ah
, 
ì_mode
);

3013 
	`©h5k_wrôe_pcdac_èbÀ
(
ah
);

3014 
	}
}

3039 
	$©h5k_£tup_øã_powîèbÀ
(
©h5k_hw
 *
ah
, 
u16
 
max_pwr
,

3040 
©h5k_øã_pˇl_öfo
 *
øã_öfo
,

3041 
u8
 
ì_mode
)

3043 
i
;

3044 
u16
 *
øãs
;

3048 
max_pwr
 *= 2;

3049 
max_pwr
 = 
	`mö
(max_pwr, (
u16
Ë
ah
->
ah_txpowî
.
txp_max_pwr
) / 2;

3052 
øãs
 = 
ah
->
ah_txpowî
.
txp_øãs_powî_èbÀ
;

3055 
i
 = 0; i < 5; i++)

3056 
øãs
[
i
] = 
	`mö
(
max_pwr
, 
øã_öfo
->
èrgë_powî_6to24
);

3059 
øãs
[5] = 
	`mö
‘©es[0], 
øã_öfo
->
èrgë_powî_36
);

3060 
øãs
[6] = 
	`mö
‘©es[0], 
øã_öfo
->
èrgë_powî_48
);

3061 
øãs
[7] = 
	`mö
‘©es[0], 
øã_öfo
->
èrgë_powî_54
);

3065 
øãs
[8] = 
	`mö
‘©es[0], 
øã_öfo
->
èrgë_powî_6to24
);

3067 
øãs
[9] = 
	`mö
‘©es[0], 
øã_öfo
->
èrgë_powî_36
);

3069 
øãs
[10] = 
	`mö
‘©es[0], 
øã_öfo
->
èrgë_powî_36
);

3071 
øãs
[11] = 
	`mö
‘©es[0], 
øã_öfo
->
èrgë_powî_48
);

3073 
øãs
[12] = 
	`mö
‘©es[0], 
øã_öfo
->
èrgë_powî_48
);

3075 
øãs
[13] = 
	`mö
‘©es[0], 
øã_öfo
->
èrgë_powî_54
);

3077 
øãs
[14] = 
	`mö
‘©es[0], 
øã_öfo
->
èrgë_powî_54
);

3080 
øãs
[15] = 
	`mö
‘©es[0], 
øã_öfo
->
èrgë_powî_6to24
);

3086 i‡((
ì_mode
 =
AR5K_EEPROM_MODE_11G
) &&

3087 (
ah
->
ah_phy_ªvisi⁄
 < 
AR5K_SREV_PHY_5212A
))

3088 
i
 = 8; i <= 15; i++)

3089 
øãs
[
i
] -
ah
->
ah_txpowî
.
txp_cck_ofdm_gaöf_dñè
;

3094 
i
 = 0; i < 16; i++) {

3095 
øãs
[
i
] +
ah
->
ah_txpowî
.
txp_off£t
;

3097 i‡(
øãs
[
i
] > 63)

3098 
øãs
[
i
] = 63;

3102 
ah
->
ah_txpowî
.
txp_mö_pwr
 = 2 * 
øãs
[7];

3103 
ah
->
ah_txpowî
.
txp_cur_pwr
 = 2 * 
øãs
[0];

3104 
ah
->
ah_txpowî
.
txp_ofdm
 = 
øãs
[7];

3105 
	}
}

3112 
	$©h5k_hw_txpowî
(
©h5k_hw
 *
ah
, 
õì80211_ch™√l
 *
ch™√l
,

3113 
u8
 
txpowî
)

3115 
©h5k_øã_pˇl_öfo
 
øã_öfo
;

3116 
õì80211_ch™√l
 *
cuº_ch™√l
 = 
ah
->
ah_cuºít_ch™√l
;

3117 
ì_mode
;

3118 
u8
 
ty≥
;

3119 
ªt
;

3121 i‡(
txpowî
 > 
AR5K_TUNE_MAX_TXPOWER
) {

3122 
	`ATH5K_ERR
(
ah
, "övÆidÅxÖowî: %u\n", 
txpowî
);

3123  -
EINVAL
;

3126 
ì_mode
 = 
	`©h5k_ì¥om_mode_‰om_ch™√l
(
ch™√l
);

3127 
	`¥ötk
("VANET-debug:Ée_mode=%d,ándÅhÅxpowî(ö hÆ‡dB)=%d\n", 
ì_mode
, 
txpowî
);

3128 i‡(
ì_mode
 < 0) {

3129 
	`ATH5K_ERR
(
ah
,

3130 "övÆid ch™√l: %d\n", 
ch™√l
->
˚¡î_‰eq
);

3131  -
EINVAL
;

3135 
ah
->
ah_ødio
) {

3136 
AR5K_RF5110
:

3139 
AR5K_RF5111
:

3140 
ty≥
 = 
AR5K_PWRTABLE_PWR_TO_PCDAC
;

3142 
AR5K_RF5112
:

3143 
ty≥
 = 
AR5K_PWRTABLE_LINEAR_PCDAC
;

3145 
AR5K_RF2413
:

3146 
AR5K_RF5413
:

3147 
AR5K_RF2316
:

3148 
AR5K_RF2317
:

3149 
AR5K_RF2425
:

3150 
ty≥
 = 
AR5K_PWRTABLE_PWR_TO_PDADC
;

3153  -
EINVAL
;

3160 i‡(!
ah
->
ah_txpowî
.
txp_£tup
 ||

3161 (
ch™√l
->
hw_vÆue
 !
cuº_ch™√l
->hw_value) ||

3162 (
ch™√l
->
˚¡î_‰eq
 !
cuº_ch™√l
->center_freq)) {

3164 
	`mem£t
(&
ah
->
ah_txpowî
, 0, (ah->ah_txpower));

3165 
ah
->
ah_txpowî
.
txp_çc
 = 
AR5K_TUNE_TPC_TXPOWER
;

3168 
ªt
 = 
	`©h5k_£tup_ch™√l_powîèbÀ
(
ah
, 
ch™√l
,

3169 
ì_mode
, 
ty≥
);

3170 
	`¥ötk
("VANET-debug: i¿CÆcuœãÅhêpowîèbÀ,Ñë=%d\n", 
ªt
);

3171 i‡(
ªt
)

3172  
ªt
;

3176 
	`©h5k_wrôe_ch™√l_powîèbÀ
(
ah
, 
ì_mode
, 
ty≥
);

3179 
	`©h5k_gë_max_˘l_powî
(
ah
, 
ch™√l
);

3189 
	`©h5k_gë_øã_pˇl_d©a
(
ah
, 
ch™√l
, &
øã_öfo
);

3192 
	`©h5k_£tup_øã_powîèbÀ
(
ah
, 
txpowî
, &
øã_öfo
, 
ì_mode
);

3195 
	`©h5k_hw_ªg_wrôe
(
ah
, 
	`AR5K_TXPOWER_OFDM
(3, 24) |

3196 
	`AR5K_TXPOWER_OFDM
(2, 16) | AR5K_TXPOWER_OFDM(1, 8) |

3197 
	`AR5K_TXPOWER_OFDM
(0, 0), 
AR5K_PHY_TXPOWER_RATE1
);

3199 
	`©h5k_hw_ªg_wrôe
(
ah
, 
	`AR5K_TXPOWER_OFDM
(7, 24) |

3200 
	`AR5K_TXPOWER_OFDM
(6, 16) | AR5K_TXPOWER_OFDM(5, 8) |

3201 
	`AR5K_TXPOWER_OFDM
(4, 0), 
AR5K_PHY_TXPOWER_RATE2
);

3203 
	`©h5k_hw_ªg_wrôe
(
ah
, 
	`AR5K_TXPOWER_CCK
(10, 24) |

3204 
	`AR5K_TXPOWER_CCK
(9, 16) | AR5K_TXPOWER_CCK(15, 8) |

3205 
	`AR5K_TXPOWER_CCK
(8, 0), 
AR5K_PHY_TXPOWER_RATE3
);

3207 
	`©h5k_hw_ªg_wrôe
(
ah
, 
	`AR5K_TXPOWER_CCK
(14, 24) |

3208 
	`AR5K_TXPOWER_CCK
(13, 16) | AR5K_TXPOWER_CCK(12, 8) |

3209 
	`AR5K_TXPOWER_CCK
(11, 0), 
AR5K_PHY_TXPOWER_RATE4
);

3210 
	`¥ötk
("VANET-debug: inÑegister writing\n");

3213 i‡(
ah
->
ah_txpowî
.
txp_çc
) {

3214 
	`©h5k_hw_ªg_wrôe
(
ah
, 
AR5K_PHY_TXPOWER_RATE_MAX_TPC_ENABLE
 |

3215 
AR5K_TUNE_MAX_TXPOWER
, 
AR5K_PHY_TXPOWER_RATE_MAX
);

3217 
	`©h5k_hw_ªg_wrôe
(
ah
,

3218 
	`AR5K_REG_MS
(
AR5K_TUNE_MAX_TXPOWER
, 
AR5K_TPC_ACK
) |

3219 
	`AR5K_REG_MS
(
AR5K_TUNE_MAX_TXPOWER
, 
AR5K_TPC_CTS
) |

3220 
	`AR5K_REG_MS
(
AR5K_TUNE_MAX_TXPOWER
, 
AR5K_TPC_CHIRP
),

3221 
AR5K_TPC
);

3223 
	`©h5k_hw_ªg_wrôe
(
ah
, 
AR5K_PHY_TXPOWER_RATE_MAX
 |

3224 
AR5K_TUNE_MAX_TXPOWER
, 
AR5K_PHY_TXPOWER_RATE_MAX
);

3228 
	}
}

3230 
	$©h5k_hw_£t_txpowî_limô
(
©h5k_hw
 *
ah
, 
u8
 
txpowî
)

3232 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_TXPOWER
,

3233 "ch™gögÅxpowîÅÿ%d\n", 
txpowî
);

3235  
	`©h5k_hw_txpowî
(
ah
,áh->
ah_cuºít_ch™√l
, 
txpowî
);

3236 
	}
}

3242 
	$©h5k_hw_phy_öô
(
©h5k_hw
 *
ah
, 
õì80211_ch™√l
 *
ch™√l
,

3243 
u8
 
mode
, 
boﬁ
 
Á°
)

3245 
õì80211_ch™√l
 *
cuº_ch™√l
;

3246 
ªt
, 
i
;

3247 
u32
 
phy_t°1
;

3248 
ªt
 = 0;

3256 
cuº_ch™√l
 = 
ah
->
ah_cuºít_ch™√l
;

3257 i‡(
Á°
 && (
ch™√l
->
hw_vÆue
 !
cuº_ch™√l
->hw_value))

3258  -
EINVAL
;

3264 i‡(
Á°
) {

3265 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_PHY_RFBUS_REQ
,

3266 
AR5K_PHY_RFBUS_REQ_REQUEST
);

3267 
i
 = 0; i < 100; i++) {

3268 i‡(
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PHY_RFBUS_GRANT
))

3270 
	`udñay
(5);

3273 i‡(
i
 >= 100)

3274  -
EIO
;

3277 
ªt
 = 
	`©h5k_hw_ch™√l
(
ah
, 
ch™√l
);

3278 i‡(
ªt
)

3279  
ªt
;

3281 
	`©h5k_hw_waô_f‹_sy¡h
(
ah
, 
ch™√l
);

3291 
	`¥ötk
("VANET-debug: o∆yÖhy_öô,áh->ah_txpowî.txp_cur_pwr=%d\n", 
ah
->
ah_txpowî
.
txp_cur_pwr
);

3292 
ªt
 = 
	`©h5k_hw_txpowî
(
ah
, 
ch™√l
,áh->
ah_txpowî
.
txp_cur_pwr
 ?

3293 
ah
->
ah_txpowî
.
txp_cur_pwr
 / 2 : 
AR5K_TUNE_MAX_TXPOWER
);

3294 i‡(
ªt
)

3295  
ªt
;

3298 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5212
 &&

3299 
ch™√l
->
hw_vÆue
 & 
CHANNEL_OFDM
) {

3301 
ªt
 = 
	`©h5k_hw_wrôe_ofdm_timögs
(
ah
, 
ch™√l
);

3302 i‡(
ªt
)

3303  
ªt
;

3308 i‡(
ah
->
ah_mac_§ev
 >
AR5K_SREV_AR5424
)

3309 
	`©h5k_hw_£t_•ur_môig©i⁄_fûãr
(
ah
,

3310 
ch™√l
);

3321 i‡(
Á°
) {

3325 
	`AR5K_REG_DISABLE_BITS
(
ah
, 
AR5K_PHY_RFBUS_REQ
,

3326 
AR5K_PHY_RFBUS_REQ_REQUEST
);

3331 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_PHY_AGCCTL
,

3332 
AR5K_PHY_AGCCTL_NF
);

3334  
ªt
;

3343 i‡(
ah
->
ah_vîsi⁄
 !
AR5K_AR5210
) {

3349 
ªt
 = 
	`©h5k_hw_rfgaö_öô
(
ah
, 
ch™√l
->
b™d
);

3350 i‡(
ªt
)

3351  
ªt
;

3353 
	`mdñay
(1);

3358 
ªt
 = 
	`©h5k_hw_r‰egs_öô
(
ah
, 
ch™√l
, 
mode
);

3359 i‡(
ªt
)

3360  
ªt
;

3364 i‡(
ah
->
ah_ødio
 =
AR5K_RF5111
) {

3365 i‡(
mode
 =
AR5K_MODE_11B
)

3366 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_TXCFG
,

3367 
AR5K_TXCFG_B_MODE
);

3369 
	`AR5K_REG_DISABLE_BITS
(
ah
, 
AR5K_TXCFG
,

3370 
AR5K_TXCFG_B_MODE
);

3373 } i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
) {

3374 
	`mdñay
(1);

3376 
	`©h5k_hw_ªg_wrôe
(
ah
, 
AR5K_PHY_ACT_DISABLE
, 
AR5K_PHY_ACT
);

3377 
	`mdñay
(1);

3381 
ªt
 = 
	`©h5k_hw_ch™√l
(
ah
, 
ch™√l
);

3382 i‡(
ªt
)

3383  
ªt
;

3390 
	`©h5k_hw_ªg_wrôe
(
ah
, 
AR5K_PHY_ACT_ENABLE
, 
AR5K_PHY_ACT
);

3392 
	`©h5k_hw_waô_f‹_sy¡h
(
ah
, 
ch™√l
);

3398 
phy_t°1
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PHY_TST1
);

3399 
	`©h5k_hw_ªg_wrôe
(
ah
, 
AR5K_PHY_TST1_TXHOLD
, 
AR5K_PHY_TST1
);

3400 
i
 = 0; i <= 20; i++) {

3401 i‡(!(
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PHY_ADC_TEST
) & 0x10))

3403 
	`udñay
(200);

3405 
	`©h5k_hw_ªg_wrôe
(
ah
, 
phy_t°1
, 
AR5K_PHY_TST1
);

3426 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_PHY_AGCCTL
,

3427 
AR5K_PHY_AGCCTL_CAL
 | 
AR5K_PHY_AGCCTL_NF
);

3431 
ah
->
ah_ˇlibøti⁄
 = 
Ál£
;

3432 i‡(!(
mode
 =
AR5K_MODE_11B
)) {

3433 
ah
->
ah_ˇlibøti⁄
 = 
åue
;

3434 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_IQ
,

3435 
AR5K_PHY_IQ_CAL_NUM_LOG_MAX
, 15);

3436 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_PHY_IQ
,

3437 
AR5K_PHY_IQ_RUN
);

3442 i‡(
	`©h5k_hw_ªgi°î_timeout
(
ah
, 
AR5K_PHY_AGCCTL
,

3443 
AR5K_PHY_AGCCTL_CAL
, 0, 
Ál£
)) {

3444 
	`ATH5K_ERR
(
ah
, "gain calibrationÅimeout (%uMHz)\n",

3445 
ch™√l
->
˚¡î_‰eq
);

3449 
	`©h5k_hw_£t_™ã¬a_mode
(
ah
,áh->
ah_™t_mode
);

3451  
ªt
;

3452 
	}
}

	@ath5k/qcu.c

23 
	~"©h5k.h
"

24 
	~"ªg.h
"

25 
	~"debug.h
"

26 
	~"ba£.h
"

37 
u32
 
	$©h5k_hw_num_tx_≥ndög
(
©h5k_hw
 *
ah
, 
queue
)

39 
u32
 
≥ndög
;

40 
	`AR5K_ASSERT_ENTRY
(
queue
, 
ah
->
ah_ˇ∑bûôõs
.
ˇp_queues
.
q_tx_num
);

43 i‡(
ah
->
ah_txq
[
queue
].
tqi_ty≥
 =
AR5K_TX_QUEUE_INACTIVE
)

44  
Ál£
;

47 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
)

48  
Ál£
;

50 
≥ndög
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
	`AR5K_QUEUE_STATUS
(
queue
));

51 
≥ndög
 &
AR5K_QCU_STS_FRMPENDCNT
;

56 i‡(!
≥ndög
 && 
	`AR5K_REG_READ_Q
(
ah
, 
AR5K_QCU_TXE
, 
queue
))

57  
åue
;

59  
≥ndög
;

60 
	}
}

65 
	$©h5k_hw_ªÀa£_tx_queue
(
©h5k_hw
 *
ah
, 
queue
)

67 i‡(
	`WARN_ON
(
queue
 >
ah
->
ah_ˇ∑bûôõs
.
ˇp_queues
.
q_tx_num
))

71 
ah
->
ah_txq
[
queue
].
tqi_ty≥
 = 
AR5K_TX_QUEUE_INACTIVE
;

73 
	`AR5K_Q_DISABLE_BITS
(
ah
->
ah_txq_°©us
, 
queue
);

74 
	}
}

79 
u16
 
	$©h5k_cw_vÆid©e
(
u16
 
cw_ªq
)

81 
u32
 
cw
 = 1;

82 
cw_ªq
 = 
	`mö
(cw_ªq, (
u16
)1023);

84 
cw
 < 
cw_ªq
)

85 
cw
 = (cw << 1) | 1;

87  
cw
;

88 
	}
}

93 
	$©h5k_hw_gë_tx_queuïr›s
(
©h5k_hw
 *
ah
, 
queue
,

94 
©h5k_txq_öfo
 *
queue_öfo
)

96 
	`mem˝y
(
queue_öfo
, &
ah
->
ah_txq
[
queue
], (
©h5k_txq_öfo
));

98 
	}
}

103 
	$©h5k_hw_£t_tx_queuïr›s
(
©h5k_hw
 *
ah
, 
queue
,

104 c⁄° 
©h5k_txq_öfo
 *
qöfo
)

106 
©h5k_txq_öfo
 *
qi
;

108 
	`AR5K_ASSERT_ENTRY
(
queue
, 
ah
->
ah_ˇ∑bûôõs
.
ˇp_queues
.
q_tx_num
);

110 
qi
 = &
ah
->
ah_txq
[
queue
];

112 i‡(
qi
->
tqi_ty≥
 =
AR5K_TX_QUEUE_INACTIVE
)

113  -
EIO
;

116 
qi
->
tqi_ty≥
 = 
qöfo
->tqi_type;

117 
qi
->
tqi_subty≥
 = 
qöfo
->tqi_subtype;

118 
qi
->
tqi_Êags
 = 
qöfo
->tqi_flags;

124 
qi
->
tqi_aifs
 = 
	`mö
(
qöfo
->tqi_aifs, (
u8
)0xFC);

125 
qi
->
tqi_cw_mö
 = 
	`©h5k_cw_vÆid©e
(
qöfo
->tqi_cw_min);

126 
qi
->
tqi_cw_max
 = 
	`©h5k_cw_vÆid©e
(
qöfo
->tqi_cw_max);

127 
qi
->
tqi_cbr_≥riod
 = 
qöfo
->tqi_cbr_period;

128 
qi
->
tqi_cbr_ovîÊow_limô
 = 
qöfo
->tqi_cbr_overflow_limit;

129 
qi
->
tqi_bur°_time
 = 
qöfo
->tqi_burst_time;

130 
qi
->
tqi_ªady_time
 = 
qöfo
->tqi_ready_time;

134 i‡((
qöfo
->
tqi_ty≥
 =
AR5K_TX_QUEUE_DATA
 &&

135 ((
qöfo
->
tqi_subty≥
 =
AR5K_WME_AC_VI
) ||

136 (
qöfo
->
tqi_subty≥
 =
AR5K_WME_AC_VO
))) ||

137 
qöfo
->
tqi_ty≥
 =
AR5K_TX_QUEUE_UAPSD
)

138 
qi
->
tqi_Êags
 |
AR5K_TXQ_FLAG_POST_FR_BKOFF_DIS
;

141 
	}
}

146 
	$©h5k_hw_£tup_tx_queue
(
©h5k_hw
 *
ah
, 
©h5k_tx_queue
 
queue_ty≥
,

147 
©h5k_txq_öfo
 *
queue_öfo
)

149 
queue
;

150 
ªt
;

156 i‡(
ah
->
ah_ˇ∑bûôõs
.
ˇp_queues
.
q_tx_num
 == 2) {

157 
queue_ty≥
) {

158 
AR5K_TX_QUEUE_DATA
:

159 
queue
 = 
AR5K_TX_QUEUE_ID_NOQCU_DATA
;

161 
AR5K_TX_QUEUE_BEACON
:

162 
AR5K_TX_QUEUE_CAB
:

163 
queue
 = 
AR5K_TX_QUEUE_ID_NOQCU_BEACON
;

166  -
EINVAL
;

169 
queue_ty≥
) {

170 
AR5K_TX_QUEUE_DATA
:

171 
queue
 = 
AR5K_TX_QUEUE_ID_DATA_MIN
;

172 
ah
->
ah_txq
[
queue
].
tqi_ty≥
 !=

173 
AR5K_TX_QUEUE_INACTIVE
; 
queue
++) {

175 i‡(
queue
 > 
AR5K_TX_QUEUE_ID_DATA_MAX
)

176  -
EINVAL
;

179 
AR5K_TX_QUEUE_UAPSD
:

180 
queue
 = 
AR5K_TX_QUEUE_ID_UAPSD
;

182 
AR5K_TX_QUEUE_BEACON
:

183 
queue
 = 
AR5K_TX_QUEUE_ID_BEACON
;

185 
AR5K_TX_QUEUE_CAB
:

186 
queue
 = 
AR5K_TX_QUEUE_ID_CAB
;

188 
AR5K_TX_QUEUE_XR_DATA
:

189 i‡(
ah
->
ah_vîsi⁄
 !
AR5K_AR5212
)

190 
	`ATH5K_ERR
(
ah
,

193 
queue
 = 
AR5K_TX_QUEUE_ID_XR_DATA
;

196  -
EINVAL
;

203 
	`mem£t
(&
ah
->
ah_txq
[
queue
], 0, (
©h5k_txq_öfo
));

204 
ah
->
ah_txq
[
queue
].
tqi_ty≥
 = 
queue_ty≥
;

206 i‡(
queue_öfo
 !
NULL
) {

207 
queue_öfo
->
tqi_ty≥
 = 
queue_ty≥
;

208 
ªt
 = 
	`©h5k_hw_£t_tx_queuïr›s
(
ah
, 
queue
, 
queue_öfo
);

209 i‡(
ªt
)

210  
ªt
;

218 
	`AR5K_Q_ENABLE_BITS
(
ah
->
ah_txq_°©us
, 
queue
);

220  
queue
;

221 
	}
}

231 
	$©h5k_hw_£t_tx_ªåy_limôs
(
©h5k_hw
 *
ah
,

232 
queue
)

235 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
) {

236 
©h5k_txq_öfo
 *
tq
 = &
ah
->
ah_txq
[
queue
];

238 i‡(
queue
 > 0)

241 
	`©h5k_hw_ªg_wrôe
(
ah
,

242 (
tq
->
tqi_cw_mö
 << 
AR5K_NODCU_RETRY_LMT_CW_MIN_S
)

243 | 
	`AR5K_REG_SM
(
ah
->
ah_ªåy_l⁄g
,

244 
AR5K_NODCU_RETRY_LMT_SLG_RETRY
)

245 | 
	`AR5K_REG_SM
(
ah
->
ah_ªåy_sh‹t
,

246 
AR5K_NODCU_RETRY_LMT_SSH_RETRY
)

247 | 
	`AR5K_REG_SM
(
ah
->
ah_ªåy_l⁄g
,

248 
AR5K_NODCU_RETRY_LMT_LG_RETRY
)

249 | 
	`AR5K_REG_SM
(
ah
->
ah_ªåy_sh‹t
,

250 
AR5K_NODCU_RETRY_LMT_SH_RETRY
),

251 
AR5K_NODCU_RETRY_LMT
);

254 
	`©h5k_hw_ªg_wrôe
(
ah
,

255 
	`AR5K_REG_SM
(
ah
->
ah_ªåy_l⁄g
,

256 
AR5K_DCU_RETRY_LMT_RTS
)

257 | 
	`AR5K_REG_SM
(
ah
->
ah_ªåy_l⁄g
,

258 
AR5K_DCU_RETRY_LMT_STA_RTS
)

259 | 
	`AR5K_REG_SM
(
	`max
(
ah
->
ah_ªåy_l⁄g
,áh->
ah_ªåy_sh‹t
),

260 
AR5K_DCU_RETRY_LMT_STA_DATA
),

261 
	`AR5K_QUEUE_DFS_RETRY_LIMIT
(
queue
));

263 
	}
}

274 
	$©h5k_hw_ª£t_tx_queue
(
©h5k_hw
 *
ah
, 
queue
)

276 
©h5k_txq_öfo
 *
tq
 = &
ah
->
ah_txq
[
queue
];

278 
	`AR5K_ASSERT_ENTRY
(
queue
, 
ah
->
ah_ˇ∑bûôõs
.
ˇp_queues
.
q_tx_num
);

280 
tq
 = &
ah
->
ah_txq
[
queue
];

284 i‡((
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
) ||

285 (
tq
->
tqi_ty≥
 =
AR5K_TX_QUEUE_INACTIVE
))

292 
	`©h5k_hw_ªg_wrôe
(
ah
,

293 
	`AR5K_REG_SM
(
tq
->
tqi_cw_mö
, 
AR5K_DCU_LCL_IFS_CW_MIN
) |

294 
	`AR5K_REG_SM
(
tq
->
tqi_cw_max
, 
AR5K_DCU_LCL_IFS_CW_MAX
) |

295 
	`AR5K_REG_SM
(
tq
->
tqi_aifs
, 
AR5K_DCU_LCL_IFS_AIFS
),

296 
	`AR5K_QUEUE_DFS_LOCAL_IFS
(
queue
));

301 
	`©h5k_hw_£t_tx_ªåy_limôs
(
ah
, 
queue
);

309 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
	`AR5K_QUEUE_DFS_MISC
(
queue
),

310 
AR5K_DCU_MISC_FRAG_WAIT
);

313 i‡(
ah
->
ah_mac_vîsi⁄
 < 
AR5K_SREV_AR5211
)

314 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
	`AR5K_QUEUE_DFS_MISC
(
queue
),

315 
AR5K_DCU_MISC_SEQNUM_CTL
);

318 i‡(
tq
->
tqi_cbr_≥riod
) {

319 
	`©h5k_hw_ªg_wrôe
(
ah
, 
	`AR5K_REG_SM
(
tq
->
tqi_cbr_≥riod
,

320 
AR5K_QCU_CBRCFG_INTVAL
) |

321 
	`AR5K_REG_SM
(
tq
->
tqi_cbr_ovîÊow_limô
,

322 
AR5K_QCU_CBRCFG_ORN_THRES
),

323 
	`AR5K_QUEUE_CBRCFG
(
queue
));

325 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
	`AR5K_QUEUE_MISC
(
queue
),

326 
AR5K_QCU_MISC_FRSHED_CBR
);

328 i‡(
tq
->
tqi_cbr_ovîÊow_limô
)

329 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
	`AR5K_QUEUE_MISC
(
queue
),

330 
AR5K_QCU_MISC_CBR_THRES_ENABLE
);

334 i‡(
tq
->
tqi_ªady_time
 && (tq->
tqi_ty≥
 !
AR5K_TX_QUEUE_CAB
))

335 
	`©h5k_hw_ªg_wrôe
(
ah
, 
	`AR5K_REG_SM
(
tq
->
tqi_ªady_time
,

336 
AR5K_QCU_RDYTIMECFG_INTVAL
) |

337 
AR5K_QCU_RDYTIMECFG_ENABLE
,

338 
	`AR5K_QUEUE_RDYTIMECFG
(
queue
));

340 i‡(
tq
->
tqi_bur°_time
) {

341 
	`©h5k_hw_ªg_wrôe
(
ah
, 
	`AR5K_REG_SM
(
tq
->
tqi_bur°_time
,

342 
AR5K_DCU_CHAN_TIME_DUR
) |

343 
AR5K_DCU_CHAN_TIME_ENABLE
,

344 
	`AR5K_QUEUE_DFS_CHANNEL_TIME
(
queue
));

346 i‡(
tq
->
tqi_Êags
 & 
AR5K_TXQ_FLAG_RDYTIME_EXP_POLICY_ENABLE
)

347 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
	`AR5K_QUEUE_MISC
(
queue
),

348 
AR5K_QCU_MISC_RDY_VEOL_POLICY
);

352 i‡(
tq
->
tqi_Êags
 & 
AR5K_TXQ_FLAG_BACKOFF_DISABLE
)

353 
	`©h5k_hw_ªg_wrôe
(
ah
, 
AR5K_DCU_MISC_POST_FR_BKOFF_DIS
,

354 
	`AR5K_QUEUE_DFS_MISC
(
queue
));

357 i‡(
tq
->
tqi_Êags
 & 
AR5K_TXQ_FLAG_FRAG_BURST_BACKOFF_ENABLE
)

358 
	`©h5k_hw_ªg_wrôe
(
ah
, 
AR5K_DCU_MISC_BACKOFF_FRAG
,

359 
	`AR5K_QUEUE_DFS_MISC
(
queue
));

364 
tq
->
tqi_ty≥
) {

365 
AR5K_TX_QUEUE_BEACON
:

366 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
	`AR5K_QUEUE_MISC
(
queue
),

367 
AR5K_QCU_MISC_FRSHED_DBA_GT
 |

368 
AR5K_QCU_MISC_CBREXP_BCN_DIS
 |

369 
AR5K_QCU_MISC_BCN_ENABLE
);

371 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
	`AR5K_QUEUE_DFS_MISC
(
queue
),

372 (
AR5K_DCU_MISC_ARBLOCK_CTL_GLOBAL
 <<

373 
AR5K_DCU_MISC_ARBLOCK_CTL_S
) |

374 
AR5K_DCU_MISC_ARBLOCK_IGNORE
 |

375 
AR5K_DCU_MISC_POST_FR_BKOFF_DIS
 |

376 
AR5K_DCU_MISC_BCN_ENABLE
);

379 
AR5K_TX_QUEUE_CAB
:

381 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
	`AR5K_QUEUE_MISC
(
queue
),

382 
AR5K_QCU_MISC_FRSHED_DBA_GT
 |

383 
AR5K_QCU_MISC_CBREXP_DIS
 |

384 
AR5K_QCU_MISC_CBREXP_BCN_DIS
);

386 
	`©h5k_hw_ªg_wrôe
(
ah
, ((
tq
->
tqi_ªady_time
 -

387 (
AR5K_TUNE_SW_BEACON_RESP
 -

388 
AR5K_TUNE_DMA_BEACON_RESP
) -

389 
AR5K_TUNE_ADDITIONAL_SWBA_BACKOFF
) * 1024) |

390 
AR5K_QCU_RDYTIMECFG_ENABLE
,

391 
	`AR5K_QUEUE_RDYTIMECFG
(
queue
));

393 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
	`AR5K_QUEUE_DFS_MISC
(
queue
),

394 (
AR5K_DCU_MISC_ARBLOCK_CTL_GLOBAL
 <<

395 
AR5K_DCU_MISC_ARBLOCK_CTL_S
));

398 
AR5K_TX_QUEUE_UAPSD
:

399 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
	`AR5K_QUEUE_MISC
(
queue
),

400 
AR5K_QCU_MISC_CBREXP_DIS
);

403 
AR5K_TX_QUEUE_DATA
:

414 i‡(
tq
->
tqi_Êags
 & 
AR5K_TXQ_FLAG_TXOKINT_ENABLE
)

415 
	`AR5K_Q_ENABLE_BITS
(
ah
->
ah_txq_imr_txok
, 
queue
);

417 i‡(
tq
->
tqi_Êags
 & 
AR5K_TXQ_FLAG_TXERRINT_ENABLE
)

418 
	`AR5K_Q_ENABLE_BITS
(
ah
->
ah_txq_imr_txîr
, 
queue
);

420 i‡(
tq
->
tqi_Êags
 & 
AR5K_TXQ_FLAG_TXURNINT_ENABLE
)

421 
	`AR5K_Q_ENABLE_BITS
(
ah
->
ah_txq_imr_txu∫
, 
queue
);

423 i‡(
tq
->
tqi_Êags
 & 
AR5K_TXQ_FLAG_TXDESCINT_ENABLE
)

424 
	`AR5K_Q_ENABLE_BITS
(
ah
->
ah_txq_imr_txdesc
, 
queue
);

426 i‡(
tq
->
tqi_Êags
 & 
AR5K_TXQ_FLAG_TXEOLINT_ENABLE
)

427 
	`AR5K_Q_ENABLE_BITS
(
ah
->
ah_txq_imr_txeﬁ
, 
queue
);

429 i‡(
tq
->
tqi_Êags
 & 
AR5K_TXQ_FLAG_CBRORNINT_ENABLE
)

430 
	`AR5K_Q_ENABLE_BITS
(
ah
->
ah_txq_imr_cbr‹n
, 
queue
);

432 i‡(
tq
->
tqi_Êags
 & 
AR5K_TXQ_FLAG_CBRURNINT_ENABLE
)

433 
	`AR5K_Q_ENABLE_BITS
(
ah
->
ah_txq_imr_cbru∫
, 
queue
);

435 i‡(
tq
->
tqi_Êags
 & 
AR5K_TXQ_FLAG_QTRIGINT_ENABLE
)

436 
	`AR5K_Q_ENABLE_BITS
(
ah
->
ah_txq_imr_qåig
, 
queue
);

438 i‡(
tq
->
tqi_Êags
 & 
AR5K_TXQ_FLAG_TXNOFRMINT_ENABLE
)

439 
	`AR5K_Q_ENABLE_BITS
(
ah
->
ah_txq_imr_no‰m
, 
queue
);

444 
ah
->
ah_txq_imr_txok
 &ah->
ah_txq_°©us
;

445 
ah
->
ah_txq_imr_txîr
 &ah->
ah_txq_°©us
;

446 
ah
->
ah_txq_imr_txu∫
 &ah->
ah_txq_°©us
;

447 
ah
->
ah_txq_imr_txdesc
 &ah->
ah_txq_°©us
;

448 
ah
->
ah_txq_imr_txeﬁ
 &ah->
ah_txq_°©us
;

449 
ah
->
ah_txq_imr_cbr‹n
 &ah->
ah_txq_°©us
;

450 
ah
->
ah_txq_imr_cbru∫
 &ah->
ah_txq_°©us
;

451 
ah
->
ah_txq_imr_qåig
 &ah->
ah_txq_°©us
;

452 
ah
->
ah_txq_imr_no‰m
 &ah->
ah_txq_°©us
;

454 
	`©h5k_hw_ªg_wrôe
(
ah
, 
	`AR5K_REG_SM
◊h->
ah_txq_imr_txok
,

455 
AR5K_SIMR0_QCU_TXOK
) |

456 
	`AR5K_REG_SM
(
ah
->
ah_txq_imr_txdesc
,

457 
AR5K_SIMR0_QCU_TXDESC
),

458 
AR5K_SIMR0
);

460 
	`©h5k_hw_ªg_wrôe
(
ah
, 
	`AR5K_REG_SM
◊h->
ah_txq_imr_txîr
,

461 
AR5K_SIMR1_QCU_TXERR
) |

462 
	`AR5K_REG_SM
(
ah
->
ah_txq_imr_txeﬁ
,

463 
AR5K_SIMR1_QCU_TXEOL
),

464 
AR5K_SIMR1
);

467 
	`AR5K_REG_DISABLE_BITS
(
ah
, 
AR5K_SIMR2
, 
AR5K_SIMR2_QCU_TXURN
);

468 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_SIMR2
,

469 
	`AR5K_REG_SM
(
ah
->
ah_txq_imr_txu∫
,

470 
AR5K_SIMR2_QCU_TXURN
));

472 
	`©h5k_hw_ªg_wrôe
(
ah
, 
	`AR5K_REG_SM
◊h->
ah_txq_imr_cbr‹n
,

473 
AR5K_SIMR3_QCBRORN
) |

474 
	`AR5K_REG_SM
(
ah
->
ah_txq_imr_cbru∫
,

475 
AR5K_SIMR3_QCBRURN
),

476 
AR5K_SIMR3
);

478 
	`©h5k_hw_ªg_wrôe
(
ah
, 
	`AR5K_REG_SM
◊h->
ah_txq_imr_qåig
,

479 
AR5K_SIMR4_QTRIG
), 
AR5K_SIMR4
);

482 
	`©h5k_hw_ªg_wrôe
(
ah
, 
	`AR5K_REG_SM
◊h->
ah_txq_imr_no‰m
,

483 
AR5K_TXNOFRM_QCU
), 
AR5K_TXNOFRM
);

487 i‡(
ah
->
ah_txq_imr_no‰m
 == 0)

488 
	`©h5k_hw_ªg_wrôe
(
ah
, 0, 
AR5K_TXNOFRM
);

491 
	`AR5K_REG_WRITE_Q
(
ah
, 
	`AR5K_QUEUE_QCUMASK
(
queue
), queue);

494 
	}
}

510 
	$©h5k_hw_£t_ifs_öãrvÆs
(
©h5k_hw
 *
ah
, 
¶Ÿ_time
)

512 
õì80211_ch™√l
 *
ch™√l
 = 
ah
->
ah_cuºít_ch™√l
;

513 
õì80211_øã
 *
øã
;

514 
u32
 
ack_tx_time
, 
eifs
, 
eifs_˛ock
, 
sifs
, 
sifs_˛ock
;

515 
u32
 
¶Ÿ_time_˛ock
 = 
	`©h5k_hw_hto˛ock
(
ah
, 
¶Ÿ_time
);

517 i‡(
¶Ÿ_time
 < 6 || 
¶Ÿ_time_˛ock
 > 
AR5K_SLOT_TIME_MAX
)

518  -
EINVAL
;

520 
sifs
 = 
	`©h5k_hw_gë_deÁu…_sifs
(
ah
);

521 
sifs_˛ock
 = 
	`©h5k_hw_hto˛ock
(
ah
, 
sifs
 - 2);

547 i‡(
ch™√l
->
hw_vÆue
 & 
CHANNEL_5GHZ
)

548 
øã
 = &
ah
->
sb™ds
[
IEEE80211_BAND_5GHZ
].
bôøãs
[0];

550 
øã
 = &
ah
->
sb™ds
[
IEEE80211_BAND_2GHZ
].
bôøãs
[0];

552 
ack_tx_time
 = 
	`©h5k_hw_gë_‰ame_duøti⁄
(
ah
, 10, 
øã
, 
Ál£
);

555 
eifs
 = 
ack_tx_time
 + 
sifs
 + 2 * 
¶Ÿ_time
;

556 
eifs_˛ock
 = 
	`©h5k_hw_hto˛ock
(
ah
, 
eifs
);

559 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
) {

560 
u32
 
pifs
, 
pifs_˛ock
, 
difs
, 
difs_˛ock
;

563 
	`©h5k_hw_ªg_wrôe
(
ah
, 
¶Ÿ_time_˛ock
, 
AR5K_SLOT_TIME
);

566 
eifs_˛ock
 = 
	`AR5K_REG_SM
”ifs_˛ock, 
AR5K_IFS1_EIFS
);

569 
pifs
 = 
¶Ÿ_time
 + 
sifs
;

570 
pifs_˛ock
 = 
	`©h5k_hw_hto˛ock
(
ah
, 
pifs
);

571 
pifs_˛ock
 = 
	`AR5K_REG_SM
’ifs_˛ock, 
AR5K_IFS1_PIFS
);

574 
difs
 = 
sifs
 + 2 * 
¶Ÿ_time
;

575 
difs_˛ock
 = 
	`©h5k_hw_hto˛ock
(
ah
, 
difs
);

578 
	`©h5k_hw_ªg_wrôe
(
ah
, (
difs_˛ock
 <<

579 
AR5K_IFS0_DIFS_S
Ë| 
sifs_˛ock
,

580 
AR5K_IFS0
);

583 
	`©h5k_hw_ªg_wrôe
(
ah
, 
pifs_˛ock
 | 
eifs_˛ock
 |

584 (
AR5K_INIT_CARR_SENSE_EN
 << 
AR5K_IFS1_CS_EN_S
),

585 
AR5K_IFS1
);

591 
	`©h5k_hw_ªg_wrôe
(
ah
, 
¶Ÿ_time_˛ock
, 
AR5K_DCU_GBL_IFS_SLOT
);

594 
	`©h5k_hw_ªg_wrôe
(
ah
, 
eifs_˛ock
, 
AR5K_DCU_GBL_IFS_EIFS
);

597 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_DCU_GBL_IFS_MISC
,

598 
AR5K_DCU_GBL_IFS_MISC_SIFS_DUR_USEC
,

599 
sifs
);

602 
	`©h5k_hw_ªg_wrôe
(
ah
, 
sifs_˛ock
, 
AR5K_DCU_GBL_IFS_SIFS
);

605 
	}
}

608 
	$©h5k_hw_öô_queues
(
©h5k_hw
 *
ah
)

610 
i
, 
ªt
;

620 i‡(
ah
->
ah_vîsi⁄
 !
AR5K_AR5210
)

621 
i
 = 0; i < 
ah
->
ah_ˇ∑bûôõs
.
ˇp_queues
.
q_tx_num
; i++) {

622 
ªt
 = 
	`©h5k_hw_ª£t_tx_queue
(
ah
, 
i
);

623 i‡(
ªt
) {

624 
	`ATH5K_ERR
(
ah
,

625 "ÁûedÅÿª£àTX queuê#%d\n", 
i
);

626  
ªt
;

633 
	`©h5k_hw_£t_tx_ªåy_limôs
(
ah
, 0);

636 i‡(
ah
->
ah_bwmode
 =
AR5K_BWMODE_40MHZ
)

637 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_DCU_GBL_IFS_MISC
,

638 
AR5K_DCU_GBL_IFS_MISC_TURBO_MODE
);

643 i‡(!
ah
->
ah_covîage_˛ass
) {

644 
¶Ÿ_time
 = 
	`©h5k_hw_gë_deÁu…_¶Ÿtime
(
ah
);

645 
	`©h5k_hw_£t_ifs_öãrvÆs
(
ah
, 
¶Ÿ_time
);

649 
	}
}

	@ath5k/reg.h

37 
	~"../ªg.h
"

46 
	#AR5K_NOQCU_TXDP0
 0x0000

	)

47 
	#AR5K_NOQCU_TXDP1
 0x0004

	)

52 
	#AR5K_CR
 0x0008

	)

53 
	#AR5K_CR_TXE0
 0x00000001

	)

54 
	#AR5K_CR_TXE1
 0x00000002

	)

55 
	#AR5K_CR_RXE
 0x00000004

	)

56 
	#AR5K_CR_TXD0
 0x00000008

	)

57 
	#AR5K_CR_TXD1
 0x00000010

	)

58 
	#AR5K_CR_RXD
 0x00000020

	)

59 
	#AR5K_CR_SWI
 0x00000040

	)

64 
	#AR5K_RXDP
 0x000c

	)

69 
	#AR5K_CFG
 0x0014

	)

70 
	#AR5K_CFG_SWTD
 0x00000001

	)

71 
	#AR5K_CFG_SWTB
 0x00000002

	)

72 
	#AR5K_CFG_SWRD
 0x00000004

	)

73 
	#AR5K_CFG_SWRB
 0x00000008

	)

74 
	#AR5K_CFG_SWRG
 0x00000010

	)

75 
	#AR5K_CFG_IBSS
 0x00000020

	)

76 
	#AR5K_CFG_PHY_OK
 0x00000100

	)

77 
	#AR5K_CFG_EEBS
 0x00000200

	)

78 
	#AR5K_CFG_CLKGD
 0x00000400

	)

79 
	#AR5K_CFG_TXCNT
 0x00007800

	)

80 
	#AR5K_CFG_TXCNT_S
 11

	)

81 
	#AR5K_CFG_TXFSTAT
 0x00008000

	)

82 
	#AR5K_CFG_TXFSTRT
 0x00010000

	)

83 
	#AR5K_CFG_PCI_THRES
 0x00060000

	)

84 
	#AR5K_CFG_PCI_THRES_S
 17

	)

89 
	#AR5K_IER
 0x0024

	)

90 
	#AR5K_IER_DISABLE
 0x00000000

	)

91 
	#AR5K_IER_ENABLE
 0x00000001

	)

102 
	#AR5K_BCR
 0x0028

	)

103 
	#AR5K_BCR_AP
 0x00000000

	)

104 
	#AR5K_BCR_ADHOC
 0x00000001

	)

105 
	#AR5K_BCR_BDMAE
 0x00000002

	)

106 
	#AR5K_BCR_TQ1FV
 0x00000004

	)

107 
	#AR5K_BCR_TQ1V
 0x00000008

	)

108 
	#AR5K_BCR_BCGET
 0x00000010

	)

113 
	#AR5K_RTSD0
 0x0028

	)

114 
	#AR5K_RTSD0_6
 0x000000f‡

	)

115 
	#AR5K_RTSD0_6_S
 0

	)

116 
	#AR5K_RTSD0_9
 0x0000ff00

	)

117 
	#AR5K_RTSD0_9_S
 8

	)

118 
	#AR5K_RTSD0_12
 0x00ff0000

	)

119 
	#AR5K_RTSD0_12_S
 16

	)

120 
	#AR5K_RTSD0_18
 0xff000000

	)

121 
	#AR5K_RTSD0_18_S
 24

	)

139 
	#AR5K_BSR
 0x002¯

	)

140 
	#AR5K_BSR_BDLYSW
 0x00000001

	)

141 
	#AR5K_BSR_BDLYDMA
 0x00000002

	)

142 
	#AR5K_BSR_TXQ1F
 0x00000004

	)

143 
	#AR5K_BSR_ATIMDLY
 0x00000008

	)

144 
	#AR5K_BSR_SNPADHOC
 0x00000100

	)

145 
	#AR5K_BSR_SNPBDMAE
 0x00000200

	)

146 
	#AR5K_BSR_SNPTQ1FV
 0x00000400

	)

147 
	#AR5K_BSR_SNPTQ1V
 0x00000800

	)

148 
	#AR5K_BSR_SNAPSHOTSVALID
 0x00001000

	)

149 
	#AR5K_BSR_SWBA_CNT
 0x00ff0000

	)

154 
	#AR5K_RTSD1
 0x002¯

	)

155 
	#AR5K_RTSD1_24
 0x000000f‡

	)

156 
	#AR5K_RTSD1_24_S
 0

	)

157 
	#AR5K_RTSD1_36
 0x0000ff00

	)

158 
	#AR5K_RTSD1_36_S
 8

	)

159 
	#AR5K_RTSD1_48
 0x00ff0000

	)

160 
	#AR5K_RTSD1_48_S
 16

	)

161 
	#AR5K_RTSD1_54
 0xff000000

	)

162 
	#AR5K_RTSD1_54_S
 24

	)

168 
	#AR5K_TXCFG
 0x0030

	)

169 
	#AR5K_TXCFG_SDMAMR
 0x00000007

	)

170 
	#AR5K_TXCFG_SDMAMR_S
 0

	)

171 
	#AR5K_TXCFG_B_MODE
 0x00000008

	)

172 
	#AR5K_TXCFG_TXFSTP
 0x00000008

	)

173 
	#AR5K_TXCFG_TXFULL
 0x000003f0

	)

174 
	#AR5K_TXCFG_TXFULL_S
 4

	)

175 
	#AR5K_TXCFG_TXFULL_0B
 0x00000000

	)

176 
	#AR5K_TXCFG_TXFULL_64B
 0x00000010

	)

177 
	#AR5K_TXCFG_TXFULL_128B
 0x00000020

	)

178 
	#AR5K_TXCFG_TXFULL_192B
 0x00000030

	)

179 
	#AR5K_TXCFG_TXFULL_256B
 0x00000040

	)

180 
	#AR5K_TXCFG_TXCONT_EN
 0x00000080

	)

181 
	#AR5K_TXCFG_DMASIZE
 0x00000100

	)

182 
	#AR5K_TXCFG_JUMBO_DESC_EN
 0x00000400

	)

183 
	#AR5K_TXCFG_ADHOC_BCN_ATIM
 0x00000800

	)

184 
	#AR5K_TXCFG_ATIM_WINDOW_DEF_DIS
 0x00001000

	)

185 
	#AR5K_TXCFG_RTSRND
 0x00001000

	)

186 
	#AR5K_TXCFG_FRMPAD_DIS
 0x00002000

	)

187 
	#AR5K_TXCFG_RDY_CBR_DIS
 0x00004000

	)

188 
	#AR5K_TXCFG_JUMBO_FRM_MODE
 0x00008000

	)

189 
	#AR5K_TXCFG_DCU_DBL_BUF_DIS
 0x00008000

	)

190 
	#AR5K_TXCFG_DCU_CACHING_DIS
 0x00010000

	)

195 
	#AR5K_RXCFG
 0x0034

	)

196 
	#AR5K_RXCFG_SDMAMW
 0x00000007

	)

197 
	#AR5K_RXCFG_SDMAMW_S
 0

	)

198 
	#AR5K_RXCFG_ZLFDMA
 0x00000008

	)

199 
	#AR5K_RXCFG_DEF_ANTENNA
 0x00000010

	)

200 
	#AR5K_RXCFG_JUMBO_RXE
 0x00000020

	)

201 
	#AR5K_RXCFG_JUMBO_WRAP
 0x00000040

	)

202 
	#AR5K_RXCFG_SLE_ENTRY
 0x00000080

	)

208 
	#AR5K_RXJLA
 0x0038

	)

213 
	#AR5K_MIBC
 0x0040

	)

214 
	#AR5K_MIBC_COW
 0x00000001

	)

215 
	#AR5K_MIBC_FMC
 0x00000002

	)

216 
	#AR5K_MIBC_CMC
 0x00000004

	)

217 
	#AR5K_MIBC_MCS
 0x00000008

	)

222 
	#AR5K_TOPS
 0x0044

	)

223 
	#AR5K_TOPS_M
 0x0000ffff

	)

228 
	#AR5K_RXNOFRM
 0x0048

	)

229 
	#AR5K_RXNOFRM_M
 0x000003ff

	)

234 
	#AR5K_TXNOFRM
 0x004c

	)

235 
	#AR5K_TXNOFRM_M
 0x000003ff

	)

236 
	#AR5K_TXNOFRM_QCU
 0x000ffc00

	)

237 
	#AR5K_TXNOFRM_QCU_S
 10

	)

242 
	#AR5K_RPGTO
 0x0050

	)

243 
	#AR5K_RPGTO_M
 0x000003ff

	)

248 
	#AR5K_RFCNT
 0x0054

	)

249 
	#AR5K_RFCNT_M
 0x0000001‡

	)

250 
	#AR5K_RFCNT_RFCL
 0x0000000‡

	)

256 
	#AR5K_MISC
 0x0058

	)

257 
	#AR5K_MISC_DMA_OBS_M
 0x000001e0

	)

258 
	#AR5K_MISC_DMA_OBS_S
 5

	)

259 
	#AR5K_MISC_MISC_OBS_M
 0x00000e00

	)

260 
	#AR5K_MISC_MISC_OBS_S
 9

	)

261 
	#AR5K_MISC_MAC_OBS_LSB_M
 0x00007000

	)

262 
	#AR5K_MISC_MAC_OBS_LSB_S
 12

	)

263 
	#AR5K_MISC_MAC_OBS_MSB_M
 0x00038000

	)

264 
	#AR5K_MISC_MAC_OBS_MSB_S
 15

	)

265 
	#AR5K_MISC_LED_DECAY
 0x001c0000

	)

266 
	#AR5K_MISC_LED_BLINK
 0x00e00000

	)

272 
	#AR5K_QCUDCU_CLKGT
 0x005¯

	)

273 
	#AR5K_QCUDCU_CLKGT_QCU
 0x0000fff‡

	)

274 
	#AR5K_QCUDCU_CLKGT_DCU
 0x07ff0000

	)

284 
	#AR5K_ISR
 0x001¯

	)

285 
	#AR5K_PISR
 0x0080

	)

286 
	#AR5K_ISR_RXOK
 0x00000001

	)

287 
	#AR5K_ISR_RXDESC
 0x00000002

	)

288 
	#AR5K_ISR_RXERR
 0x00000004

	)

289 
	#AR5K_ISR_RXNOFRM
 0x00000008

	)

290 
	#AR5K_ISR_RXEOL
 0x00000010

	)

291 
	#AR5K_ISR_RXORN
 0x00000020

	)

292 
	#AR5K_ISR_TXOK
 0x00000040

	)

293 
	#AR5K_ISR_TXDESC
 0x00000080

	)

294 
	#AR5K_ISR_TXERR
 0x00000100

	)

295 
	#AR5K_ISR_TXNOFRM
 0x00000200

	)

296 
	#AR5K_ISR_TXEOL
 0x00000400

	)

297 
	#AR5K_ISR_TXURN
 0x00000800

	)

298 
	#AR5K_ISR_MIB
 0x00001000

	)

299 
	#AR5K_ISR_SWI
 0x00002000

	)

300 
	#AR5K_ISR_RXPHY
 0x00004000

	)

301 
	#AR5K_ISR_RXKCM
 0x00008000

	)

302 
	#AR5K_ISR_SWBA
 0x00010000

	)

303 
	#AR5K_ISR_BRSSI
 0x00020000

	)

304 
	#AR5K_ISR_BMISS
 0x00040000

	)

305 
	#AR5K_ISR_HIUERR
 0x00080000

	)

306 
	#AR5K_ISR_BNR
 0x00100000

	)

307 
	#AR5K_ISR_MCABT
 0x00100000

	)

308 
	#AR5K_ISR_RXCHIRP
 0x00200000

	)

309 
	#AR5K_ISR_SSERR
 0x00200000

	)

310 
	#AR5K_ISR_DPERR
 0x00400000

	)

311 
	#AR5K_ISR_RXDOPPLER
 0x00400000

	)

312 
	#AR5K_ISR_TIM
 0x00800000

	)

313 
	#AR5K_ISR_BCNMISC
 0x00800000

	)

315 
	#AR5K_ISR_GPIO
 0x01000000

	)

316 
	#AR5K_ISR_QCBRORN
 0x02000000

	)

317 
	#AR5K_ISR_QCBRURN
 0x04000000

	)

318 
	#AR5K_ISR_QTRIG
 0x08000000

	)

326 
	#AR5K_SISR0
 0x0084

	)

327 
	#AR5K_SISR0_QCU_TXOK
 0x000003f‡

	)

328 
	#AR5K_SISR0_QCU_TXOK_S
 0

	)

329 
	#AR5K_SISR0_QCU_TXDESC
 0x03ff0000

	)

330 
	#AR5K_SISR0_QCU_TXDESC_S
 16

	)

332 
	#AR5K_SISR1
 0x0088

	)

333 
	#AR5K_SISR1_QCU_TXERR
 0x000003f‡

	)

334 
	#AR5K_SISR1_QCU_TXERR_S
 0

	)

335 
	#AR5K_SISR1_QCU_TXEOL
 0x03ff0000

	)

336 
	#AR5K_SISR1_QCU_TXEOL_S
 16

	)

338 
	#AR5K_SISR2
 0x008¯

	)

339 
	#AR5K_SISR2_QCU_TXURN
 0x000003f‡

	)

340 
	#AR5K_SISR2_QCU_TXURN_S
 0

	)

341 
	#AR5K_SISR2_MCABT
 0x00010000

	)

342 
	#AR5K_SISR2_SSERR
 0x00020000

	)

343 
	#AR5K_SISR2_DPERR
 0x00040000

	)

344 
	#AR5K_SISR2_TIM
 0x01000000

	)

345 
	#AR5K_SISR2_CAB_END
 0x02000000

	)

346 
	#AR5K_SISR2_DTIM_SYNC
 0x04000000

	)

347 
	#AR5K_SISR2_BCN_TIMEOUT
 0x08000000

	)

348 
	#AR5K_SISR2_CAB_TIMEOUT
 0x10000000

	)

349 
	#AR5K_SISR2_DTIM
 0x20000000

	)

350 
	#AR5K_SISR2_TSFOOR
 0x80000000

	)

352 
	#AR5K_SISR3
 0x0090

	)

353 
	#AR5K_SISR3_QCBRORN
 0x000003f‡

	)

354 
	#AR5K_SISR3_QCBRORN_S
 0

	)

355 
	#AR5K_SISR3_QCBRURN
 0x03ff0000

	)

356 
	#AR5K_SISR3_QCBRURN_S
 16

	)

358 
	#AR5K_SISR4
 0x0094

	)

359 
	#AR5K_SISR4_QTRIG
 0x000003f‡

	)

360 
	#AR5K_SISR4_QTRIG_S
 0

	)

365 
	#AR5K_RAC_PISR
 0x00c0

	)

366 
	#AR5K_RAC_SISR0
 0x00c4

	)

367 
	#AR5K_RAC_SISR1
 0x00c8

	)

368 
	#AR5K_RAC_SISR2
 0x00c¯

	)

369 
	#AR5K_RAC_SISR3
 0x00d0

	)

370 
	#AR5K_RAC_SISR4
 0x00d4

	)

378 
	#AR5K_IMR
 0x0020

	)

379 
	#AR5K_PIMR
 0x00a0

	)

380 
	#AR5K_IMR_RXOK
 0x00000001

	)

381 
	#AR5K_IMR_RXDESC
 0x00000002

	)

382 
	#AR5K_IMR_RXERR
 0x00000004

	)

383 
	#AR5K_IMR_RXNOFRM
 0x00000008

	)

384 
	#AR5K_IMR_RXEOL
 0x00000010

	)

385 
	#AR5K_IMR_RXORN
 0x00000020

	)

386 
	#AR5K_IMR_TXOK
 0x00000040

	)

387 
	#AR5K_IMR_TXDESC
 0x00000080

	)

388 
	#AR5K_IMR_TXERR
 0x00000100

	)

389 
	#AR5K_IMR_TXNOFRM
 0x00000200

	)

390 
	#AR5K_IMR_TXEOL
 0x00000400

	)

391 
	#AR5K_IMR_TXURN
 0x00000800

	)

392 
	#AR5K_IMR_MIB
 0x00001000

	)

393 
	#AR5K_IMR_SWI
 0x00002000

	)

394 
	#AR5K_IMR_RXPHY
 0x00004000

	)

395 
	#AR5K_IMR_RXKCM
 0x00008000

	)

396 
	#AR5K_IMR_SWBA
 0x00010000

	)

397 
	#AR5K_IMR_BRSSI
 0x00020000

	)

398 
	#AR5K_IMR_BMISS
 0x00040000

	)

399 
	#AR5K_IMR_HIUERR
 0x00080000

	)

400 
	#AR5K_IMR_BNR
 0x00100000

	)

401 
	#AR5K_IMR_MCABT
 0x00100000

	)

402 
	#AR5K_IMR_RXCHIRP
 0x00200000

	)

403 
	#AR5K_IMR_SSERR
 0x00200000

	)

404 
	#AR5K_IMR_DPERR
 0x00400000

	)

405 
	#AR5K_IMR_RXDOPPLER
 0x00400000

	)

406 
	#AR5K_IMR_TIM
 0x00800000

	)

407 
	#AR5K_IMR_BCNMISC
 0x00800000

	)

409 
	#AR5K_IMR_GPIO
 0x01000000

	)

410 
	#AR5K_IMR_QCBRORN
 0x02000000

	)

411 
	#AR5K_IMR_QCBRURN
 0x04000000

	)

412 
	#AR5K_IMR_QTRIG
 0x08000000

	)

417 
	#AR5K_SIMR0
 0x00a4

	)

418 
	#AR5K_SIMR0_QCU_TXOK
 0x000003f‡

	)

419 
	#AR5K_SIMR0_QCU_TXOK_S
 0

	)

420 
	#AR5K_SIMR0_QCU_TXDESC
 0x03ff0000

	)

421 
	#AR5K_SIMR0_QCU_TXDESC_S
 16

	)

423 
	#AR5K_SIMR1
 0x00a8

	)

424 
	#AR5K_SIMR1_QCU_TXERR
 0x000003f‡

	)

425 
	#AR5K_SIMR1_QCU_TXERR_S
 0

	)

426 
	#AR5K_SIMR1_QCU_TXEOL
 0x03ff0000

	)

427 
	#AR5K_SIMR1_QCU_TXEOL_S
 16

	)

429 
	#AR5K_SIMR2
 0x00a¯

	)

430 
	#AR5K_SIMR2_QCU_TXURN
 0x000003f‡

	)

431 
	#AR5K_SIMR2_QCU_TXURN_S
 0

	)

432 
	#AR5K_SIMR2_MCABT
 0x00010000

	)

433 
	#AR5K_SIMR2_SSERR
 0x00020000

	)

434 
	#AR5K_SIMR2_DPERR
 0x00040000

	)

435 
	#AR5K_SIMR2_TIM
 0x01000000

	)

436 
	#AR5K_SIMR2_CAB_END
 0x02000000

	)

437 
	#AR5K_SIMR2_DTIM_SYNC
 0x04000000

	)

438 
	#AR5K_SIMR2_BCN_TIMEOUT
 0x08000000

	)

439 
	#AR5K_SIMR2_CAB_TIMEOUT
 0x10000000

	)

440 
	#AR5K_SIMR2_DTIM
 0x20000000

	)

441 
	#AR5K_SIMR2_TSFOOR
 0x80000000

	)

443 
	#AR5K_SIMR3
 0x00b0

	)

444 
	#AR5K_SIMR3_QCBRORN
 0x000003f‡

	)

445 
	#AR5K_SIMR3_QCBRORN_S
 0

	)

446 
	#AR5K_SIMR3_QCBRURN
 0x03ff0000

	)

447 
	#AR5K_SIMR3_QCBRURN_S
 16

	)

449 
	#AR5K_SIMR4
 0x00b4

	)

450 
	#AR5K_SIMR4_QTRIG
 0x000003f‡

	)

451 
	#AR5K_SIMR4_QTRIG_S
 0

	)

461 
	#AR5K_DCM_ADDR
 0x0400

	)

462 
	#AR5K_DCM_DATA
 0x0404

	)

467 
	#AR5K_WOW_PCFG
 0x0410

	)

468 
	#AR5K_WOW_PCFG_PAT_MATCH_EN
 0x00000001

	)

469 
	#AR5K_WOW_PCFG_LONG_FRAME_POL
 0x00000002

	)

470 
	#AR5K_WOW_PCFG_WOBMISS
 0x00000004

	)

471 
	#AR5K_WOW_PCFG_PAT_0_EN
 0x00000100

	)

472 
	#AR5K_WOW_PCFG_PAT_1_EN
 0x00000200

	)

473 
	#AR5K_WOW_PCFG_PAT_2_EN
 0x00000400

	)

474 
	#AR5K_WOW_PCFG_PAT_3_EN
 0x00000800

	)

475 
	#AR5K_WOW_PCFG_PAT_4_EN
 0x00001000

	)

476 
	#AR5K_WOW_PCFG_PAT_5_EN
 0x00002000

	)

481 
	#AR5K_WOW_PAT_IDX
 0x0414

	)

486 
	#AR5K_WOW_PAT_DATA
 0x0418

	)

487 
	#AR5K_WOW_PAT_DATA_0_3_V
 0x00000001

	)

488 
	#AR5K_WOW_PAT_DATA_1_4_V
 0x00000100

	)

489 
	#AR5K_WOW_PAT_DATA_2_5_V
 0x00010000

	)

490 
	#AR5K_WOW_PAT_DATA_0_3_M
 0x01000000

	)

491 
	#AR5K_WOW_PAT_DATA_1_4_M
 0x04000000

	)

492 
	#AR5K_WOW_PAT_DATA_2_5_M
 0x10000000

	)

497 
	#AR5K_DCCFG
 0x0420

	)

498 
	#AR5K_DCCFG_GLOBAL_EN
 0x00000001

	)

499 
	#AR5K_DCCFG_BYPASS_EN
 0x00000002

	)

500 
	#AR5K_DCCFG_BCAST_EN
 0x00000004

	)

501 
	#AR5K_DCCFG_MCAST_EN
 0x00000008

	)

506 
	#AR5K_CCFG
 0x0600

	)

507 
	#AR5K_CCFG_WINDOW_SIZE
 0x00000007

	)

508 
	#AR5K_CCFG_CPC_EN
 0x00000008

	)

510 
	#AR5K_CCFG_CCU
 0x0604

	)

511 
	#AR5K_CCFG_CCU_CUP_EN
 0x00000001

	)

512 
	#AR5K_CCFG_CCU_CREDIT
 0x00000002

	)

513 
	#AR5K_CCFG_CCU_CD_THRES
 0x00000080

	)

514 
	#AR5K_CCFG_CCU_CUP_LCNT
 0x00010000

	)

515 
	#AR5K_CCFG_CCU_INIT
 0x00100200

	)

520 
	#AR5K_CPC0
 0x0610

	)

521 
	#AR5K_CPC1
 0x0614

	)

522 
	#AR5K_CPC2
 0x0618

	)

523 
	#AR5K_CPC3
 0x061¯

	)

524 
	#AR5K_CPCOVF
 0x0620

	)

545 
	#AR5K_QUEUE_REG
(
_r
, 
_q
Ë(((_qË<< 2Ë+ _r)

	)

546 
	#AR5K_QCU_GLOBAL_READ
(
_r
, 
_q
Ë(
	`AR5K_REG_READ
(_rË& (1 << _q))

	)

547 
	#AR5K_QCU_GLOBAL_WRITE
(
_r
, 
_q
Ë
	`AR5K_REG_WRITE
(_r, (1 << _q))

	)

552 
	#AR5K_QCU_TXDP_BASE
 0x0800

	)

553 
	#AR5K_QUEUE_TXDP
(
_q
Ë
	`AR5K_QUEUE_REG
(
AR5K_QCU_TXDP_BASE
, _q)

	)

558 
	#AR5K_QCU_TXE
 0x0840

	)

559 
	#AR5K_ENABLE_QUEUE
(
_q
Ë
	`AR5K_QCU_GLOBAL_WRITE
(
AR5K_QCU_TXE
, _q)

	)

560 
	#AR5K_QUEUE_ENABLED
(
_q
Ë
	`AR5K_QCU_GLOBAL_READ
(
AR5K_QCU_TXE
, _q)

	)

565 
	#AR5K_QCU_TXD
 0x0880

	)

566 
	#AR5K_DISABLE_QUEUE
(
_q
Ë
	`AR5K_QCU_GLOBAL_WRITE
(
AR5K_QCU_TXD
, _q)

	)

567 
	#AR5K_QUEUE_DISABLED
(
_q
Ë
	`AR5K_QCU_GLOBAL_READ
(
AR5K_QCU_TXD
, _q)

	)

572 
	#AR5K_QCU_CBRCFG_BASE
 0x08c0

	)

573 
	#AR5K_QCU_CBRCFG_INTVAL
 0x00fffff‡

	)

574 
	#AR5K_QCU_CBRCFG_INTVAL_S
 0

	)

575 
	#AR5K_QCU_CBRCFG_ORN_THRES
 0xff000000

	)

576 
	#AR5K_QCU_CBRCFG_ORN_THRES_S
 24

	)

577 
	#AR5K_QUEUE_CBRCFG
(
_q
Ë
	`AR5K_QUEUE_REG
(
AR5K_QCU_CBRCFG_BASE
, _q)

	)

582 
	#AR5K_QCU_RDYTIMECFG_BASE
 0x0900

	)

583 
	#AR5K_QCU_RDYTIMECFG_INTVAL
 0x00fffff‡

	)

584 
	#AR5K_QCU_RDYTIMECFG_INTVAL_S
 0

	)

585 
	#AR5K_QCU_RDYTIMECFG_ENABLE
 0x01000000

	)

586 
	#AR5K_QUEUE_RDYTIMECFG
(
_q
Ë
	`AR5K_QUEUE_REG
(
AR5K_QCU_RDYTIMECFG_BASE
, _q)

	)

591 
	#AR5K_QCU_ONESHOTARM_SET
 0x0940

	)

592 
	#AR5K_QCU_ONESHOTARM_SET_M
 0x0000ffff

	)

597 
	#AR5K_QCU_ONESHOTARM_CLEAR
 0x0980

	)

598 
	#AR5K_QCU_ONESHOTARM_CLEAR_M
 0x0000ffff

	)

603 
	#AR5K_QCU_MISC_BASE
 0x09c0

	)

604 
	#AR5K_QCU_MISC_FRSHED_M
 0x0000000‡

	)

605 
	#AR5K_QCU_MISC_FRSHED_ASAP
 0

	)

606 
	#AR5K_QCU_MISC_FRSHED_CBR
 1

	)

607 
	#AR5K_QCU_MISC_FRSHED_DBA_GT
 2

	)

608 
	#AR5K_QCU_MISC_FRSHED_TIM_GT
 3

	)

609 
	#AR5K_QCU_MISC_FRSHED_BCN_SENT_GT
 4

	)

610 
	#AR5K_QCU_MISC_ONESHOT_ENABLE
 0x00000010

	)

611 
	#AR5K_QCU_MISC_CBREXP_DIS
 0x00000020

	)

612 
	#AR5K_QCU_MISC_CBREXP_BCN_DIS
 0x00000040

	)

613 
	#AR5K_QCU_MISC_BCN_ENABLE
 0x00000080

	)

614 
	#AR5K_QCU_MISC_CBR_THRES_ENABLE
 0x00000100

	)

615 
	#AR5K_QCU_MISC_RDY_VEOL_POLICY
 0x00000200

	)

616 
	#AR5K_QCU_MISC_CBR_RESET_CNT
 0x00000400

	)

617 
	#AR5K_QCU_MISC_DCU_EARLY
 0x00000800

	)

618 
	#AR5K_QCU_MISC_DCU_CMP_EN
 0x00001000

	)

619 
	#AR5K_QUEUE_MISC
(
_q
Ë
	`AR5K_QUEUE_REG
(
AR5K_QCU_MISC_BASE
, _q)

	)

625 
	#AR5K_QCU_STS_BASE
 0x0a00

	)

626 
	#AR5K_QCU_STS_FRMPENDCNT
 0x00000003

	)

627 
	#AR5K_QCU_STS_CBREXPCNT
 0x0000ff00

	)

628 
	#AR5K_QUEUE_STATUS
(
_q
Ë
	`AR5K_QUEUE_REG
(
AR5K_QCU_STS_BASE
, _q)

	)

633 
	#AR5K_QCU_RDYTIMESHDN
 0x0a40

	)

634 
	#AR5K_QCU_RDYTIMESHDN_M
 0x000003ff

	)

639 
	#AR5K_QCU_CBB_SELECT
 0x0b00

	)

640 
	#AR5K_QCU_CBB_ADDR
 0x0b04

	)

641 
	#AR5K_QCU_CBB_ADDR_S
 9

	)

647 
	#AR5K_QCU_CBCFG
 0x0b08

	)

670 
	#AR5K_DCU_QCUMASK_BASE
 0x1000

	)

671 
	#AR5K_DCU_QCUMASK_M
 0x000003ff

	)

672 
	#AR5K_QUEUE_QCUMASK
(
_q
Ë
	`AR5K_QUEUE_REG
(
AR5K_DCU_QCUMASK_BASE
, _q)

	)

677 
	#AR5K_DCU_LCL_IFS_BASE
 0x1040

	)

678 
	#AR5K_DCU_LCL_IFS_CW_MIN
 0x000003f‡

	)

679 
	#AR5K_DCU_LCL_IFS_CW_MIN_S
 0

	)

680 
	#AR5K_DCU_LCL_IFS_CW_MAX
 0x000ffc00

	)

681 
	#AR5K_DCU_LCL_IFS_CW_MAX_S
 10

	)

682 
	#AR5K_DCU_LCL_IFS_AIFS
 0x0ff00000

	)

683 
	#AR5K_DCU_LCL_IFS_AIFS_S
 20

	)

684 
	#AR5K_DCU_LCL_IFS_AIFS_MAX
 0xf¯

	)

685 
	#AR5K_QUEUE_DFS_LOCAL_IFS
(
_q
Ë
	`AR5K_QUEUE_REG
(
AR5K_DCU_LCL_IFS_BASE
, _q)

	)

691 
	#AR5K_DCU_RETRY_LMT_BASE
 0x1080

	)

692 
	#AR5K_DCU_RETRY_LMT_RTS
 0x0000000‡

	)

693 
	#AR5K_DCU_RETRY_LMT_RTS_S
 0

	)

694 
	#AR5K_DCU_RETRY_LMT_STA_RTS
 0x00003f00

	)

695 
	#AR5K_DCU_RETRY_LMT_STA_RTS_S
 8

	)

696 
	#AR5K_DCU_RETRY_LMT_STA_DATA
 0x000fc000

	)

697 
	#AR5K_DCU_RETRY_LMT_STA_DATA_S
 14

	)

698 
	#AR5K_QUEUE_DFS_RETRY_LIMIT
(
_q
Ë
	`AR5K_QUEUE_REG
(
AR5K_DCU_RETRY_LMT_BASE
, _q)

	)

703 
	#AR5K_DCU_CHAN_TIME_BASE
 0x10c0

	)

704 
	#AR5K_DCU_CHAN_TIME_DUR
 0x000ffff‡

	)

705 
	#AR5K_DCU_CHAN_TIME_DUR_S
 0

	)

706 
	#AR5K_DCU_CHAN_TIME_ENABLE
 0x00100000

	)

707 
	#AR5K_QUEUE_DFS_CHANNEL_TIME
(
_q
Ë
	`AR5K_QUEUE_REG
(
AR5K_DCU_CHAN_TIME_BASE
, _q)

	)

721 
	#AR5K_DCU_MISC_BASE
 0x1100

	)

722 
	#AR5K_DCU_MISC_BACKOFF
 0x0000003‡

	)

723 
	#AR5K_DCU_MISC_ETS_RTS_POL
 0x00000040

	)

726 
	#AR5K_DCU_MISC_ETS_CW_POL
 0x00000080

	)

728 
	#AR5K_DCU_MISC_FRAG_WAIT
 0x00000100

	)

729 
	#AR5K_DCU_MISC_BACKOFF_FRAG
 0x00000200

	)

730 
	#AR5K_DCU_MISC_HCFPOLL_ENABLE
 0x00000800

	)

731 
	#AR5K_DCU_MISC_BACKOFF_PERSIST
 0x00001000

	)

732 
	#AR5K_DCU_MISC_FRMPRFTCH_ENABLE
 0x00002000

	)

733 
	#AR5K_DCU_MISC_VIRTCOL
 0x0000c000

	)

734 
	#AR5K_DCU_MISC_VIRTCOL_NORMAL
 0

	)

735 
	#AR5K_DCU_MISC_VIRTCOL_IGNORE
 1

	)

736 
	#AR5K_DCU_MISC_BCN_ENABLE
 0x00010000

	)

737 
	#AR5K_DCU_MISC_ARBLOCK_CTL
 0x00060000

	)

738 
	#AR5K_DCU_MISC_ARBLOCK_CTL_S
 17

	)

739 
	#AR5K_DCU_MISC_ARBLOCK_CTL_NONE
 0

	)

740 
	#AR5K_DCU_MISC_ARBLOCK_CTL_INTFRM
 1

	)

741 
	#AR5K_DCU_MISC_ARBLOCK_CTL_GLOBAL
 2

	)

742 
	#AR5K_DCU_MISC_ARBLOCK_IGNORE
 0x00080000

	)

743 
	#AR5K_DCU_MISC_SEQ_NUM_INCR_DIS
 0x00100000

	)

744 
	#AR5K_DCU_MISC_POST_FR_BKOFF_DIS
 0x00200000

	)

745 
	#AR5K_DCU_MISC_VIRT_COLL_POLICY
 0x00400000

	)

746 
	#AR5K_DCU_MISC_BLOWN_IFS_POLICY
 0x00800000

	)

747 
	#AR5K_DCU_MISC_SEQNUM_CTL
 0x01000000

	)

748 
	#AR5K_QUEUE_DFS_MISC
(
_q
Ë
	`AR5K_QUEUE_REG
(
AR5K_DCU_MISC_BASE
, _q)

	)

753 
	#AR5K_DCU_SEQNUM_BASE
 0x1140

	)

754 
	#AR5K_DCU_SEQNUM_M
 0x00000fff

	)

755 
	#AR5K_QUEUE_DCU_SEQNUM
(
_q
Ë
	`AR5K_QUEUE_REG
(
AR5K_DCU_SEQNUM_BASE
, _q)

	)

760 
	#AR5K_DCU_GBL_IFS_SIFS
 0x1030

	)

761 
	#AR5K_DCU_GBL_IFS_SIFS_M
 0x0000ffff

	)

766 
	#AR5K_DCU_GBL_IFS_SLOT
 0x1070

	)

767 
	#AR5K_DCU_GBL_IFS_SLOT_M
 0x0000ffff

	)

772 
	#AR5K_DCU_GBL_IFS_EIFS
 0x10b0

	)

773 
	#AR5K_DCU_GBL_IFS_EIFS_M
 0x0000ffff

	)

785 
	#AR5K_DCU_GBL_IFS_MISC
 0x10f0

	)

786 
	#AR5K_DCU_GBL_IFS_MISC_LFSR_SLICE
 0x00000007

	)

787 
	#AR5K_DCU_GBL_IFS_MISC_TURBO_MODE
 0x00000008

	)

788 
	#AR5K_DCU_GBL_IFS_MISC_SIFS_DUR_USEC
 0x000003f0

	)

789 
	#AR5K_DCU_GBL_IFS_MISC_SIFS_DUR_USEC_S
 4

	)

790 
	#AR5K_DCU_GBL_IFS_MISC_USEC_DUR
 0x000ffc00

	)

791 
	#AR5K_DCU_GBL_IFS_MISC_USEC_DUR_S
 10

	)

792 
	#AR5K_DCU_GBL_IFS_MISC_DCU_ARB_DELAY
 0x00300000

	)

793 
	#AR5K_DCU_GBL_IFS_MISC_SIFS_CNT_RST
 0x00400000

	)

794 
	#AR5K_DCU_GBL_IFS_MISC_AIFS_CNT_RST
 0x00800000

	)

795 
	#AR5K_DCU_GBL_IFS_MISC_RND_LFSR_SL_DIS
 0x01000000

	)

800 
	#AR5K_DCU_FP
 0x1230

	)

801 
	#AR5K_DCU_FP_NOBURST_DCU_EN
 0x00000001

	)

802 
	#AR5K_DCU_FP_NOBURST_EN
 0x00000010

	)

803 
	#AR5K_DCU_FP_BURST_DCU_EN
 0x00000020

	)

808 
	#AR5K_DCU_TXP
 0x1270

	)

809 
	#AR5K_DCU_TXP_M
 0x000003f‡

	)

810 
	#AR5K_DCU_TXP_STATUS
 0x00010000

	)

817 
	#AR5K_DCU_TX_FILTER_0_BASE
 0x1038

	)

818 
	#AR5K_DCU_TX_FILTER_0
(
_n
Ë(
AR5K_DCU_TX_FILTER_0_BASE
 + (_¿* 64))

	)

823 
	#AR5K_DCU_TX_FILTER_1_BASE
 0x103c

	)

824 
	#AR5K_DCU_TX_FILTER_1
(
_n
Ë(
AR5K_DCU_TX_FILTER_1_BASE
 + (_¿* 64))

	)

829 
	#AR5K_DCU_TX_FILTER_CLR
 0x143c

	)

834 
	#AR5K_DCU_TX_FILTER_SET
 0x147c

	)

839 
	#AR5K_RESET_CTL
 0x4000

	)

840 
	#AR5K_RESET_CTL_PCU
 0x00000001

	)

841 
	#AR5K_RESET_CTL_DMA
 0x00000002

	)

842 
	#AR5K_RESET_CTL_BASEBAND
 0x00000002

	)

843 
	#AR5K_RESET_CTL_MAC
 0x00000004

	)

844 
	#AR5K_RESET_CTL_PHY
 0x00000008

	)

845 
	#AR5K_RESET_CTL_PCI
 0x00000010

	)

850 
	#AR5K_SLEEP_CTL
 0x4004

	)

851 
	#AR5K_SLEEP_CTL_SLDUR
 0x0000fff‡

	)

852 
	#AR5K_SLEEP_CTL_SLDUR_S
 0

	)

853 
	#AR5K_SLEEP_CTL_SLE
 0x00030000

	)

854 
	#AR5K_SLEEP_CTL_SLE_S
 16

	)

855 
	#AR5K_SLEEP_CTL_SLE_WAKE
 0x00000000

	)

856 
	#AR5K_SLEEP_CTL_SLE_SLP
 0x00010000

	)

857 
	#AR5K_SLEEP_CTL_SLE_ALLOW
 0x00020000

	)

858 
	#AR5K_SLEEP_CTL_SLE_UNITS
 0x00000008

	)

859 
	#AR5K_SLEEP_CTL_DUR_TIM_POL
 0x00040000

	)

860 
	#AR5K_SLEEP_CTL_DUR_WRITE_POL
 0x00080000

	)

861 
	#AR5K_SLEEP_CTL_SLE_POL
 0x00100000

	)

866 
	#AR5K_INTPEND
 0x4008

	)

867 
	#AR5K_INTPEND_M
 0x00000001

	)

872 
	#AR5K_SFR
 0x400c

	)

873 
	#AR5K_SFR_EN
 0x00000001

	)

879 
	#AR5K_PCICFG
 0x4010

	)

880 
	#AR5K_PCICFG_EEAE
 0x00000001

	)

881 
	#AR5K_PCICFG_SLEEP_CLOCK_EN
 0x00000002

	)

882 
	#AR5K_PCICFG_CLKRUNEN
 0x00000004

	)

883 
	#AR5K_PCICFG_EESIZE
 0x00000018

	)

884 
	#AR5K_PCICFG_EESIZE_S
 3

	)

885 
	#AR5K_PCICFG_EESIZE_4K
 0

	)

886 
	#AR5K_PCICFG_EESIZE_8K
 1

	)

887 
	#AR5K_PCICFG_EESIZE_16K
 2

	)

888 
	#AR5K_PCICFG_EESIZE_FAIL
 3

	)

889 
	#AR5K_PCICFG_LED
 0x00000060

	)

890 
	#AR5K_PCICFG_LED_NONE
 0x00000000

	)

891 
	#AR5K_PCICFG_LED_PEND
 0x00000020

	)

892 
	#AR5K_PCICFG_LED_ASSOC
 0x00000040

	)

893 
	#AR5K_PCICFG_BUS_SEL
 0x00000380

	)

894 
	#AR5K_PCICFG_CBEFIX_DIS
 0x00000400

	)

895 
	#AR5K_PCICFG_SL_INTEN
 0x00000800

	)

896 
	#AR5K_PCICFG_LED_BCTL
 0x00001000

	)

897 
	#AR5K_PCICFG_RETRY_FIX
 0x00001000

	)

898 
	#AR5K_PCICFG_SL_INPEN
 0x00002000

	)

899 
	#AR5K_PCICFG_SPWR_DN
 0x00010000

	)

900 
	#AR5K_PCICFG_LEDMODE
 0x000e0000

	)

901 
	#AR5K_PCICFG_LEDMODE_PROP
 0x00000000

	)

902 
	#AR5K_PCICFG_LEDMODE_PROM
 0x00020000

	)

903 
	#AR5K_PCICFG_LEDMODE_PWR
 0x00040000

	)

904 
	#AR5K_PCICFG_LEDMODE_RAND
 0x00060000

	)

905 
	#AR5K_PCICFG_LEDBLINK
 0x00700000

	)

906 
	#AR5K_PCICFG_LEDBLINK_S
 20

	)

907 
	#AR5K_PCICFG_LEDSLOW
 0x00800000

	)

908 
	#AR5K_PCICFG_LEDSTATE
 \

909 (
AR5K_PCICFG_LED
 | 
AR5K_PCICFG_LEDMODE
 | \

910 
AR5K_PCICFG_LEDBLINK
 | 
AR5K_PCICFG_LEDSLOW
)

	)

911 
	#AR5K_PCICFG_SLEEP_CLOCK_RATE
 0x03000000

	)

912 
	#AR5K_PCICFG_SLEEP_CLOCK_RATE_S
 24

	)

930 
	#AR5K_NUM_GPIO
 6

	)

932 
	#AR5K_GPIOCR
 0x4014

	)

933 
	#AR5K_GPIOCR_INT_ENA
 0x00008000

	)

934 
	#AR5K_GPIOCR_INT_SELL
 0x00000000

	)

935 
	#AR5K_GPIOCR_INT_SELH
 0x00010000

	)

936 
	#AR5K_GPIOCR_IN
(
n
Ë(0 << (“Ë* 2)Ë

	)

937 
	#AR5K_GPIOCR_OUT0
(
n
Ë(1 << (“Ë* 2)Ë

	)

938 
	#AR5K_GPIOCR_OUT1
(
n
Ë(2 << (“Ë* 2)Ë

	)

939 
	#AR5K_GPIOCR_OUT
(
n
Ë(3 << (“Ë* 2)Ë

	)

940 
	#AR5K_GPIOCR_INT_SEL
(
n
Ë(“Ë<< 12Ë

	)

945 
	#AR5K_GPIODO
 0x4018

	)

950 
	#AR5K_GPIODI
 0x401c

	)

951 
	#AR5K_GPIODI_M
 0x0000002f

	)

956 
	#AR5K_SREV
 0x4020

	)

957 
	#AR5K_SREV_REV
 0x0000000‡

	)

958 
	#AR5K_SREV_REV_S
 0

	)

959 
	#AR5K_SREV_VER
 0x000000f‡

	)

960 
	#AR5K_SREV_VER_S
 4

	)

965 
	#AR5K_TXEPOST
 0x4028

	)

970 
	#AR5K_QCU_SLEEP_MASK
 0x402c

	)

980 
	#AR5K_5414_CBCFG
 0x4068

	)

981 
	#AR5K_5414_CBCFG_BUF_DIS
 0x10

	)

987 
	#AR5K_PCIE_PM_CTL
 0x4068

	)

989 
	#AR5K_PCIE_PM_CTL_L1_WHEN_D2
 0x00000001

	)

991 
	#AR5K_PCIE_PM_CTL_L0_L0S_CLEAR
 0x00000002

	)

992 
	#AR5K_PCIE_PM_CTL_L0_L0S_EN
 0x00000004

	)

993 
	#AR5K_PCIE_PM_CTL_LDRESET_EN
 0x00000008

	)

996 
	#AR5K_PCIE_PM_CTL_PME_EN
 0x00000010

	)

997 
	#AR5K_PCIE_PM_CTL_AUX_PWR_DET
 0x00000020

	)

998 
	#AR5K_PCIE_PM_CTL_PME_CLEAR
 0x00000040

	)

999 
	#AR5K_PCIE_PM_CTL_PSM_D0
 0x00000080

	)

1000 
	#AR5K_PCIE_PM_CTL_PSM_D1
 0x00000100

	)

1001 
	#AR5K_PCIE_PM_CTL_PSM_D2
 0x00000200

	)

1002 
	#AR5K_PCIE_PM_CTL_PSM_D3
 0x00000400

	)

1007 
	#AR5K_PCIE_WAEN
 0x407c

	)

1013 
	#AR5K_PCIE_SERDES
 0x4080

	)

1014 
	#AR5K_PCIE_SERDES_RESET
 0x4084

	)

1053 
	#AR5K_EEPROM_BASE
 0x6000

	)

1058 
	#AR5K_EEPROM_DATA_5211
 0x6004

	)

1059 
	#AR5K_EEPROM_DATA_5210
 0x6800

	)

1060 
	#AR5K_EEPROM_DATA
 (
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
 ? \

1061 
AR5K_EEPROM_DATA_5210
 : 
AR5K_EEPROM_DATA_5211
)

	)

1066 
	#AR5K_EEPROM_CMD
 0x6008

	)

1067 
	#AR5K_EEPROM_CMD_READ
 0x00000001

	)

1068 
	#AR5K_EEPROM_CMD_WRITE
 0x00000002

	)

1069 
	#AR5K_EEPROM_CMD_RESET
 0x00000004

	)

1074 
	#AR5K_EEPROM_STAT_5210
 0x6c00

	)

1075 
	#AR5K_EEPROM_STAT_5211
 0x600¯

	)

1076 
	#AR5K_EEPROM_STATUS
 (
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
 ? \

1077 
AR5K_EEPROM_STAT_5210
 : 
AR5K_EEPROM_STAT_5211
)

	)

1078 
	#AR5K_EEPROM_STAT_RDERR
 0x00000001

	)

1079 
	#AR5K_EEPROM_STAT_RDDONE
 0x00000002

	)

1080 
	#AR5K_EEPROM_STAT_WRERR
 0x00000004

	)

1081 
	#AR5K_EEPROM_STAT_WRDONE
 0x00000008

	)

1086 
	#AR5K_EEPROM_CFG
 0x6010

	)

1087 
	#AR5K_EEPROM_CFG_SIZE
 0x00000003

	)

1088 
	#AR5K_EEPROM_CFG_SIZE_AUTO
 0

	)

1089 
	#AR5K_EEPROM_CFG_SIZE_4KBIT
 1

	)

1090 
	#AR5K_EEPROM_CFG_SIZE_8KBIT
 2

	)

1091 
	#AR5K_EEPROM_CFG_SIZE_16KBIT
 3

	)

1092 
	#AR5K_EEPROM_CFG_WR_WAIT_DIS
 0x00000004

	)

1093 
	#AR5K_EEPROM_CFG_CLK_RATE
 0x00000018

	)

1094 
	#AR5K_EEPROM_CFG_CLK_RATE_S
 3

	)

1095 
	#AR5K_EEPROM_CFG_CLK_RATE_156KHZ
 0

	)

1096 
	#AR5K_EEPROM_CFG_CLK_RATE_312KHZ
 1

	)

1097 
	#AR5K_EEPROM_CFG_CLK_RATE_625KHZ
 2

	)

1098 
	#AR5K_EEPROM_CFG_PROT_KEY
 0x00ffff00

	)

1099 
	#AR5K_EEPROM_CFG_PROT_KEY_S
 8

	)

1100 
	#AR5K_EEPROM_CFG_LIND_EN
 0x01000000

	)

1115 
	#AR5K_PCU_MIN
 0x8000

	)

1116 
	#AR5K_PCU_MAX
 0x8fff

	)

1121 
	#AR5K_STA_ID0
 0x8000

	)

1122 
	#AR5K_STA_ID0_ARRD_L32
 0xffffffff

	)

1127 
	#AR5K_STA_ID1
 0x8004

	)

1128 
	#AR5K_STA_ID1_ADDR_U16
 0x0000fff‡

	)

1129 
	#AR5K_STA_ID1_AP
 0x00010000

	)

1130 
	#AR5K_STA_ID1_ADHOC
 0x00020000

	)

1131 
	#AR5K_STA_ID1_PWR_SV
 0x00040000

	)

1132 
	#AR5K_STA_ID1_NO_KEYSRCH
 0x00080000

	)

1133 
	#AR5K_STA_ID1_NO_PSPOLL
 0x00100000

	)

1134 
	#AR5K_STA_ID1_PCF_5211
 0x00100000

	)

1135 
	#AR5K_STA_ID1_PCF_5210
 0x00200000

	)

1136 
	#AR5K_STA_ID1_PCF
 (
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
 ? \

1137 
AR5K_STA_ID1_PCF_5210
 : 
AR5K_STA_ID1_PCF_5211
)

	)

1138 
	#AR5K_STA_ID1_DEFAULT_ANTENNA
 0x00200000

	)

1139 
	#AR5K_STA_ID1_DESC_ANTENNA
 0x00400000

	)

1140 
	#AR5K_STA_ID1_RTS_DEF_ANTENNA
 0x00800000

	)

1141 
	#AR5K_STA_ID1_ACKCTS_6MB
 0x01000000

	)

1142 
	#AR5K_STA_ID1_BASE_RATE_11B
 0x02000000

	)

1143 
	#AR5K_STA_ID1_SELFGEN_DEF_ANT
 0x04000000

	)

1144 
	#AR5K_STA_ID1_CRYPT_MIC_EN
 0x08000000

	)

1145 
	#AR5K_STA_ID1_KEYSRCH_MODE
 0x10000000

	)

1146 
	#AR5K_STA_ID1_PRESERVE_SEQ_NUM
 0x20000000

	)

1147 
	#AR5K_STA_ID1_CBCIV_ENDIAN
 0x40000000

	)

1148 
	#AR5K_STA_ID1_KEYSRCH_MCAST
 0x80000000

	)

1150 
	#AR5K_STA_ID1_ANTENNA_SETTINGS
 (
AR5K_STA_ID1_DEFAULT_ANTENNA
 | \

1151 
AR5K_STA_ID1_DESC_ANTENNA
 | \

1152 
AR5K_STA_ID1_RTS_DEF_ANTENNA
 | \

1153 
AR5K_STA_ID1_SELFGEN_DEF_ANT
)

	)

1158 
	#AR5K_BSS_ID0
 0x8008

	)

1165 
	#AR5K_BSS_ID1
 0x800c

	)

1166 
	#AR5K_BSS_ID1_AID
 0xffff0000

	)

1167 
	#AR5K_BSS_ID1_AID_S
 16

	)

1172 
	#AR5K_SLOT_TIME
 0x8010

	)

1177 
	#AR5K_TIME_OUT
 0x8014

	)

1178 
	#AR5K_TIME_OUT_ACK
 0x00001ff‡

	)

1179 
	#AR5K_TIME_OUT_ACK_S
 0

	)

1180 
	#AR5K_TIME_OUT_CTS
 0x1fff0000

	)

1181 
	#AR5K_TIME_OUT_CTS_S
 16

	)

1186 
	#AR5K_RSSI_THR
 0x8018

	)

1187 
	#AR5K_RSSI_THR_M
 0x000000f‡

	)

1188 
	#AR5K_RSSI_THR_BMISS_5210
 0x00000700

	)

1189 
	#AR5K_RSSI_THR_BMISS_5210_S
 8

	)

1190 
	#AR5K_RSSI_THR_BMISS_5211
 0x0000ff00

	)

1191 
	#AR5K_RSSI_THR_BMISS_5211_S
 8

	)

1192 
	#AR5K_RSSI_THR_BMISS
 (
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
 ? \

1193 
AR5K_RSSI_THR_BMISS_5210
 : 
AR5K_RSSI_THR_BMISS_5211
)

	)

1194 
	#AR5K_RSSI_THR_BMISS_S
 8

	)

1209 
	#AR5K_NODCU_RETRY_LMT
 0x801¯

	)

1210 
	#AR5K_NODCU_RETRY_LMT_SH_RETRY
 0x0000000‡

	)

1211 
	#AR5K_NODCU_RETRY_LMT_SH_RETRY_S
 0

	)

1212 
	#AR5K_NODCU_RETRY_LMT_LG_RETRY
 0x000000f0

	)

1213 
	#AR5K_NODCU_RETRY_LMT_LG_RETRY_S
 4

	)

1214 
	#AR5K_NODCU_RETRY_LMT_SSH_RETRY
 0x00003f00

	)

1215 
	#AR5K_NODCU_RETRY_LMT_SSH_RETRY_S
 8

	)

1216 
	#AR5K_NODCU_RETRY_LMT_SLG_RETRY
 0x000fc000

	)

1217 
	#AR5K_NODCU_RETRY_LMT_SLG_RETRY_S
 14

	)

1218 
	#AR5K_NODCU_RETRY_LMT_CW_MIN
 0x3ff00000

	)

1219 
	#AR5K_NODCU_RETRY_LMT_CW_MIN_S
 20

	)

1224 
	#AR5K_USEC_5210
 0x8020

	)

1225 
	#AR5K_USEC_5211
 0x801¯

	)

1226 
	#AR5K_USEC
 (
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
 ? \

1227 
AR5K_USEC_5210
 : 
AR5K_USEC_5211
)

	)

1228 
	#AR5K_USEC_1
 0x0000007‡

	)

1229 
	#AR5K_USEC_1_S
 0

	)

1230 
	#AR5K_USEC_32
 0x00003f80

	)

1231 
	#AR5K_USEC_32_S
 7

	)

1232 
	#AR5K_USEC_TX_LATENCY_5211
 0x007fc000

	)

1233 
	#AR5K_USEC_TX_LATENCY_5211_S
 14

	)

1234 
	#AR5K_USEC_RX_LATENCY_5211
 0x1f800000

	)

1235 
	#AR5K_USEC_RX_LATENCY_5211_S
 23

	)

1236 
	#AR5K_USEC_TX_LATENCY_5210
 0x000fc000

	)

1237 
	#AR5K_USEC_TX_LATENCY_5210_S
 14

	)

1238 
	#AR5K_USEC_RX_LATENCY_5210
 0x03f00000

	)

1239 
	#AR5K_USEC_RX_LATENCY_5210_S
 20

	)

1244 
	#AR5K_BEACON_5210
 0x8024

	)

1245 
	#AR5K_BEACON_5211
 0x8020

	)

1246 
	#AR5K_BEACON
 (
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
 ? \

1247 
AR5K_BEACON_5210
 : 
AR5K_BEACON_5211
)

	)

1248 
	#AR5K_BEACON_PERIOD
 0x0000fff‡

	)

1249 
	#AR5K_BEACON_PERIOD_S
 0

	)

1250 
	#AR5K_BEACON_TIM
 0x007f0000

	)

1251 
	#AR5K_BEACON_TIM_S
 16

	)

1252 
	#AR5K_BEACON_ENABLE
 0x00800000

	)

1253 
	#AR5K_BEACON_RESET_TSF
 0x01000000

	)

1258 
	#AR5K_CFP_PERIOD_5210
 0x8028

	)

1259 
	#AR5K_CFP_PERIOD_5211
 0x8024

	)

1260 
	#AR5K_CFP_PERIOD
 (
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
 ? \

1261 
AR5K_CFP_PERIOD_5210
 : 
AR5K_CFP_PERIOD_5211
)

	)

1266 
	#AR5K_TIMER0_5210
 0x802c

	)

1267 
	#AR5K_TIMER0_5211
 0x8028

	)

1268 
	#AR5K_TIMER0
 (
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
 ? \

1269 
AR5K_TIMER0_5210
 : 
AR5K_TIMER0_5211
)

	)

1274 
	#AR5K_TIMER1_5210
 0x8030

	)

1275 
	#AR5K_TIMER1_5211
 0x802c

	)

1276 
	#AR5K_TIMER1
 (
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
 ? \

1277 
AR5K_TIMER1_5210
 : 
AR5K_TIMER1_5211
)

	)

1282 
	#AR5K_TIMER2_5210
 0x8034

	)

1283 
	#AR5K_TIMER2_5211
 0x8030

	)

1284 
	#AR5K_TIMER2
 (
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
 ? \

1285 
AR5K_TIMER2_5210
 : 
AR5K_TIMER2_5211
)

	)

1290 
	#AR5K_TIMER3_5210
 0x8038

	)

1291 
	#AR5K_TIMER3_5211
 0x8034

	)

1292 
	#AR5K_TIMER3
 (
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
 ? \

1293 
AR5K_TIMER3_5210
 : 
AR5K_TIMER3_5211
)

	)

1299 
	#AR5K_IFS0
 0x8040

	)

1300 
	#AR5K_IFS0_SIFS
 0x000007ff

	)

1301 
	#AR5K_IFS0_SIFS_S
 0

	)

1302 
	#AR5K_IFS0_DIFS
 0x007ff800

	)

1303 
	#AR5K_IFS0_DIFS_S
 11

	)

1308 
	#AR5K_IFS1
 0x8044

	)

1309 
	#AR5K_IFS1_PIFS
 0x00000fff

	)

1310 
	#AR5K_IFS1_PIFS_S
 0

	)

1311 
	#AR5K_IFS1_EIFS
 0x03fff000

	)

1312 
	#AR5K_IFS1_EIFS_S
 12

	)

1313 
	#AR5K_IFS1_CS_EN
 0x04000000

	)

1314 
	#AR5K_IFS1_CS_EN_S
 26

	)

1319 
	#AR5K_CFP_DUR_5210
 0x8048

	)

1320 
	#AR5K_CFP_DUR_5211
 0x8038

	)

1321 
	#AR5K_CFP_DUR
 (
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
 ? \

1322 
AR5K_CFP_DUR_5210
 : 
AR5K_CFP_DUR_5211
)

	)

1327 
	#AR5K_RX_FILTER_5210
 0x804¯

	)

1328 
	#AR5K_RX_FILTER_5211
 0x803¯

	)

1329 
	#AR5K_RX_FILTER
 (
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
 ? \

1330 
AR5K_RX_FILTER_5210
 : 
AR5K_RX_FILTER_5211
)

	)

1331 
	#AR5K_RX_FILTER_UCAST
 0x00000001

	)

1332 
	#AR5K_RX_FILTER_MCAST
 0x00000002

	)

1333 
	#AR5K_RX_FILTER_BCAST
 0x00000004

	)

1334 
	#AR5K_RX_FILTER_CONTROL
 0x00000008

	)

1335 
	#AR5K_RX_FILTER_BEACON
 0x00000010

	)

1336 
	#AR5K_RX_FILTER_PROM
 0x00000020

	)

1337 
	#AR5K_RX_FILTER_XRPOLL
 0x00000040

	)

1338 
	#AR5K_RX_FILTER_PROBEREQ
 0x00000080

	)

1339 
	#AR5K_RX_FILTER_PHYERR_5212
 0x00000100

	)

1340 
	#AR5K_RX_FILTER_RADARERR_5212
 0x00000200

	)

1341 
	#AR5K_RX_FILTER_PHYERR_5211
 0x00000040

	)

1342 
	#AR5K_RX_FILTER_RADARERR_5211
 0x00000080

	)

1343 
	#AR5K_RX_FILTER_PHYERR
 \

1344 ((
ah
->
ah_vîsi⁄
 =
AR5K_AR5211
 ? \

1345 
AR5K_RX_FILTER_PHYERR_5211
 : 
AR5K_RX_FILTER_PHYERR_5212
))

	)

1346 
	#AR5K_RX_FILTER_RADARERR
 \

1347 ((
ah
->
ah_vîsi⁄
 =
AR5K_AR5211
 ? \

1348 
AR5K_RX_FILTER_RADARERR_5211
 : 
AR5K_RX_FILTER_RADARERR_5212
))

	)

1353 
	#AR5K_MCAST_FILTER0_5210
 0x8050

	)

1354 
	#AR5K_MCAST_FILTER0_5211
 0x8040

	)

1355 
	#AR5K_MCAST_FILTER0
 (
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
 ? \

1356 
AR5K_MCAST_FILTER0_5210
 : 
AR5K_MCAST_FILTER0_5211
)

	)

1361 
	#AR5K_MCAST_FILTER1_5210
 0x8054

	)

1362 
	#AR5K_MCAST_FILTER1_5211
 0x8044

	)

1363 
	#AR5K_MCAST_FILTER1
 (
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
 ? \

1364 
AR5K_MCAST_FILTER1_5210
 : 
AR5K_MCAST_FILTER1_5211
)

	)

1370 
	#AR5K_TX_MASK0
 0x8058

	)

1375 
	#AR5K_TX_MASK1
 0x805c

	)

1380 
	#AR5K_CLR_TMASK
 0x8060

	)

1385 
	#AR5K_TRIG_LVL
 0x8064

	)

1393 
	#AR5K_DIAG_SW_5210
 0x8068

	)

1394 
	#AR5K_DIAG_SW_5211
 0x8048

	)

1395 
	#AR5K_DIAG_SW
 (
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
 ? \

1396 
AR5K_DIAG_SW_5210
 : 
AR5K_DIAG_SW_5211
)

	)

1397 
	#AR5K_DIAG_SW_DIS_WEP_ACK
 0x00000001

	)

1398 
	#AR5K_DIAG_SW_DIS_ACK
 0x00000002

	)

1399 
	#AR5K_DIAG_SW_DIS_CTS
 0x00000004

	)

1400 
	#AR5K_DIAG_SW_DIS_ENC
 0x00000008

	)

1401 
	#AR5K_DIAG_SW_DIS_DEC
 0x00000010

	)

1402 
	#AR5K_DIAG_SW_DIS_TX_5210
 0x00000020

	)

1403 
	#AR5K_DIAG_SW_DIS_RX_5210
 0x00000040

	)

1404 
	#AR5K_DIAG_SW_DIS_RX_5211
 0x00000020

	)

1405 
	#AR5K_DIAG_SW_DIS_RX
 (
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
 ? \

1406 
AR5K_DIAG_SW_DIS_RX_5210
 : 
AR5K_DIAG_SW_DIS_RX_5211
)

	)

1407 
	#AR5K_DIAG_SW_LOOP_BACK_5210
 0x00000080

	)

1408 
	#AR5K_DIAG_SW_LOOP_BACK_5211
 0x00000040

	)

1409 
	#AR5K_DIAG_SW_LOOP_BACK
 (
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
 ? \

1410 
AR5K_DIAG_SW_LOOP_BACK_5210
 : 
AR5K_DIAG_SW_LOOP_BACK_5211
)

	)

1411 
	#AR5K_DIAG_SW_CORR_FCS_5210
 0x00000100

	)

1412 
	#AR5K_DIAG_SW_CORR_FCS_5211
 0x00000080

	)

1413 
	#AR5K_DIAG_SW_CORR_FCS
 (
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
 ? \

1414 
AR5K_DIAG_SW_CORR_FCS_5210
 : 
AR5K_DIAG_SW_CORR_FCS_5211
)

	)

1415 
	#AR5K_DIAG_SW_CHAN_INFO_5210
 0x00000200

	)

1416 
	#AR5K_DIAG_SW_CHAN_INFO_5211
 0x00000100

	)

1417 
	#AR5K_DIAG_SW_CHAN_INFO
 (
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
 ? \

1418 
AR5K_DIAG_SW_CHAN_INFO_5210
 : 
AR5K_DIAG_SW_CHAN_INFO_5211
)

	)

1419 
	#AR5K_DIAG_SW_EN_SCRAM_SEED_5210
 0x00000400

	)

1420 
	#AR5K_DIAG_SW_EN_SCRAM_SEED_5211
 0x00000200

	)

1421 
	#AR5K_DIAG_SW_EN_SCRAM_SEED
 (
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
 ? \

1422 
AR5K_DIAG_SW_EN_SCRAM_SEED_5210
 : 
AR5K_DIAG_SW_EN_SCRAM_SEED_5211
)

	)

1423 
	#AR5K_DIAG_SW_ECO_ENABLE
 0x00000400

	)

1424 
	#AR5K_DIAG_SW_SCVRAM_SEED
 0x0003f800

	)

1425 
	#AR5K_DIAG_SW_SCRAM_SEED_M
 0x0001fc00

	)

1426 
	#AR5K_DIAG_SW_SCRAM_SEED_S
 10

	)

1427 
	#AR5K_DIAG_SW_DIS_SEQ_INC_5210
 0x00040000

	)

1428 
	#AR5K_DIAG_SW_FRAME_NV0_5210
 0x00080000

	)

1429 
	#AR5K_DIAG_SW_FRAME_NV0_5211
 0x00020000

	)

1430 
	#AR5K_DIAG_SW_FRAME_NV0
 (
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
 ? \

1431 
AR5K_DIAG_SW_FRAME_NV0_5210
 : 
AR5K_DIAG_SW_FRAME_NV0_5211
)

	)

1432 
	#AR5K_DIAG_SW_OBSPT_M
 0x000c0000

	)

1433 
	#AR5K_DIAG_SW_OBSPT_S
 18

	)

1434 
	#AR5K_DIAG_SW_RX_CLEAR_HIGH
 0x00100000

	)

1435 
	#AR5K_DIAG_SW_IGNORE_CARR_SENSE
 0x00200000

	)

1436 
	#AR5K_DIAG_SW_CHANNEL_IDLE_HIGH
 0x00400000

	)

1437 
	#AR5K_DIAG_SW_PHEAR_ME
 0x00800000

	)

1442 
	#AR5K_TSF_L32_5210
 0x806c

	)

1443 
	#AR5K_TSF_L32_5211
 0x804c

	)

1444 
	#AR5K_TSF_L32
 (
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
 ? \

1445 
AR5K_TSF_L32_5210
 : 
AR5K_TSF_L32_5211
)

	)

1450 
	#AR5K_TSF_U32_5210
 0x8070

	)

1451 
	#AR5K_TSF_U32_5211
 0x8050

	)

1452 
	#AR5K_TSF_U32
 (
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
 ? \

1453 
AR5K_TSF_U32_5210
 : 
AR5K_TSF_U32_5211
)

	)

1458 
	#AR5K_LAST_TSTP
 0x8080

	)

1463 
	#AR5K_ADDAC_TEST
 0x8054

	)

1464 
	#AR5K_ADDAC_TEST_TXCONT
 0x00000001

	)

1465 
	#AR5K_ADDAC_TEST_TST_MODE
 0x00000002

	)

1466 
	#AR5K_ADDAC_TEST_LOOP_EN
 0x00000004

	)

1467 
	#AR5K_ADDAC_TEST_LOOP_LEN
 0x00000008

	)

1468 
	#AR5K_ADDAC_TEST_USE_U8
 0x00004000

	)

1469 
	#AR5K_ADDAC_TEST_MSB
 0x00008000

	)

1470 
	#AR5K_ADDAC_TEST_TRIG_SEL
 0x00010000

	)

1471 
	#AR5K_ADDAC_TEST_TRIG_PTY
 0x00020000

	)

1472 
	#AR5K_ADDAC_TEST_RXCONT
 0x00040000

	)

1473 
	#AR5K_ADDAC_TEST_CAPTURE
 0x00080000

	)

1474 
	#AR5K_ADDAC_TEST_TST_ARM
 0x00100000

	)

1479 
	#AR5K_DEFAULT_ANTENNA
 0x8058

	)

1485 
	#AR5K_FRAME_CTL_QOSM
 0x805c

	)

1490 
	#AR5K_SEQ_MASK
 0x8060

	)

1495 
	#AR5K_RETRY_CNT
 0x8084

	)

1496 
	#AR5K_RETRY_CNT_SSH
 0x0000003‡

	)

1497 
	#AR5K_RETRY_CNT_SLG
 0x00000fc0

	)

1502 
	#AR5K_BACKOFF
 0x8088

	)

1503 
	#AR5K_BACKOFF_CW
 0x000003f‡

	)

1504 
	#AR5K_BACKOFF_CNT
 0x03ff0000

	)

1511 
	#AR5K_NAV_5210
 0x808c

	)

1512 
	#AR5K_NAV_5211
 0x8084

	)

1513 
	#AR5K_NAV
 (
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
 ? \

1514 
AR5K_NAV_5210
 : 
AR5K_NAV_5211
)

	)

1526 
	#AR5K_RTS_OK_5210
 0x8090

	)

1527 
	#AR5K_RTS_OK_5211
 0x8088

	)

1528 
	#AR5K_RTS_OK
 (
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
 ? \

1529 
AR5K_RTS_OK_5210
 : 
AR5K_RTS_OK_5211
)

	)

1534 
	#AR5K_RTS_FAIL_5210
 0x8094

	)

1535 
	#AR5K_RTS_FAIL_5211
 0x808c

	)

1536 
	#AR5K_RTS_FAIL
 (
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
 ? \

1537 
AR5K_RTS_FAIL_5210
 : 
AR5K_RTS_FAIL_5211
)

	)

1542 
	#AR5K_ACK_FAIL_5210
 0x8098

	)

1543 
	#AR5K_ACK_FAIL_5211
 0x8090

	)

1544 
	#AR5K_ACK_FAIL
 (
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
 ? \

1545 
AR5K_ACK_FAIL_5210
 : 
AR5K_ACK_FAIL_5211
)

	)

1550 
	#AR5K_FCS_FAIL_5210
 0x809c

	)

1551 
	#AR5K_FCS_FAIL_5211
 0x8094

	)

1552 
	#AR5K_FCS_FAIL
 (
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
 ? \

1553 
AR5K_FCS_FAIL_5210
 : 
AR5K_FCS_FAIL_5211
)

	)

1558 
	#AR5K_BEACON_CNT_5210
 0x80a0

	)

1559 
	#AR5K_BEACON_CNT_5211
 0x8098

	)

1560 
	#AR5K_BEACON_CNT
 (
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
 ? \

1561 
AR5K_BEACON_CNT_5210
 : 
AR5K_BEACON_CNT_5211
)

	)

1569 
	#AR5K_TPC
 0x80e8

	)

1570 
	#AR5K_TPC_ACK
 0x0000003‡

	)

1571 
	#AR5K_TPC_ACK_S
 0

	)

1572 
	#AR5K_TPC_CTS
 0x00003f00

	)

1573 
	#AR5K_TPC_CTS_S
 8

	)

1574 
	#AR5K_TPC_CHIRP
 0x003f0000

	)

1575 
	#AR5K_TPC_CHIRP_S
 16

	)

1576 
	#AR5K_TPC_DOPPLER
 0x0f000000

	)

1577 
	#AR5K_TPC_DOPPLER_S
 24

	)

1582 
	#AR5K_XRMODE
 0x80c0

	)

1583 
	#AR5K_XRMODE_POLL_TYPE_M
 0x0000003‡

	)

1584 
	#AR5K_XRMODE_POLL_TYPE_S
 0

	)

1585 
	#AR5K_XRMODE_POLL_SUBTYPE_M
 0x0000003¯

	)

1586 
	#AR5K_XRMODE_POLL_SUBTYPE_S
 2

	)

1587 
	#AR5K_XRMODE_POLL_WAIT_ALL
 0x00000080

	)

1588 
	#AR5K_XRMODE_SIFS_DELAY
 0x000fff00

	)

1589 
	#AR5K_XRMODE_FRAME_HOLD_M
 0xfff00000

	)

1590 
	#AR5K_XRMODE_FRAME_HOLD_S
 20

	)

1595 
	#AR5K_XRDELAY
 0x80c4

	)

1596 
	#AR5K_XRDELAY_SLOT_DELAY_M
 0x0000fff‡

	)

1597 
	#AR5K_XRDELAY_SLOT_DELAY_S
 0

	)

1598 
	#AR5K_XRDELAY_CHIRP_DELAY_M
 0xffff0000

	)

1599 
	#AR5K_XRDELAY_CHIRP_DELAY_S
 16

	)

1604 
	#AR5K_XRTIMEOUT
 0x80c8

	)

1605 
	#AR5K_XRTIMEOUT_CHIRP_M
 0x0000fff‡

	)

1606 
	#AR5K_XRTIMEOUT_CHIRP_S
 0

	)

1607 
	#AR5K_XRTIMEOUT_POLL_M
 0xffff0000

	)

1608 
	#AR5K_XRTIMEOUT_POLL_S
 16

	)

1613 
	#AR5K_XRCHIRP
 0x80c¯

	)

1614 
	#AR5K_XRCHIRP_SEND
 0x00000001

	)

1615 
	#AR5K_XRCHIRP_GAP
 0xffff0000

	)

1620 
	#AR5K_XRSTOMP
 0x80d0

	)

1621 
	#AR5K_XRSTOMP_TX
 0x00000001

	)

1622 
	#AR5K_XRSTOMP_RX
 0x00000002

	)

1623 
	#AR5K_XRSTOMP_TX_RSSI
 0x00000004

	)

1624 
	#AR5K_XRSTOMP_TX_BSSID
 0x00000008

	)

1625 
	#AR5K_XRSTOMP_DATA
 0x00000010

	)

1626 
	#AR5K_XRSTOMP_RSSI_THRES
 0x0000ff00

	)

1631 
	#AR5K_SLEEP0
 0x80d4

	)

1632 
	#AR5K_SLEEP0_NEXT_DTIM
 0x0007fff‡

	)

1633 
	#AR5K_SLEEP0_NEXT_DTIM_S
 0

	)

1634 
	#AR5K_SLEEP0_ASSUME_DTIM
 0x00080000

	)

1635 
	#AR5K_SLEEP0_ENH_SLEEP_EN
 0x00100000

	)

1636 
	#AR5K_SLEEP0_CABTO
 0xff000000

	)

1637 
	#AR5K_SLEEP0_CABTO_S
 24

	)

1642 
	#AR5K_SLEEP1
 0x80d8

	)

1643 
	#AR5K_SLEEP1_NEXT_TIM
 0x0007fff‡

	)

1644 
	#AR5K_SLEEP1_NEXT_TIM_S
 0

	)

1645 
	#AR5K_SLEEP1_BEACON_TO
 0xff000000

	)

1646 
	#AR5K_SLEEP1_BEACON_TO_S
 24

	)

1651 
	#AR5K_SLEEP2
 0x80d¯

	)

1652 
	#AR5K_SLEEP2_TIM_PER
 0x0000fff‡

	)

1653 
	#AR5K_SLEEP2_TIM_PER_S
 0

	)

1654 
	#AR5K_SLEEP2_DTIM_PER
 0xffff0000

	)

1655 
	#AR5K_SLEEP2_DTIM_PER_S
 16

	)

1663 
	#AR5K_TXPC
 0x80e8

	)

1664 
	#AR5K_TXPC_ACK_M
 0x0000003‡

	)

1665 
	#AR5K_TXPC_ACK_S
 0

	)

1666 
	#AR5K_TXPC_CTS_M
 0x00003f00

	)

1667 
	#AR5K_TXPC_CTS_S
 8

	)

1668 
	#AR5K_TXPC_CHIRP_M
 0x003f0000

	)

1669 
	#AR5K_TXPC_CHIRP_S
 16

	)

1670 
	#AR5K_TXPC_DOPPLER
 0x0f000000

	)

1671 
	#AR5K_TXPC_DOPPLER_S
 24

	)

1682 
	#AR5K_PROFCNT_TX
 0x80e¯

	)

1683 
	#AR5K_PROFCNT_RX
 0x80f0

	)

1684 
	#AR5K_PROFCNT_RXCLR
 0x80f4

	)

1685 
	#AR5K_PROFCNT_CYCLE
 0x80f8

	)

1690 
	#AR5K_QUIET_CTL1
 0x80f¯

	)

1691 
	#AR5K_QUIET_CTL1_NEXT_QT_TSF
 0x0000fff‡

	)

1692 
	#AR5K_QUIET_CTL1_NEXT_QT_TSF_S
 0

	)

1693 
	#AR5K_QUIET_CTL1_QT_EN
 0x00010000

	)

1694 
	#AR5K_QUIET_CTL1_ACK_CTS_EN
 0x00020000

	)

1696 
	#AR5K_QUIET_CTL2
 0x8100

	)

1697 
	#AR5K_QUIET_CTL2_QT_PER
 0x0000fff‡

	)

1698 
	#AR5K_QUIET_CTL2_QT_PER_S
 0

	)

1699 
	#AR5K_QUIET_CTL2_QT_DUR
 0xffff0000

	)

1700 
	#AR5K_QUIET_CTL2_QT_DUR_S
 16

	)

1705 
	#AR5K_TSF_PARM
 0x8104

	)

1706 
	#AR5K_TSF_PARM_INC
 0x000000f‡

	)

1707 
	#AR5K_TSF_PARM_INC_S
 0

	)

1712 
	#AR5K_QOS_NOACK
 0x8108

	)

1713 
	#AR5K_QOS_NOACK_2BIT_VALUES
 0x0000000‡

	)

1714 
	#AR5K_QOS_NOACK_2BIT_VALUES_S
 0

	)

1715 
	#AR5K_QOS_NOACK_BIT_OFFSET
 0x00000070

	)

1716 
	#AR5K_QOS_NOACK_BIT_OFFSET_S
 4

	)

1717 
	#AR5K_QOS_NOACK_BYTE_OFFSET
 0x00000180

	)

1718 
	#AR5K_QOS_NOACK_BYTE_OFFSET_S
 7

	)

1723 
	#AR5K_PHY_ERR_FIL
 0x810c

	)

1724 
	#AR5K_PHY_ERR_FIL_RADAR
 0x00000020

	)

1725 
	#AR5K_PHY_ERR_FIL_OFDM
 0x00020000

	)

1726 
	#AR5K_PHY_ERR_FIL_CCK
 0x02000000

	)

1731 
	#AR5K_XRLAT_TX
 0x8110

	)

1736 
	#AR5K_ACKSIFS
 0x8114

	)

1737 
	#AR5K_ACKSIFS_INC
 0x00000000

	)

1742 
	#AR5K_MIC_QOS_CTL
 0x8118

	)

1743 
	#AR5K_MIC_QOS_CTL_OFF
(
_n
Ë(1 << (_¿* 2))

	)

1744 
	#AR5K_MIC_QOS_CTL_MQ_EN
 0x00010000

	)

1749 
	#AR5K_MIC_QOS_SEL
 0x811c

	)

1750 
	#AR5K_MIC_QOS_SEL_OFF
(
_n
Ë(1 << (_¿* 4))

	)

1755 
	#AR5K_MISC_MODE
 0x8120

	)

1756 
	#AR5K_MISC_MODE_FBSSID_MATCH
 0x00000001

	)

1757 
	#AR5K_MISC_MODE_ACKSIFS_MEM
 0x00000002

	)

1758 
	#AR5K_MISC_MODE_COMBINED_MIC
 0x00000004

	)

1764 
	#AR5K_OFDM_FIL_CNT
 0x8124

	)

1769 
	#AR5K_CCK_FIL_CNT
 0x8128

	)

1774 
	#AR5K_PHYERR_CNT1
 0x812c

	)

1775 
	#AR5K_PHYERR_CNT1_MASK
 0x8130

	)

1777 
	#AR5K_PHYERR_CNT2
 0x8134

	)

1778 
	#AR5K_PHYERR_CNT2_MASK
 0x8138

	)

1781 
	#ATH5K_PHYERR_CNT_MAX
 0x00c00000

	)

1786 
	#AR5K_TSF_THRES
 0x813c

	)

1796 
	#AR5K_RATE_ACKSIFS_BASE
 0x8680

	)

1797 
	#AR5K_RATE_ACKSIFS
(
_n
Ë(
AR5K_RATE_ACKSIFS_BSE
 + ((_nË<< 2))

	)

1798 
	#AR5K_RATE_ACKSIFS_NORMAL
 0x00000001

	)

1799 
	#AR5K_RATE_ACKSIFS_TURBO
 0x00000400

	)

1804 
	#AR5K_RATE_DUR_BASE
 0x8700

	)

1805 
	#AR5K_RATE_DUR
(
_n
Ë(
AR5K_RATE_DUR_BASE
 + ((_nË<< 2))

	)

1811 
	#AR5K_RATE2DB_BASE
 0x87c0

	)

1812 
	#AR5K_RATE2DB
(
_n
Ë(
AR5K_RATE2DB_BASE
 + ((_nË<< 2))

	)

1818 
	#AR5K_DB2RATE_BASE
 0x87e0

	)

1819 
	#AR5K_DB2RATE
(
_n
Ë(
AR5K_DB2RATE_BASE
 + ((_nË<< 2))

	)

1823 
	#AR5K_KEYTABLE_SIZE_5210
 64

	)

1824 
	#AR5K_KEYTABLE_SIZE_5211
 128

	)

1831 
	#AR5K_PHY_BASE
 0x9800

	)

1832 
	#AR5K_PHY
(
_n
Ë(
AR5K_PHY_BASE
 + ((_nË<< 2))

	)

1837 
	#AR5K_PHY_TST2
 0x9800

	)

1838 
	#AR5K_PHY_TST2_TRIG_SEL
 0x00000007

	)

1839 
	#AR5K_PHY_TST2_TRIG
 0x00000010

	)

1840 
	#AR5K_PHY_TST2_CBUS_MODE
 0x00000060

	)

1841 
	#AR5K_PHY_TST2_CLK32
 0x00000400

	)

1842 
	#AR5K_PHY_TST2_CHANCOR_DUMP_EN
 0x00000800

	)

1843 
	#AR5K_PHY_TST2_EVEN_CHANCOR_DUMP
 0x00001000

	)

1844 
	#AR5K_PHY_TST2_RFSILENT_EN
 0x00002000

	)

1845 
	#AR5K_PHY_TST2_ALT_RFDATA
 0x00004000

	)

1846 
	#AR5K_PHY_TST2_MINI_OBS_EN
 0x00008000

	)

1847 
	#AR5K_PHY_TST2_RX2_IS_RX5_INV
 0x00010000

	)

1848 
	#AR5K_PHY_TST2_SLOW_CLK160
 0x00020000

	)

1849 
	#AR5K_PHY_TST2_AGC_OBS_SEL_3
 0x00040000

	)

1850 
	#AR5K_PHY_TST2_BBB_OBS_SEL
 0x00080000

	)

1851 
	#AR5K_PHY_TST2_ADC_OBS_SEL
 0x00800000

	)

1852 
	#AR5K_PHY_TST2_RX_CLR_SEL
 0x08000000

	)

1853 
	#AR5K_PHY_TST2_FORCE_AGC_CLR
 0x10000000

	)

1854 
	#AR5K_PHY_SHIFT_2GHZ
 0x00004007

	)

1855 
	#AR5K_PHY_SHIFT_5GHZ
 0x00000007

	)

1867 
	#AR5K_PHY_TURBO
 0x9804

	)

1868 
	#AR5K_PHY_TURBO_MODE
 0x00000001

	)

1869 
	#AR5K_PHY_TURBO_SHORT
 0x00000002

	)

1870 
	#AR5K_PHY_TURBO_MIMO
 0x00000004

	)

1876 
	#AR5K_PHY_AGC
 0x9808

	)

1877 
	#AR5K_PHY_TST1
 0x9808

	)

1878 
	#AR5K_PHY_AGC_DISABLE
 0x08000000

	)

1879 
	#AR5K_PHY_TST1_TXHOLD
 0x00003800

	)

1880 
	#AR5K_PHY_TST1_TXSRC_SRC
 0x00000002

	)

1881 
	#AR5K_PHY_TST1_TXSRC_SRC_S
 1

	)

1882 
	#AR5K_PHY_TST1_TXSRC_ALT
 0x00000080

	)

1883 
	#AR5K_PHY_TST1_TXSRC_ALT_S
 7

	)

1889 
	#AR5K_PHY_TIMING_3
 0x9814

	)

1890 
	#AR5K_PHY_TIMING_3_DSC_MAN
 0xff„0000

	)

1891 
	#AR5K_PHY_TIMING_3_DSC_MAN_S
 17

	)

1892 
	#AR5K_PHY_TIMING_3_DSC_EXP
 0x0001e000

	)

1893 
	#AR5K_PHY_TIMING_3_DSC_EXP_S
 13

	)

1898 
	#AR5K_PHY_CHIP_ID
 0x9818

	)

1903 
	#AR5K_PHY_ACT
 0x981¯

	)

1904 
	#AR5K_PHY_ACT_ENABLE
 0x00000001

	)

1905 
	#AR5K_PHY_ACT_DISABLE
 0x00000002

	)

1910 
	#AR5K_PHY_RF_CTL2
 0x9824

	)

1911 
	#AR5K_PHY_RF_CTL2_TXF2TXD_START
 0x0000000‡

	)

1912 
	#AR5K_PHY_RF_CTL2_TXF2TXD_START_S
 0

	)

1914 
	#AR5K_PHY_RF_CTL3
 0x9828

	)

1915 
	#AR5K_PHY_RF_CTL3_TXE2XLNA_ON
 0x0000ff00

	)

1916 
	#AR5K_PHY_RF_CTL3_TXE2XLNA_ON_S
 8

	)

1918 
	#AR5K_PHY_ADC_CTL
 0x982c

	)

1919 
	#AR5K_PHY_ADC_CTL_INBUFGAIN_OFF
 0x00000003

	)

1920 
	#AR5K_PHY_ADC_CTL_INBUFGAIN_OFF_S
 0

	)

1921 
	#AR5K_PHY_ADC_CTL_PWD_DAC_OFF
 0x00002000

	)

1922 
	#AR5K_PHY_ADC_CTL_PWD_BAND_GAP_OFF
 0x00004000

	)

1923 
	#AR5K_PHY_ADC_CTL_PWD_ADC_OFF
 0x00008000

	)

1924 
	#AR5K_PHY_ADC_CTL_INBUFGAIN_ON
 0x00030000

	)

1925 
	#AR5K_PHY_ADC_CTL_INBUFGAIN_ON_S
 16

	)

1927 
	#AR5K_PHY_RF_CTL4
 0x9834

	)

1928 
	#AR5K_PHY_RF_CTL4_TXF2XPA_A_ON
 0x00000001

	)

1929 
	#AR5K_PHY_RF_CTL4_TXF2XPA_B_ON
 0x00000100

	)

1930 
	#AR5K_PHY_RF_CTL4_TXE2XPA_A_OFF
 0x00010000

	)

1931 
	#AR5K_PHY_RF_CTL4_TXE2XPA_B_OFF
 0x01000000

	)

1937 
	#AR5K_PHY_PA_CTL
 0x9838

	)

1938 
	#AR5K_PHY_PA_CTL_XPA_A_HI
 0x00000001

	)

1939 
	#AR5K_PHY_PA_CTL_XPA_B_HI
 0x00000002

	)

1940 
	#AR5K_PHY_PA_CTL_XPA_A_EN
 0x00000004

	)

1941 
	#AR5K_PHY_PA_CTL_XPA_B_EN
 0x00000008

	)

1946 
	#AR5K_PHY_SETTLING
 0x9844

	)

1947 
	#AR5K_PHY_SETTLING_AGC
 0x0000007‡

	)

1948 
	#AR5K_PHY_SETTLING_AGC_S
 0

	)

1949 
	#AR5K_PHY_SETTLING_SWITCH
 0x00003f80

	)

1950 
	#AR5K_PHY_SETTLING_SWITCH_S
 7

	)

1955 
	#AR5K_PHY_GAIN
 0x9848

	)

1956 
	#AR5K_PHY_GAIN_TXRX_ATTEN
 0x0003f000

	)

1957 
	#AR5K_PHY_GAIN_TXRX_ATTEN_S
 12

	)

1958 
	#AR5K_PHY_GAIN_TXRX_RF_MAX
 0x007c0000

	)

1959 
	#AR5K_PHY_GAIN_TXRX_RF_MAX_S
 18

	)

1961 
	#AR5K_PHY_GAIN_OFFSET
 0x984¯

	)

1962 
	#AR5K_PHY_GAIN_OFFSET_RXTX_FLAG
 0x00020000

	)

1968 
	#AR5K_PHY_DESIRED_SIZE
 0x9850

	)

1969 
	#AR5K_PHY_DESIRED_SIZE_ADC
 0x000000f‡

	)

1970 
	#AR5K_PHY_DESIRED_SIZE_ADC_S
 0

	)

1971 
	#AR5K_PHY_DESIRED_SIZE_PGA
 0x0000ff00

	)

1972 
	#AR5K_PHY_DESIRED_SIZE_PGA_S
 8

	)

1973 
	#AR5K_PHY_DESIRED_SIZE_TOT
 0x0ff00000

	)

1974 
	#AR5K_PHY_DESIRED_SIZE_TOT_S
 20

	)

1980 
	#AR5K_PHY_SIG
 0x9858

	)

1981 
	#AR5K_PHY_SIG_FIRSTEP
 0x0003f000

	)

1982 
	#AR5K_PHY_SIG_FIRSTEP_S
 12

	)

1983 
	#AR5K_PHY_SIG_FIRPWR
 0x03fc0000

	)

1984 
	#AR5K_PHY_SIG_FIRPWR_S
 18

	)

1990 
	#AR5K_PHY_AGCCOARSE
 0x985¯

	)

1991 
	#AR5K_PHY_AGCCOARSE_LO
 0x00007f80

	)

1992 
	#AR5K_PHY_AGCCOARSE_LO_S
 7

	)

1993 
	#AR5K_PHY_AGCCOARSE_HI
 0x003f8000

	)

1994 
	#AR5K_PHY_AGCCOARSE_HI_S
 15

	)

1999 
	#AR5K_PHY_AGCCTL
 0x9860

	)

2000 
	#AR5K_PHY_AGCCTL_CAL
 0x00000001

	)

2001 
	#AR5K_PHY_AGCCTL_NF
 0x00000002

	)

2002 
	#AR5K_PHY_AGCCTL_OFDM_DIV_DIS
 0x00000008

	)

2003 
	#AR5K_PHY_AGCCTL_NF_EN
 0x00008000

	)

2004 
	#AR5K_PHY_AGCTL_FLTR_CAL
 0x00010000

	)

2005 
	#AR5K_PHY_AGCCTL_NF_NOUPDATE
 0x00020000

	)

2010 
	#AR5K_PHY_NF
 0x9864

	)

2011 
	#AR5K_PHY_NF_M
 0x000001f‡

	)

2012 
	#AR5K_PHY_NF_SVAL
(
_n
Ë(((_nË& 
AR5K_PHY_NF_M
Ë| (1 << 9))

	)

2013 
	#AR5K_PHY_NF_THRESH62
 0x0007f000

	)

2014 
	#AR5K_PHY_NF_THRESH62_S
 12

	)

2015 
	#AR5K_PHY_NF_MINCCA_PWR
 0x0ff80000

	)

2016 
	#AR5K_PHY_NF_MINCCA_PWR_S
 19

	)

2021 
	#AR5K_PHY_ADCSAT
 0x9868

	)

2022 
	#AR5K_PHY_ADCSAT_ICNT
 0x0001f800

	)

2023 
	#AR5K_PHY_ADCSAT_ICNT_S
 11

	)

2024 
	#AR5K_PHY_ADCSAT_THR
 0x000007e0

	)

2025 
	#AR5K_PHY_ADCSAT_THR_S
 5

	)

2032 
	#AR5K_PHY_WEAK_OFDM_HIGH_THR
 0x9868

	)

2033 
	#AR5K_PHY_WEAK_OFDM_HIGH_THR_M2_COUNT
 0x0000001f

	)

2034 
	#AR5K_PHY_WEAK_OFDM_HIGH_THR_M2_COUNT_S
 0

	)

2035 
	#AR5K_PHY_WEAK_OFDM_HIGH_THR_M1
 0x00„0000

	)

2036 
	#AR5K_PHY_WEAK_OFDM_HIGH_THR_M1_S
 17

	)

2037 
	#AR5K_PHY_WEAK_OFDM_HIGH_THR_M2
 0x7f000000

	)

2038 
	#AR5K_PHY_WEAK_OFDM_HIGH_THR_M2_S
 24

	)

2041 
	#AR5K_PHY_WEAK_OFDM_LOW_THR
 0x986c

	)

2042 
	#AR5K_PHY_WEAK_OFDM_LOW_THR_SELFCOR_EN
 0x00000001

	)

2043 
	#AR5K_PHY_WEAK_OFDM_LOW_THR_M2_COUNT
 0x00003f00

	)

2044 
	#AR5K_PHY_WEAK_OFDM_LOW_THR_M2_COUNT_S
 8

	)

2045 
	#AR5K_PHY_WEAK_OFDM_LOW_THR_M1
 0x001fc000

	)

2046 
	#AR5K_PHY_WEAK_OFDM_LOW_THR_M1_S
 14

	)

2047 
	#AR5K_PHY_WEAK_OFDM_LOW_THR_M2
 0x0„00000

	)

2048 
	#AR5K_PHY_WEAK_OFDM_LOW_THR_M2_S
 21

	)

2054 
	#AR5K_PHY_SCR
 0x9870

	)

2056 
	#AR5K_PHY_SLMT
 0x9874

	)

2057 
	#AR5K_PHY_SLMT_32MHZ
 0x0000007f

	)

2059 
	#AR5K_PHY_SCAL
 0x9878

	)

2060 
	#AR5K_PHY_SCAL_32MHZ
 0x0000000e

	)

2061 
	#AR5K_PHY_SCAL_32MHZ_5311
 0x00000008

	)

2062 
	#AR5K_PHY_SCAL_32MHZ_2417
 0x0000000a

	)

2063 
	#AR5K_PHY_SCAL_32MHZ_HB63
 0x00000032

	)

2068 
	#AR5K_PHY_PLL
 0x987c

	)

2069 
	#AR5K_PHY_PLL_20MHZ
 0x00000013

	)

2071 
	#AR5K_PHY_PLL_40MHZ_5211
 0x00000018

	)

2072 
	#AR5K_PHY_PLL_40MHZ_5212
 0x000000Ø

	)

2073 
	#AR5K_PHY_PLL_40MHZ_5413
 0x00000004

	)

2074 
	#AR5K_PHY_PLL_40MHZ
 (
ah
->
ah_vîsi⁄
 =
AR5K_AR5211
 ? \

2075 
AR5K_PHY_PLL_40MHZ_5211
 : 
AR5K_PHY_PLL_40MHZ_5212
)

	)

2077 
	#AR5K_PHY_PLL_44MHZ_5211
 0x00000019

	)

2078 
	#AR5K_PHY_PLL_44MHZ_5212
 0x000000ab

	)

2079 
	#AR5K_PHY_PLL_44MHZ
 (
ah
->
ah_vîsi⁄
 =
AR5K_AR5211
 ? \

2080 
AR5K_PHY_PLL_44MHZ_5211
 : 
AR5K_PHY_PLL_44MHZ_5212
)

	)

2082 
	#AR5K_PHY_PLL_RF5111
 0x00000000

	)

2083 
	#AR5K_PHY_PLL_RF5112
 0x00000040

	)

2084 
	#AR5K_PHY_PLL_HALF_RATE
 0x00000100

	)

2085 
	#AR5K_PHY_PLL_QUARTER_RATE
 0x00000200

	)

2096 
	#AR5K_RF_BUFFER
 0x989c

	)

2097 
	#AR5K_RF_BUFFER_CONTROL_0
 0x98c0

	)

2098 
	#AR5K_RF_BUFFER_CONTROL_1
 0x98c4

	)

2099 
	#AR5K_RF_BUFFER_CONTROL_2
 0x98c¯

	)

2101 
	#AR5K_RF_BUFFER_CONTROL_3
 0x98d0

	)

2105 
	#AR5K_RF_BUFFER_CONTROL_4
 0x98d4

	)

2110 
	#AR5K_RF_BUFFER_CONTROL_5
 0x98d8

	)

2115 
	#AR5K_RF_BUFFER_CONTROL_6
 0x98d¯

	)

2120 
	#AR5K_PHY_RFSTG
 0x98d4

	)

2121 
	#AR5K_PHY_RFSTG_DISABLE
 0x00000021

	)

2126 
	#AR5K_PHY_BIN_MASK_1
 0x9900

	)

2127 
	#AR5K_PHY_BIN_MASK_2
 0x9904

	)

2128 
	#AR5K_PHY_BIN_MASK_3
 0x9908

	)

2130 
	#AR5K_PHY_BIN_MASK_CTL
 0x990c

	)

2131 
	#AR5K_PHY_BIN_MASK_CTL_MASK_4
 0x00003fff

	)

2132 
	#AR5K_PHY_BIN_MASK_CTL_MASK_4_S
 0

	)

2133 
	#AR5K_PHY_BIN_MASK_CTL_RATE
 0xff000000

	)

2134 
	#AR5K_PHY_BIN_MASK_CTL_RATE_S
 24

	)

2139 
	#AR5K_PHY_ANT_CTL
 0x9910

	)

2140 
	#AR5K_PHY_ANT_CTL_TXRX_EN
 0x00000001

	)

2141 
	#AR5K_PHY_ANT_CTL_SECTORED_ANT
 0x00000004

	)

2142 
	#AR5K_PHY_ANT_CTL_HITUNE5
 0x00000008

	)

2143 
	#AR5K_PHY_ANT_CTL_SWTABLE_IDLE
 0x000003f0

	)

2144 
	#AR5K_PHY_ANT_CTL_SWTABLE_IDLE_S
 4

	)

2149 
	#AR5K_PHY_RX_DELAY
 0x9914

	)

2150 
	#AR5K_PHY_RX_DELAY_M
 0x00003ff‡

	)

2155 
	#AR5K_PHY_MAX_RX_LEN
 0x991c

	)

2161 
	#AR5K_PHY_IQ
 0x9920

	)

2162 
	#AR5K_PHY_IQ_CORR_Q_Q_COFF
 0x0000001‡

	)

2163 
	#AR5K_PHY_IQ_CORR_Q_Q_COFF_S
 0

	)

2164 
	#AR5K_PHY_IQ_CORR_Q_I_COFF
 0x000007e0

	)

2165 
	#AR5K_PHY_IQ_CORR_Q_I_COFF_S
 5

	)

2166 
	#AR5K_PHY_IQ_CORR_ENABLE
 0x00000800

	)

2167 
	#AR5K_PHY_IQ_CAL_NUM_LOG_MAX
 0x0000f000

	)

2168 
	#AR5K_PHY_IQ_CAL_NUM_LOG_MAX_S
 12

	)

2169 
	#AR5K_PHY_IQ_RUN
 0x00010000

	)

2170 
	#AR5K_PHY_IQ_USE_PT_DF
 0x00020000

	)

2171 
	#AR5K_PHY_IQ_EARLY_TRIG_THR
 0x00200000

	)

2172 
	#AR5K_PHY_IQ_PILOT_MASK_EN
 0x10000000

	)

2173 
	#AR5K_PHY_IQ_CHAN_MASK_EN
 0x20000000

	)

2174 
	#AR5K_PHY_IQ_SPUR_FILT_EN
 0x40000000

	)

2175 
	#AR5K_PHY_IQ_SPUR_RSSI_EN
 0x80000000

	)

2182 
	#AR5K_PHY_OFDM_SELFCORR
 0x9924

	)

2183 
	#AR5K_PHY_OFDM_SELFCORR_CYPWR_THR1_EN
 0x00000001

	)

2184 
	#AR5K_PHY_OFDM_SELFCORR_CYPWR_THR1
 0x000000„

	)

2185 
	#AR5K_PHY_OFDM_SELFCORR_CYPWR_THR1_S
 1

	)

2186 
	#AR5K_PHY_OFDM_SELFCORR_CYPWR_THR3
 0x00000100

	)

2187 
	#AR5K_PHY_OFDM_SELFCORR_RSSI_1ATHR_EN
 0x00008000

	)

2188 
	#AR5K_PHY_OFDM_SELFCORR_RSSI_1ATHR
 0x00010000

	)

2189 
	#AR5K_PHY_OFDM_SELFCORR_LSCTHR_HIRSSI
 0x00800000

	)

2194 
	#AR5K_PHY_WARM_RESET
 0x9928

	)

2199 
	#AR5K_PHY_CTL
 0x992¯

	)

2200 
	#AR5K_PHY_CTL_RX_DRAIN_RATE
 0x00000001

	)

2201 
	#AR5K_PHY_CTL_LATE_TX_SIG_SYM
 0x00000002

	)

2202 
	#AR5K_PHY_CTL_GEN_SCRAMBLER
 0x00000004

	)

2203 
	#AR5K_PHY_CTL_TX_ANT_SEL
 0x00000008

	)

2204 
	#AR5K_PHY_CTL_TX_ANT_STATIC
 0x00000010

	)

2205 
	#AR5K_PHY_CTL_RX_ANT_SEL
 0x00000020

	)

2206 
	#AR5K_PHY_CTL_RX_ANT_STATIC
 0x00000040

	)

2207 
	#AR5K_PHY_CTL_LOW_FREQ_SLE_EN
 0x00000080

	)

2212 
	#AR5K_PHY_PAPD_PROBE
 0x9930

	)

2213 
	#AR5K_PHY_PAPD_PROBE_SH_HI_PAR
 0x00000001

	)

2214 
	#AR5K_PHY_PAPD_PROBE_PCDAC_BIAS
 0x00000002

	)

2215 
	#AR5K_PHY_PAPD_PROBE_COMP_GAIN
 0x00000040

	)

2216 
	#AR5K_PHY_PAPD_PROBE_TXPOWER
 0x00007e00

	)

2217 
	#AR5K_PHY_PAPD_PROBE_TXPOWER_S
 9

	)

2218 
	#AR5K_PHY_PAPD_PROBE_TX_NEXT
 0x00008000

	)

2219 
	#AR5K_PHY_PAPD_PROBE_PREDIST_EN
 0x00010000

	)

2220 
	#AR5K_PHY_PAPD_PROBE_TYPE
 0x01800000

	)

2221 
	#AR5K_PHY_PAPD_PROBE_TYPE_S
 23

	)

2222 
	#AR5K_PHY_PAPD_PROBE_TYPE_OFDM
 0

	)

2223 
	#AR5K_PHY_PAPD_PROBE_TYPE_XR
 1

	)

2224 
	#AR5K_PHY_PAPD_PROBE_TYPE_CCK
 2

	)

2225 
	#AR5K_PHY_PAPD_PROBE_GAINF
 0x„000000

	)

2226 
	#AR5K_PHY_PAPD_PROBE_GAINF_S
 25

	)

2227 
	#AR5K_PHY_PAPD_PROBE_INI_5111
 0x00004883

	)

2228 
	#AR5K_PHY_PAPD_PROBE_INI_5112
 0x00004882

	)

2233 
	#AR5K_PHY_TXPOWER_RATE1
 0x9934

	)

2234 
	#AR5K_PHY_TXPOWER_RATE2
 0x9938

	)

2235 
	#AR5K_PHY_TXPOWER_RATE_MAX
 0x993c

	)

2236 
	#AR5K_PHY_TXPOWER_RATE_MAX_TPC_ENABLE
 0x00000040

	)

2237 
	#AR5K_PHY_TXPOWER_RATE3
 0xa234

	)

2238 
	#AR5K_PHY_TXPOWER_RATE4
 0xa238

	)

2243 
	#AR5K_PHY_FRAME_CTL_5210
 0x9804

	)

2244 
	#AR5K_PHY_FRAME_CTL_5211
 0x9944

	)

2245 
	#AR5K_PHY_FRAME_CTL
 (
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
 ? \

2246 
AR5K_PHY_FRAME_CTL_5210
 : 
AR5K_PHY_FRAME_CTL_5211
)

	)

2248 
	#AR5K_PHY_FRAME_CTL_WIN_LEN
 0x00000003

	)

2249 
	#AR5K_PHY_FRAME_CTL_WIN_LEN_S
 0

	)

2250 
	#AR5K_PHY_FRAME_CTL_TX_CLIP
 0x00000038

	)

2251 
	#AR5K_PHY_FRAME_CTL_TX_CLIP_S
 3

	)

2252 
	#AR5K_PHY_FRAME_CTL_PREP_CHINFO
 0x00010000

	)

2253 
	#AR5K_PHY_FRAME_CTL_EMU
 0x80000000

	)

2254 
	#AR5K_PHY_FRAME_CTL_EMU_S
 31

	)

2256 
	#AR5K_PHY_FRAME_CTL_TIMING_ERR
 0x01000000

	)

2257 
	#AR5K_PHY_FRAME_CTL_PARITY_ERR
 0x02000000

	)

2258 
	#AR5K_PHY_FRAME_CTL_ILLRATE_ERR
 0x04000000

	)

2259 
	#AR5K_PHY_FRAME_CTL_ILLLEN_ERR
 0x08000000

	)

2260 
	#AR5K_PHY_FRAME_CTL_SERVICE_ERR
 0x20000000

	)

2261 
	#AR5K_PHY_FRAME_CTL_TXURN_ERR
 0x40000000

	)

2262 
	#AR5K_PHY_FRAME_CTL_INI
 \

2263 (
AR5K_PHY_FRAME_CTL_SERVICE_ERR
 | \

2264 
AR5K_PHY_FRAME_CTL_TXURN_ERR
 | \

2265 
AR5K_PHY_FRAME_CTL_ILLLEN_ERR
 | \

2266 
AR5K_PHY_FRAME_CTL_ILLRATE_ERR
 | \

2267 
AR5K_PHY_FRAME_CTL_PARITY_ERR
 | \

2268 
AR5K_PHY_FRAME_CTL_TIMING_ERR
)

	)

2273 
	#AR5K_PHY_TX_PWR_ADJ
 0x994c

	)

2274 
	#AR5K_PHY_TX_PWR_ADJ_CCK_GAIN_DELTA
 0x00000fc0

	)

2275 
	#AR5K_PHY_TX_PWR_ADJ_CCK_GAIN_DELTA_S
 6

	)

2276 
	#AR5K_PHY_TX_PWR_ADJ_CCK_PCDAC_INDEX
 0x00fc0000

	)

2277 
	#AR5K_PHY_TX_PWR_ADJ_CCK_PCDAC_INDEX_S
 18

	)

2282 
	#AR5K_PHY_RADAR
 0x9954

	)

2283 
	#AR5K_PHY_RADAR_ENABLE
 0x00000001

	)

2284 
	#AR5K_PHY_RADAR_DISABLE
 0x00000000

	)

2285 
	#AR5K_PHY_RADAR_INBANDTHR
 0x0000003ê

	)

2288 
	#AR5K_PHY_RADAR_INBANDTHR_S
 1

	)

2290 
	#AR5K_PHY_RADAR_PRSSI_THR
 0x00000fc0

	)

2293 
	#AR5K_PHY_RADAR_PRSSI_THR_S
 6

	)

2295 
	#AR5K_PHY_RADAR_PHEIGHT_THR
 0x0003f000

	)

2298 
	#AR5K_PHY_RADAR_PHEIGHT_THR_S
 12

	)

2300 
	#AR5K_PHY_RADAR_RSSI_THR
 0x00fc0000

	)

2303 
	#AR5K_PHY_RADAR_RSSI_THR_S
 18

	)

2305 
	#AR5K_PHY_RADAR_FIRPWR_THR
 0x7f000000

	)

2309 
	#AR5K_PHY_RADAR_FIRPWR_THRS
 24

	)

2314 
	#AR5K_PHY_ANT_SWITCH_TABLE_0
 0x9960

	)

2315 
	#AR5K_PHY_ANT_SWITCH_TABLE_1
 0x9964

	)

2320 
	#AR5K_PHY_NFTHRES
 0x9968

	)

2325 
	#AR5K_PHY_SIGMA_DELTA
 0x996C

	)

2326 
	#AR5K_PHY_SIGMA_DELTA_ADC_SEL
 0x00000003

	)

2327 
	#AR5K_PHY_SIGMA_DELTA_ADC_SEL_S
 0

	)

2328 
	#AR5K_PHY_SIGMA_DELTA_FILT2
 0x000000f8

	)

2329 
	#AR5K_PHY_SIGMA_DELTA_FILT2_S
 3

	)

2330 
	#AR5K_PHY_SIGMA_DELTA_FILT1
 0x00001f00

	)

2331 
	#AR5K_PHY_SIGMA_DELTA_FILT1_S
 8

	)

2332 
	#AR5K_PHY_SIGMA_DELTA_ADC_CLIP
 0x01f„000

	)

2333 
	#AR5K_PHY_SIGMA_DELTA_ADC_CLIP_S
 13

	)

2338 
	#AR5K_PHY_RESTART
 0x9970

	)

2339 
	#AR5K_PHY_RESTART_DIV_GC
 0x001c0000

	)

2340 
	#AR5K_PHY_RESTART_DIV_GC_S
 18

	)

2345 
	#AR5K_PHY_RFBUS_REQ
 0x997C

	)

2346 
	#AR5K_PHY_RFBUS_REQ_REQUEST
 0x00000001

	)

2351 
	#AR5K_PHY_TIMING_7
 0x9980

	)

2352 
	#AR5K_PHY_TIMING_8
 0x9984

	)

2353 
	#AR5K_PHY_TIMING_8_PILOT_MASK_2
 0x000fffff

	)

2354 
	#AR5K_PHY_TIMING_8_PILOT_MASK_2_S
 0

	)

2356 
	#AR5K_PHY_BIN_MASK2_1
 0x9988

	)

2357 
	#AR5K_PHY_BIN_MASK2_2
 0x998c

	)

2358 
	#AR5K_PHY_BIN_MASK2_3
 0x9990

	)

2360 
	#AR5K_PHY_BIN_MASK2_4
 0x9994

	)

2361 
	#AR5K_PHY_BIN_MASK2_4_MASK_4
 0x00003fff

	)

2362 
	#AR5K_PHY_BIN_MASK2_4_MASK_4_S
 0

	)

2364 
	#AR5K_PHY_TIMING_9
 0x9998

	)

2365 
	#AR5K_PHY_TIMING_10
 0x999c

	)

2366 
	#AR5K_PHY_TIMING_10_PILOT_MASK_2
 0x000fffff

	)

2367 
	#AR5K_PHY_TIMING_10_PILOT_MASK_2_S
 0

	)

2372 
	#AR5K_PHY_TIMING_11
 0x99a0

	)

2373 
	#AR5K_PHY_TIMING_11_SPUR_DELTA_PHASE
 0x000ffff‡

	)

2374 
	#AR5K_PHY_TIMING_11_SPUR_DELTA_PHASE_S
 0

	)

2375 
	#AR5K_PHY_TIMING_11_SPUR_FREQ_SD
 0x3ff00000

	)

2376 
	#AR5K_PHY_TIMING_11_SPUR_FREQ_SD_S
 20

	)

2377 
	#AR5K_PHY_TIMING_11_USE_SPUR_IN_AGC
 0x40000000

	)

2378 
	#AR5K_PHY_TIMING_11_USE_SPUR_IN_SELFCOR
 0x80000000

	)

2383 
	#AR5K_BB_GAIN_BASE
 0x9b00

	)

2384 
	#AR5K_BB_GAIN
(
_n
Ë(
AR5K_BB_GAIN_BASE
 + ((_nË<< 2))

	)

2385 
	#AR5K_RF_GAIN_BASE
 0x9a00

	)

2386 
	#AR5K_RF_GAIN
(
_n
Ë(
AR5K_RF_GAIN_BASE
 + ((_nË<< 2))

	)

2391 
	#AR5K_PHY_IQRES_CAL_PWR_I
 0x9c10

	)

2392 
	#AR5K_PHY_IQRES_CAL_PWR_Q
 0x9c14

	)

2393 
	#AR5K_PHY_IQRES_CAL_CORR
 0x9c18

	)

2398 
	#AR5K_PHY_CURRENT_RSSI
 0x9c1c

	)

2403 
	#AR5K_PHY_RFBUS_GRANT
 0x9c20

	)

2404 
	#AR5K_PHY_RFBUS_GRANT_OK
 0x00000001

	)

2409 
	#AR5K_PHY_ADC_TEST
 0x9c24

	)

2410 
	#AR5K_PHY_ADC_TEST_I
 0x00000001

	)

2411 
	#AR5K_PHY_ADC_TEST_Q
 0x00000200

	)

2416 
	#AR5K_PHY_DAC_TEST
 0x9c28

	)

2417 
	#AR5K_PHY_DAC_TEST_I
 0x00000001

	)

2418 
	#AR5K_PHY_DAC_TEST_Q
 0x00000200

	)

2423 
	#AR5K_PHY_PTAT
 0x9c2c

	)

2428 
	#AR5K_PHY_BAD_TX_RATE
 0x9c30

	)

2433 
	#AR5K_PHY_SPUR_PWR
 0x9c34

	)

2434 
	#AR5K_PHY_SPUR_PWR_I
 0x00000001

	)

2435 
	#AR5K_PHY_SPUR_PWR_Q
 0x00000100

	)

2436 
	#AR5K_PHY_SPUR_PWR_FILT
 0x00010000

	)

2441 
	#AR5K_PHY_CHAN_STATUS
 0x9c38

	)

2442 
	#AR5K_PHY_CHAN_STATUS_BT_ACT
 0x00000001

	)

2443 
	#AR5K_PHY_CHAN_STATUS_RX_CLR_RAW
 0x00000002

	)

2444 
	#AR5K_PHY_CHAN_STATUS_RX_CLR_MAC
 0x00000004

	)

2445 
	#AR5K_PHY_CHAN_STATUS_RX_CLR_PAP
 0x00000008

	)

2450 
	#AR5K_PHY_HEAVY_CLIP_ENABLE
 0x99e0

	)

2455 
	#AR5K_PHY_SCLOCK
 0x99f0

	)

2456 
	#AR5K_PHY_SCLOCK_32MHZ
 0x0000000c

	)

2457 
	#AR5K_PHY_SDELAY
 0x99f4

	)

2458 
	#AR5K_PHY_SDELAY_32MHZ
 0x000000ff

	)

2459 
	#AR5K_PHY_SPENDING
 0x99f8

	)

2466 
	#AR5K_PHY_PAPD_I_BASE
 0xa000

	)

2467 
	#AR5K_PHY_PAPD_I
(
_n
Ë(
AR5K_PHY_PAPD_I_BASE
 + ((_nË<< 2))

	)

2472 
	#AR5K_PHY_PCDAC_TXPOWER_BASE
 0xa180

	)

2473 
	#AR5K_PHY_PCDAC_TXPOWER
(
_n
Ë(
AR5K_PHY_PCDAC_TXPOWER_BASE
 + ((_nË<< 2))

	)

2478 
	#AR5K_PHY_MODE
 0x0a200

	)

2479 
	#AR5K_PHY_MODE_MOD
 0x00000001

	)

2480 
	#AR5K_PHY_MODE_MOD_OFDM
 0

	)

2481 
	#AR5K_PHY_MODE_MOD_CCK
 1

	)

2482 
	#AR5K_PHY_MODE_FREQ
 0x00000002

	)

2483 
	#AR5K_PHY_MODE_FREQ_5GHZ
 0

	)

2484 
	#AR5K_PHY_MODE_FREQ_2GHZ
 2

	)

2485 
	#AR5K_PHY_MODE_MOD_DYN
 0x00000004

	)

2486 
	#AR5K_PHY_MODE_RAD
 0x00000008

	)

2487 
	#AR5K_PHY_MODE_RAD_RF5111
 0

	)

2488 
	#AR5K_PHY_MODE_RAD_RF5112
 8

	)

2489 
	#AR5K_PHY_MODE_XR
 0x00000010

	)

2490 
	#AR5K_PHY_MODE_HALF_RATE
 0x00000020

	)

2491 
	#AR5K_PHY_MODE_QUARTER_RATE
 0x00000040

	)

2496 
	#AR5K_PHY_CCKTXCTL
 0xa204

	)

2497 
	#AR5K_PHY_CCKTXCTL_WORLD
 0x00000000

	)

2498 
	#AR5K_PHY_CCKTXCTL_JAPAN
 0x00000010

	)

2499 
	#AR5K_PHY_CCKTXCTL_SCRAMBLER_DIS
 0x00000001

	)

2500 
	#AR5K_PHY_CCKTXCTK_DAC_SCALE
 0x00000004

	)

2505 
	#AR5K_PHY_CCK_CROSSCORR
 0xa208

	)

2506 
	#AR5K_PHY_CCK_CROSSCORR_WEAK_SIG_THR
 0x0000003f

	)

2507 
	#AR5K_PHY_CCK_CROSSCORR_WEAK_SIG_THR_S
 0

	)

2510 
	#AR5K_PHY_FAST_ANT_DIV
 0xa208

	)

2511 
	#AR5K_PHY_FAST_ANT_DIV_EN
 0x00002000

	)

2516 
	#AR5K_PHY_GAIN_2GHZ
 0xa20c

	)

2517 
	#AR5K_PHY_GAIN_2GHZ_MARGIN_TXRX
 0x00fc0000

	)

2518 
	#AR5K_PHY_GAIN_2GHZ_MARGIN_TXRX_S
 18

	)

2519 
	#AR5K_PHY_GAIN_2GHZ_INI_5111
 0x6480416c

	)

2521 
	#AR5K_PHY_CCK_RX_CTL_4
 0xa21c

	)

2522 
	#AR5K_PHY_CCK_RX_CTL_4_FREQ_EST_SHORT
 0x01f80000

	)

2523 
	#AR5K_PHY_CCK_RX_CTL_4_FREQ_EST_SHORT_S
 19

	)

2525 
	#AR5K_PHY_DAG_CCK_CTL
 0xa228

	)

2526 
	#AR5K_PHY_DAG_CCK_CTL_EN_RSSI_THR
 0x00000200

	)

2527 
	#AR5K_PHY_DAG_CCK_CTL_RSSI_THR
 0x0001fc00

	)

2528 
	#AR5K_PHY_DAG_CCK_CTL_RSSI_THR_S
 10

	)

2530 
	#AR5K_PHY_FAST_ADC
 0xa24c

	)

2532 
	#AR5K_PHY_BLUETOOTH
 0xa254

	)

2538 
	#AR5K_PHY_TPC_RG1
 0xa258

	)

2539 
	#AR5K_PHY_TPC_RG1_NUM_PD_GAIN
 0x0000c000

	)

2540 
	#AR5K_PHY_TPC_RG1_NUM_PD_GAIN_S
 14

	)

2541 
	#AR5K_PHY_TPC_RG1_PDGAIN_1
 0x00030000

	)

2542 
	#AR5K_PHY_TPC_RG1_PDGAIN_1_S
 16

	)

2543 
	#AR5K_PHY_TPC_RG1_PDGAIN_2
 0x000c0000

	)

2544 
	#AR5K_PHY_TPC_RG1_PDGAIN_2_S
 18

	)

2545 
	#AR5K_PHY_TPC_RG1_PDGAIN_3
 0x00300000

	)

2546 
	#AR5K_PHY_TPC_RG1_PDGAIN_3_S
 20

	)

2548 
	#AR5K_PHY_TPC_RG5
 0xa26C

	)

2549 
	#AR5K_PHY_TPC_RG5_PD_GAIN_OVERLAP
 0x0000000F

	)

2550 
	#AR5K_PHY_TPC_RG5_PD_GAIN_OVERLAP_S
 0

	)

2551 
	#AR5K_PHY_TPC_RG5_PD_GAIN_BOUNDARY_1
 0x000003F0

	)

2552 
	#AR5K_PHY_TPC_RG5_PD_GAIN_BOUNDARY_1_S
 4

	)

2553 
	#AR5K_PHY_TPC_RG5_PD_GAIN_BOUNDARY_2
 0x0000FC00

	)

2554 
	#AR5K_PHY_TPC_RG5_PD_GAIN_BOUNDARY_2_S
 10

	)

2555 
	#AR5K_PHY_TPC_RG5_PD_GAIN_BOUNDARY_3
 0x003F0000

	)

2556 
	#AR5K_PHY_TPC_RG5_PD_GAIN_BOUNDARY_3_S
 16

	)

2557 
	#AR5K_PHY_TPC_RG5_PD_GAIN_BOUNDARY_4
 0x0FC00000

	)

2558 
	#AR5K_PHY_TPC_RG5_PD_GAIN_BOUNDARY_4_S
 22

	)

2563 
	#AR5K_PHY_PDADC_TXPOWER_BASE
 0xa280

	)

2564 
	#AR5K_PHY_PDADC_TXPOWER
(
_n
Ë(
AR5K_PHY_PDADC_TXPOWER_BASE
 + ((_nË<< 2))

	)

2569 
	#AR5K_AR5312_RESET
 0xbc003020

	)

2570 
	#AR5K_AR5312_RESET_BB0_COLD
 0x00000004

	)

2571 
	#AR5K_AR5312_RESET_BB1_COLD
 0x00000200

	)

2572 
	#AR5K_AR5312_RESET_WMAC0
 0x00002000

	)

2573 
	#AR5K_AR5312_RESET_BB0_WARM
 0x00004000

	)

2574 
	#AR5K_AR5312_RESET_WMAC1
 0x00020000

	)

2575 
	#AR5K_AR5312_RESET_BB1_WARM
 0x00040000

	)

2577 
	#AR5K_AR5312_ENABLE
 0xbc003080

	)

2578 
	#AR5K_AR5312_ENABLE_WLAN0
 0x00000001

	)

2579 
	#AR5K_AR5312_ENABLE_WLAN1
 0x00000008

	)

2581 
	#AR5K_AR2315_RESET
 0xb1000004

	)

2582 
	#AR5K_AR2315_RESET_WMAC
 0x00000001

	)

2583 
	#AR5K_AR2315_RESET_BB_WARM
 0x00000002

	)

2585 
	#AR5K_AR2315_AHB_ARB_CTL
 0xb1000008

	)

2586 
	#AR5K_AR2315_AHB_ARB_CTL_WLAN
 0x00000002

	)

2588 
	#AR5K_AR2315_BYTESWAP
 0xb100000c

	)

2589 
	#AR5K_AR2315_BYTESWAP_WMAC
 0x00000002

	)

	@ath5k/reset.c

26 
	~<asm/u«lig√d.h
>

28 
	~<löux/pci.h
>

29 
	~<löux/log2.h
>

30 
	~<löux/∂©f‹m_devi˚.h
>

31 
	~"©h5k.h
"

32 
	~"ªg.h
"

33 
	~"ba£.h
"

34 
	~"debug.h
"

44 
	$©h5k_hw_ªgi°î_timeout
(
©h5k_hw
 *
ah
, 
u32
 
ªg
, u32 
Êag
, u32 
vÆ
,

45 
boﬁ
 
is_£t
)

47 
i
;

48 
u32
 
d©a
;

50 
i
 = 
AR5K_TUNE_REGISTER_TIMEOUT
; i > 0; i--) {

51 
d©a
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
ªg
);

52 i‡(
is_£t
 && (
d©a
 & 
Êag
))

54 i‡((
d©a
 & 
Êag
Ë=
vÆ
)

56 
	`udñay
(15);

59  (
i
 <0Ë? -
EAGAIN
 : 0;

60 
	}
}

73 
	$©h5k_hw_hto˛ock
(
©h5k_hw
 *
ah
, 
u£c
)

75 
©h_comm⁄
 *
comm⁄
 = 
	`©h5k_hw_comm⁄
(
ah
);

76  
u£c
 * 
comm⁄
->
˛ockøã
;

77 
	}
}

83 
	$©h5k_hw_˛ocktoh
(
©h5k_hw
 *
ah
, 
˛ock
)

85 
©h_comm⁄
 *
comm⁄
 = 
	`©h5k_hw_comm⁄
(
ah
);

86  
˛ock
 / 
comm⁄
->
˛ockøã
;

87 
	}
}

96 
	$©h5k_hw_öô_c‹e_˛ock
(
©h5k_hw
 *
ah
)

98 
õì80211_ch™√l
 *
ch™√l
 = 
ah
->
ah_cuºít_ch™√l
;

99 
©h_comm⁄
 *
comm⁄
 = 
	`©h5k_hw_comm⁄
(
ah
);

100 
u32
 
u£c_ªg
, 
txœt
, 
rxœt
, 
u£c
, 
˛ock
, 
s˛ock
, 
txf2txs
;

105 i‡(
ch™√l
->
hw_vÆue
 & 
CHANNEL_5GHZ
)

106 
˛ock
 = 40;

107 i‡(
ch™√l
->
hw_vÆue
 & 
CHANNEL_CCK
)

108 
˛ock
 = 22;

110 
˛ock
 = 44;

114 
ah
->
ah_bwmode
) {

115 
AR5K_BWMODE_40MHZ
:

116 
˛ock
 *= 2;

118 
AR5K_BWMODE_10MHZ
:

119 
˛ock
 /= 2;

121 
AR5K_BWMODE_5MHZ
:

122 
˛ock
 /= 4;

128 
comm⁄
->
˛ockøã
 = 
˛ock
;

134 
u£c
 = 
˛ock
 - 1;

135 
u£c
 = 
	`AR5K_REG_SM
(u£c, 
AR5K_USEC_1
);

138 i‡(
ah
->
ah_vîsi⁄
 !
AR5K_AR5210
)

139 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_DCU_GBL_IFS_MISC
,

140 
AR5K_DCU_GBL_IFS_MISC_USEC_DUR
,

141 
˛ock
);

144 i‡((
ah
->
ah_ødio
 =
AR5K_RF5112
) ||

145 (
ah
->
ah_ødio
 =
AR5K_RF2413
) ||

146 (
ah
->
ah_ødio
 =
AR5K_RF5413
) ||

147 (
ah
->
ah_ødio
 =
AR5K_RF2316
) ||

148 (
ah
->
ah_ødio
 =
AR5K_RF2317
))

150 
s˛ock
 = 40 - 1;

152 
s˛ock
 = 32 - 1;

153 
s˛ock
 = 
	`AR5K_REG_SM
(s˛ock, 
AR5K_USEC_32
);

158 
u£c_ªg
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_USEC_5211
);

159 
txœt
 = 
	`AR5K_REG_MS
(
u£c_ªg
, 
AR5K_USEC_TX_LATENCY_5211
);

160 
rxœt
 = 
	`AR5K_REG_MS
(
u£c_ªg
, 
AR5K_USEC_RX_LATENCY_5211
);

165 
txf2txs
 = 
AR5K_INIT_TXF2TXD_START_DEFAULT
;

172 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
) {

174 
txœt
 = 
AR5K_INIT_TX_LATENCY_5210
;

175 
rxœt
 = 
AR5K_INIT_RX_LATENCY_5210
;

178 i‡(
ah
->
ah_mac_§ev
 < 
AR5K_SREV_AR5211
) {

186 
txœt
 = 
	`AR5K_REG_SM
—xœt, 
AR5K_USEC_TX_LATENCY_5210
);

187 
rxœt
 = 
	`AR5K_REG_SM
‘xœt, 
AR5K_USEC_RX_LATENCY_5210
);

189 
ah
->
ah_bwmode
) {

190 
AR5K_BWMODE_10MHZ
:

191 
txœt
 = 
	`AR5K_REG_SM
(txlat * 2,

192 
AR5K_USEC_TX_LATENCY_5211
);

193 
rxœt
 = 
	`AR5K_REG_SM
(
AR5K_INIT_RX_LAT_MAX
,

194 
AR5K_USEC_RX_LATENCY_5211
);

195 
txf2txs
 = 
AR5K_INIT_TXF2TXD_START_DELAY_10MHZ
;

197 
AR5K_BWMODE_5MHZ
:

198 
txœt
 = 
	`AR5K_REG_SM
(txlat * 4,

199 
AR5K_USEC_TX_LATENCY_5211
);

200 
rxœt
 = 
	`AR5K_REG_SM
(
AR5K_INIT_RX_LAT_MAX
,

201 
AR5K_USEC_RX_LATENCY_5211
);

202 
txf2txs
 = 
AR5K_INIT_TXF2TXD_START_DELAY_5MHZ
;

204 
AR5K_BWMODE_40MHZ
:

205 
txœt
 = 
AR5K_INIT_TX_LAT_MIN
;

206 
rxœt
 = 
	`AR5K_REG_SM
(rxlat / 2,

207 
AR5K_USEC_RX_LATENCY_5211
);

208 
txf2txs
 = 
AR5K_INIT_TXF2TXD_START_DEFAULT
;

214 
u£c_ªg
 = (
u£c
 | 
s˛ock
 | 
txœt
 | 
rxœt
);

215 
	`©h5k_hw_ªg_wrôe
(
ah
, 
u£c_ªg
, 
AR5K_USEC
);

218 i‡(
ah
->
ah_ødio
 =
AR5K_RF5112
) {

219 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_RF_CTL2
,

220 
AR5K_PHY_RF_CTL2_TXF2TXD_START
,

221 
txf2txs
);

223 
	}
}

234 
	$©h5k_hw_£t_¶ìp_˛ock
(
©h5k_hw
 *
ah
, 
boﬁ
 
íabÀ
)

236 
©h5k_ì¥om_öfo
 *
ì
 = &
ah
->
ah_ˇ∑bûôõs
.
ˇp_ì¥om
;

237 
u32
 
sˇl
, 
•ídög
, 
s˛ock
;

241 i‡((
	`AR5K_EEPROM_HAS32KHZCRYSTAL
(
ì
->
ì_misc1
) ||

242 
	`AR5K_EEPROM_HAS32KHZCRYSTAL_OLD
(
ì
->
ì_misc1
)) &&

243 
íabÀ
) {

246 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_USEC_5211
, 
AR5K_USEC_32
, 1);

248 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_TSF_PARM
, 
AR5K_TSF_PARM_INC
, 61);

252 
	`©h5k_hw_ªg_wrôe
(
ah
, 0x1f, 
AR5K_PHY_SCR
);

254 i‡((
ah
->
ah_ødio
 =
AR5K_RF5112
) ||

255 (
ah
->
ah_ødio
 =
AR5K_RF5413
) ||

256 (
ah
->
ah_ødio
 =
AR5K_RF2316
) ||

257 (
ah
->
ah_mac_vîsi⁄
 =(
AR5K_SREV_AR2417
 >> 4)))

258 
•ídög
 = 0x14;

260 
•ídög
 = 0x18;

261 
	`©h5k_hw_ªg_wrôe
(
ah
, 
•ídög
, 
AR5K_PHY_SPENDING
);

263 i‡((
ah
->
ah_ødio
 =
AR5K_RF5112
) ||

264 (
ah
->
ah_ødio
 =
AR5K_RF5413
) ||

265 (
ah
->
ah_mac_vîsi⁄
 =(
AR5K_SREV_AR2417
 >> 4))) {

266 
	`©h5k_hw_ªg_wrôe
(
ah
, 0x26, 
AR5K_PHY_SLMT
);

267 
	`©h5k_hw_ªg_wrôe
(
ah
, 0x0d, 
AR5K_PHY_SCAL
);

268 
	`©h5k_hw_ªg_wrôe
(
ah
, 0x07, 
AR5K_PHY_SCLOCK
);

269 
	`©h5k_hw_ªg_wrôe
(
ah
, 0x3f, 
AR5K_PHY_SDELAY
);

270 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PCICFG
,

271 
AR5K_PCICFG_SLEEP_CLOCK_RATE
, 0x02);

273 
	`©h5k_hw_ªg_wrôe
(
ah
, 0x0a, 
AR5K_PHY_SLMT
);

274 
	`©h5k_hw_ªg_wrôe
(
ah
, 0x0c, 
AR5K_PHY_SCAL
);

275 
	`©h5k_hw_ªg_wrôe
(
ah
, 0x03, 
AR5K_PHY_SCLOCK
);

276 
	`©h5k_hw_ªg_wrôe
(
ah
, 0x20, 
AR5K_PHY_SDELAY
);

277 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PCICFG
,

278 
AR5K_PCICFG_SLEEP_CLOCK_RATE
, 0x03);

282 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_PCICFG
,

283 
AR5K_PCICFG_SLEEP_CLOCK_EN
);

289 
	`AR5K_REG_DISABLE_BITS
(
ah
, 
AR5K_PCICFG
,

290 
AR5K_PCICFG_SLEEP_CLOCK_EN
);

292 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PCICFG
,

293 
AR5K_PCICFG_SLEEP_CLOCK_RATE
, 0);

296 
	`©h5k_hw_ªg_wrôe
(
ah
, 0x1f, 
AR5K_PHY_SCR
);

297 
	`©h5k_hw_ªg_wrôe
(
ah
, 
AR5K_PHY_SLMT_32MHZ
, 
AR5K_PHY_SLMT
);

299 i‡(
ah
->
ah_mac_vîsi⁄
 =(
AR5K_SREV_AR2417
 >> 4))

300 
sˇl
 = 
AR5K_PHY_SCAL_32MHZ_2417
;

301 i‡(
ì
->
ì_is_hb63
)

302 
sˇl
 = 
AR5K_PHY_SCAL_32MHZ_HB63
;

304 
sˇl
 = 
AR5K_PHY_SCAL_32MHZ
;

305 
	`©h5k_hw_ªg_wrôe
(
ah
, 
sˇl
, 
AR5K_PHY_SCAL
);

307 
	`©h5k_hw_ªg_wrôe
(
ah
, 
AR5K_PHY_SCLOCK_32MHZ
, 
AR5K_PHY_SCLOCK
);

308 
	`©h5k_hw_ªg_wrôe
(
ah
, 
AR5K_PHY_SDELAY_32MHZ
, 
AR5K_PHY_SDELAY
);

310 i‡((
ah
->
ah_ødio
 =
AR5K_RF5112
) ||

311 (
ah
->
ah_ødio
 =
AR5K_RF5413
) ||

312 (
ah
->
ah_ødio
 =
AR5K_RF2316
) ||

313 (
ah
->
ah_mac_vîsi⁄
 =(
AR5K_SREV_AR2417
 >> 4)))

314 
•ídög
 = 0x14;

316 
•ídög
 = 0x18;

317 
	`©h5k_hw_ªg_wrôe
(
ah
, 
•ídög
, 
AR5K_PHY_SPENDING
);

320 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_TSF_PARM
, 
AR5K_TSF_PARM_INC
, 1);

322 i‡((
ah
->
ah_ødio
 =
AR5K_RF5112
) ||

323 (
ah
->
ah_ødio
 =
AR5K_RF5413
) ||

324 (
ah
->
ah_ødio
 =
AR5K_RF2316
) ||

325 (
ah
->
ah_ødio
 =
AR5K_RF2317
))

326 
s˛ock
 = 40 - 1;

328 
s˛ock
 = 32 - 1;

329 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_USEC_5211
, 
AR5K_USEC_32
, 
s˛ock
);

331 
	}
}

341 
	$©h5k_hw_nic_ª£t
(
©h5k_hw
 *
ah
, 
u32
 
vÆ
)

343 
ªt
;

344 
u32
 
mask
 = 
vÆ
 ? val : ~0U;

347 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_RXDP
);

352 
	`©h5k_hw_ªg_wrôe
(
ah
, 
vÆ
, 
AR5K_RESET_CTL
);

355 
	`udñay
(15);

357 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
) {

358 
vÆ
 &
AR5K_RESET_CTL_PCU
 | 
AR5K_RESET_CTL_DMA


359 | 
AR5K_RESET_CTL_MAC
 | 
AR5K_RESET_CTL_PHY
;

360 
mask
 &
AR5K_RESET_CTL_PCU
 | 
AR5K_RESET_CTL_DMA


361 | 
AR5K_RESET_CTL_MAC
 | 
AR5K_RESET_CTL_PHY
;

363 
vÆ
 &
AR5K_RESET_CTL_PCU
 | 
AR5K_RESET_CTL_BASEBAND
;

364 
mask
 &
AR5K_RESET_CTL_PCU
 | 
AR5K_RESET_CTL_BASEBAND
;

367 
ªt
 = 
	`©h5k_hw_ªgi°î_timeout
(
ah
, 
AR5K_RESET_CTL
, 
mask
, 
vÆ
, 
Ál£
);

374 i‡((
vÆ
 & 
AR5K_RESET_CTL_PCU
) == 0)

375 
	`©h5k_hw_ªg_wrôe
(
ah
, 
AR5K_INIT_CFG
, 
AR5K_CFG
);

377  
ªt
;

378 
	}
}

385 
	$©h5k_hw_wisoc_ª£t
(
©h5k_hw
 *
ah
, 
u32
 
Êags
)

387 
u32
 
mask
 = 
Êags
 ? flags : ~0U;

388 
u32
 
__iomem
 *
ªg
;

389 
u32
 
ªgvÆ
;

390 
u32
 
vÆ
 = 0;

393 i‡(
ah
->
devid
 >
AR5K_SREV_AR2315_R6
) {

394 
ªg
 = (
u32
 
__iomem
 *Ë
AR5K_AR2315_RESET
;

395 i‡(
mask
 & 
AR5K_RESET_CTL_PCU
)

396 
vÆ
 |
AR5K_AR2315_RESET_WMAC
;

397 i‡(
mask
 & 
AR5K_RESET_CTL_BASEBAND
)

398 
vÆ
 |
AR5K_AR2315_RESET_BB_WARM
;

400 
ªg
 = (
u32
 
__iomem
 *Ë
AR5K_AR5312_RESET
;

401 i‡(
	`to_∂©f‹m_devi˚
(
ah
->
dev
)->
id
 == 0) {

402 i‡(
mask
 & 
AR5K_RESET_CTL_PCU
)

403 
vÆ
 |
AR5K_AR5312_RESET_WMAC0
;

404 i‡(
mask
 & 
AR5K_RESET_CTL_BASEBAND
)

405 
vÆ
 |
AR5K_AR5312_RESET_BB0_COLD
 |

406 
AR5K_AR5312_RESET_BB0_WARM
;

408 i‡(
mask
 & 
AR5K_RESET_CTL_PCU
)

409 
vÆ
 |
AR5K_AR5312_RESET_WMAC1
;

410 i‡(
mask
 & 
AR5K_RESET_CTL_BASEBAND
)

411 
vÆ
 |
AR5K_AR5312_RESET_BB1_COLD
 |

412 
AR5K_AR5312_RESET_BB1_WARM
;

417 
ªgvÆ
 = 
	`__øw_ªadl
(
ªg
);

418 
	`__øw_wrôñ
(
ªgvÆ
 | 
vÆ
, 
ªg
);

419 
ªgvÆ
 = 
	`__øw_ªadl
(
ªg
);

420 
	`udñay
(100);

423 
	`__øw_wrôñ
(
ªgvÆ
 & ~
vÆ
, 
ªg
);

424 
ªgvÆ
 = 
	`__øw_ªadl
(
ªg
);

431 i‡((
Êags
 & 
AR5K_RESET_CTL_PCU
) == 0)

432 
	`©h5k_hw_ªg_wrôe
(
ah
, 
AR5K_INIT_CFG
, 
AR5K_CFG
);

435 
	}
}

441 
	$©h5k_hw_£t_powî
(
©h5k_hw
 *
ah
, 
©h5k_powî_mode
 
mode
,

442 
boﬁ
 
£t_chù
, 
u16
 
¶ìp_duøti⁄
)

444 
i
;

445 
u32
 
°aid
, 
d©a
;

447 
°aid
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_STA_ID1
);

449 
mode
) {

450 
AR5K_PM_AUTO
:

451 
°aid
 &~
AR5K_STA_ID1_DEFAULT_ANTENNA
;

453 
AR5K_PM_NETWORK_SLEEP
:

454 i‡(
£t_chù
)

455 
	`©h5k_hw_ªg_wrôe
(
ah
,

456 
AR5K_SLEEP_CTL_SLE_ALLOW
 |

457 
¶ìp_duøti⁄
,

458 
AR5K_SLEEP_CTL
);

460 
°aid
 |
AR5K_STA_ID1_PWR_SV
;

463 
AR5K_PM_FULL_SLEEP
:

464 i‡(
£t_chù
)

465 
	`©h5k_hw_ªg_wrôe
(
ah
, 
AR5K_SLEEP_CTL_SLE_SLP
,

466 
AR5K_SLEEP_CTL
);

468 
°aid
 |
AR5K_STA_ID1_PWR_SV
;

471 
AR5K_PM_AWAKE
:

473 
°aid
 &~
AR5K_STA_ID1_PWR_SV
;

475 i‡(!
£t_chù
)

476 
commô
;

478 
d©a
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_SLEEP_CTL
);

483 i‡(
d©a
 & 0xffc00000)

484 
d©a
 = 0;

487 
d©a
 = d©®& ~
AR5K_SLEEP_CTL_SLE
;

489 
	`©h5k_hw_ªg_wrôe
(
ah
, 
d©a
 | 
AR5K_SLEEP_CTL_SLE_WAKE
,

490 
AR5K_SLEEP_CTL
);

491 
	`udñay
(15);

493 
i
 = 200; i > 0; i--) {

495 i‡((
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PCICFG
) &

496 
AR5K_PCICFG_SPWR_DN
) == 0)

500 
	`udñay
(50);

501 
	`©h5k_hw_ªg_wrôe
(
ah
, 
d©a
 | 
AR5K_SLEEP_CTL_SLE_WAKE
,

502 
AR5K_SLEEP_CTL
);

506 i‡(
i
 == 0)

507  -
EIO
;

512  -
EINVAL
;

515 
commô
:

516 
	`©h5k_hw_ªg_wrôe
(
ah
, 
°aid
, 
AR5K_STA_ID1
);

519 
	}
}

531 
	$©h5k_hw_⁄_hﬁd
(
©h5k_hw
 *
ah
)

533 
pci_dev
 *
pdev
 = 
ah
->pdev;

534 
u32
 
bus_Êags
;

535 
ªt
;

537 i‡(
	`©h5k_gë_bus_ty≥
(
ah
Ë=
ATH_AHB
)

541 
ªt
 = 
	`©h5k_hw_£t_powî
(
ah
, 
AR5K_PM_AWAKE
, 
åue
, 0);

542 i‡(
ªt
) {

543 
	`ATH5K_ERR
(
ah
, "failedÅo wakeupÅhe MAC Chip\n");

544  
ªt
;

555 
bus_Êags
 = (
pdev
 && 
	`pci_is_pcõ
’dev)Ë? 0 : 
AR5K_RESET_CTL_PCI
;

557 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
) {

558 
ªt
 = 
	`©h5k_hw_nic_ª£t
(
ah
, 
AR5K_RESET_CTL_PCU
 |

559 
AR5K_RESET_CTL_MAC
 | 
AR5K_RESET_CTL_DMA
 |

560 
AR5K_RESET_CTL_PHY
 | 
AR5K_RESET_CTL_PCI
);

561 
	`mdñay
(2);

563 
ªt
 = 
	`©h5k_hw_nic_ª£t
(
ah
, 
AR5K_RESET_CTL_PCU
 |

564 
AR5K_RESET_CTL_BASEBAND
 | 
bus_Êags
);

567 i‡(
ªt
) {

568 
	`ATH5K_ERR
(
ah
, "failedÅoÖut device on warmÑeset\n");

569  -
EIO
;

573 
ªt
 = 
	`©h5k_hw_£t_powî
(
ah
, 
AR5K_PM_AWAKE
, 
åue
, 0);

574 i‡(
ªt
) {

575 
	`ATH5K_ERR
(
ah
, "failedÅoÖut device on hold\n");

576  
ªt
;

579  
ªt
;

580 
	}
}

585 
	$©h5k_hw_nic_wakeup
(
©h5k_hw
 *
ah
, 
Êags
, 
boﬁ
 
öôül
)

587 
pci_dev
 *
pdev
 = 
ah
->pdev;

588 
u32
 
turbo
, 
mode
, 
˛ock
, 
bus_Êags
;

589 
ªt
;

591 
turbo
 = 0;

592 
mode
 = 0;

593 
˛ock
 = 0;

595 i‡((
	`©h5k_gë_bus_ty≥
(
ah
Ë!
ATH_AHB
Ë|| !
öôül
) {

597 
ªt
 = 
	`©h5k_hw_£t_powî
(
ah
, 
AR5K_PM_AWAKE
, 
åue
, 0);

598 i‡(
ªt
) {

599 
	`ATH5K_ERR
(
ah
, "failedÅo wakeupÅhe MAC Chip\n");

600  
ªt
;

612 
bus_Êags
 = (
pdev
 && 
	`pci_is_pcõ
’dev)Ë? 0 : 
AR5K_RESET_CTL_PCI
;

614 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
) {

615 
ªt
 = 
	`©h5k_hw_nic_ª£t
(
ah
, 
AR5K_RESET_CTL_PCU
 |

616 
AR5K_RESET_CTL_MAC
 | 
AR5K_RESET_CTL_DMA
 |

617 
AR5K_RESET_CTL_PHY
 | 
AR5K_RESET_CTL_PCI
);

618 
	`mdñay
(2);

620 i‡(
	`©h5k_gë_bus_ty≥
(
ah
Ë=
ATH_AHB
)

621 
ªt
 = 
	`©h5k_hw_wisoc_ª£t
(
ah
, 
AR5K_RESET_CTL_PCU
 |

622 
AR5K_RESET_CTL_BASEBAND
);

624 
ªt
 = 
	`©h5k_hw_nic_ª£t
(
ah
, 
AR5K_RESET_CTL_PCU
 |

625 
AR5K_RESET_CTL_BASEBAND
 | 
bus_Êags
);

628 i‡(
ªt
) {

629 
	`ATH5K_ERR
(
ah
, "failedÅoÑesetÅhe MAC Chip\n");

630  -
EIO
;

634 
ªt
 = 
	`©h5k_hw_£t_powî
(
ah
, 
AR5K_PM_AWAKE
, 
åue
, 0);

635 i‡(
ªt
) {

636 
	`ATH5K_ERR
(
ah
, "failedÅoÑesumeÅhe MAC Chip\n");

637  
ªt
;

643 i‡(
	`©h5k_gë_bus_ty≥
(
ah
Ë=
ATH_AHB
)

644 
ªt
 = 
	`©h5k_hw_wisoc_ª£t
(
ah
, 0);

646 
ªt
 = 
	`©h5k_hw_nic_ª£t
(
ah
, 0);

648 i‡(
ªt
) {

649 
	`ATH5K_ERR
(
ah
, "failedÅo warmÑesetÅhe MAC Chip\n");

650  -
EIO
;

655 i‡(
öôül
)

658 i‡(
ah
->
ah_vîsi⁄
 !
AR5K_AR5210
) {

663 i‡(
ah
->
ah_ødio
 >
AR5K_RF5112
) {

664 
mode
 = 
AR5K_PHY_MODE_RAD_RF5112
;

665 
˛ock
 = 
AR5K_PHY_PLL_RF5112
;

667 
mode
 = 
AR5K_PHY_MODE_RAD_RF5111
;

668 
˛ock
 = 
AR5K_PHY_PLL_RF5111
;

671 i‡(
Êags
 & 
CHANNEL_2GHZ
) {

672 
mode
 |
AR5K_PHY_MODE_FREQ_2GHZ
;

673 
˛ock
 |
AR5K_PHY_PLL_44MHZ
;

675 i‡(
Êags
 & 
CHANNEL_CCK
) {

676 
mode
 |
AR5K_PHY_MODE_MOD_CCK
;

677 } i‡(
Êags
 & 
CHANNEL_OFDM
) {

685 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5211
)

686 
mode
 |
AR5K_PHY_MODE_MOD_OFDM
;

688 
mode
 |
AR5K_PHY_MODE_MOD_DYN
;

690 
	`ATH5K_ERR
(
ah
,

692  -
EINVAL
;

694 } i‡(
Êags
 & 
CHANNEL_5GHZ
) {

695 
mode
 |
AR5K_PHY_MODE_FREQ_5GHZ
;

698 i‡(
ah
->
ah_ødio
 =
AR5K_RF5413
)

699 
˛ock
 = 
AR5K_PHY_PLL_40MHZ_5413
;

701 
˛ock
 |
AR5K_PHY_PLL_40MHZ
;

703 i‡(
Êags
 & 
CHANNEL_OFDM
)

704 
mode
 |
AR5K_PHY_MODE_MOD_OFDM
;

706 
	`ATH5K_ERR
(
ah
,

708  -
EINVAL
;

711 
	`ATH5K_ERR
(
ah
, "invalidÑadio frequency mode\n");

712  -
EINVAL
;

718 i‡(
ah
->
ah_bwmode
 =
AR5K_BWMODE_40MHZ
) {

719 
turbo
 = 
AR5K_PHY_TURBO_MODE
 |

720 (
ah
->
ah_ødio
 =
AR5K_RF2425
) ? 0 :

721 
AR5K_PHY_TURBO_SHORT
;

722 } i‡(
ah
->
ah_bwmode
 !
AR5K_BWMODE_DEFAULT
) {

723 i‡(
ah
->
ah_ødio
 =
AR5K_RF5413
) {

724 
mode
 |(
ah
->
ah_bwmode
 =
AR5K_BWMODE_10MHZ
) ?

725 
AR5K_PHY_MODE_HALF_RATE
 :

726 
AR5K_PHY_MODE_QUARTER_RATE
;

727 } i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5212
) {

728 
˛ock
 |(
ah
->
ah_bwmode
 =
AR5K_BWMODE_10MHZ
) ?

729 
AR5K_PHY_PLL_HALF_RATE
 :

730 
AR5K_PHY_PLL_QUARTER_RATE
;

737 i‡(
ah
->
ah_bwmode
 =
AR5K_BWMODE_40MHZ
)

738 
	`©h5k_hw_ªg_wrôe
(
ah
, 
AR5K_PHY_TURBO_MODE
,

739 
AR5K_PHY_TURBO
);

742 i‡(
ah
->
ah_vîsi⁄
 !
AR5K_AR5210
) {

745 i‡(
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PHY_PLL
Ë!
˛ock
) {

746 
	`©h5k_hw_ªg_wrôe
(
ah
, 
˛ock
, 
AR5K_PHY_PLL
);

747 
	`udñay
(300);

751 
	`©h5k_hw_ªg_wrôe
(
ah
, 
mode
, 
AR5K_PHY_MODE
);

752 
	`©h5k_hw_ªg_wrôe
(
ah
, 
turbo
, 
AR5K_PHY_TURBO
);

756 
	}
}

764 
	$©h5k_hw_twók_öôvÆ_£âögs
(
©h5k_hw
 *
ah
,

765 
õì80211_ch™√l
 *
ch™√l
)

767 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5212
 &&

768 
ah
->
ah_phy_ªvisi⁄
 >
AR5K_SREV_PHY_5212A
) {

771 
	`©h5k_hw_ªg_wrôe
(
ah
,

772 (
	`AR5K_REG_SM
(2,

773 
AR5K_PHY_ADC_CTL_INBUFGAIN_OFF
) |

774 
	`AR5K_REG_SM
(2,

775 
AR5K_PHY_ADC_CTL_INBUFGAIN_ON
) |

776 
AR5K_PHY_ADC_CTL_PWD_DAC_OFF
 |

777 
AR5K_PHY_ADC_CTL_PWD_ADC_OFF
),

778 
AR5K_PHY_ADC_CTL
);

783 
	`AR5K_REG_DISABLE_BITS
(
ah
, 
AR5K_PHY_DAG_CCK_CTL
,

784 
AR5K_PHY_DAG_CCK_CTL_EN_RSSI_THR
);

786 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_DAG_CCK_CTL
,

787 
AR5K_PHY_DAG_CCK_CTL_RSSI_THR
, 2);

790 
	`©h5k_hw_ªg_wrôe
(
ah
, 0x0000000f, 
AR5K_SEQ_MASK
);

794 i‡(
ah
->
ah_phy_ªvisi⁄
 >
AR5K_SREV_PHY_5212B
)

795 
	`©h5k_hw_ªg_wrôe
(
ah
, 0, 
AR5K_PHY_BLUETOOTH
);

798 i‡(
ah
->
ah_phy_ªvisi⁄
 > 
AR5K_SREV_PHY_5212B
)

799 
	`AR5K_REG_DISABLE_BITS
(
ah
, 
AR5K_TXCFG
,

800 
AR5K_TXCFG_DCU_DBL_BUF_DIS
);

803 i‡((
ah
->
ah_ødio
 =
AR5K_RF5413
) ||

804 (
ah
->
ah_ødio
 =
AR5K_RF2317
) ||

805 (
ah
->
ah_mac_vîsi⁄
 =(
AR5K_SREV_AR2417
 >> 4))) {

806 
u32
 
Á°_adc
 = 
åue
;

808 i‡(
ch™√l
->
˚¡î_‰eq
 == 2462 ||

809 
ch™√l
->
˚¡î_‰eq
 == 2467)

810 
Á°_adc
 = 0;

813 i‡(
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PHY_FAST_ADC
Ë!
Á°_adc
)

814 
	`©h5k_hw_ªg_wrôe
(
ah
, 
Á°_adc
,

815 
AR5K_PHY_FAST_ADC
);

819 i‡(
ah
->
ah_ødio
 =
AR5K_RF5112
 &&

820 
ah
->
ah_ødio_5ghz_ªvisi⁄
 <

821 
AR5K_SREV_RAD_5112A
) {

822 
u32
 
d©a
;

823 
	`©h5k_hw_ªg_wrôe
(
ah
, 
AR5K_PHY_CCKTXCTL_WORLD
,

824 
AR5K_PHY_CCKTXCTL
);

825 i‡(
ch™√l
->
hw_vÆue
 & 
CHANNEL_5GHZ
)

826 
d©a
 = 0xffb81020;

828 
d©a
 = 0xffb80d20;

829 
	`©h5k_hw_ªg_wrôe
(
ah
, 
d©a
, 
AR5K_PHY_FRAME_CTL
);

832 i‡(
ah
->
ah_mac_§ev
 < 
AR5K_SREV_AR5211
) {

834 
	`©h5k_hw_ªg_wrôe
(
ah
, 0, 
AR5K_QCUDCU_CLKGT
);

836 
	`©h5k_hw_ªg_wrôe
(
ah
, 
AR5K_PHY_SCAL_32MHZ_5311
,

837 
AR5K_PHY_SCAL
);

839 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_DIAG_SW_5211
,

840 
AR5K_DIAG_SW_ECO_ENABLE
);

843 i‡(
ah
->
ah_bwmode
) {

847 i‡(
ah
->
ah_bwmode
 =
AR5K_BWMODE_40MHZ
) {

849 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_SETTLING
,

850 
AR5K_PHY_SETTLING_AGC
,

851 
AR5K_AGC_SETTLING_TURBO
);

856 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5212
)

857 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_SETTLING
,

858 
AR5K_PHY_SETTLING_SWITCH
,

859 
AR5K_SWITCH_SETTLING_TURBO
);

861 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
) {

863 
	`©h5k_hw_ªg_wrôe
(
ah
,

864 (
AR5K_PHY_FRAME_CTL_INI
 |

865 
AR5K_PHY_TURBO_MODE
 |

866 
AR5K_PHY_TURBO_SHORT
 | 0x2020),

867 
AR5K_PHY_FRAME_CTL_5210
);

870 } i‡((
ah
->
ah_mac_§ev
 >
AR5K_SREV_AR5424
) &&

871 (
ah
->
ah_mac_§ev
 <
AR5K_SREV_AR5414
)) {

872 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_FRAME_CTL_5211
,

873 
AR5K_PHY_FRAME_CTL_WIN_LEN
,

876 } i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
) {

878 
	`©h5k_hw_ªg_wrôe
(
ah
, (
AR5K_PHY_FRAME_CTL_INI
 | 0x1020),

879 
AR5K_PHY_FRAME_CTL_5210
);

881 
	}
}

883 
	$©h5k_hw_commô_ì¥om_£âögs
(
©h5k_hw
 *
ah
,

884 
õì80211_ch™√l
 *
ch™√l
)

886 
©h5k_ì¥om_öfo
 *
ì
 = &
ah
->
ah_ˇ∑bûôõs
.
ˇp_ì¥om
;

887 
s16
 
cck_ofdm_pwr_dñè
;

888 
u8
 
ì_mode
;

891 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5210
)

894 
ì_mode
 = 
	`©h5k_ì¥om_mode_‰om_ch™√l
(
ch™√l
);

897 i‡(
ch™√l
->
˚¡î_‰eq
 == 2484)

898 
cck_ofdm_pwr_dñè
 =

899 ((
ì
->
ì_cck_ofdm_powî_dñè
 -

900 
ì
->
ì_sˇÀd_cck_dñè
) * 2) / 10;

902 
cck_ofdm_pwr_dñè
 =

903 (
ì
->
ì_cck_ofdm_powî_dñè
 * 2) / 10;

907 i‡(
ah
->
ah_phy_ªvisi⁄
 >
AR5K_SREV_PHY_5212A
) {

908 i‡(
ch™√l
->
hw_vÆue
 =
CHANNEL_G
)

909 
	`©h5k_hw_ªg_wrôe
(
ah
,

910 
	`AR5K_REG_SM
((
ì
->
ì_cck_ofdm_gaö_dñè
 * -1),

911 
AR5K_PHY_TX_PWR_ADJ_CCK_GAIN_DELTA
) |

912 
	`AR5K_REG_SM
((
cck_ofdm_pwr_dñè
 * -1),

913 
AR5K_PHY_TX_PWR_ADJ_CCK_PCDAC_INDEX
),

914 
AR5K_PHY_TX_PWR_ADJ
);

916 
	`©h5k_hw_ªg_wrôe
(
ah
, 0, 
AR5K_PHY_TX_PWR_ADJ
);

920 
ah
->
ah_txpowî
.
txp_cck_ofdm_pwr_dñè
 = 
cck_ofdm_pwr_dñè
;

921 
ah
->
ah_txpowî
.
txp_cck_ofdm_gaöf_dñè
 =

922 
ì
->
ì_cck_ofdm_gaö_dñè
;

927 
	`©h5k_hw_£t_™ã¬a_swôch
(
ah
, 
ì_mode
);

930 
	`©h5k_hw_ªg_wrôe
(
ah
,

931 
	`AR5K_PHY_NF_SVAL
(
ì
->
ì_noi£_Êo‹_thr
[
ì_mode
]),

932 
AR5K_PHY_NFTHRES
);

934 i‡((
ah
->
ah_bwmode
 =
AR5K_BWMODE_40MHZ
) &&

935 (
ah
->
ah_ì_vîsi⁄
 >
AR5K_EEPROM_VERSION_5_0
)) {

937 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_SETTLING
,

938 
AR5K_PHY_SETTLING_SWITCH
,

939 
ì
->
ì_swôch_£âlög_turbo
[
ì_mode
]);

942 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_GAIN
,

943 
AR5K_PHY_GAIN_TXRX_ATTEN
,

944 
ì
->
ì_©n_tx_rx_turbo
[
ì_mode
]);

947 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_DESIRED_SIZE
,

948 
AR5K_PHY_DESIRED_SIZE_ADC
,

949 
ì
->
ì_adc_desúed_size_turbo
[
ì_mode
]);

951 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_DESIRED_SIZE
,

952 
AR5K_PHY_DESIRED_SIZE_PGA
,

953 
ì
->
ì_pga_desúed_size_turbo
[
ì_mode
]);

956 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_GAIN_2GHZ
,

957 
AR5K_PHY_GAIN_2GHZ_MARGIN_TXRX
,

958 
ì
->
ì_m¨gö_tx_rx_turbo
[
ì_mode
]);

962 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_SETTLING
,

963 
AR5K_PHY_SETTLING_SWITCH
,

964 
ì
->
ì_swôch_£âlög
[
ì_mode
]);

967 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_GAIN
,

968 
AR5K_PHY_GAIN_TXRX_ATTEN
,

969 
ì
->
ì_©n_tx_rx
[
ì_mode
]);

972 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_DESIRED_SIZE
,

973 
AR5K_PHY_DESIRED_SIZE_ADC
,

974 
ì
->
ì_adc_desúed_size
[
ì_mode
]);

976 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_DESIRED_SIZE
,

977 
AR5K_PHY_DESIRED_SIZE_PGA
,

978 
ì
->
ì_pga_desúed_size
[
ì_mode
]);

981 i‡(
ah
->
ah_ì_vîsi⁄
 >
AR5K_EEPROM_VERSION_4_1
)

982 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_GAIN_2GHZ
,

983 
AR5K_PHY_GAIN_2GHZ_MARGIN_TXRX
,

984 
ì
->
ì_m¨gö_tx_rx
[
ì_mode
]);

988 
	`©h5k_hw_ªg_wrôe
(
ah
,

989 (
ì
->
ì_tx_íd2x∑_dißbÀ
[
ì_mode
] << 24) |

990 (
ì
->
ì_tx_íd2x∑_dißbÀ
[
ì_mode
] << 16) |

991 (
ì
->
ì_tx_‰m2x∑_íabÀ
[
ì_mode
] << 8) |

992 (
ì
->
ì_tx_‰m2x∑_íabÀ
[
ì_mode
]), 
AR5K_PHY_RF_CTL4
);

995 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_RF_CTL3
,

996 
AR5K_PHY_RF_CTL3_TXE2XLNA_ON
,

997 
ì
->
ì_tx_íd2x a_íabÀ
[
ì_mode
]);

1000 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_NF
,

1001 
AR5K_PHY_NF_THRESH62
,

1002 
ì
->
ì_thr_62
[
ì_mode
]);

1007 i‡(
	`©h5k_hw_ch™_has_•ur_noi£
(
ah
, 
ch™√l
))

1008 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_OFDM_SELFCORR
,

1009 
AR5K_PHY_OFDM_SELFCORR_CYPWR_THR1
,

1010 
AR5K_INIT_CYCRSSI_THR1
 +

1011 
ì
->
ì_Ál£_dëe˘
[
ì_mode
]);

1013 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_OFDM_SELFCORR
,

1014 
AR5K_PHY_OFDM_SELFCORR_CYPWR_THR1
,

1015 
AR5K_INIT_CYCRSSI_THR1
);

1019 i‡(
ah
->
ah_ì_vîsi⁄
 >
AR5K_EEPROM_VERSION_4_0
) {

1020 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_IQ
, 
AR5K_PHY_IQ_CORR_Q_I_COFF
,

1021 
ì
->
ì_i_ˇl
[
ì_mode
]);

1022 
	`AR5K_REG_WRITE_BITS
(
ah
, 
AR5K_PHY_IQ
, 
AR5K_PHY_IQ_CORR_Q_Q_COFF
,

1023 
ì
->
ì_q_ˇl
[
ì_mode
]);

1024 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_PHY_IQ
, 
AR5K_PHY_IQ_CORR_ENABLE
);

1028 i‡(
ah
->
ah_ì_vîsi⁄
 >
AR5K_EEPROM_VERSION_5_1
)

1029 
	`©h5k_hw_ªg_wrôe
(
ah
, 0, 
AR5K_PHY_HEAVY_CLIP_ENABLE
);

1030 
	}
}

1037 
	$©h5k_hw_ª£t
(
©h5k_hw
 *
ah
, 
∆80211_i·y≥
 
›_mode
,

1038 
õì80211_ch™√l
 *
ch™√l
, 
boﬁ
 
Á°
, boﬁ 
skù_pcu
)

1040 
u32
 
s_£q
[10], 
s_Àd
[3], 
tsf_up
, 
tsf_lo
;

1041 
u8
 
mode
;

1042 
i
, 
ªt
;

1044 
tsf_up
 = 0;

1045 
tsf_lo
 = 0;

1046 
mode
 = 0;

1048 
	`¥ötk
("VANET-debug:áth5k_hw_resetázsoarsky\n");

1055 i‡(
Á°
 && (
ah
->
ah_ødio
 !
AR5K_RF2413
) &&

1056 (
ah
->
ah_ødio
 !
AR5K_RF5413
))

1057 
Á°
 = 0;

1062 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5212
)

1063 
	`©h5k_hw_£t_¶ìp_˛ock
(
ah
, 
Ál£
);

1068 
	`©h5k_hw_°›_rx_pcu
(
ah
);

1076 
ªt
 = 
	`©h5k_hw_dma_°›
(
ah
);

1080 i‡(
ªt
 && 
Á°
) {

1081 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_RESET
,

1083 
Á°
 = 0;

1086 
ªt
 = 0;

1089 
ch™√l
->
hw_vÆue
 & 
CHANNEL_MODES
) {

1090 
CHANNEL_A
:

1091 
mode
 = 
AR5K_MODE_11A
;

1093 
CHANNEL_G
:

1095 i‡(
ah
->
ah_vîsi⁄
 <
AR5K_AR5211
) {

1096 
	`ATH5K_ERR
(
ah
,

1098  -
EINVAL
;

1101 
mode
 = 
AR5K_MODE_11G
;

1103 
CHANNEL_B
:

1105 i‡(
ah
->
ah_vîsi⁄
 < 
AR5K_AR5211
) {

1106 
	`ATH5K_ERR
(
ah
,

1108  -
EINVAL
;

1111 
mode
 = 
AR5K_MODE_11B
;

1113 
CHANNEL_XR
:

1114 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5211
) {

1115 
	`ATH5K_ERR
(
ah
,

1117  -
EINVAL
;

1119 
mode
 = 
AR5K_MODE_XR
;

1122 
	`ATH5K_ERR
(
ah
,

1123 "övÆid ch™√l: %d\n", 
ch™√l
->
˚¡î_‰eq
);

1124  -
EINVAL
;

1131 i‡(
Á°
) {

1132 
ªt
 = 
	`©h5k_hw_phy_öô
(
ah
, 
ch™√l
, 
mode
, 
åue
);

1133 i‡(
ªt
) {

1134 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_RESET
,

1138 
ªt
 = 0;

1140 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_RESET
,

1149 i‡(
ah
->
ah_vîsi⁄
 !
AR5K_AR5210
) {

1155 i‡(
ah
->
ah_mac_§ev
 < 
AR5K_SREV_AR5211
) {

1157 
i
 = 0; i < 10; i++)

1158 
s_£q
[
i
] = 
	`©h5k_hw_ªg_ªad
(
ah
,

1159 
	`AR5K_QUEUE_DCU_SEQNUM
(
i
));

1162 
s_£q
[0] = 
	`©h5k_hw_ªg_ªad
(
ah
,

1163 
	`AR5K_QUEUE_DCU_SEQNUM
(0));

1179 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5211
) {

1180 
tsf_up
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_TSF_U32
);

1181 
tsf_lo
 = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_TSF_L32
);

1187 
s_Àd
[0] = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_PCICFG
) &

1188 
AR5K_PCICFG_LEDSTATE
;

1189 
s_Àd
[1] = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_GPIOCR
);

1190 
s_Àd
[2] = 
	`©h5k_hw_ªg_ªad
(
ah
, 
AR5K_GPIODO
);

1198 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5212
 &&

1199 (
ah
->
ah_ødio
 <
AR5K_RF5112
)) {

1200 i‡(!
Á°
 && 
ah
->
ah_rf_b™ks
 !
NULL
)

1201 
	`©h5k_hw_gaöf_ˇlibøã
(
ah
);

1205 
ªt
 = 
	`©h5k_hw_nic_wakeup
(
ah
, 
ch™√l
->
hw_vÆue
, 
Ál£
);

1206 i‡(
ªt
)

1207  
ªt
;

1210 i‡(
ah
->
ah_mac_§ev
 >
AR5K_SREV_AR5211
)

1211 
	`©h5k_hw_ªg_wrôe
(
ah
, 
AR5K_PHY_SHIFT_5GHZ
, 
	`AR5K_PHY
(0));

1213 
	`©h5k_hw_ªg_wrôe
(
ah
, 
AR5K_PHY_SHIFT_5GHZ
 | 0x40,

1214 
	`AR5K_PHY
(0));

1217 
ªt
 = 
	`©h5k_hw_wrôe_öôvÆs
(
ah
, 
mode
, 
skù_pcu
);

1218 i‡(
ªt
)

1219  
ªt
;

1222 
	`©h5k_hw_öô_c‹e_˛ock
(
ah
);

1229 
	`©h5k_hw_twók_öôvÆ_£âögs
(
ah
, 
ch™√l
);

1232 
	`©h5k_hw_commô_ì¥om_£âögs
(
ah
, 
ch™√l
);

1240 i‡(
ah
->
ah_vîsi⁄
 !
AR5K_AR5210
) {

1241 i‡(
ah
->
ah_mac_§ev
 < 
AR5K_SREV_AR5211
) {

1242 
i
 = 0; i < 10; i++)

1243 
	`©h5k_hw_ªg_wrôe
(
ah
, 
s_£q
[
i
],

1244 
	`AR5K_QUEUE_DCU_SEQNUM
(
i
));

1246 
	`©h5k_hw_ªg_wrôe
(
ah
, 
s_£q
[0],

1247 
	`AR5K_QUEUE_DCU_SEQNUM
(0));

1250 i‡(
ah
->
ah_vîsi⁄
 =
AR5K_AR5211
) {

1251 
	`©h5k_hw_ªg_wrôe
(
ah
, 
tsf_up
, 
AR5K_TSF_U32
);

1252 
	`©h5k_hw_ªg_wrôe
(
ah
, 
tsf_lo
, 
AR5K_TSF_L32
);

1257 
	`AR5K_REG_ENABLE_BITS
(
ah
, 
AR5K_PCICFG
, 
s_Àd
[0]);

1260 
	`©h5k_hw_ªg_wrôe
(
ah
, 
s_Àd
[1], 
AR5K_GPIOCR
);

1261 
	`©h5k_hw_ªg_wrôe
(
ah
, 
s_Àd
[2], 
AR5K_GPIODO
);

1266 
	`©h5k_hw_pcu_öô
(
ah
, 
›_mode
, 
mode
);

1271 
ªt
 = 
	`©h5k_hw_phy_öô
(
ah
, 
ch™√l
, 
mode
, 
Ál£
);

1272 i‡(
ªt
) {

1273 
	`ATH5K_ERR
(
ah
,

1274 "ÁûedÅÿöôülizêPHY (%iË!\n", 
ªt
);

1275  
ªt
;

1281 
ªt
 = 
	`©h5k_hw_öô_queues
(
ah
);

1282 i‡(
ªt
)

1283  
ªt
;

1289 
	`©h5k_hw_dma_öô
(
ah
);

1301 i‡(
ah
->
ah_u£_32khz_˛ock
 &&áh->
ah_vîsi⁄
 =
AR5K_AR5212
 &&

1302 
›_mode
 !
NL80211_IFTYPE_AP
)

1303 
	`©h5k_hw_£t_¶ìp_˛ock
(
ah
, 
åue
);

1308 
	`AR5K_REG_DISABLE_BITS
(
ah
, 
AR5K_BEACON
, 
AR5K_BEACON_ENABLE
);

1309 
	`©h5k_hw_ª£t_tsf
(
ah
);

1311 
	}
}

	@ath5k/rfbuffer.h

51 
	s©h5k_öi_rfbuf„r
 {

52 
u8
 
	mrfb_b™k
;

53 
u16
 
	mrfb_˘æ_ªgi°î
;

54 
u32
 
	mrfb_mode_d©a
[3];

62 
	s©h5k_rfb_fõld
 {

63 
u8
 
	mÀn
;

64 
u16
 
	mpos
;

65 
u8
 
	mcﬁ
;

71 
	s©h5k_rf_ªg
 {

72 
u8
 
	mb™k
;

73 
u8
 
	mödex
;

74 
©h5k_rfb_fõld
 
	mfõld
;

81 
	e©h5k_rf_ªgs_idx
 {

83 
	mAR5K_RF_TURBO
 = 0,

85 
	mAR5K_RF_OB_2GHZ
,

86 
	mAR5K_RF_OB_5GHZ
,

87 
	mAR5K_RF_DB_2GHZ
,

88 
	mAR5K_RF_DB_5GHZ
,

89 
	mAR5K_RF_FIXED_BIAS_A
,

90 
	mAR5K_RF_FIXED_BIAS_B
,

91 
	mAR5K_RF_PWD_XPD
,

92 
	mAR5K_RF_XPD_SEL
,

93 
	mAR5K_RF_XPD_GAIN
,

94 
	mAR5K_RF_PD_GAIN_LO
,

95 
	mAR5K_RF_PD_GAIN_HI
,

96 
	mAR5K_RF_HIGH_VC_CP
,

97 
	mAR5K_RF_MID_VC_CP
,

98 
	mAR5K_RF_LOW_VC_CP
,

99 
	mAR5K_RF_PUSH_UP
,

100 
	mAR5K_RF_PAD2GND
,

101 
	mAR5K_RF_XB2_LVL
,

102 
	mAR5K_RF_XB5_LVL
,

103 
	mAR5K_RF_PWD_ICLOBUF_2G
,

104 
	mAR5K_RF_PWD_84
,

105 
	mAR5K_RF_PWD_90
,

106 
	mAR5K_RF_PWD_130
,

107 
	mAR5K_RF_PWD_131
,

108 
	mAR5K_RF_PWD_132
,

109 
	mAR5K_RF_PWD_136
,

110 
	mAR5K_RF_PWD_137
,

111 
	mAR5K_RF_PWD_138
,

112 
	mAR5K_RF_PWD_166
,

113 
	mAR5K_RF_PWD_167
,

114 
	mAR5K_RF_DERBY_CHAN_SEL_MODE
,

116 
	mAR5K_RF_GAIN_I
,

117 
	mAR5K_RF_PLO_SEL
,

118 
	mAR5K_RF_RFGAIN_SEL
,

119 
	mAR5K_RF_RFGAIN_STEP
,

120 
	mAR5K_RF_WAIT_S
,

121 
	mAR5K_RF_WAIT_I
,

122 
	mAR5K_RF_MAX_TIME
,

123 
	mAR5K_RF_MIXVGA_OVR
,

124 
	mAR5K_RF_MIXGAIN_OVR
,

125 
	mAR5K_RF_MIXGAIN_STEP
,

126 
	mAR5K_RF_PD_DELAY_A
,

127 
	mAR5K_RF_PD_DELAY_B
,

128 
	mAR5K_RF_PD_DELAY_XR
,

129 
	mAR5K_RF_PD_PERIOD_A
,

130 
	mAR5K_RF_PD_PERIOD_B
,

131 
	mAR5K_RF_PD_PERIOD_XR
,

140 
	#AR5K_RF5111_RF_TURBO
 { 1, 3, 0 }

	)

143 
	#AR5K_RF5111_OB_2GHZ
 { 3, 119, 0 }

	)

144 
	#AR5K_RF5111_DB_2GHZ
 { 3, 122, 0 }

	)

146 
	#AR5K_RF5111_OB_5GHZ
 { 3, 104, 0 }

	)

147 
	#AR5K_RF5111_DB_5GHZ
 { 3, 107, 0 }

	)

149 
	#AR5K_RF5111_PWD_XPD
 { 1, 95, 0 }

	)

150 
	#AR5K_RF5111_XPD_GAIN
 { 4, 96, 0 }

	)

153 
	#AR5K_RF5111_PWD
(
_n
Ë{ 1, (135 - _n), 3 }

	)

156 
	#AR5K_RF5111_GAIN_I
 { 6, 29, 0 }

	)

157 
	#AR5K_RF5111_PLO_SEL
 { 1, 4, 0 }

	)

158 
	#AR5K_RF5111_RFGAIN_SEL
 { 1, 36, 0 }

	)

159 
	#AR5K_RF5111_RFGAIN_STEP
 { 6, 37, 0 }

	)

161 
	#AR5K_RF5111_WAIT_S
 { 5, 19, 0 }

	)

162 
	#AR5K_RF5111_WAIT_I
 { 5, 24, 0 }

	)

163 
	#AR5K_RF5111_MAX_TIME
 { 2, 49, 0 }

	)

165 c⁄° 
©h5k_rf_ªg
 
	grf_ªgs_5111
[] = {

166 {2, 
AR5K_RF_TURBO
, 
AR5K_RF5111_RF_TURBO
},

167 {6, 
AR5K_RF_OB_2GHZ
, 
AR5K_RF5111_OB_2GHZ
},

168 {6, 
AR5K_RF_DB_2GHZ
, 
AR5K_RF5111_DB_2GHZ
},

169 {6, 
AR5K_RF_OB_5GHZ
, 
AR5K_RF5111_OB_5GHZ
},

170 {6, 
AR5K_RF_DB_5GHZ
, 
AR5K_RF5111_DB_5GHZ
},

171 {6, 
AR5K_RF_PWD_XPD
, 
AR5K_RF5111_PWD_XPD
},

172 {6, 
AR5K_RF_XPD_GAIN
, 
AR5K_RF5111_XPD_GAIN
},

173 {6, 
AR5K_RF_PWD_84
, 
AR5K_RF5111_PWD
(84)},

174 {6, 
AR5K_RF_PWD_90
, 
AR5K_RF5111_PWD
(90)},

175 {7, 
AR5K_RF_GAIN_I
, 
AR5K_RF5111_GAIN_I
},

176 {7, 
AR5K_RF_PLO_SEL
, 
AR5K_RF5111_PLO_SEL
},

177 {7, 
AR5K_RF_RFGAIN_SEL
, 
AR5K_RF5111_RFGAIN_SEL
},

178 {7, 
AR5K_RF_RFGAIN_STEP
, 
AR5K_RF5111_RFGAIN_STEP
},

179 {7, 
AR5K_RF_WAIT_S
, 
AR5K_RF5111_WAIT_S
},

180 {7, 
AR5K_RF_WAIT_I
, 
AR5K_RF5111_WAIT_I
},

181 {7, 
AR5K_RF_MAX_TIME
, 
AR5K_RF5111_MAX_TIME
}

185 c⁄° 
©h5k_öi_rfbuf„r
 
	grfb_5111
[] = {

241 
	#AR5K_RF5112X_RF_TURBO
 { 1, 1, 2 }

	)

244 
	#AR5K_RF5112X_GAIN_I
 { 6, 14, 0 }

	)

245 
	#AR5K_RF5112X_MIXVGA_OVR
 { 1, 36, 0 }

	)

246 
	#AR5K_RF5112X_MIXGAIN_OVR
 { 2, 37, 0 }

	)

247 
	#AR5K_RF5112X_MIXGAIN_STEP
 { 4, 32, 0 }

	)

248 
	#AR5K_RF5112X_PD_DELAY_A
 { 4, 58, 0 }

	)

249 
	#AR5K_RF5112X_PD_DELAY_B
 { 4, 62, 0 }

	)

250 
	#AR5K_RF5112X_PD_DELAY_XR
 { 4, 66, 0 }

	)

251 
	#AR5K_RF5112X_PD_PERIOD_A
 { 4, 70, 0 }

	)

252 
	#AR5K_RF5112X_PD_PERIOD_B
 { 4, 74, 0 }

	)

253 
	#AR5K_RF5112X_PD_PERIOD_XR
 { 4, 78, 0 }

	)

258 
	#AR5K_RF5112_OB_2GHZ
 { 3, 269, 0 }

	)

259 
	#AR5K_RF5112_DB_2GHZ
 { 3, 272, 0 }

	)

261 
	#AR5K_RF5112_OB_5GHZ
 { 3, 261, 0 }

	)

262 
	#AR5K_RF5112_DB_5GHZ
 { 3, 264, 0 }

	)

264 
	#AR5K_RF5112_FIXED_BIAS_A
 { 1, 260, 0 }

	)

265 
	#AR5K_RF5112_FIXED_BIAS_B
 { 1, 259, 0 }

	)

267 
	#AR5K_RF5112_XPD_SEL
 { 1, 284, 0 }

	)

268 
	#AR5K_RF5112_XPD_GAIN
 { 2, 252, 0 }

	)

271 
	#AR5K_RF5112_PWD
(
_n
Ë{ 1, (302 - _n), 3 }

	)

273 c⁄° 
©h5k_rf_ªg
 
	grf_ªgs_5112
[] = {

274 {2, 
AR5K_RF_TURBO
, 
AR5K_RF5112X_RF_TURBO
},

275 {6, 
AR5K_RF_OB_2GHZ
, 
AR5K_RF5112_OB_2GHZ
},

276 {6, 
AR5K_RF_DB_2GHZ
, 
AR5K_RF5112_DB_2GHZ
},

277 {6, 
AR5K_RF_OB_5GHZ
, 
AR5K_RF5112_OB_5GHZ
},

278 {6, 
AR5K_RF_DB_5GHZ
, 
AR5K_RF5112_DB_5GHZ
},

279 {6, 
AR5K_RF_FIXED_BIAS_A
, 
AR5K_RF5112_FIXED_BIAS_A
},

280 {6, 
AR5K_RF_FIXED_BIAS_B
, 
AR5K_RF5112_FIXED_BIAS_B
},

281 {6, 
AR5K_RF_XPD_SEL
, 
AR5K_RF5112_XPD_SEL
},

282 {6, 
AR5K_RF_XPD_GAIN
, 
AR5K_RF5112_XPD_GAIN
},

283 {6, 
AR5K_RF_PWD_130
, 
AR5K_RF5112_PWD
(130)},

284 {6, 
AR5K_RF_PWD_131
, 
AR5K_RF5112_PWD
(131)},

285 {6, 
AR5K_RF_PWD_132
, 
AR5K_RF5112_PWD
(132)},

286 {6, 
AR5K_RF_PWD_136
, 
AR5K_RF5112_PWD
(136)},

287 {6, 
AR5K_RF_PWD_137
, 
AR5K_RF5112_PWD
(137)},

288 {6, 
AR5K_RF_PWD_138
, 
AR5K_RF5112_PWD
(138)},

289 {7, 
AR5K_RF_GAIN_I
, 
AR5K_RF5112X_GAIN_I
},

290 {7, 
AR5K_RF_MIXVGA_OVR
, 
AR5K_RF5112X_MIXVGA_OVR
},

291 {7, 
AR5K_RF_MIXGAIN_OVR
, 
AR5K_RF5112X_MIXGAIN_OVR
},

292 {7, 
AR5K_RF_MIXGAIN_STEP
, 
AR5K_RF5112X_MIXGAIN_STEP
},

293 {7, 
AR5K_RF_PD_DELAY_A
, 
AR5K_RF5112X_PD_DELAY_A
},

294 {7, 
AR5K_RF_PD_DELAY_B
, 
AR5K_RF5112X_PD_DELAY_B
},

295 {7, 
AR5K_RF_PD_DELAY_XR
, 
AR5K_RF5112X_PD_DELAY_XR
},

296 {7, 
AR5K_RF_PD_PERIOD_A
, 
AR5K_RF5112X_PD_PERIOD_A
},

297 {7, 
AR5K_RF_PD_PERIOD_B
, 
AR5K_RF5112X_PD_PERIOD_B
},

298 {7, 
AR5K_RF_PD_PERIOD_XR
, 
AR5K_RF5112X_PD_PERIOD_XR
},

302 c⁄° 
©h5k_öi_rfbuf„r
 
	grfb_5112
[] = {

363 
	#AR5K_RF5112A_OB_2GHZ
 { 3, 287, 0 }

	)

364 
	#AR5K_RF5112A_DB_2GHZ
 { 3, 290, 0 }

	)

366 
	#AR5K_RF5112A_OB_5GHZ
 { 3, 279, 0 }

	)

367 
	#AR5K_RF5112A_DB_5GHZ
 { 3, 282, 0 }

	)

369 
	#AR5K_RF5112A_FIXED_BIAS_A
 { 1, 278, 0 }

	)

370 
	#AR5K_RF5112A_FIXED_BIAS_B
 { 1, 277, 0 }

	)

372 
	#AR5K_RF5112A_XPD_SEL
 { 1, 302, 0 }

	)

373 
	#AR5K_RF5112A_PDGAINLO
 { 2, 270, 0 }

	)

374 
	#AR5K_RF5112A_PDGAINHI
 { 2, 257, 0 }

	)

377 
	#AR5K_RF5112A_PWD
(
_n
Ë{ 1, (306 - _n), 3 }

	)

380 
	#AR5K_RF5112A_HIGH_VC_CP
 { 2, 90, 2 }

	)

381 
	#AR5K_RF5112A_MID_VC_CP
 { 2, 92, 2 }

	)

382 
	#AR5K_RF5112A_LOW_VC_CP
 { 2, 94, 2 }

	)

383 
	#AR5K_RF5112A_PUSH_UP
 { 1, 254, 2 }

	)

386 
	#AR5K_RF5112A_PAD2GND
 { 1, 281, 1 }

	)

387 
	#AR5K_RF5112A_XB2_LVL
 { 2, 1, 3 }

	)

388 
	#AR5K_RF5112A_XB5_LVL
 { 2, 3, 3 }

	)

390 c⁄° 
©h5k_rf_ªg
 
	grf_ªgs_5112a
[] = {

391 {2, 
AR5K_RF_TURBO
, 
AR5K_RF5112X_RF_TURBO
},

392 {6, 
AR5K_RF_OB_2GHZ
, 
AR5K_RF5112A_OB_2GHZ
},

393 {6, 
AR5K_RF_DB_2GHZ
, 
AR5K_RF5112A_DB_2GHZ
},

394 {6, 
AR5K_RF_OB_5GHZ
, 
AR5K_RF5112A_OB_5GHZ
},

395 {6, 
AR5K_RF_DB_5GHZ
, 
AR5K_RF5112A_DB_5GHZ
},

396 {6, 
AR5K_RF_FIXED_BIAS_A
, 
AR5K_RF5112A_FIXED_BIAS_A
},

397 {6, 
AR5K_RF_FIXED_BIAS_B
, 
AR5K_RF5112A_FIXED_BIAS_B
},

398 {6, 
AR5K_RF_XPD_SEL
, 
AR5K_RF5112A_XPD_SEL
},

399 {6, 
AR5K_RF_PD_GAIN_LO
, 
AR5K_RF5112A_PDGAINLO
},

400 {6, 
AR5K_RF_PD_GAIN_HI
, 
AR5K_RF5112A_PDGAINHI
},

401 {6, 
AR5K_RF_PWD_130
, 
AR5K_RF5112A_PWD
(130)},

402 {6, 
AR5K_RF_PWD_131
, 
AR5K_RF5112A_PWD
(131)},

403 {6, 
AR5K_RF_PWD_132
, 
AR5K_RF5112A_PWD
(132)},

404 {6, 
AR5K_RF_PWD_136
, 
AR5K_RF5112A_PWD
(136)},

405 {6, 
AR5K_RF_PWD_137
, 
AR5K_RF5112A_PWD
(137)},

406 {6, 
AR5K_RF_PWD_138
, 
AR5K_RF5112A_PWD
(138)},

407 {6, 
AR5K_RF_PWD_166
, 
AR5K_RF5112A_PWD
(166)},

408 {6, 
AR5K_RF_PWD_167
, 
AR5K_RF5112A_PWD
(167)},

409 {6, 
AR5K_RF_HIGH_VC_CP
, 
AR5K_RF5112A_HIGH_VC_CP
},

410 {6, 
AR5K_RF_MID_VC_CP
, 
AR5K_RF5112A_MID_VC_CP
},

411 {6, 
AR5K_RF_LOW_VC_CP
, 
AR5K_RF5112A_LOW_VC_CP
},

412 {6, 
AR5K_RF_PUSH_UP
, 
AR5K_RF5112A_PUSH_UP
},

413 {6, 
AR5K_RF_PAD2GND
, 
AR5K_RF5112A_PAD2GND
},

414 {6, 
AR5K_RF_XB2_LVL
, 
AR5K_RF5112A_XB2_LVL
},

415 {6, 
AR5K_RF_XB5_LVL
, 
AR5K_RF5112A_XB5_LVL
},

416 {7, 
AR5K_RF_GAIN_I
, 
AR5K_RF5112X_GAIN_I
},

417 {7, 
AR5K_RF_MIXVGA_OVR
, 
AR5K_RF5112X_MIXVGA_OVR
},

418 {7, 
AR5K_RF_MIXGAIN_OVR
, 
AR5K_RF5112X_MIXGAIN_OVR
},

419 {7, 
AR5K_RF_MIXGAIN_STEP
, 
AR5K_RF5112X_MIXGAIN_STEP
},

420 {7, 
AR5K_RF_PD_DELAY_A
, 
AR5K_RF5112X_PD_DELAY_A
},

421 {7, 
AR5K_RF_PD_DELAY_B
, 
AR5K_RF5112X_PD_DELAY_B
},

422 {7, 
AR5K_RF_PD_DELAY_XR
, 
AR5K_RF5112X_PD_DELAY_XR
},

423 {7, 
AR5K_RF_PD_PERIOD_A
, 
AR5K_RF5112X_PD_PERIOD_A
},

424 {7, 
AR5K_RF_PD_PERIOD_B
, 
AR5K_RF5112X_PD_PERIOD_B
},

425 {7, 
AR5K_RF_PD_PERIOD_XR
, 
AR5K_RF5112X_PD_PERIOD_XR
},

429 c⁄° 
©h5k_öi_rfbuf„r
 
	grfb_5112a
[] = {

496 
	#AR5K_RF2413_RF_TURBO
 { 1, 1, 2 }

	)

499 
	#AR5K_RF2413_OB_2GHZ
 { 3, 168, 0 }

	)

500 
	#AR5K_RF2413_DB_2GHZ
 { 3, 165, 0 }

	)

502 c⁄° 
©h5k_rf_ªg
 
	grf_ªgs_2413
[] = {

503 {2, 
AR5K_RF_TURBO
, 
AR5K_RF2413_RF_TURBO
},

504 {6, 
AR5K_RF_OB_2GHZ
, 
AR5K_RF2413_OB_2GHZ
},

505 {6, 
AR5K_RF_DB_2GHZ
, 
AR5K_RF2413_DB_2GHZ
},

511 c⁄° 
©h5k_öi_rfbuf„r
 
	grfb_2413
[] = {

555 
	#AR5K_RF2316_RF_TURBO
 { 1, 1, 2 }

	)

558 
	#AR5K_RF2316_OB_2GHZ
 { 3, 178, 0 }

	)

559 
	#AR5K_RF2316_DB_2GHZ
 { 3, 175, 0 }

	)

561 c⁄° 
©h5k_rf_ªg
 
	grf_ªgs_2316
[] = {

562 {2, 
AR5K_RF_TURBO
, 
AR5K_RF2316_RF_TURBO
},

563 {6, 
AR5K_RF_OB_2GHZ
, 
AR5K_RF2316_OB_2GHZ
},

564 {6, 
AR5K_RF_DB_2GHZ
, 
AR5K_RF2316_DB_2GHZ
},

568 c⁄° 
©h5k_öi_rfbuf„r
 
	grfb_2316
[] = {

614 
	#AR5K_RF5413_OB_2GHZ
 { 3, 241, 0 }

	)

615 
	#AR5K_RF5413_DB_2GHZ
 { 3, 238, 0 }

	)

617 
	#AR5K_RF5413_OB_5GHZ
 { 3, 247, 0 }

	)

618 
	#AR5K_RF5413_DB_5GHZ
 { 3, 244, 0 }

	)

620 
	#AR5K_RF5413_PWD_ICLOBUF2G
 { 3, 131, 3 }

	)

621 
	#AR5K_RF5413_DERBY_CHAN_SEL_MODE
 { 1, 291, 2 }

	)

623 c⁄° 
©h5k_rf_ªg
 
	grf_ªgs_5413
[] = {

624 {6, 
AR5K_RF_OB_2GHZ
, 
AR5K_RF5413_OB_2GHZ
},

625 {6, 
AR5K_RF_DB_2GHZ
, 
AR5K_RF5413_DB_2GHZ
},

626 {6, 
AR5K_RF_OB_5GHZ
, 
AR5K_RF5413_OB_5GHZ
},

627 {6, 
AR5K_RF_DB_5GHZ
, 
AR5K_RF5413_DB_5GHZ
},

628 {6, 
AR5K_RF_PWD_ICLOBUF_2G
, 
AR5K_RF5413_PWD_ICLOBUF2G
},

629 {6, 
AR5K_RF_DERBY_CHAN_SEL_MODE
, 
AR5K_RF5413_DERBY_CHAN_SEL_MODE
},

633 c⁄° 
©h5k_öi_rfbuf„r
 
	grfb_5413
[] = {

688 
	#AR5K_RF2425_RF_TURBO
 { 1, 1, 2 }

	)

691 
	#AR5K_RF2425_OB_2GHZ
 { 3, 193, 0 }

	)

692 
	#AR5K_RF2425_DB_2GHZ
 { 3, 190, 0 }

	)

694 c⁄° 
©h5k_rf_ªg
 
	grf_ªgs_2425
[] = {

695 {2, 
AR5K_RF_TURBO
, 
AR5K_RF2425_RF_TURBO
},

696 {6, 
AR5K_RF_OB_2GHZ
, 
AR5K_RF2425_OB_2GHZ
},

697 {6, 
AR5K_RF_DB_2GHZ
, 
AR5K_RF2425_DB_2GHZ
},

702 c⁄° 
©h5k_öi_rfbuf„r
 
	grfb_2425
[] = {

746 c⁄° 
©h5k_öi_rfbuf„r
 
	grfb_2317
[] = {

790 c⁄° 
©h5k_öi_rfbuf„r
 
	grfb_2417
[] = {

	@ath5k/rfgain.h

26 
	s©h5k_öi_rfgaö
 {

27 
u16
 
	mrfg_ªgi°î
;

28 
u32
 
	mrfg_vÆue
[2];

32 c⁄° 
©h5k_öi_rfgaö
 
	grfgaö_5111
[] = {

34 { 
AR5K_RF_GAIN
(0), { 0x000001a9, 0x00000000 } },

35 { 
AR5K_RF_GAIN
(1), { 0x000001e9, 0x00000040 } },

36 { 
AR5K_RF_GAIN
(2), { 0x00000029, 0x00000080 } },

37 { 
AR5K_RF_GAIN
(3), { 0x00000069, 0x00000150 } },

38 { 
AR5K_RF_GAIN
(4), { 0x00000199, 0x00000190 } },

39 { 
AR5K_RF_GAIN
(5), { 0x000001d9, 0x000001d0 } },

40 { 
AR5K_RF_GAIN
(6), { 0x00000019, 0x00000010 } },

41 { 
AR5K_RF_GAIN
(7), { 0x00000059, 0x00000044 } },

42 { 
AR5K_RF_GAIN
(8), { 0x00000099, 0x00000084 } },

43 { 
AR5K_RF_GAIN
(9), { 0x000001a5, 0x00000148 } },

44 { 
AR5K_RF_GAIN
(10), { 0x000001e5, 0x00000188 } },

45 { 
AR5K_RF_GAIN
(11), { 0x00000025, 0x000001c8 } },

46 { 
AR5K_RF_GAIN
(12), { 0x000001c8, 0x00000014 } },

47 { 
AR5K_RF_GAIN
(13), { 0x00000008, 0x00000042 } },

48 { 
AR5K_RF_GAIN
(14), { 0x00000048, 0x00000082 } },

49 { 
AR5K_RF_GAIN
(15), { 0x00000088, 0x00000178 } },

50 { 
AR5K_RF_GAIN
(16), { 0x00000198, 0x000001b8 } },

51 { 
AR5K_RF_GAIN
(17), { 0x000001d8, 0x000001f8 } },

52 { 
AR5K_RF_GAIN
(18), { 0x00000018, 0x00000012 } },

53 { 
AR5K_RF_GAIN
(19), { 0x00000058, 0x00000052 } },

54 { 
AR5K_RF_GAIN
(20), { 0x00000098, 0x00000092 } },

55 { 
AR5K_RF_GAIN
(21), { 0x000001a4, 0x0000017c } },

56 { 
AR5K_RF_GAIN
(22), { 0x000001e4, 0x000001bc } },

57 { 
AR5K_RF_GAIN
(23), { 0x00000024, 0x000001fc } },

58 { 
AR5K_RF_GAIN
(24), { 0x00000064, 0x0000000a } },

59 { 
AR5K_RF_GAIN
(25), { 0x000000a4, 0x0000004a } },

60 { 
AR5K_RF_GAIN
(26), { 0x000000e4, 0x0000008a } },

61 { 
AR5K_RF_GAIN
(27), { 0x0000010a, 0x0000015a } },

62 { 
AR5K_RF_GAIN
(28), { 0x0000014a, 0x0000019a } },

63 { 
AR5K_RF_GAIN
(29), { 0x0000018a, 0x000001da } },

64 { 
AR5K_RF_GAIN
(30), { 0x000001ca, 0x0000000e } },

65 { 
AR5K_RF_GAIN
(31), { 0x0000000a, 0x0000004e } },

66 { 
AR5K_RF_GAIN
(32), { 0x0000004a, 0x0000008e } },

67 { 
AR5K_RF_GAIN
(33), { 0x0000008a, 0x0000015e } },

68 { 
AR5K_RF_GAIN
(34), { 0x000001ba, 0x0000019e } },

69 { 
AR5K_RF_GAIN
(35), { 0x000001fa, 0x000001de } },

70 { 
AR5K_RF_GAIN
(36), { 0x0000003a, 0x00000009 } },

71 { 
AR5K_RF_GAIN
(37), { 0x0000007a, 0x00000049 } },

72 { 
AR5K_RF_GAIN
(38), { 0x00000186, 0x00000089 } },

73 { 
AR5K_RF_GAIN
(39), { 0x000001c6, 0x00000179 } },

74 { 
AR5K_RF_GAIN
(40), { 0x00000006, 0x000001b9 } },

75 { 
AR5K_RF_GAIN
(41), { 0x00000046, 0x000001f9 } },

76 { 
AR5K_RF_GAIN
(42), { 0x00000086, 0x00000039 } },

77 { 
AR5K_RF_GAIN
(43), { 0x000000c6, 0x00000079 } },

78 { 
AR5K_RF_GAIN
(44), { 0x000000c6, 0x000000b9 } },

79 { 
AR5K_RF_GAIN
(45), { 0x000000c6, 0x000001bd } },

80 { 
AR5K_RF_GAIN
(46), { 0x000000c6, 0x000001fd } },

81 { 
AR5K_RF_GAIN
(47), { 0x000000c6, 0x0000003d } },

82 { 
AR5K_RF_GAIN
(48), { 0x000000c6, 0x0000007d } },

83 { 
AR5K_RF_GAIN
(49), { 0x000000c6, 0x000000bd } },

84 { 
AR5K_RF_GAIN
(50), { 0x000000c6, 0x000000fd } },

85 { 
AR5K_RF_GAIN
(51), { 0x000000c6, 0x000000fd } },

86 { 
AR5K_RF_GAIN
(52), { 0x000000c6, 0x000000fd } },

87 { 
AR5K_RF_GAIN
(53), { 0x000000c6, 0x000000fd } },

88 { 
AR5K_RF_GAIN
(54), { 0x000000c6, 0x000000fd } },

89 { 
AR5K_RF_GAIN
(55), { 0x000000c6, 0x000000fd } },

90 { 
AR5K_RF_GAIN
(56), { 0x000000c6, 0x000000fd } },

91 { 
AR5K_RF_GAIN
(57), { 0x000000c6, 0x000000fd } },

92 { 
AR5K_RF_GAIN
(58), { 0x000000c6, 0x000000fd } },

93 { 
AR5K_RF_GAIN
(59), { 0x000000c6, 0x000000fd } },

94 { 
AR5K_RF_GAIN
(60), { 0x000000c6, 0x000000fd } },

95 { 
AR5K_RF_GAIN
(61), { 0x000000c6, 0x000000fd } },

96 { 
AR5K_RF_GAIN
(62), { 0x000000c6, 0x000000fd } },

97 { 
AR5K_RF_GAIN
(63), { 0x000000c6, 0x000000fd } },

101 c⁄° 
©h5k_öi_rfgaö
 
	grfgaö_5112
[] = {

103 { 
AR5K_RF_GAIN
(0), { 0x00000007, 0x00000007 } },

104 { 
AR5K_RF_GAIN
(1), { 0x00000047, 0x00000047 } },

105 { 
AR5K_RF_GAIN
(2), { 0x00000087, 0x00000087 } },

106 { 
AR5K_RF_GAIN
(3), { 0x000001a0, 0x000001a0 } },

107 { 
AR5K_RF_GAIN
(4), { 0x000001e0, 0x000001e0 } },

108 { 
AR5K_RF_GAIN
(5), { 0x00000020, 0x00000020 } },

109 { 
AR5K_RF_GAIN
(6), { 0x00000060, 0x00000060 } },

110 { 
AR5K_RF_GAIN
(7), { 0x000001a1, 0x000001a1 } },

111 { 
AR5K_RF_GAIN
(8), { 0x000001e1, 0x000001e1 } },

112 { 
AR5K_RF_GAIN
(9), { 0x00000021, 0x00000021 } },

113 { 
AR5K_RF_GAIN
(10), { 0x00000061, 0x00000061 } },

114 { 
AR5K_RF_GAIN
(11), { 0x00000162, 0x00000162 } },

115 { 
AR5K_RF_GAIN
(12), { 0x000001a2, 0x000001a2 } },

116 { 
AR5K_RF_GAIN
(13), { 0x000001e2, 0x000001e2 } },

117 { 
AR5K_RF_GAIN
(14), { 0x00000022, 0x00000022 } },

118 { 
AR5K_RF_GAIN
(15), { 0x00000062, 0x00000062 } },

119 { 
AR5K_RF_GAIN
(16), { 0x00000163, 0x00000163 } },

120 { 
AR5K_RF_GAIN
(17), { 0x000001a3, 0x000001a3 } },

121 { 
AR5K_RF_GAIN
(18), { 0x000001e3, 0x000001e3 } },

122 { 
AR5K_RF_GAIN
(19), { 0x00000023, 0x00000023 } },

123 { 
AR5K_RF_GAIN
(20), { 0x00000063, 0x00000063 } },

124 { 
AR5K_RF_GAIN
(21), { 0x00000184, 0x00000184 } },

125 { 
AR5K_RF_GAIN
(22), { 0x000001c4, 0x000001c4 } },

126 { 
AR5K_RF_GAIN
(23), { 0x00000004, 0x00000004 } },

127 { 
AR5K_RF_GAIN
(24), { 0x000001ea, 0x0000000b } },

128 { 
AR5K_RF_GAIN
(25), { 0x0000002a, 0x0000004b } },

129 { 
AR5K_RF_GAIN
(26), { 0x0000006a, 0x0000008b } },

130 { 
AR5K_RF_GAIN
(27), { 0x000000aa, 0x000001ac } },

131 { 
AR5K_RF_GAIN
(28), { 0x000001ab, 0x000001ec } },

132 { 
AR5K_RF_GAIN
(29), { 0x000001eb, 0x0000002c } },

133 { 
AR5K_RF_GAIN
(30), { 0x0000002b, 0x00000012 } },

134 { 
AR5K_RF_GAIN
(31), { 0x0000006b, 0x00000052 } },

135 { 
AR5K_RF_GAIN
(32), { 0x000000ab, 0x00000092 } },

136 { 
AR5K_RF_GAIN
(33), { 0x000001ac, 0x00000193 } },

137 { 
AR5K_RF_GAIN
(34), { 0x000001ec, 0x000001d3 } },

138 { 
AR5K_RF_GAIN
(35), { 0x0000002c, 0x00000013 } },

139 { 
AR5K_RF_GAIN
(36), { 0x0000003a, 0x00000053 } },

140 { 
AR5K_RF_GAIN
(37), { 0x0000007a, 0x00000093 } },

141 { 
AR5K_RF_GAIN
(38), { 0x000000ba, 0x00000194 } },

142 { 
AR5K_RF_GAIN
(39), { 0x000001bb, 0x000001d4 } },

143 { 
AR5K_RF_GAIN
(40), { 0x000001fb, 0x00000014 } },

144 { 
AR5K_RF_GAIN
(41), { 0x0000003b, 0x0000003a } },

145 { 
AR5K_RF_GAIN
(42), { 0x0000007b, 0x0000007a } },

146 { 
AR5K_RF_GAIN
(43), { 0x000000bb, 0x000000ba } },

147 { 
AR5K_RF_GAIN
(44), { 0x000001bc, 0x000001bb } },

148 { 
AR5K_RF_GAIN
(45), { 0x000001fc, 0x000001fb } },

149 { 
AR5K_RF_GAIN
(46), { 0x0000003c, 0x0000003b } },

150 { 
AR5K_RF_GAIN
(47), { 0x0000007c, 0x0000007b } },

151 { 
AR5K_RF_GAIN
(48), { 0x000000bc, 0x000000bb } },

152 { 
AR5K_RF_GAIN
(49), { 0x000000fc, 0x000001bc } },

153 { 
AR5K_RF_GAIN
(50), { 0x000000fc, 0x000001fc } },

154 { 
AR5K_RF_GAIN
(51), { 0x000000fc, 0x0000003c } },

155 { 
AR5K_RF_GAIN
(52), { 0x000000fc, 0x0000007c } },

156 { 
AR5K_RF_GAIN
(53), { 0x000000fc, 0x000000bc } },

157 { 
AR5K_RF_GAIN
(54), { 0x000000fc, 0x000000fc } },

158 { 
AR5K_RF_GAIN
(55), { 0x000000fc, 0x000000fc } },

159 { 
AR5K_RF_GAIN
(56), { 0x000000fc, 0x000000fc } },

160 { 
AR5K_RF_GAIN
(57), { 0x000000fc, 0x000000fc } },

161 { 
AR5K_RF_GAIN
(58), { 0x000000fc, 0x000000fc } },

162 { 
AR5K_RF_GAIN
(59), { 0x000000fc, 0x000000fc } },

163 { 
AR5K_RF_GAIN
(60), { 0x000000fc, 0x000000fc } },

164 { 
AR5K_RF_GAIN
(61), { 0x000000fc, 0x000000fc } },

165 { 
AR5K_RF_GAIN
(62), { 0x000000fc, 0x000000fc } },

166 { 
AR5K_RF_GAIN
(63), { 0x000000fc, 0x000000fc } },

170 c⁄° 
©h5k_öi_rfgaö
 
	grfgaö_2413
[] = {

171 { 
AR5K_RF_GAIN
(0), { 0x00000000, 0x00000000 } },

172 { 
AR5K_RF_GAIN
(1), { 0x00000000, 0x00000040 } },

173 { 
AR5K_RF_GAIN
(2), { 0x00000000, 0x00000080 } },

174 { 
AR5K_RF_GAIN
(3), { 0x00000000, 0x00000181 } },

175 { 
AR5K_RF_GAIN
(4), { 0x00000000, 0x000001c1 } },

176 { 
AR5K_RF_GAIN
(5), { 0x00000000, 0x00000001 } },

177 { 
AR5K_RF_GAIN
(6), { 0x00000000, 0x00000041 } },

178 { 
AR5K_RF_GAIN
(7), { 0x00000000, 0x00000081 } },

179 { 
AR5K_RF_GAIN
(8), { 0x00000000, 0x00000168 } },

180 { 
AR5K_RF_GAIN
(9), { 0x00000000, 0x000001a8 } },

181 { 
AR5K_RF_GAIN
(10), { 0x00000000, 0x000001e8 } },

182 { 
AR5K_RF_GAIN
(11), { 0x00000000, 0x00000028 } },

183 { 
AR5K_RF_GAIN
(12), { 0x00000000, 0x00000068 } },

184 { 
AR5K_RF_GAIN
(13), { 0x00000000, 0x00000189 } },

185 { 
AR5K_RF_GAIN
(14), { 0x00000000, 0x000001c9 } },

186 { 
AR5K_RF_GAIN
(15), { 0x00000000, 0x00000009 } },

187 { 
AR5K_RF_GAIN
(16), { 0x00000000, 0x00000049 } },

188 { 
AR5K_RF_GAIN
(17), { 0x00000000, 0x00000089 } },

189 { 
AR5K_RF_GAIN
(18), { 0x00000000, 0x00000190 } },

190 { 
AR5K_RF_GAIN
(19), { 0x00000000, 0x000001d0 } },

191 { 
AR5K_RF_GAIN
(20), { 0x00000000, 0x00000010 } },

192 { 
AR5K_RF_GAIN
(21), { 0x00000000, 0x00000050 } },

193 { 
AR5K_RF_GAIN
(22), { 0x00000000, 0x00000090 } },

194 { 
AR5K_RF_GAIN
(23), { 0x00000000, 0x00000191 } },

195 { 
AR5K_RF_GAIN
(24), { 0x00000000, 0x000001d1 } },

196 { 
AR5K_RF_GAIN
(25), { 0x00000000, 0x00000011 } },

197 { 
AR5K_RF_GAIN
(26), { 0x00000000, 0x00000051 } },

198 { 
AR5K_RF_GAIN
(27), { 0x00000000, 0x00000091 } },

199 { 
AR5K_RF_GAIN
(28), { 0x00000000, 0x00000178 } },

200 { 
AR5K_RF_GAIN
(29), { 0x00000000, 0x000001b8 } },

201 { 
AR5K_RF_GAIN
(30), { 0x00000000, 0x000001f8 } },

202 { 
AR5K_RF_GAIN
(31), { 0x00000000, 0x00000038 } },

203 { 
AR5K_RF_GAIN
(32), { 0x00000000, 0x00000078 } },

204 { 
AR5K_RF_GAIN
(33), { 0x00000000, 0x00000199 } },

205 { 
AR5K_RF_GAIN
(34), { 0x00000000, 0x000001d9 } },

206 { 
AR5K_RF_GAIN
(35), { 0x00000000, 0x00000019 } },

207 { 
AR5K_RF_GAIN
(36), { 0x00000000, 0x00000059 } },

208 { 
AR5K_RF_GAIN
(37), { 0x00000000, 0x00000099 } },

209 { 
AR5K_RF_GAIN
(38), { 0x00000000, 0x000000d9 } },

210 { 
AR5K_RF_GAIN
(39), { 0x00000000, 0x000000f9 } },

211 { 
AR5K_RF_GAIN
(40), { 0x00000000, 0x000000f9 } },

212 { 
AR5K_RF_GAIN
(41), { 0x00000000, 0x000000f9 } },

213 { 
AR5K_RF_GAIN
(42), { 0x00000000, 0x000000f9 } },

214 { 
AR5K_RF_GAIN
(43), { 0x00000000, 0x000000f9 } },

215 { 
AR5K_RF_GAIN
(44), { 0x00000000, 0x000000f9 } },

216 { 
AR5K_RF_GAIN
(45), { 0x00000000, 0x000000f9 } },

217 { 
AR5K_RF_GAIN
(46), { 0x00000000, 0x000000f9 } },

218 { 
AR5K_RF_GAIN
(47), { 0x00000000, 0x000000f9 } },

219 { 
AR5K_RF_GAIN
(48), { 0x00000000, 0x000000f9 } },

220 { 
AR5K_RF_GAIN
(49), { 0x00000000, 0x000000f9 } },

221 { 
AR5K_RF_GAIN
(50), { 0x00000000, 0x000000f9 } },

222 { 
AR5K_RF_GAIN
(51), { 0x00000000, 0x000000f9 } },

223 { 
AR5K_RF_GAIN
(52), { 0x00000000, 0x000000f9 } },

224 { 
AR5K_RF_GAIN
(53), { 0x00000000, 0x000000f9 } },

225 { 
AR5K_RF_GAIN
(54), { 0x00000000, 0x000000f9 } },

226 { 
AR5K_RF_GAIN
(55), { 0x00000000, 0x000000f9 } },

227 { 
AR5K_RF_GAIN
(56), { 0x00000000, 0x000000f9 } },

228 { 
AR5K_RF_GAIN
(57), { 0x00000000, 0x000000f9 } },

229 { 
AR5K_RF_GAIN
(58), { 0x00000000, 0x000000f9 } },

230 { 
AR5K_RF_GAIN
(59), { 0x00000000, 0x000000f9 } },

231 { 
AR5K_RF_GAIN
(60), { 0x00000000, 0x000000f9 } },

232 { 
AR5K_RF_GAIN
(61), { 0x00000000, 0x000000f9 } },

233 { 
AR5K_RF_GAIN
(62), { 0x00000000, 0x000000f9 } },

234 { 
AR5K_RF_GAIN
(63), { 0x00000000, 0x000000f9 } },

238 c⁄° 
©h5k_öi_rfgaö
 
	grfgaö_2316
[] = {

239 { 
AR5K_RF_GAIN
(0), { 0x00000000, 0x00000000 } },

240 { 
AR5K_RF_GAIN
(1), { 0x00000000, 0x00000040 } },

241 { 
AR5K_RF_GAIN
(2), { 0x00000000, 0x00000080 } },

242 { 
AR5K_RF_GAIN
(3), { 0x00000000, 0x000000c0 } },

243 { 
AR5K_RF_GAIN
(4), { 0x00000000, 0x000000e0 } },

244 { 
AR5K_RF_GAIN
(5), { 0x00000000, 0x000000e0 } },

245 { 
AR5K_RF_GAIN
(6), { 0x00000000, 0x00000128 } },

246 { 
AR5K_RF_GAIN
(7), { 0x00000000, 0x00000128 } },

247 { 
AR5K_RF_GAIN
(8), { 0x00000000, 0x00000128 } },

248 { 
AR5K_RF_GAIN
(9), { 0x00000000, 0x00000168 } },

249 { 
AR5K_RF_GAIN
(10), { 0x00000000, 0x000001a8 } },

250 { 
AR5K_RF_GAIN
(11), { 0x00000000, 0x000001e8 } },

251 { 
AR5K_RF_GAIN
(12), { 0x00000000, 0x00000028 } },

252 { 
AR5K_RF_GAIN
(13), { 0x00000000, 0x00000068 } },

253 { 
AR5K_RF_GAIN
(14), { 0x00000000, 0x000000a8 } },

254 { 
AR5K_RF_GAIN
(15), { 0x00000000, 0x000000e8 } },

255 { 
AR5K_RF_GAIN
(16), { 0x00000000, 0x000000e8 } },

256 { 
AR5K_RF_GAIN
(17), { 0x00000000, 0x00000130 } },

257 { 
AR5K_RF_GAIN
(18), { 0x00000000, 0x00000130 } },

258 { 
AR5K_RF_GAIN
(19), { 0x00000000, 0x00000170 } },

259 { 
AR5K_RF_GAIN
(20), { 0x00000000, 0x000001b0 } },

260 { 
AR5K_RF_GAIN
(21), { 0x00000000, 0x000001f0 } },

261 { 
AR5K_RF_GAIN
(22), { 0x00000000, 0x00000030 } },

262 { 
AR5K_RF_GAIN
(23), { 0x00000000, 0x00000070 } },

263 { 
AR5K_RF_GAIN
(24), { 0x00000000, 0x000000b0 } },

264 { 
AR5K_RF_GAIN
(25), { 0x00000000, 0x000000f0 } },

265 { 
AR5K_RF_GAIN
(26), { 0x00000000, 0x000000f0 } },

266 { 
AR5K_RF_GAIN
(27), { 0x00000000, 0x000000f0 } },

267 { 
AR5K_RF_GAIN
(28), { 0x00000000, 0x000000f0 } },

268 { 
AR5K_RF_GAIN
(29), { 0x00000000, 0x000000f0 } },

269 { 
AR5K_RF_GAIN
(30), { 0x00000000, 0x000000f0 } },

270 { 
AR5K_RF_GAIN
(31), { 0x00000000, 0x000000f0 } },

271 { 
AR5K_RF_GAIN
(32), { 0x00000000, 0x000000f0 } },

272 { 
AR5K_RF_GAIN
(33), { 0x00000000, 0x000000f0 } },

273 { 
AR5K_RF_GAIN
(34), { 0x00000000, 0x000000f0 } },

274 { 
AR5K_RF_GAIN
(35), { 0x00000000, 0x000000f0 } },

275 { 
AR5K_RF_GAIN
(36), { 0x00000000, 0x000000f0 } },

276 { 
AR5K_RF_GAIN
(37), { 0x00000000, 0x000000f0 } },

277 { 
AR5K_RF_GAIN
(38), { 0x00000000, 0x000000f0 } },

278 { 
AR5K_RF_GAIN
(39), { 0x00000000, 0x000000f0 } },

279 { 
AR5K_RF_GAIN
(40), { 0x00000000, 0x000000f0 } },

280 { 
AR5K_RF_GAIN
(41), { 0x00000000, 0x000000f0 } },

281 { 
AR5K_RF_GAIN
(42), { 0x00000000, 0x000000f0 } },

282 { 
AR5K_RF_GAIN
(43), { 0x00000000, 0x000000f0 } },

283 { 
AR5K_RF_GAIN
(44), { 0x00000000, 0x000000f0 } },

284 { 
AR5K_RF_GAIN
(45), { 0x00000000, 0x000000f0 } },

285 { 
AR5K_RF_GAIN
(46), { 0x00000000, 0x000000f0 } },

286 { 
AR5K_RF_GAIN
(47), { 0x00000000, 0x000000f0 } },

287 { 
AR5K_RF_GAIN
(48), { 0x00000000, 0x000000f0 } },

288 { 
AR5K_RF_GAIN
(49), { 0x00000000, 0x000000f0 } },

289 { 
AR5K_RF_GAIN
(50), { 0x00000000, 0x000000f0 } },

290 { 
AR5K_RF_GAIN
(51), { 0x00000000, 0x000000f0 } },

291 { 
AR5K_RF_GAIN
(52), { 0x00000000, 0x000000f0 } },

292 { 
AR5K_RF_GAIN
(53), { 0x00000000, 0x000000f0 } },

293 { 
AR5K_RF_GAIN
(54), { 0x00000000, 0x000000f0 } },

294 { 
AR5K_RF_GAIN
(55), { 0x00000000, 0x000000f0 } },

295 { 
AR5K_RF_GAIN
(56), { 0x00000000, 0x000000f0 } },

296 { 
AR5K_RF_GAIN
(57), { 0x00000000, 0x000000f0 } },

297 { 
AR5K_RF_GAIN
(58), { 0x00000000, 0x000000f0 } },

298 { 
AR5K_RF_GAIN
(59), { 0x00000000, 0x000000f0 } },

299 { 
AR5K_RF_GAIN
(60), { 0x00000000, 0x000000f0 } },

300 { 
AR5K_RF_GAIN
(61), { 0x00000000, 0x000000f0 } },

301 { 
AR5K_RF_GAIN
(62), { 0x00000000, 0x000000f0 } },

302 { 
AR5K_RF_GAIN
(63), { 0x00000000, 0x000000f0 } },

307 c⁄° 
©h5k_öi_rfgaö
 
	grfgaö_5413
[] = {

309 { 
AR5K_RF_GAIN
(0), { 0x00000000, 0x00000000 } },

310 { 
AR5K_RF_GAIN
(1), { 0x00000040, 0x00000040 } },

311 { 
AR5K_RF_GAIN
(2), { 0x00000080, 0x00000080 } },

312 { 
AR5K_RF_GAIN
(3), { 0x000001a1, 0x00000161 } },

313 { 
AR5K_RF_GAIN
(4), { 0x000001e1, 0x000001a1 } },

314 { 
AR5K_RF_GAIN
(5), { 0x00000021, 0x000001e1 } },

315 { 
AR5K_RF_GAIN
(6), { 0x00000061, 0x00000021 } },

316 { 
AR5K_RF_GAIN
(7), { 0x00000188, 0x00000061 } },

317 { 
AR5K_RF_GAIN
(8), { 0x000001c8, 0x00000188 } },

318 { 
AR5K_RF_GAIN
(9), { 0x00000008, 0x000001c8 } },

319 { 
AR5K_RF_GAIN
(10), { 0x00000048, 0x00000008 } },

320 { 
AR5K_RF_GAIN
(11), { 0x00000088, 0x00000048 } },

321 { 
AR5K_RF_GAIN
(12), { 0x000001a9, 0x00000088 } },

322 { 
AR5K_RF_GAIN
(13), { 0x000001e9, 0x00000169 } },

323 { 
AR5K_RF_GAIN
(14), { 0x00000029, 0x000001a9 } },

324 { 
AR5K_RF_GAIN
(15), { 0x00000069, 0x000001e9 } },

325 { 
AR5K_RF_GAIN
(16), { 0x000001d0, 0x00000029 } },

326 { 
AR5K_RF_GAIN
(17), { 0x00000010, 0x00000069 } },

327 { 
AR5K_RF_GAIN
(18), { 0x00000050, 0x00000190 } },

328 { 
AR5K_RF_GAIN
(19), { 0x00000090, 0x000001d0 } },

329 { 
AR5K_RF_GAIN
(20), { 0x000001b1, 0x00000010 } },

330 { 
AR5K_RF_GAIN
(21), { 0x000001f1, 0x00000050 } },

331 { 
AR5K_RF_GAIN
(22), { 0x00000031, 0x00000090 } },

332 { 
AR5K_RF_GAIN
(23), { 0x00000071, 0x00000171 } },

333 { 
AR5K_RF_GAIN
(24), { 0x000001b8, 0x000001b1 } },

334 { 
AR5K_RF_GAIN
(25), { 0x000001f8, 0x000001f1 } },

335 { 
AR5K_RF_GAIN
(26), { 0x00000038, 0x00000031 } },

336 { 
AR5K_RF_GAIN
(27), { 0x00000078, 0x00000071 } },

337 { 
AR5K_RF_GAIN
(28), { 0x00000199, 0x00000198 } },

338 { 
AR5K_RF_GAIN
(29), { 0x000001d9, 0x000001d8 } },

339 { 
AR5K_RF_GAIN
(30), { 0x00000019, 0x00000018 } },

340 { 
AR5K_RF_GAIN
(31), { 0x00000059, 0x00000058 } },

341 { 
AR5K_RF_GAIN
(32), { 0x00000099, 0x00000098 } },

342 { 
AR5K_RF_GAIN
(33), { 0x000000d9, 0x00000179 } },

343 { 
AR5K_RF_GAIN
(34), { 0x000000f9, 0x000001b9 } },

344 { 
AR5K_RF_GAIN
(35), { 0x000000f9, 0x000001f9 } },

345 { 
AR5K_RF_GAIN
(36), { 0x000000f9, 0x00000039 } },

346 { 
AR5K_RF_GAIN
(37), { 0x000000f9, 0x00000079 } },

347 { 
AR5K_RF_GAIN
(38), { 0x000000f9, 0x000000b9 } },

348 { 
AR5K_RF_GAIN
(39), { 0x000000f9, 0x000000f9 } },

349 { 
AR5K_RF_GAIN
(40), { 0x000000f9, 0x000000f9 } },

350 { 
AR5K_RF_GAIN
(41), { 0x000000f9, 0x000000f9 } },

351 { 
AR5K_RF_GAIN
(42), { 0x000000f9, 0x000000f9 } },

352 { 
AR5K_RF_GAIN
(43), { 0x000000f9, 0x000000f9 } },

353 { 
AR5K_RF_GAIN
(44), { 0x000000f9, 0x000000f9 } },

354 { 
AR5K_RF_GAIN
(45), { 0x000000f9, 0x000000f9 } },

355 { 
AR5K_RF_GAIN
(46), { 0x000000f9, 0x000000f9 } },

356 { 
AR5K_RF_GAIN
(47), { 0x000000f9, 0x000000f9 } },

357 { 
AR5K_RF_GAIN
(48), { 0x000000f9, 0x000000f9 } },

358 { 
AR5K_RF_GAIN
(49), { 0x000000f9, 0x000000f9 } },

359 { 
AR5K_RF_GAIN
(50), { 0x000000f9, 0x000000f9 } },

360 { 
AR5K_RF_GAIN
(51), { 0x000000f9, 0x000000f9 } },

361 { 
AR5K_RF_GAIN
(52), { 0x000000f9, 0x000000f9 } },

362 { 
AR5K_RF_GAIN
(53), { 0x000000f9, 0x000000f9 } },

363 { 
AR5K_RF_GAIN
(54), { 0x000000f9, 0x000000f9 } },

364 { 
AR5K_RF_GAIN
(55), { 0x000000f9, 0x000000f9 } },

365 { 
AR5K_RF_GAIN
(56), { 0x000000f9, 0x000000f9 } },

366 { 
AR5K_RF_GAIN
(57), { 0x000000f9, 0x000000f9 } },

367 { 
AR5K_RF_GAIN
(58), { 0x000000f9, 0x000000f9 } },

368 { 
AR5K_RF_GAIN
(59), { 0x000000f9, 0x000000f9 } },

369 { 
AR5K_RF_GAIN
(60), { 0x000000f9, 0x000000f9 } },

370 { 
AR5K_RF_GAIN
(61), { 0x000000f9, 0x000000f9 } },

371 { 
AR5K_RF_GAIN
(62), { 0x000000f9, 0x000000f9 } },

372 { 
AR5K_RF_GAIN
(63), { 0x000000f9, 0x000000f9 } },

377 c⁄° 
©h5k_öi_rfgaö
 
	grfgaö_2425
[] = {

378 { 
AR5K_RF_GAIN
(0), { 0x00000000, 0x00000000 } },

379 { 
AR5K_RF_GAIN
(1), { 0x00000000, 0x00000040 } },

380 { 
AR5K_RF_GAIN
(2), { 0x00000000, 0x00000080 } },

381 { 
AR5K_RF_GAIN
(3), { 0x00000000, 0x00000181 } },

382 { 
AR5K_RF_GAIN
(4), { 0x00000000, 0x000001c1 } },

383 { 
AR5K_RF_GAIN
(5), { 0x00000000, 0x00000001 } },

384 { 
AR5K_RF_GAIN
(6), { 0x00000000, 0x00000041 } },

385 { 
AR5K_RF_GAIN
(7), { 0x00000000, 0x00000081 } },

386 { 
AR5K_RF_GAIN
(8), { 0x00000000, 0x00000188 } },

387 { 
AR5K_RF_GAIN
(9), { 0x00000000, 0x000001c8 } },

388 { 
AR5K_RF_GAIN
(10), { 0x00000000, 0x00000008 } },

389 { 
AR5K_RF_GAIN
(11), { 0x00000000, 0x00000048 } },

390 { 
AR5K_RF_GAIN
(12), { 0x00000000, 0x00000088 } },

391 { 
AR5K_RF_GAIN
(13), { 0x00000000, 0x00000189 } },

392 { 
AR5K_RF_GAIN
(14), { 0x00000000, 0x000001c9 } },

393 { 
AR5K_RF_GAIN
(15), { 0x00000000, 0x00000009 } },

394 { 
AR5K_RF_GAIN
(16), { 0x00000000, 0x00000049 } },

395 { 
AR5K_RF_GAIN
(17), { 0x00000000, 0x00000089 } },

396 { 
AR5K_RF_GAIN
(18), { 0x00000000, 0x000001b0 } },

397 { 
AR5K_RF_GAIN
(19), { 0x00000000, 0x000001f0 } },

398 { 
AR5K_RF_GAIN
(20), { 0x00000000, 0x00000030 } },

399 { 
AR5K_RF_GAIN
(21), { 0x00000000, 0x00000070 } },

400 { 
AR5K_RF_GAIN
(22), { 0x00000000, 0x00000171 } },

401 { 
AR5K_RF_GAIN
(23), { 0x00000000, 0x000001b1 } },

402 { 
AR5K_RF_GAIN
(24), { 0x00000000, 0x000001f1 } },

403 { 
AR5K_RF_GAIN
(25), { 0x00000000, 0x00000031 } },

404 { 
AR5K_RF_GAIN
(26), { 0x00000000, 0x00000071 } },

405 { 
AR5K_RF_GAIN
(27), { 0x00000000, 0x000001b8 } },

406 { 
AR5K_RF_GAIN
(28), { 0x00000000, 0x000001f8 } },

407 { 
AR5K_RF_GAIN
(29), { 0x00000000, 0x00000038 } },

408 { 
AR5K_RF_GAIN
(30), { 0x00000000, 0x00000078 } },

409 { 
AR5K_RF_GAIN
(31), { 0x00000000, 0x000000b8 } },

410 { 
AR5K_RF_GAIN
(32), { 0x00000000, 0x000001b9 } },

411 { 
AR5K_RF_GAIN
(33), { 0x00000000, 0x000001f9 } },

412 { 
AR5K_RF_GAIN
(34), { 0x00000000, 0x00000039 } },

413 { 
AR5K_RF_GAIN
(35), { 0x00000000, 0x00000079 } },

414 { 
AR5K_RF_GAIN
(36), { 0x00000000, 0x000000b9 } },

415 { 
AR5K_RF_GAIN
(37), { 0x00000000, 0x000000f9 } },

416 { 
AR5K_RF_GAIN
(38), { 0x00000000, 0x000000f9 } },

417 { 
AR5K_RF_GAIN
(39), { 0x00000000, 0x000000f9 } },

418 { 
AR5K_RF_GAIN
(40), { 0x00000000, 0x000000f9 } },

419 { 
AR5K_RF_GAIN
(41), { 0x00000000, 0x000000f9 } },

420 { 
AR5K_RF_GAIN
(42), { 0x00000000, 0x000000f9 } },

421 { 
AR5K_RF_GAIN
(43), { 0x00000000, 0x000000f9 } },

422 { 
AR5K_RF_GAIN
(44), { 0x00000000, 0x000000f9 } },

423 { 
AR5K_RF_GAIN
(45), { 0x00000000, 0x000000f9 } },

424 { 
AR5K_RF_GAIN
(46), { 0x00000000, 0x000000f9 } },

425 { 
AR5K_RF_GAIN
(47), { 0x00000000, 0x000000f9 } },

426 { 
AR5K_RF_GAIN
(48), { 0x00000000, 0x000000f9 } },

427 { 
AR5K_RF_GAIN
(49), { 0x00000000, 0x000000f9 } },

428 { 
AR5K_RF_GAIN
(50), { 0x00000000, 0x000000f9 } },

429 { 
AR5K_RF_GAIN
(51), { 0x00000000, 0x000000f9 } },

430 { 
AR5K_RF_GAIN
(52), { 0x00000000, 0x000000f9 } },

431 { 
AR5K_RF_GAIN
(53), { 0x00000000, 0x000000f9 } },

432 { 
AR5K_RF_GAIN
(54), { 0x00000000, 0x000000f9 } },

433 { 
AR5K_RF_GAIN
(55), { 0x00000000, 0x000000f9 } },

434 { 
AR5K_RF_GAIN
(56), { 0x00000000, 0x000000f9 } },

435 { 
AR5K_RF_GAIN
(57), { 0x00000000, 0x000000f9 } },

436 { 
AR5K_RF_GAIN
(58), { 0x00000000, 0x000000f9 } },

437 { 
AR5K_RF_GAIN
(59), { 0x00000000, 0x000000f9 } },

438 { 
AR5K_RF_GAIN
(60), { 0x00000000, 0x000000f9 } },

439 { 
AR5K_RF_GAIN
(61), { 0x00000000, 0x000000f9 } },

440 { 
AR5K_RF_GAIN
(62), { 0x00000000, 0x000000f9 } },

441 { 
AR5K_RF_GAIN
(63), { 0x00000000, 0x000000f9 } },

444 
	#AR5K_GAIN_CRN_FIX_BITS_5111
 4

	)

445 
	#AR5K_GAIN_CRN_FIX_BITS_5112
 7

	)

446 
	#AR5K_GAIN_CRN_MAX_FIX_BITS
 
AR5K_GAIN_CRN_FIX_BITS_5112


	)

447 
	#AR5K_GAIN_DYN_ADJUST_HI_MARGIN
 15

	)

448 
	#AR5K_GAIN_DYN_ADJUST_LO_MARGIN
 20

	)

449 
	#AR5K_GAIN_CCK_PROBE_CORR
 5

	)

450 
	#AR5K_GAIN_CCK_OFDM_GAIN_DELTA
 15

	)

451 
	#AR5K_GAIN_STEP_COUNT
 10

	)

455 
	#AR5K_GAIN_CHECK_ADJUST
(
_g
) \

456 ((
_g
)->
g_cuºít
 <(_g)->
g_low
 || (_g)->g_cuºíà>(_g)->
g_high
)

	)

458 
	s©h5k_gaö_›t_°ï
 {

459 
s8
 
	mgos_∑øm
[
AR5K_GAIN_CRN_MAX_FIX_BITS
];

460 
s8
 
	mgos_gaö
;

463 
	s©h5k_gaö_›t
 {

464 
u8
 
	mgo_deÁu…
;

465 
u8
 
	mgo_°ïs_cou¡
;

466 c⁄° 
©h5k_gaö_›t_°ï
 
	mgo_°ï
[
AR5K_GAIN_STEP_COUNT
];

476 c⁄° 
©h5k_gaö_›t
 
	grfgaö_›t_5111
 = {

502 c⁄° 
©h5k_gaö_›t
 
	grfgaö_›t_5112
 = {

	@ath5k/rfkill.c

36 
	~"ba£.h
"

39 
ölöe
 
	$©h5k_rfkûl_dißbÀ
(
©h5k_hw
 *
ah
)

41 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_ANY
, "rfkill disable (gpio:%dÖolarity:%d)\n",

42 
ah
->
rf_kûl
.
gpio
,áh->rf_kûl.
pﬁ¨ôy
);

43 
	`©h5k_hw_£t_gpio_ouçut
(
ah
,áh->
rf_kûl
.
gpio
);

44 
	`©h5k_hw_£t_gpio
(
ah
,áh->
rf_kûl
.
gpio
, !ah->rf_kûl.
pﬁ¨ôy
);

45 
	}
}

48 
ölöe
 
	$©h5k_rfkûl_íabÀ
(
©h5k_hw
 *
ah
)

50 
	`ATH5K_DBG
(
ah
, 
ATH5K_DEBUG_ANY
, "rfkillÉnable (gpio:%dÖolarity:%d)\n",

51 
ah
->
rf_kûl
.
gpio
,áh->rf_kûl.
pﬁ¨ôy
);

52 
	`©h5k_hw_£t_gpio_ouçut
(
ah
,áh->
rf_kûl
.
gpio
);

53 
	`©h5k_hw_£t_gpio
(
ah
,áh->
rf_kûl
.
gpio
,áh->rf_kûl.
pﬁ¨ôy
);

54 
	}
}

56 
ölöe
 
	$©h5k_rfkûl_£t_öå
(
©h5k_hw
 *
ah
, 
boﬁ
 
íabÀ
)

58 
u32
 
curvÆ
;

60 
	`©h5k_hw_£t_gpio_öput
(
ah
,áh->
rf_kûl
.
gpio
);

61 
curvÆ
 = 
	`©h5k_hw_gë_gpio
(
ah
,áh->
rf_kûl
.
gpio
);

62 
	`©h5k_hw_£t_gpio_öå
(
ah
,áh->
rf_kûl
.
gpio
, 
íabÀ
 ?

63 !!
curvÆ
 : !curval);

64 
	}
}

66 
boﬁ


67 
	$©h5k_is_rfkûl_£t
(
©h5k_hw
 *
ah
)

71  
	`©h5k_hw_gë_gpio
(
ah
,áh->
rf_kûl
.
gpio
) ==

72 
ah
->
rf_kûl
.
pﬁ¨ôy
;

73 
	}
}

76 
	$©h5k_èskÀt_rfkûl_toggÀ
(
d©a
)

78 
©h5k_hw
 *
ah
 = (*)
d©a
;

79 
boﬁ
 
blocked
;

81 
blocked
 = 
	`©h5k_is_rfkûl_£t
(
ah
);

82 
	`wùhy_rfkûl_£t_hw_°©e
(
ah
->
hw
->
wùhy
, 
blocked
);

83 
	}
}

87 
	$©h5k_rfkûl_hw_°¨t
(
©h5k_hw
 *
ah
)

90 
ah
->
rf_kûl
.
gpio
 =áh->
ah_ˇ∑bûôõs
.
ˇp_ì¥om
.
ì_rfkûl_pö
;

91 
ah
->
rf_kûl
.
pﬁ¨ôy
 =áh->
ah_ˇ∑bûôõs
.
ˇp_ì¥om
.
ì_rfkûl_pﬁ
;

93 
	`èskÀt_öô
(&
ah
->
rf_kûl
.
toggÀq
, 
©h5k_èskÀt_rfkûl_toggÀ
,

94 ()
ah
);

96 
	`©h5k_rfkûl_dißbÀ
(
ah
);

99 i‡(
	`AR5K_EEPROM_HDR_RFKILL
(
ah
->
ah_ˇ∑bûôõs
.
ˇp_ì¥om
.
ì_hódî
))

100 
	`©h5k_rfkûl_£t_öå
(
ah
, 
åue
);

101 
	}
}

105 
	$©h5k_rfkûl_hw_°›
(
©h5k_hw
 *
ah
)

108 i‡(
	`AR5K_EEPROM_HDR_RFKILL
(
ah
->
ah_ˇ∑bûôõs
.
ˇp_ì¥om
.
ì_hódî
))

109 
	`©h5k_rfkûl_£t_öå
(
ah
, 
Ál£
);

111 
	`èskÀt_kûl
(&
ah
->
rf_kûl
.
toggÀq
);

114 
	`©h5k_rfkûl_íabÀ
(
ah
);

115 
	}
}

	@ath5k/sysfs.c

1 
	~<löux/devi˚.h
>

2 
	~<löux/pci.h
>

4 
	~"ba£.h
"

5 
	~"©h5k.h
"

6 
	~"ªg.h
"

8 
	#SIMPLE_SHOW_STORE
(
«me
, 
gë
, 
£t
) \

9 
ssize_t
 
©h5k_©å_show_
##
	`«me
(
devi˚
 *
dev
, \

10 
devi˚_©åibuã
 *
©å
, \

11 *
buf
) \

13 
õì80211_hw
 *
hw
 = 
	`dev_gë_drvd©a
(
dev
); \

14 
©h5k_hw
 *
ah
 = 
hw
->
¥iv
; \

15  
	`¢¥ötf
(
buf
, 
PAGE_SIZE
, "%d\n", 
gë
); \

18 
ssize_t
 
©h5k_©å_°‹e_
##
	`«me
(
devi˚
 *
dev
, \

19 
devi˚_©åibuã
 *
©å
, \

20 c⁄° *
buf
, 
size_t
 
cou¡
) \

22 
õì80211_hw
 *
hw
 = 
	`dev_gë_drvd©a
(
dev
); \

23 
©h5k_hw
 *
ah
 = 
hw
->
¥iv
; \

24 
vÆ
, 
ªt
; \

26 
ªt
 = 
	`k°πoöt
(
buf
, 10, &
vÆ
); \

27 i‡(
ªt
 < 0) \

28  
ªt
; \

29 
	`£t
(
ah
, 
vÆ
); \

30  
cou¡
; \

32 
	`DEVICE_ATTR
(
«me
, 
S_IRUGO
 | 
S_IWUSR
, \

33 
©h5k_©å_show_
##
«me
, 
©h5k_©å_°‹e_
##«me)

	)

35 
	#SIMPLE_SHOW
(
«me
, 
gë
) \

36 
ssize_t
 
©h5k_©å_show_
##
	`«me
(
devi˚
 *
dev
, \

37 
devi˚_©åibuã
 *
©å
, \

38 *
buf
) \

40 
õì80211_hw
 *
hw
 = 
	`dev_gë_drvd©a
(
dev
); \

41 
©h5k_hw
 *
ah
 = 
hw
->
¥iv
; \

42  
	`¢¥ötf
(
buf
, 
PAGE_SIZE
, "%d\n", 
gë
); \

44 
	`DEVICE_ATTR
(
«me
, 
S_IRUGO
, 
©h5k_©å_show_
##«me, 
NULL
)

	)

48 
SIMPLE_SHOW_STORE
(
™i_mode
, 
ah
->
™i_°©e
.™i_mode, 
©h5k_™i_öô
);

49 
SIMPLE_SHOW_STORE
(
noi£_immunôy_Àvñ
, 
ah
->
™i_°©e
.
noi£_imm_Àvñ
,

50 
©h5k_™i_£t_noi£_immunôy_Àvñ
);

51 
SIMPLE_SHOW_STORE
(
•ur_Àvñ
, 
ah
->
™i_°©e
.spur_level,

52 
©h5k_™i_£t_•ur_immunôy_Àvñ
);

53 
SIMPLE_SHOW_STORE
(
fú°ï_Àvñ
, 
ah
->
™i_°©e
.firstep_level,

54 
©h5k_™i_£t_fú°ï_Àvñ
);

55 
SIMPLE_SHOW_STORE
(
ofdm_wók_sig«l_dëe˘i⁄
, 
ah
->
™i_°©e
.
ofdm_wók_sig
,

56 
©h5k_™i_£t_ofdm_wók_sig«l_dëe˘i⁄
);

57 
SIMPLE_SHOW_STORE
(
cck_wók_sig«l_dëe˘i⁄
, 
ah
->
™i_°©e
.
cck_wók_sig
,

58 
©h5k_™i_£t_cck_wók_sig«l_dëe˘i⁄
);

59 
SIMPLE_SHOW
(
•ur_Àvñ_max
, 
ah
->
™i_°©e
.
max_•ur_Àvñ
);

61 
ssize_t
 
	$©h5k_©å_show_noi£_immunôy_Àvñ_max
(
devi˚
 *
dev
,

62 
devi˚_©åibuã
 *
©å
,

63 *
buf
)

65  
	`¢¥ötf
(
buf
, 
PAGE_SIZE
, "%d\n", 
ATH5K_ANI_MAX_NOISE_IMM_LVL
);

66 
	}
}

67 
DEVICE_ATTR
(
noi£_immunôy_Àvñ_max
, 
S_IRUGO
,

68 
©h5k_©å_show_noi£_immunôy_Àvñ_max
, 
NULL
);

70 
ssize_t
 
	$©h5k_©å_show_fú°ï_Àvñ_max
(
devi˚
 *
dev
,

71 
devi˚_©åibuã
 *
©å
,

72 *
buf
)

74  
	`¢¥ötf
(
buf
, 
PAGE_SIZE
, "%d\n", 
ATH5K_ANI_MAX_FIRSTEP_LVL
);

75 
	}
}

76 
DEVICE_ATTR
(
fú°ï_Àvñ_max
, 
S_IRUGO
,

77 
©h5k_©å_show_fú°ï_Àvñ_max
, 
NULL
);

79 
©åibuã
 *
	g©h5k_sysfs_íåõs_™i
[] = {

80 &
dev_©å_™i_mode
.
©å
,

81 &
dev_©å_noi£_immunôy_Àvñ
.
©å
,

82 &
dev_©å_•ur_Àvñ
.
©å
,

83 &
dev_©å_fú°ï_Àvñ
.
©å
,

84 &
dev_©å_ofdm_wók_sig«l_dëe˘i⁄
.
©å
,

85 &
dev_©å_cck_wók_sig«l_dëe˘i⁄
.
©å
,

86 &
dev_©å_noi£_immunôy_Àvñ_max
.
©å
,

87 &
dev_©å_•ur_Àvñ_max
.
©å
,

88 &
dev_©å_fú°ï_Àvñ_max
.
©å
,

89 
NULL


92 
©åibuã_group
 
	g©h5k_©åibuã_group_™i
 = {

93 .
«me
 = "ani",

94 .
	g©ås
 = 
©h5k_sysfs_íåõs_™i
,

101 
	$©h5k_sysfs_ªgi°î
(
©h5k_hw
 *
ah
)

103 
devi˚
 *
dev
 = 
ah
->dev;

104 
îr
;

106 
îr
 = 
	`sysfs_¸óã_group
(&
dev
->
kobj
, &
©h5k_©åibuã_group_™i
);

107 i‡(
îr
) {

108 
	`ATH5K_ERR
(
ah
, "failedÅo create sysfs group\n");

109  
îr
;

113 
	}
}

116 
	$©h5k_sysfs_uƒegi°î
(
©h5k_hw
 *
ah
)

118 
devi˚
 *
dev
 = 
ah
->dev;

120 
	`sysfs_ªmove_group
(&
dev
->
kobj
, &
©h5k_©åibuã_group_™i
);

121 
	}
}

	@ath5k/trace.h

1 #i‡!
deföed
(
__TRACE_ATH5K_H
Ë|| deföed(
TRACE_HEADER_MULTI_READ
)

2 
	#__TRACE_ATH5K_H


	)

4 
	~<löux/åa˚poöt.h
>

5 
	~"ba£.h
"

7 #i‚de‡
CONFIG_ATH5K_TRACER


8 #unde‡
TRACE_EVENT


9 
	#TRACE_EVENT
(
«me
, 
¥Ÿo
, ...) \

10 
ölöe
 
åa˚_
 ## 
	`«me
(
¥Ÿo
Ë{}

	)

13 
	gsk_buff
;

15 #unde‡
TRACE_SYSTEM


16 
	#TRACE_SYSTEM
 
©h5k


	)

18 
TRACE_EVENT
(
©h5k_rx
,

19 
TP_PROTO
(
©h5k_hw
 *
¥iv
, 
sk_buff
 *
skb
),

20 
TP_ARGS
(
¥iv
, 
skb
),

21 
TP_STRUCT__íåy
(

22 
	$__fõld
(
©h5k_hw
 *, 
¥iv
)

23 
	$__fõld
(, 
skbaddr
)

24 
	`__dy«mic_¨øy
(
u8
, 
‰ame
, 
skb
->
Àn
)

26 
	`TP_Á°_assign
(

27 
__íåy
->
¥iv
 =Öriv;

28 
__íåy
->
skbaddr
 = (Ë
skb
;

29 
	`mem˝y
(
	`__gë_dy«mic_¨øy
(
‰ame
), 
skb
->
d©a
, skb->
Àn
);

31 
	`TP_¥ötk
(

32 "[%p] RX skb=%lx", 
__íåy
->
¥iv
, __íåy->
skbaddr


36 
	`TRACE_EVENT
(
©h5k_tx
,

37 
	`TP_PROTO
(
©h5k_hw
 *
¥iv
, 
sk_buff
 *
skb
,

38 
©h5k_txq
 *
q
),

40 
	`TP_ARGS
(
¥iv
, 
skb
, 
q
),

42 
	`TP_STRUCT__íåy
(

43 
	$__fõld
(
©h5k_hw
 *, 
¥iv
)

44 
	$__fõld
(, 
skbaddr
)

45 
	$__fõld
(
u8
, 
qnum
)

46 
	`__dy«mic_¨øy
(
u8
, 
‰ame
, 
skb
->
Àn
)

49 
	`TP_Á°_assign
(

50 
__íåy
->
¥iv
 =Öriv;

51 
__íåy
->
skbaddr
 = (Ë
skb
;

52 
__íåy
->
qnum
 = (
u8
Ë
q
->qnum;

53 
	`mem˝y
(
	`__gë_dy«mic_¨øy
(
‰ame
), 
skb
->
d©a
, skb->
Àn
);

56 
	`TP_¥ötk
(

57 "[%p] TX skb=%lx q=%d", 
__íåy
->
¥iv
, __íåy->
skbaddr
,

58 
__íåy
->
qnum


62 
	`TRACE_EVENT
(
©h5k_tx_com∂ëe
,

63 
	`TP_PROTO
(
©h5k_hw
 *
¥iv
, 
sk_buff
 *
skb
,

64 
©h5k_txq
 *
q
, 
©h5k_tx_°©us
 *
ts
),

66 
	`TP_ARGS
(
¥iv
, 
skb
, 
q
, 
ts
),

68 
	`TP_STRUCT__íåy
(

69 
	$__fõld
(
©h5k_hw
 *, 
¥iv
)

70 
	$__fõld
(, 
skbaddr
)

71 
	$__fõld
(
u8
, 
qnum
)

72 
	$__fõld
(
u8
, 
ts_°©us
)

73 
	$__fõld
(
s8
, 
ts_rssi
)

74 
	`__fõld
(
u8
, 
ts_™ã¬a
)

77 
	`TP_Á°_assign
(

78 
__íåy
->
¥iv
 =Öriv;

79 
__íåy
->
skbaddr
 = (Ë
skb
;

80 
__íåy
->
qnum
 = (
u8
Ë
q
->qnum;

81 
__íåy
->
ts_°©us
 = 
ts
->ts_status;

82 
__íåy
->
ts_rssi
 = 
ts
->ts_rssi;

83 
__íåy
->
ts_™ã¬a
 = 
ts
->ts_antenna;

86 
	`TP_¥ötk
(

88 
__íåy
->
¥iv
, __íåy->
skbaddr
, __íåy->
qnum
,

89 
__íåy
->
ts_°©us
, __íåy->
ts_rssi
, __íåy->
ts_™ã¬a


95 #ifde‡
CONFIG_ATH5K_TRACER


97 #unde‡
TRACE_INCLUDE_PATH


98 
	#TRACE_INCLUDE_PATH
 ../../
drivîs
/
√t
/
wúñess
/
©h
/
©h5k


	)

99 #unde‡
TRACE_INCLUDE_FILE


100 
	#TRACE_INCLUDE_FILE
 
åa˚


	)

102 
	~<åa˚/deföe_åa˚.h
>

	@debug.c

17 
	~"©h.h
"

19 c⁄° *
	$©h_›mode_to_°rög
(
∆80211_i·y≥
 
›mode
)

21 
›mode
) {

22 
NL80211_IFTYPE_UNSPECIFIED
:

24 
NL80211_IFTYPE_ADHOC
:

26 
NL80211_IFTYPE_STATION
:

28 
NL80211_IFTYPE_AP
:

30 
NL80211_IFTYPE_AP_VLAN
:

32 
NL80211_IFTYPE_WDS
:

34 
NL80211_IFTYPE_MONITOR
:

36 
NL80211_IFTYPE_MESH_POINT
:

38 
NL80211_IFTYPE_P2P_CLIENT
:

40 
NL80211_IFTYPE_P2P_GO
:

45 
	}
}

46 
EXPORT_SYMBOL
(
©h_›mode_to_°rög
);

	@hw.c

17 
	~<asm/u«lig√d.h
>

19 
	~"©h.h
"

20 
	~"ªg.h
"

22 
	#REG_READ
 (
comm⁄
->
›s
->
ªad
)

	)

23 
	#REG_WRITE
 (
comm⁄
->
›s
->
wrôe
)

	)

117 
	$©h_hw_£tbssidmask
(
©h_comm⁄
 *
comm⁄
)

119 *
ah
 = 
comm⁄
->ah;

121 
	`REG_WRITE
(
ah
, 
	`gë_u«lig√d_À32
(
comm⁄
->
bssidmask
), 
AR_BSSMSKL
);

122 
	`REG_WRITE
(
ah
, 
	`gë_u«lig√d_À16
(
comm⁄
->
bssidmask
 + 4), 
AR_BSSMSKU
);

123 
	}
}

124 
EXPORT_SYMBOL
(
©h_hw_£tbssidmask
);

135 
	$©h_hw_cy˛e_cou¡îs_upd©e
(
©h_comm⁄
 *
comm⁄
)

137 
u32
 
cy˛es
, 
busy
, 
rx
, 
tx
;

138 *
ah
 = 
comm⁄
->ah;

141 
	`REG_WRITE
(
ah
, 
AR_MIBC_FMC
, 
AR_MIBC
);

144 
cy˛es
 = 
	`REG_READ
(
ah
, 
AR_CCCNT
);

145 
busy
 = 
	`REG_READ
(
ah
, 
AR_RCCNT
);

146 
rx
 = 
	`REG_READ
(
ah
, 
AR_RFCNT
);

147 
tx
 = 
	`REG_READ
(
ah
, 
AR_TFCNT
);

150 
	`REG_WRITE
(
ah
, 0, 
AR_CCCNT
);

151 
	`REG_WRITE
(
ah
, 0, 
AR_RFCNT
);

152 
	`REG_WRITE
(
ah
, 0, 
AR_RCCNT
);

153 
	`REG_WRITE
(
ah
, 0, 
AR_TFCNT
);

156 
	`REG_WRITE
(
ah
, 0, 
AR_MIBC
);

159 
comm⁄
->
cc_™i
.
cy˛es
 += cycles;

160 
comm⁄
->
cc_™i
.
rx_busy
 +
busy
;

161 
comm⁄
->
cc_™i
.
rx_‰ame
 +
rx
;

162 
comm⁄
->
cc_™i
.
tx_‰ame
 +
tx
;

164 
comm⁄
->
cc_survey
.
cy˛es
 += cycles;

165 
comm⁄
->
cc_survey
.
rx_busy
 +
busy
;

166 
comm⁄
->
cc_survey
.
rx_‰ame
 +
rx
;

167 
comm⁄
->
cc_survey
.
tx_‰ame
 +
tx
;

168 
	}
}

169 
EXPORT_SYMBOL
(
©h_hw_cy˛e_cou¡îs_upd©e
);

171 
öt32_t
 
	$©h_hw_gë_li°í_time
(
©h_comm⁄
 *
comm⁄
)

173 
©h_cy˛e_cou¡îs
 *
cc
 = &
comm⁄
->
cc_™i
;

174 
öt32_t
 
li°í_time
;

176 
li°í_time
 = (
cc
->
cy˛es
 - cc->
rx_‰ame
 - cc->
tx_‰ame
) /

177 (
comm⁄
->
˛ockøã
 * 1000);

179 
	`mem£t
(
cc
, 0, (*cc));

181  
li°í_time
;

182 
	}
}

183 
EXPORT_SYMBOL
(
©h_hw_gë_li°í_time
);

	@key.c

18 
	~<asm/u«lig√d.h
>

19 
	~<√t/mac80211.h
>

21 
	~"©h.h
"

22 
	~"ªg.h
"

24 
	#REG_READ
 (
comm⁄
->
›s
->
ªad
)

	)

25 
	#REG_WRITE
(
_ah
, 
_ªg
, 
_vÆ
Ë(
comm⁄
->
›s
->
wrôe
)(_ah, _vÆ, _ªg)

	)

26 
	#ENABLE_REGWRITE_BUFFER
(
_ah
) \

27 i‡(
comm⁄
->
›s
->
íabÀ_wrôe_buf„r
) \

28 
comm⁄
->
›s
->
	`íabÀ_wrôe_buf„r
((
_ah
));

	)

30 
	#REGWRITE_BUFFER_FLUSH
(
_ah
) \

31 i‡(
comm⁄
->
›s
->
wrôe_Êush
) \

32 
comm⁄
->
›s
->
	`wrôe_Êush
((
_ah
));

	)

35 
	#IEEE80211_WEP_NKID
 4

	)

41 
boﬁ
 
	$©h_hw_keyª£t
(
©h_comm⁄
 *
comm⁄
, 
u16
 
íåy
)

43 
u32
 
keyTy≥
;

44 *
ah
 = 
comm⁄
->ah;

46 i‡(
íåy
 >
comm⁄
->
keymax
) {

47 
	`©h_îr
(
comm⁄
, "keyˇchêíåy %u ouào‡ønge\n", 
íåy
);

48  
Ál£
;

51 
keyTy≥
 = 
	`REG_READ
(
ah
, 
	`AR_KEYTABLE_TYPE
(
íåy
));

53 
	`ENABLE_REGWRITE_BUFFER
(
ah
);

55 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_KEY0
(
íåy
), 0);

56 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_KEY1
(
íåy
), 0);

57 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_KEY2
(
íåy
), 0);

58 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_KEY3
(
íåy
), 0);

59 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_KEY4
(
íåy
), 0);

60 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_TYPE
(
íåy
), 
AR_KEYTABLE_TYPE_CLR
);

61 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_MAC0
(
íåy
), 0);

62 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_MAC1
(
íåy
), 0);

64 i‡(
keyTy≥
 =
AR_KEYTABLE_TYPE_TKIP
) {

65 
u16
 
mi˚¡ry
 = 
íåy
 + 64;

67 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_KEY0
(
mi˚¡ry
), 0);

68 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_KEY1
(
mi˚¡ry
), 0);

69 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_KEY2
(
mi˚¡ry
), 0);

70 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_KEY3
(
mi˚¡ry
), 0);

71 i‡(
comm⁄
->
¸y±_ˇps
 & 
ATH_CRYPT_CAP_MIC_COMBINED
) {

72 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_KEY4
(
mi˚¡ry
), 0);

73 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_TYPE
(
mi˚¡ry
),

74 
AR_KEYTABLE_TYPE_CLR
);

79 
	`REGWRITE_BUFFER_FLUSH
(
ah
);

81  
åue
;

82 
	}
}

83 
EXPORT_SYMBOL
(
©h_hw_keyª£t
);

85 
boﬁ
 
	$©h_hw_key£tmac
(
©h_comm⁄
 *
comm⁄
,

86 
u16
 
íåy
, c⁄° 
u8
 *
mac
)

88 
u32
 
macHi
, 
macLo
;

89 
u32
 
uniˇ°_Êag
 = 
AR_KEYTABLE_VALID
;

90 *
ah
 = 
comm⁄
->ah;

92 i‡(
íåy
 >
comm⁄
->
keymax
) {

93 
	`©h_îr
(
comm⁄
, "keyˇchêíåy %u ouào‡ønge\n", 
íåy
);

94  
Ál£
;

97 i‡(
mac
 !
NULL
) {

105 i‡(
mac
[0] & 0x01)

106 
uniˇ°_Êag
 = 0;

108 
macLo
 = 
	`gë_u«lig√d_À32
(
mac
);

109 
macHi
 = 
	`gë_u«lig√d_À16
(
mac
 + 4);

110 
macLo
 >>= 1;

111 
macLo
 |(
macHi
 & 1) << 31;

112 
macHi
 >>= 1;

114 
macLo
 = 
macHi
 = 0;

116 
	`ENABLE_REGWRITE_BUFFER
(
ah
);

118 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_MAC0
(
íåy
), 
macLo
);

119 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_MAC1
(
íåy
), 
macHi
 | 
uniˇ°_Êag
);

121 
	`REGWRITE_BUFFER_FLUSH
(
ah
);

123  
åue
;

124 
	}
}

126 
boﬁ
 
	$©h_hw_£t_keyˇche_íåy
(
©h_comm⁄
 *
comm⁄
, 
u16
 
íåy
,

127 c⁄° 
©h_keyvÆ
 *
k
,

128 c⁄° 
u8
 *
mac
)

130 *
ah
 = 
comm⁄
->ah;

131 
u32
 
key0
, 
key1
, 
key2
, 
key3
, 
key4
;

132 
u32
 
keyTy≥
;

134 i‡(
íåy
 >
comm⁄
->
keymax
) {

135 
	`©h_îr
(
comm⁄
, "keyˇchêíåy %u ouào‡ønge\n", 
íåy
);

136  
Ál£
;

139 
k
->
kv_ty≥
) {

140 
ATH_CIPHER_AES_OCB
:

141 
keyTy≥
 = 
AR_KEYTABLE_TYPE_AES
;

143 
ATH_CIPHER_AES_CCM
:

144 i‡(!(
comm⁄
->
¸y±_ˇps
 & 
ATH_CRYPT_CAP_CIPHER_AESCCM
)) {

145 
	`©h_dbg
(
comm⁄
, 
ATH_DBG_ANY
,

147  
Ál£
;

149 
keyTy≥
 = 
AR_KEYTABLE_TYPE_CCM
;

151 
ATH_CIPHER_TKIP
:

152 
keyTy≥
 = 
AR_KEYTABLE_TYPE_TKIP
;

153 i‡(
íåy
 + 64 >
comm⁄
->
keymax
) {

154 
	`©h_dbg
(
comm⁄
, 
ATH_DBG_ANY
,

155 "íåy %u i«µr›rüã f‹ TKIP\n", 
íåy
);

156  
Ál£
;

159 
ATH_CIPHER_WEP
:

160 i‡(
k
->
kv_Àn
 < 
WLAN_KEY_LEN_WEP40
) {

161 
	`©h_dbg
(
comm⁄
, 
ATH_DBG_ANY
,

162 "WEP keyÜígth %uÅoÿsmÆl\n", 
k
->
kv_Àn
);

163  
Ál£
;

165 i‡(
k
->
kv_Àn
 <
WLAN_KEY_LEN_WEP40
)

166 
keyTy≥
 = 
AR_KEYTABLE_TYPE_40
;

167 i‡(
k
->
kv_Àn
 <
WLAN_KEY_LEN_WEP104
)

168 
keyTy≥
 = 
AR_KEYTABLE_TYPE_104
;

170 
keyTy≥
 = 
AR_KEYTABLE_TYPE_128
;

172 
ATH_CIPHER_CLR
:

173 
keyTy≥
 = 
AR_KEYTABLE_TYPE_CLR
;

176 
	`©h_îr
(
comm⁄
, "cùhî %uÇŸ suµ‹ãd\n", 
k
->
kv_ty≥
);

177  
Ál£
;

180 
key0
 = 
	`gë_u«lig√d_À32
(
k
->
kv_vÆ
 + 0);

181 
key1
 = 
	`gë_u«lig√d_À16
(
k
->
kv_vÆ
 + 4);

182 
key2
 = 
	`gë_u«lig√d_À32
(
k
->
kv_vÆ
 + 6);

183 
key3
 = 
	`gë_u«lig√d_À16
(
k
->
kv_vÆ
 + 10);

184 
key4
 = 
	`gë_u«lig√d_À32
(
k
->
kv_vÆ
 + 12);

185 i‡(
k
->
kv_Àn
 <
WLAN_KEY_LEN_WEP104
)

186 
key4
 &= 0xff;

195 i‡(
keyTy≥
 =
AR_KEYTABLE_TYPE_TKIP
) {

196 
u16
 
mi˚¡ry
 = 
íåy
 + 64;

204 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_KEY0
(
íåy
), ~
key0
);

205 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_KEY1
(
íåy
), ~
key1
);

208 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_KEY2
(
íåy
), 
key2
);

209 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_KEY3
(
íåy
), 
key3
);

212 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_KEY4
(
íåy
), 
key4
);

213 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_TYPE
(
íåy
), 
keyTy≥
);

216 (Ë
	`©h_hw_key£tmac
(
comm⁄
, 
íåy
, 
mac
);

218 i‡(
comm⁄
->
¸y±_ˇps
 & 
ATH_CRYPT_CAP_MIC_COMBINED
) {

231 
u32
 
mic0
, 
mic1
, 
mic2
, 
mic3
, 
mic4
;

233 
mic0
 = 
	`gë_u«lig√d_À32
(
k
->
kv_mic
 + 0);

234 
mic2
 = 
	`gë_u«lig√d_À32
(
k
->
kv_mic
 + 4);

235 
mic1
 = 
	`gë_u«lig√d_À16
(
k
->
kv_txmic
 + 2) & 0xffff;

236 
mic3
 = 
	`gë_u«lig√d_À16
(
k
->
kv_txmic
 + 0) & 0xffff;

237 
mic4
 = 
	`gë_u«lig√d_À32
(
k
->
kv_txmic
 + 4);

239 
	`ENABLE_REGWRITE_BUFFER
(
ah
);

242 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_KEY0
(
mi˚¡ry
), 
mic0
);

243 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_KEY1
(
mi˚¡ry
), 
mic1
);

246 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_KEY2
(
mi˚¡ry
), 
mic2
);

247 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_KEY3
(
mi˚¡ry
), 
mic3
);

250 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_KEY4
(
mi˚¡ry
), 
mic4
);

251 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_TYPE
(
mi˚¡ry
),

252 
AR_KEYTABLE_TYPE_CLR
);

254 
	`REGWRITE_BUFFER_FLUSH
(
ah
);

273 
u32
 
mic0
, 
mic2
;

275 
mic0
 = 
	`gë_u«lig√d_À32
(
k
->
kv_mic
 + 0);

276 
mic2
 = 
	`gë_u«lig√d_À32
(
k
->
kv_mic
 + 4);

278 
	`ENABLE_REGWRITE_BUFFER
(
ah
);

281 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_KEY0
(
mi˚¡ry
), 
mic0
);

282 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_KEY1
(
mi˚¡ry
), 0);

285 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_KEY2
(
mi˚¡ry
), 
mic2
);

286 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_KEY3
(
mi˚¡ry
), 0);

289 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_KEY4
(
mi˚¡ry
), 0);

290 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_TYPE
(
mi˚¡ry
),

291 
AR_KEYTABLE_TYPE_CLR
);

293 
	`REGWRITE_BUFFER_FLUSH
(
ah
);

296 
	`ENABLE_REGWRITE_BUFFER
(
ah
);

299 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_MAC0
(
mi˚¡ry
), 0);

300 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_MAC1
(
mi˚¡ry
), 0);

307 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_KEY0
(
íåy
), 
key0
);

308 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_KEY1
(
íåy
), 
key1
);

310 
	`REGWRITE_BUFFER_FLUSH
(
ah
);

312 
	`ENABLE_REGWRITE_BUFFER
(
ah
);

315 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_KEY0
(
íåy
), 
key0
);

316 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_KEY1
(
íåy
), 
key1
);

319 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_KEY2
(
íåy
), 
key2
);

320 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_KEY3
(
íåy
), 
key3
);

323 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_KEY4
(
íåy
), 
key4
);

324 
	`REG_WRITE
(
ah
, 
	`AR_KEYTABLE_TYPE
(
íåy
), 
keyTy≥
);

326 
	`REGWRITE_BUFFER_FLUSH
(
ah
);

329 (Ë
	`©h_hw_key£tmac
(
comm⁄
, 
íåy
, 
mac
);

332  
åue
;

333 
	}
}

335 
	$©h_£tkey_tkù
(
©h_comm⁄
 *
comm⁄
, 
u16
 
keyix
, c⁄° 
u8
 *
key
,

336 
©h_keyvÆ
 *
hk
, c⁄° 
u8
 *
addr
,

337 
boﬁ
 
authítiˇt‹
)

339 c⁄° 
u8
 *
key_rxmic
;

340 c⁄° 
u8
 *
key_txmic
;

342 
key_txmic
 = 
key
 + 
NL80211_TKIP_DATA_OFFSET_TX_MIC_KEY
;

343 
key_rxmic
 = 
key
 + 
NL80211_TKIP_DATA_OFFSET_RX_MIC_KEY
;

345 i‡(
addr
 =
NULL
) {

351 i‡(
authítiˇt‹
) {

352 
	`mem˝y
(
hk
->
kv_mic
, 
key_txmic
, (hk->kv_mic));

353 
	`mem˝y
(
hk
->
kv_txmic
, 
key_txmic
, (hk->
kv_mic
));

355 
	`mem˝y
(
hk
->
kv_mic
, 
key_rxmic
, (hk->kv_mic));

356 
	`mem˝y
(
hk
->
kv_txmic
, 
key_rxmic
, (hk->
kv_mic
));

358  
	`©h_hw_£t_keyˇche_íåy
(
comm⁄
, 
keyix
, 
hk
, 
addr
);

360 i‡(
comm⁄
->
¸y±_ˇps
 & 
ATH_CRYPT_CAP_MIC_COMBINED
) {

362 
	`mem˝y
(
hk
->
kv_mic
, 
key_rxmic
, (hk->kv_mic));

363 
	`mem˝y
(
hk
->
kv_txmic
, 
key_txmic
, (hk->kv_txmic));

364  
	`©h_hw_£t_keyˇche_íåy
(
comm⁄
, 
keyix
, 
hk
, 
addr
);

370 
	`mem˝y
(
hk
->
kv_mic
, 
key_txmic
, (hk->kv_mic));

371 i‡(!
	`©h_hw_£t_keyˇche_íåy
(
comm⁄
, 
keyix
, 
hk
, 
NULL
)) {

373 
	`©h_îr
(
comm⁄
, "Setting TX MIC Key Failed\n");

377 
	`mem˝y
(
hk
->
kv_mic
, 
key_rxmic
, (hk->kv_mic));

379  
	`©h_hw_£t_keyˇche_íåy
(
comm⁄
, 
keyix
 + 32, 
hk
, 
addr
);

380 
	}
}

382 
	$©h_ª£rve_key_ˇche_¶Ÿ_tkù
(
©h_comm⁄
 *
comm⁄
)

384 
i
;

386 
i
 = 
IEEE80211_WEP_NKID
; i < 
comm⁄
->
keymax
 / 2; i++) {

387 i‡(
	`ã°_bô
(
i
, 
comm⁄
->
keym≠
) ||

388 
	`ã°_bô
(
i
 + 64, 
comm⁄
->
keym≠
))

390 i‡(!(
comm⁄
->
¸y±_ˇps
 & 
ATH_CRYPT_CAP_MIC_COMBINED
) &&

391 (
	`ã°_bô
(
i
 + 32, 
comm⁄
->
keym≠
) ||

392 
	`ã°_bô
(
i
 + 64 + 32, 
comm⁄
->
keym≠
)))

396  
i
;

399 
	}
}

401 
	$©h_ª£rve_key_ˇche_¶Ÿ
(
©h_comm⁄
 *
comm⁄
,

402 
u32
 
cùhî
)

404 
i
;

406 i‡(
cùhî
 =
WLAN_CIPHER_SUITE_TKIP
)

407  
	`©h_ª£rve_key_ˇche_¶Ÿ_tkù
(
comm⁄
);

410 i‡(!(
comm⁄
->
¸y±_ˇps
 & 
ATH_CRYPT_CAP_MIC_COMBINED
)) {

411 
i
 = 
IEEE80211_WEP_NKID
; i < 
comm⁄
->
keymax
 / 4; i++) {

412 i‡(!
	`ã°_bô
(
i
, 
comm⁄
->
keym≠
) &&

413 (
	`ã°_bô
(
i
 + 32, 
comm⁄
->
keym≠
) ||

414 
	`ã°_bô
(
i
 + 64, 
comm⁄
->
keym≠
) ||

415 
	`ã°_bô
(
i
 + 64 + 32, 
comm⁄
->
keym≠
)))

416  
i
;

417 i‡(!
	`ã°_bô
(
i
 + 32, 
comm⁄
->
keym≠
) &&

418 (
	`ã°_bô
(
i
, 
comm⁄
->
keym≠
) ||

419 
	`ã°_bô
(
i
 + 64, 
comm⁄
->
keym≠
) ||

420 
	`ã°_bô
(
i
 + 64 + 32, 
comm⁄
->
keym≠
)))

421  
i
 + 32;

422 i‡(!
	`ã°_bô
(
i
 + 64, 
comm⁄
->
keym≠
) &&

423 (
	`ã°_bô
(
i
 , 
comm⁄
->
keym≠
) ||

424 
	`ã°_bô
(
i
 + 32, 
comm⁄
->
keym≠
) ||

425 
	`ã°_bô
(
i
 + 64 + 32, 
comm⁄
->
keym≠
)))

426  
i
 + 64;

427 i‡(!
	`ã°_bô
(
i
 + 64 + 32, 
comm⁄
->
keym≠
) &&

428 (
	`ã°_bô
(
i
, 
comm⁄
->
keym≠
) ||

429 
	`ã°_bô
(
i
 + 32, 
comm⁄
->
keym≠
) ||

430 
	`ã°_bô
(
i
 + 64, 
comm⁄
->
keym≠
)))

431  
i
 + 64 + 32;

434 
i
 = 
IEEE80211_WEP_NKID
; i < 
comm⁄
->
keymax
 / 2; i++) {

435 i‡(!
	`ã°_bô
(
i
, 
comm⁄
->
keym≠
) &&

436 
	`ã°_bô
(
i
 + 64, 
comm⁄
->
keym≠
))

437  
i
;

438 i‡(
	`ã°_bô
(
i
, 
comm⁄
->
keym≠
) &&

439 !
	`ã°_bô
(
i
 + 64, 
comm⁄
->
keym≠
))

440  
i
 + 64;

445 
i
 = 
IEEE80211_WEP_NKID
; i < 
comm⁄
->
keymax
; i++) {

449 i‡(
i
 >64 && i < 64 + 
IEEE80211_WEP_NKID
)

451 i‡(!(
comm⁄
->
¸y±_ˇps
 & 
ATH_CRYPT_CAP_MIC_COMBINED
)) {

452 i‡(
i
 >32 && i < 32 + 
IEEE80211_WEP_NKID
)

454 i‡(
i
 >64 + 32 && i < 64 + 32 + 
IEEE80211_WEP_NKID
)

458 i‡(!
	`ã°_bô
(
i
, 
comm⁄
->
keym≠
))

459  
i
;

464 
	}
}

469 
	$©h_key_c⁄fig
(
©h_comm⁄
 *
comm⁄
,

470 
õì80211_vif
 *
vif
,

471 
õì80211_°a
 *
°a
,

472 
õì80211_key_c⁄f
 *
key
)

474 
©h_keyvÆ
 
hk
;

475 c⁄° 
u8
 *
mac
 = 
NULL
;

476 
u8
 
gmac
[
ETH_ALEN
];

477 
ªt
 = 0;

478 
idx
;

480 
	`mem£t
(&
hk
, 0, (hk));

482 
key
->
cùhî
) {

484 
hk
.
kv_ty≥
 = 
ATH_CIPHER_CLR
;

486 
WLAN_CIPHER_SUITE_WEP40
:

487 
WLAN_CIPHER_SUITE_WEP104
:

488 
hk
.
kv_ty≥
 = 
ATH_CIPHER_WEP
;

490 
WLAN_CIPHER_SUITE_TKIP
:

491 
hk
.
kv_ty≥
 = 
ATH_CIPHER_TKIP
;

493 
WLAN_CIPHER_SUITE_CCMP
:

494 
hk
.
kv_ty≥
 = 
ATH_CIPHER_AES_CCM
;

497  -
EOPNOTSUPP
;

500 
hk
.
kv_Àn
 = 
key
->
keyÀn
;

501 i‡(
key
->
keyÀn
)

502 
	`mem˝y
(
hk
.
kv_vÆ
, 
key
->key, key->
keyÀn
);

504 i‡(!(
key
->
Êags
 & 
IEEE80211_KEY_FLAG_PAIRWISE
)) {

505 
vif
->
ty≥
) {

506 
NL80211_IFTYPE_AP
:

507 
	`mem˝y
(
gmac
, 
vif
->
addr
, 
ETH_ALEN
);

508 
gmac
[0] |= 0x01;

509 
mac
 = 
gmac
;

510 
idx
 = 
	`©h_ª£rve_key_ˇche_¶Ÿ
(
comm⁄
, 
key
->
cùhî
);

512 
NL80211_IFTYPE_ADHOC
:

513 i‡(!
°a
) {

514 
idx
 = 
key
->
keyidx
;

517 
	`mem˝y
(
gmac
, 
°a
->
addr
, 
ETH_ALEN
);

518 
gmac
[0] |= 0x01;

519 
mac
 = 
gmac
;

520 
idx
 = 
	`©h_ª£rve_key_ˇche_¶Ÿ
(
comm⁄
, 
key
->
cùhî
);

523 
idx
 = 
key
->
keyidx
;

526 } i‡(
key
->
keyidx
) {

527 i‡(
	`WARN_ON
(!
°a
))

528  -
EOPNOTSUPP
;

529 
mac
 = 
°a
->
addr
;

531 i‡(
vif
->
ty≥
 !
NL80211_IFTYPE_AP
) {

534 
idx
 = 
key
->
keyidx
;

536  -
EIO
;

538 i‡(
	`WARN_ON
(!
°a
))

539  -
EOPNOTSUPP
;

540 
mac
 = 
°a
->
addr
;

542 
idx
 = 
	`©h_ª£rve_key_ˇche_¶Ÿ
(
comm⁄
, 
key
->
cùhî
);

545 i‡(
idx
 < 0)

546  -
ENOSPC
;

548 i‡(
key
->
cùhî
 =
WLAN_CIPHER_SUITE_TKIP
)

549 
ªt
 = 
	`©h_£tkey_tkù
(
comm⁄
, 
idx
, 
key
->key, &
hk
, 
mac
,

550 
vif
->
ty≥
 =
NL80211_IFTYPE_AP
);

552 
ªt
 = 
	`©h_hw_£t_keyˇche_íåy
(
comm⁄
, 
idx
, &
hk
, 
mac
);

554 i‡(!
ªt
)

555  -
EIO
;

557 
	`£t_bô
(
idx
, 
comm⁄
->
keym≠
);

558 i‡(
key
->
cùhî
 =
WLAN_CIPHER_SUITE_TKIP
) {

559 
	`£t_bô
(
idx
 + 64, 
comm⁄
->
keym≠
);

560 
	`£t_bô
(
idx
, 
comm⁄
->
tkù_keym≠
);

561 
	`£t_bô
(
idx
 + 64, 
comm⁄
->
tkù_keym≠
);

562 i‡(!(
comm⁄
->
¸y±_ˇps
 & 
ATH_CRYPT_CAP_MIC_COMBINED
)) {

563 
	`£t_bô
(
idx
 + 32, 
comm⁄
->
keym≠
);

564 
	`£t_bô
(
idx
 + 64 + 32, 
comm⁄
->
keym≠
);

565 
	`£t_bô
(
idx
 + 32, 
comm⁄
->
tkù_keym≠
);

566 
	`£t_bô
(
idx
 + 64 + 32, 
comm⁄
->
tkù_keym≠
);

570  
idx
;

571 
	}
}

572 
EXPORT_SYMBOL
(
©h_key_c⁄fig
);

577 
	$©h_key_dñëe
(
©h_comm⁄
 *
comm⁄
, 
õì80211_key_c⁄f
 *
key
)

579 
	`©h_hw_keyª£t
(
comm⁄
, 
key
->
hw_key_idx
);

580 i‡(
key
->
hw_key_idx
 < 
IEEE80211_WEP_NKID
)

583 
	`˛ór_bô
(
key
->
hw_key_idx
, 
comm⁄
->
keym≠
);

584 i‡(
key
->
cùhî
 !
WLAN_CIPHER_SUITE_TKIP
)

587 
	`˛ór_bô
(
key
->
hw_key_idx
 + 64, 
comm⁄
->
keym≠
);

589 
	`˛ór_bô
(
key
->
hw_key_idx
, 
comm⁄
->
tkù_keym≠
);

590 
	`˛ór_bô
(
key
->
hw_key_idx
 + 64, 
comm⁄
->
tkù_keym≠
);

592 i‡(!(
comm⁄
->
¸y±_ˇps
 & 
ATH_CRYPT_CAP_MIC_COMBINED
)) {

593 
	`©h_hw_keyª£t
(
comm⁄
, 
key
->
hw_key_idx
 + 32);

594 
	`˛ór_bô
(
key
->
hw_key_idx
 + 32, 
comm⁄
->
keym≠
);

595 
	`˛ór_bô
(
key
->
hw_key_idx
 + 64 + 32, 
comm⁄
->
keym≠
);

597 
	`˛ór_bô
(
key
->
hw_key_idx
 + 32, 
comm⁄
->
tkù_keym≠
);

598 
	`˛ór_bô
(
key
->
hw_key_idx
 + 64 + 32, 
comm⁄
->
tkù_keym≠
);

600 
	}
}

601 
EXPORT_SYMBOL
(
©h_key_dñëe
);

	@main.c

17 
	~<löux/kî√l.h
>

18 
	~<löux/moduÀ.h
>

20 
	~"©h.h
"

22 
MODULE_AUTHOR
("Atheros Communications");

23 
MODULE_DESCRIPTION
("SharedÜibrary for Atheros wireless LAN cards.");

24 
MODULE_LICENSE
("Dual BSD/GPL");

26 
sk_buff
 *
	$©h_rxbuf_Æloc
(
©h_comm⁄
 *
comm⁄
,

27 
u32
 
Àn
,

28 
gÂ_t
 
gÂ_mask
)

30 
sk_buff
 *
skb
;

31 
u32
 
off
;

46 
skb
 = 
	`__dev_Æloc_skb
(
Àn
 + 
comm⁄
->
ˇchñsz
 - 1, 
gÂ_mask
);

47 i‡(
skb
 !
NULL
) {

48 
off
 = ((Ë
skb
->
d©a
Ë% 
comm⁄
->
ˇchñsz
;

49 i‡(
off
 != 0)

50 
	`skb_ª£rve
(
skb
, 
comm⁄
->
ˇchñsz
 - 
off
);

52 
	`¥ötk
(
KERN_ERR
 "skbuf‡Ælo¯o‡sizê%u faûed\n", 
Àn
);

53  
NULL
;

56  
skb
;

57 
	}
}

58 
EXPORT_SYMBOL
(
©h_rxbuf_Æloc
);

60 
	$©h_¥ötk
(c⁄° *
Àvñ
, 
©h_comm⁄
 *
comm⁄
,

61 c⁄° *
fmt
, ...)

63 
va_f‹m©
 
vaf
;

64 
va_li°
 
¨gs
;

65 
πn
;

67 
	`va_°¨t
(
¨gs
, 
fmt
);

69 
vaf
.
fmt
 = fmt;

70 
vaf
.
va
 = &
¨gs
;

72 
πn
 = 
	`¥ötk
("%ßth: %pV", 
Àvñ
, &
vaf
);

74 
	`va_íd
(
¨gs
);

76  
πn
;

77 
	}
}

78 
EXPORT_SYMBOL
(
©h_¥ötk
);

	@reg.h

17 #i‚de‡
ATH_REGISTERS_H


18 
	#ATH_REGISTERS_H


	)

20 
	#AR_MIBC
 0x0040

	)

21 
	#AR_MIBC_COW
 0x00000001

	)

22 
	#AR_MIBC_FMC
 0x00000002

	)

23 
	#AR_MIBC_CMC
 0x00000004

	)

24 
	#AR_MIBC_MCS
 0x00000008

	)

30 
	#AR_BSSMSKL
 0x80e0

	)

31 
	#AR_BSSMSKU
 0x80e4

	)

33 
	#AR_TFCNT
 0x80ec

	)

34 
	#AR_RFCNT
 0x80f0

	)

35 
	#AR_RCCNT
 0x80f4

	)

36 
	#AR_CCCNT
 0x80f8

	)

38 
	#AR_KEYTABLE_0
 0x8800

	)

39 
	#AR_KEYTABLE
(
_n
Ë(
AR_KEYTABLE_0
 + ((_n)*32))

	)

40 
	#AR_KEY_CACHE_SIZE
 128

	)

41 
	#AR_RSVD_KEYTABLE_ENTRIES
 4

	)

42 
	#AR_KEY_TYPE
 0x00000007

	)

43 
	#AR_KEYTABLE_TYPE_40
 0x00000000

	)

44 
	#AR_KEYTABLE_TYPE_104
 0x00000001

	)

45 
	#AR_KEYTABLE_TYPE_128
 0x00000003

	)

46 
	#AR_KEYTABLE_TYPE_TKIP
 0x00000004

	)

47 
	#AR_KEYTABLE_TYPE_AES
 0x00000005

	)

48 
	#AR_KEYTABLE_TYPE_CCM
 0x00000006

	)

49 
	#AR_KEYTABLE_TYPE_CLR
 0x00000007

	)

50 
	#AR_KEYTABLE_ANT
 0x00000008

	)

51 
	#AR_KEYTABLE_VALID
 0x00008000

	)

52 
	#AR_KEYTABLE_KEY0
(
_n
Ë(
	`AR_KEYTABLE
(_nË+ 0)

	)

53 
	#AR_KEYTABLE_KEY1
(
_n
Ë(
	`AR_KEYTABLE
(_nË+ 4)

	)

54 
	#AR_KEYTABLE_KEY2
(
_n
Ë(
	`AR_KEYTABLE
(_nË+ 8)

	)

55 
	#AR_KEYTABLE_KEY3
(
_n
Ë(
	`AR_KEYTABLE
(_nË+ 12)

	)

56 
	#AR_KEYTABLE_KEY4
(
_n
Ë(
	`AR_KEYTABLE
(_nË+ 16)

	)

57 
	#AR_KEYTABLE_TYPE
(
_n
Ë(
	`AR_KEYTABLE
(_nË+ 20)

	)

58 
	#AR_KEYTABLE_MAC0
(
_n
Ë(
	`AR_KEYTABLE
(_nË+ 24)

	)

59 
	#AR_KEYTABLE_MAC1
(
_n
Ë(
	`AR_KEYTABLE
(_nË+ 28)

	)

	@regd.c

17 
	~<löux/kî√l.h
>

18 
	~<√t/cfg80211.h
>

19 
	~<√t/mac80211.h
>

20 
	~"ªgd.h
"

21 
	~"ªgd_comm⁄.h
"

31 
	#ATH9K_2GHZ_CH01_11
 
	`REG_RULE
(2412-10, 2462+10, 40, 0, 20, 0)

	)

34 
	#ATH9K_2GHZ_CH12_13
 
	`REG_RULE
(2467-10, 2472+10, 40, 0, 20,\

35 
NL80211_RRF_PASSIVE_SCAN
)

	)

36 
	#ATH9K_2GHZ_CH14
 
	`REG_RULE
(2484-10, 2484+10, 40, 0, 20,\

37 
NL80211_RRF_PASSIVE_SCAN
 | 
NL80211_RRF_NO_OFDM
)

	)

40 
	#ATH9K_5GHZ_5150_5350
 
	`REG_RULE
(5150-10, 5350+10, 40, 0, 30,\

41 
NL80211_RRF_PASSIVE_SCAN
 | 
NL80211_RRF_NO_IBSS
)

	)

42 
	#ATH9K_5GHZ_5470_5850
 
	`REG_RULE
(5470-10, 5850+10, 40, 0, 30,\

43 
NL80211_RRF_PASSIVE_SCAN
 | 
NL80211_RRF_NO_IBSS
)

	)

44 
	#ATH9K_5GHZ_5725_5850
 
	`REG_RULE
(5725-10, 5850+10, 40, 0, 30,\

45 
NL80211_RRF_PASSIVE_SCAN
 | 
NL80211_RRF_NO_IBSS
)

	)

47 
	#ATH9K_2GHZ_ALL
 
ATH9K_2GHZ_CH01_11
, \

48 
ATH9K_2GHZ_CH12_13
, \

49 
ATH9K_2GHZ_CH14


	)

51 
	#ATH9K_5GHZ_ALL
 
ATH9K_5GHZ_5150_5350
, \

52 
ATH9K_5GHZ_5470_5850


	)

55 
	#ATH9K_5GHZ_NO_MIDBAND
 
ATH9K_5GHZ_5150_5350
, \

56 
ATH9K_5GHZ_5725_5850


	)

60 c⁄° 
õì80211_ªgdomaö
 
	g©h_w‹ld_ªgdom_60_61_62
 = {

61 .
n_ªg_ruÀs
 = 5,

62 .
	gÆpha2
 = "99",

63 .
	gªg_ruÀs
 = {

64 
ATH9K_2GHZ_ALL
,

65 
ATH9K_5GHZ_ALL
,

70 c⁄° 
õì80211_ªgdomaö
 
	g©h_w‹ld_ªgdom_63_65
 = {

71 .
n_ªg_ruÀs
 = 4,

72 .
	gÆpha2
 = "99",

73 .
	gªg_ruÀs
 = {

74 
ATH9K_2GHZ_CH01_11
,

75 
ATH9K_2GHZ_CH12_13
,

76 
ATH9K_5GHZ_NO_MIDBAND
,

81 c⁄° 
õì80211_ªgdomaö
 
	g©h_w‹ld_ªgdom_64
 = {

82 .
n_ªg_ruÀs
 = 3,

83 .
	gÆpha2
 = "99",

84 .
	gªg_ruÀs
 = {

85 
ATH9K_2GHZ_CH01_11
,

86 
ATH9K_5GHZ_NO_MIDBAND
,

91 c⁄° 
õì80211_ªgdomaö
 
	g©h_w‹ld_ªgdom_66_69
 = {

92 .
n_ªg_ruÀs
 = 3,

93 .
	gÆpha2
 = "99",

94 .
	gªg_ruÀs
 = {

95 
ATH9K_2GHZ_CH01_11
,

96 
ATH9K_5GHZ_ALL
,

101 c⁄° 
õì80211_ªgdomaö
 
	g©h_w‹ld_ªgdom_67_68_6A_6C
 = {

102 .
n_ªg_ruÀs
 = 4,

103 .
	gÆpha2
 = "99",

104 .
	gªg_ruÀs
 = {

105 
ATH9K_2GHZ_CH01_11
,

106 
ATH9K_2GHZ_CH12_13
,

107 
ATH9K_5GHZ_ALL
,

111 
ölöe
 
boﬁ
 
	$is_wwr_sku
(
u16
 
ªgd
)

113  ((
ªgd
 & 
COUNTRY_ERD_FLAG
) != COUNTRY_ERD_FLAG) &&

114 (((
ªgd
 & 
WORLD_SKU_MASK
Ë=
WORLD_SKU_PREFIX
) ||

115 (
ªgd
 =
WORLD
));

116 
	}
}

118 
u16
 
	$©h_ªgd_gë_ì¥omRD
(
©h_ªguœt‹y
 *
ªg
)

120  
ªg
->
cuºít_rd
 & ~
WORLDWIDE_ROAMING_FLAG
;

121 
	}
}

123 
boﬁ
 
	$©h_is_w‹ld_ªgd
(
©h_ªguœt‹y
 *
ªg
)

125  
	`is_wwr_sku
(
	`©h_ªgd_gë_ì¥omRD
(
ªg
));

126 
	}
}

127 
EXPORT_SYMBOL
(
©h_is_w‹ld_ªgd
);

129 c⁄° 
õì80211_ªgdomaö
 *
	$©h_deÁu…_w‹ld_ªgdomaö
()

132  &
©h_w‹ld_ªgdom_64
;

133 
	}
}

136 
õì80211_ªgdomaö
 *
	$©h_w‹ld_ªgdomaö
(
©h_ªguœt‹y
 *
ªg
)

138 
ªg
->
ªg∑ú
->
ªgDmnEnum
) {

142  &
©h_w‹ld_ªgdom_60_61_62
;

145  &
©h_w‹ld_ªgdom_63_65
;

147  &
©h_w‹ld_ªgdom_64
;

150  &
©h_w‹ld_ªgdom_66_69
;

155  &
©h_w‹ld_ªgdom_67_68_6A_6C
;

157 
	`WARN_ON
(1);

158  
	`©h_deÁu…_w‹ld_ªgdomaö
();

160 
	}
}

162 
boﬁ
 
	$©h_is_49ghz_Ælowed
(
u16
 
ªgdomaö
)

165  
ªgdomaö
 =
MKK9_MKKC
;

166 
	}
}

167 
EXPORT_SYMBOL
(
©h_is_49ghz_Ælowed
);

170 
boﬁ
 
	$©h_is_ød¨_‰eq
(
u16
 
˚¡î_‰eq
)

172  (
˚¡î_‰eq
 >= 5260 && center_freq <= 5700);

173 
	}
}

185 
	$©h_ªg_≠∂y_bóc⁄ög_Êags
(
wùhy
 *wiphy,

186 
∆80211_ªg_öôüt‹
 
öôüt‹
)

188 
õì80211_b™d
 
b™d
;

189 
õì80211_suµ‹ãd_b™d
 *
sb™d
;

190 c⁄° 
õì80211_ªg_ruÀ
 *
ªg_ruÀ
;

191 
õì80211_ch™√l
 *
ch
;

192 
i
;

193 
u32
 
b™dwidth
 = 0;

194 
r
;

196 
b™d
 = 0; b™d < 
IEEE80211_NUM_BANDS
; band++) {

198 i‡(!
wùhy
->
b™ds
[
b™d
])

201 
sb™d
 = 
wùhy
->
b™ds
[
b™d
];

203 
i
 = 0; i < 
sb™d
->
n_ch™√ls
; i++) {

205 
ch
 = &
sb™d
->
ch™√ls
[
i
];

207 i‡(
	`©h_is_ød¨_‰eq
(
ch
->
˚¡î_‰eq
) ||

208 (
ch
->
Êags
 & 
IEEE80211_CHAN_RADAR
))

211 i‡(
öôüt‹
 =
NL80211_REGDOM_SET_BY_COUNTRY_IE
) {

212 
r
 = 
	`‰eq_ªg_öfo
(
wùhy
,

213 
ch
->
˚¡î_‰eq
,

214 
b™dwidth
,

215 &
ªg_ruÀ
);

216 i‡(
r
)

226 i‡(!(
ªg_ruÀ
->
Êags
 &

227 
NL80211_RRF_NO_IBSS
))

228 
ch
->
Êags
 &=

229 ~
IEEE80211_CHAN_NO_IBSS
;

230 i‡(!(
ªg_ruÀ
->
Êags
 &

231 
NL80211_RRF_PASSIVE_SCAN
))

232 
ch
->
Êags
 &=

233 ~
IEEE80211_CHAN_PASSIVE_SCAN
;

235 i‡(
ch
->
bóc⁄_found
)

236 
ch
->
Êags
 &~(
IEEE80211_CHAN_NO_IBSS
 |

237 
IEEE80211_CHAN_PASSIVE_SCAN
);

242 
	}
}

246 
	$©h_ªg_≠∂y_a˘ive_sˇn_Êags
(
wùhy
 *wiphy,

247 
∆80211_ªg_öôüt‹
 
öôüt‹
)

249 
õì80211_suµ‹ãd_b™d
 *
sb™d
;

250 
õì80211_ch™√l
 *
ch
;

251 c⁄° 
õì80211_ªg_ruÀ
 *
ªg_ruÀ
;

252 
u32
 
b™dwidth
 = 0;

253 
r
;

255 
sb™d
 = 
wùhy
->
b™ds
[
IEEE80211_BAND_2GHZ
];

261 i‡(
öôüt‹
 !
NL80211_REGDOM_SET_BY_COUNTRY_IE
) {

262 
ch
 = &
sb™d
->
ch™√ls
[11];

263 i‡(
ch
->
Êags
 & 
IEEE80211_CHAN_PASSIVE_SCAN
)

264 
ch
->
Êags
 &~
IEEE80211_CHAN_PASSIVE_SCAN
;

265 
ch
 = &
sb™d
->
ch™√ls
[12];

266 i‡(
ch
->
Êags
 & 
IEEE80211_CHAN_PASSIVE_SCAN
)

267 
ch
->
Êags
 &~
IEEE80211_CHAN_PASSIVE_SCAN
;

278 
ch
 = &
sb™d
->
ch™√ls
[11];

279 
r
 = 
	`‰eq_ªg_öfo
(
wùhy
, 
ch
->
˚¡î_‰eq
, 
b™dwidth
, &
ªg_ruÀ
);

280 i‡(!
r
) {

281 i‡(!(
ªg_ruÀ
->
Êags
 & 
NL80211_RRF_PASSIVE_SCAN
))

282 i‡(
ch
->
Êags
 & 
IEEE80211_CHAN_PASSIVE_SCAN
)

283 
ch
->
Êags
 &~
IEEE80211_CHAN_PASSIVE_SCAN
;

286 
ch
 = &
sb™d
->
ch™√ls
[12];

287 
r
 = 
	`‰eq_ªg_öfo
(
wùhy
, 
ch
->
˚¡î_‰eq
, 
b™dwidth
, &
ªg_ruÀ
);

288 i‡(!
r
) {

289 i‡(!(
ªg_ruÀ
->
Êags
 & 
NL80211_RRF_PASSIVE_SCAN
))

290 i‡(
ch
->
Êags
 & 
IEEE80211_CHAN_PASSIVE_SCAN
)

291 
ch
->
Êags
 &~
IEEE80211_CHAN_PASSIVE_SCAN
;

293 
	}
}

296 
	$©h_ªg_≠∂y_ød¨_Êags
(
wùhy
 *wiphy)

298 
õì80211_suµ‹ãd_b™d
 *
sb™d
;

299 
õì80211_ch™√l
 *
ch
;

300 
i
;

302 i‡(!
wùhy
->
b™ds
[
IEEE80211_BAND_5GHZ
])

305 
sb™d
 = 
wùhy
->
b™ds
[
IEEE80211_BAND_5GHZ
];

307 
i
 = 0; i < 
sb™d
->
n_ch™√ls
; i++) {

308 
ch
 = &
sb™d
->
ch™√ls
[
i
];

309 i‡(!
	`©h_is_ød¨_‰eq
(
ch
->
˚¡î_‰eq
))

321 i‡(!(
ch
->
Êags
 & 
IEEE80211_CHAN_DISABLED
))

322 
ch
->
Êags
 |
IEEE80211_CHAN_RADAR
 |

323 
IEEE80211_CHAN_NO_IBSS
 |

324 
IEEE80211_CHAN_PASSIVE_SCAN
;

326 
	}
}

328 
	$©h_ªg_≠∂y_w‹ld_Êags
(
wùhy
 *wiphy,

329 
∆80211_ªg_öôüt‹
 
öôüt‹
,

330 
©h_ªguœt‹y
 *
ªg
)

332 
ªg
->
ªg∑ú
->
ªgDmnEnum
) {

338 
	`©h_ªg_≠∂y_bóc⁄ög_Êags
(
wùhy
, 
öôüt‹
);

341 
	`©h_ªg_≠∂y_bóc⁄ög_Êags
(
wùhy
, 
öôüt‹
);

342 
	`©h_ªg_≠∂y_a˘ive_sˇn_Êags
(
wùhy
, 
öôüt‹
);

345 
	}
}

347 
	$©h_ªg_nŸifõr_≠∂y
(
wùhy
 *wiphy,

348 
ªguœt‹y_ªque°
 *
ªque°
,

349 
©h_ªguœt‹y
 *
ªg
)

352 
	`©h_ªg_≠∂y_ød¨_Êags
(
wùhy
);

359 i‡(!
ªque°
)

362 
ªque°
->
öôüt‹
) {

363 
NL80211_REGDOM_SET_BY_DRIVER
:

364 
NL80211_REGDOM_SET_BY_CORE
:

365 
NL80211_REGDOM_SET_BY_USER
:

367 
NL80211_REGDOM_SET_BY_COUNTRY_IE
:

368 i‡(
	`©h_is_w‹ld_ªgd
(
ªg
))

369 
	`©h_ªg_≠∂y_w‹ld_Êags
(
wùhy
, 
ªque°
->
öôüt‹
,

370 
ªg
);

375 
	}
}

376 
EXPORT_SYMBOL
(
©h_ªg_nŸifõr_≠∂y
);

378 
boﬁ
 
	$©h_ªgd_is_ì¥om_vÆid
(
©h_ªguœt‹y
 *
ªg
)

380 
u16
 
rd
 = 
	`©h_ªgd_gë_ì¥omRD
(
ªg
);

381 
i
;

383 i‡(
rd
 & 
COUNTRY_ERD_FLAG
) {

385 
u16
 
cc
 = 
rd
 & ~
COUNTRY_ERD_FLAG
;

386 
	`¥ötk
(
KERN_DEBUG


389 
i
 = 0; i < 
	`ARRAY_SIZE
(
ÆlCou¡rõs
); i++)

390 i‡(
ÆlCou¡rõs
[
i
].
cou¡ryCode
 =
cc
)

391  
åue
;

394 i‡(
rd
 !
CTRY_DEFAULT
)

395 
	`¥ötk
(
KERN_DEBUG
 "ath: EEPROM indicates we "

397 
i
 = 0; i < 
	`ARRAY_SIZE
(
ªgDomaöPaús
); i++)

398 i‡(
ªgDomaöPaús
[
i
].
ªgDmnEnum
 =
rd
)

399  
åue
;

401 
	`¥ötk
(
KERN_DEBUG


402 "©h: invÆidÑeguœt‹y domaö/cou¡ry codê0x%x\n", 
rd
);

403  
Ál£
;

404 
	}
}

407 
cou¡ry_code_to_íum_rd
*

408 
	$©h_ªgd_föd_cou¡ry
(
u16
 
cou¡ryCode
)

410 
i
;

412 
i
 = 0; i < 
	`ARRAY_SIZE
(
ÆlCou¡rõs
); i++) {

413 i‡(
ÆlCou¡rõs
[
i
].
cou¡ryCode
 == countryCode)

414  &
ÆlCou¡rõs
[
i
];

416  
NULL
;

417 
	}
}

420 
cou¡ry_code_to_íum_rd
*

421 
	$©h_ªgd_föd_cou¡ry_by_rd
(
ªgdmn
)

423 
i
;

425 
i
 = 0; i < 
	`ARRAY_SIZE
(
ÆlCou¡rõs
); i++) {

426 i‡(
ÆlCou¡rõs
[
i
].
ªgDmnEnum
 =
ªgdmn
)

427  &
ÆlCou¡rõs
[
i
];

429  
NULL
;

430 
	}
}

433 
u16
 
	$©h_ªgd_gë_deÁu…_cou¡ry
(
u16
 
rd
)

435 i‡(
rd
 & 
COUNTRY_ERD_FLAG
) {

436 
cou¡ry_code_to_íum_rd
 *
cou¡ry
 = 
NULL
;

437 
u16
 
cc
 = 
rd
 & ~
COUNTRY_ERD_FLAG
;

439 
cou¡ry
 = 
	`©h_ªgd_föd_cou¡ry
(
cc
);

440 i‡(
cou¡ry
 !
NULL
)

441  
cc
;

444  
CTRY_DEFAULT
;

445 
	}
}

447 
ªg_dmn_∑ú_m≠pög
*

448 
	$©h_gë_ªg∑ú
(
ªgdmn
)

450 
i
;

452 i‡(
ªgdmn
 =
NO_ENUMRD
)

453  
NULL
;

454 
i
 = 0; i < 
	`ARRAY_SIZE
(
ªgDomaöPaús
); i++) {

455 i‡(
ªgDomaöPaús
[
i
].
ªgDmnEnum
 =
ªgdmn
)

456  &
ªgDomaöPaús
[
i
];

458  
NULL
;

459 
	}
}

462 
©h_ªgd_öô_wùhy
(
©h_ªguœt‹y
 *
ªg
,

463 
wùhy
 *wiphy,

464 (*
ªg_nŸifõr
)(
wùhy
 *wiphy,

465 
ªguœt‹y_ªque°
 *
ªque°
))

467 c⁄° 
õì80211_ªgdomaö
 *
ªgd
;

469 
wùhy
->
ªg_nŸifõr
 =Ñeg_notifier;

470 
wùhy
->
Êags
 |
WIPHY_FLAG_STRICT_REGULATORY
;

472 i‡(
	`©h_is_w‹ld_ªgd
(
ªg
)) {

477 
ªgd
 = 
	`©h_w‹ld_ªgdomaö
(
ªg
);

478 
wùhy
->
Êags
 |
WIPHY_FLAG_CUSTOM_REGULATORY
;

485 
ªgd
 = 
	`©h_deÁu…_w‹ld_ªgdomaö
();

487 
	`wùhy_≠∂y_cu°om_ªguœt‹y
(
wùhy
, 
ªgd
);

488 
	`©h_ªg_≠∂y_ød¨_Êags
(
wùhy
);

489 
	`©h_ªg_≠∂y_w‹ld_Êags
(
wùhy
, 
NL80211_REGDOM_SET_BY_DRIVER
, 
ªg
);

491 
	}
}

500 
	$©h_ªgd_ßnôize
(
©h_ªguœt‹y
 *
ªg
)

502 i‡(
ªg
->
cuºít_rd
 !
COUNTRY_ERD_FLAG
)

504 
	`¥ötk
(
KERN_DEBUG
 "ath: EEPROMÑegdomain sanitized\n");

505 
ªg
->
cuºít_rd
 = 0x64;

506 
	}
}

509 
©h_ªgd_öô
(
©h_ªguœt‹y
 *
ªg
,

510 
wùhy
 *wiphy,

511 (*
ªg_nŸifõr
)(
wùhy
 *wiphy,

512 
ªguœt‹y_ªque°
 *
ªque°
))

514 
cou¡ry_code_to_íum_rd
 *
cou¡ry
 = 
NULL
;

515 
u16
 
ªgdmn
;

517 i‡(!
ªg
)

518  -
EINVAL
;

520 
	`©h_ªgd_ßnôize
(
ªg
);

522 
	`¥ötk
(
KERN_DEBUG
 "©h: EEPROMÑegdomaö: 0x%0x\n", 
ªg
->
cuºít_rd
);

524 i‡(!
	`©h_ªgd_is_ì¥om_vÆid
(
ªg
)) {

525 
	`¥ötk
(
KERN_ERR
 "ath: Invalid EEPROM contents\n");

526  -
EINVAL
;

529 
ªgdmn
 = 
	`©h_ªgd_gë_ì¥omRD
(
ªg
);

530 
ªg
->
cou¡ry_code
 = 
	`©h_ªgd_gë_deÁu…_cou¡ry
(
ªgdmn
);

532 i‡(
ªg
->
cou¡ry_code
 =
CTRY_DEFAULT
 &&

533 
ªgdmn
 =
CTRY_DEFAULT
) {

534 
	`¥ötk
(
KERN_DEBUG
 "ath: EEPROM indicates default "

536 
ªg
->
cou¡ry_code
 = 
CTRY_UNITED_STATES
;

539 i‡(
ªg
->
cou¡ry_code
 =
CTRY_DEFAULT
) {

540 
cou¡ry
 = 
NULL
;

542 
	`¥ötk
(
KERN_DEBUG
 "ath: doing EEPROM country->regdmn "

544 
cou¡ry
 = 
	`©h_ªgd_föd_cou¡ry
(
ªg
->
cou¡ry_code
);

545 i‡(
cou¡ry
 =
NULL
) {

546 
	`¥ötk
(
KERN_DEBUG


549 
ªg
->
cou¡ry_code
);

550  -
EINVAL
;

552 
ªgdmn
 = 
cou¡ry
->
ªgDmnEnum
;

553 
	`¥ötk
(
KERN_DEBUG
 "ath: country mapsÅo "

555 
ªgdmn
);

559 
ªg
->
ªg∑ú
 = 
	`©h_gë_ªg∑ú
(
ªgdmn
);

561 i‡(!
ªg
->
ªg∑ú
) {

562 
	`¥ötk
(
KERN_DEBUG
 "ath: "

564  -
EINVAL
;

567 i‡(!
cou¡ry
)

568 
cou¡ry
 = 
	`©h_ªgd_föd_cou¡ry_by_rd
(
ªgdmn
);

570 i‡(
cou¡ry
) {

571 
ªg
->
Æpha2
[0] = 
cou¡ry
->
isoName
[0];

572 
ªg
->
Æpha2
[1] = 
cou¡ry
->
isoName
[1];

574 
ªg
->
Æpha2
[0] = '0';

575 
ªg
->
Æpha2
[1] = '0';

578 
	`¥ötk
(
KERN_DEBUG
 "ath: Countryálpha2 being used: %c%c\n",

579 
ªg
->
Æpha2
[0],Ñeg->alpha2[1]);

580 
	`¥ötk
(
KERN_DEBUG
 "ath: Regpair used: 0x%0x\n",

581 
ªg
->
ªg∑ú
->
ªgDmnEnum
);

583 
	`©h_ªgd_öô_wùhy
(
ªg
, 
wùhy
, 
ªg_nŸifõr
);

585 
	}
}

586 
EXPORT_SYMBOL
(
©h_ªgd_öô
);

588 
u32
 
	$©h_ªgd_gë_b™d_˘l
(
©h_ªguœt‹y
 *
ªg
,

589 
õì80211_b™d
 
b™d
)

591 i‡(!
ªg
->
ªg∑ú
 ||

592 (
ªg
->
cou¡ry_code
 =
CTRY_DEFAULT
 &&

593 
	`is_wwr_sku
(
	`©h_ªgd_gë_ì¥omRD
(
ªg
)))) {

594  
SD_NO_CTL
;

597 
b™d
) {

598 
IEEE80211_BAND_2GHZ
:

599  
ªg
->
ªg∑ú
->
ªg_2ghz_˘l
;

600 
IEEE80211_BAND_5GHZ
:

601  
ªg
->
ªg∑ú
->
ªg_5ghz_˘l
;

603  
NO_CTL
;

605 
	}
}

606 
EXPORT_SYMBOL
(
©h_ªgd_gë_b™d_˘l
);

	@regd.h

17 #i‚de‡
REGD_H


18 
	#REGD_H


	)

20 
	~<löux/∆80211.h
>

21 
	~<√t/cfg80211.h
>

23 
	~"©h.h
"

25 
	e˘l_group
 {

26 
	mCTL_FCC
 = 0x10,

27 
	mCTL_MKK
 = 0x40,

28 
	mCTL_ETSI
 = 0x30,

31 
	#NO_CTL
 0xff

	)

32 
	#SD_NO_CTL
 0xE0

	)

33 
	#NO_CTL
 0xff

	)

34 
	#CTL_11A
 0

	)

35 
	#CTL_11B
 1

	)

36 
	#CTL_11G
 2

	)

37 
	#CTL_2GHT20
 5

	)

38 
	#CTL_5GHT20
 6

	)

39 
	#CTL_2GHT40
 7

	)

40 
	#CTL_5GHT40
 8

	)

42 
	#CTRY_DEBUG
 0x1ff

	)

43 
	#CTRY_DEFAULT
 0

	)

45 
	#COUNTRY_ERD_FLAG
 0x8000

	)

46 
	#WORLDWIDE_ROAMING_FLAG
 0x4000

	)

48 
	#MULTI_DOMAIN_MASK
 0xFF00

	)

50 
	#WORLD_SKU_MASK
 0x00F0

	)

51 
	#WORLD_SKU_PREFIX
 0x0060

	)

53 
	#CHANNEL_HALF_BW
 10

	)

54 
	#CHANNEL_QUARTER_BW
 5

	)

56 
	scou¡ry_code_to_íum_rd
 {

57 
u16
 
	mcou¡ryCode
;

58 
u16
 
	mªgDmnEnum
;

59 c⁄° *
	misoName
;

62 
	eCou¡ryCode
 {

63 
	mCTRY_ALBANIA
 = 8,

64 
	mCTRY_ALGERIA
 = 12,

65 
	mCTRY_ARGENTINA
 = 32,

66 
	mCTRY_ARMENIA
 = 51,

67 
	mCTRY_ARUBA
 = 533,

68 
	mCTRY_AUSTRALIA
 = 36,

69 
	mCTRY_AUSTRIA
 = 40,

70 
	mCTRY_AZERBAIJAN
 = 31,

71 
	mCTRY_BAHRAIN
 = 48,

72 
	mCTRY_BANGLADESH
 = 50,

73 
	mCTRY_BARBADOS
 = 52,

74 
	mCTRY_BELARUS
 = 112,

75 
	mCTRY_BELGIUM
 = 56,

76 
	mCTRY_BELIZE
 = 84,

77 
	mCTRY_BOLIVIA
 = 68,

78 
	mCTRY_BOSNIA_HERZ
 = 70,

79 
	mCTRY_BRAZIL
 = 76,

80 
	mCTRY_BRUNEI_DARUSSALAM
 = 96,

81 
	mCTRY_BULGARIA
 = 100,

82 
	mCTRY_CAMBODIA
 = 116,

83 
	mCTRY_CANADA
 = 124,

84 
	mCTRY_CHILE
 = 152,

85 
	mCTRY_CHINA
 = 156,

86 
	mCTRY_COLOMBIA
 = 170,

87 
	mCTRY_COSTA_RICA
 = 188,

88 
	mCTRY_CROATIA
 = 191,

89 
	mCTRY_CYPRUS
 = 196,

90 
	mCTRY_CZECH
 = 203,

91 
	mCTRY_DENMARK
 = 208,

92 
	mCTRY_DOMINICAN_REPUBLIC
 = 214,

93 
	mCTRY_ECUADOR
 = 218,

94 
	mCTRY_EGYPT
 = 818,

95 
	mCTRY_EL_SALVADOR
 = 222,

96 
	mCTRY_ESTONIA
 = 233,

97 
	mCTRY_FAEROE_ISLANDS
 = 234,

98 
	mCTRY_FINLAND
 = 246,

99 
	mCTRY_FRANCE
 = 250,

100 
	mCTRY_GEORGIA
 = 268,

101 
	mCTRY_GERMANY
 = 276,

102 
	mCTRY_GREECE
 = 300,

103 
	mCTRY_GREENLAND
 = 304,

104 
	mCTRY_GRENEDA
 = 308,

105 
	mCTRY_GUAM
 = 316,

106 
	mCTRY_GUATEMALA
 = 320,

107 
	mCTRY_HAITI
 = 332,

108 
	mCTRY_HONDURAS
 = 340,

109 
	mCTRY_HONG_KONG
 = 344,

110 
	mCTRY_HUNGARY
 = 348,

111 
	mCTRY_ICELAND
 = 352,

112 
	mCTRY_INDIA
 = 356,

113 
	mCTRY_INDONESIA
 = 360,

114 
	mCTRY_IRAN
 = 364,

115 
	mCTRY_IRAQ
 = 368,

116 
	mCTRY_IRELAND
 = 372,

117 
	mCTRY_ISRAEL
 = 376,

118 
	mCTRY_ITALY
 = 380,

119 
	mCTRY_JAMAICA
 = 388,

120 
	mCTRY_JAPAN
 = 392,

121 
	mCTRY_JORDAN
 = 400,

122 
	mCTRY_KAZAKHSTAN
 = 398,

123 
	mCTRY_KENYA
 = 404,

124 
	mCTRY_KOREA_NORTH
 = 408,

125 
	mCTRY_KOREA_ROC
 = 410,

126 
	mCTRY_KOREA_ROC2
 = 411,

127 
	mCTRY_KOREA_ROC3
 = 412,

128 
	mCTRY_KUWAIT
 = 414,

129 
	mCTRY_LATVIA
 = 428,

130 
	mCTRY_LEBANON
 = 422,

131 
	mCTRY_LIBYA
 = 434,

132 
	mCTRY_LIECHTENSTEIN
 = 438,

133 
	mCTRY_LITHUANIA
 = 440,

134 
	mCTRY_LUXEMBOURG
 = 442,

135 
	mCTRY_MACAU
 = 446,

136 
	mCTRY_MACEDONIA
 = 807,

137 
	mCTRY_MALAYSIA
 = 458,

138 
	mCTRY_MALTA
 = 470,

139 
	mCTRY_MEXICO
 = 484,

140 
	mCTRY_MONACO
 = 492,

141 
	mCTRY_MOROCCO
 = 504,

142 
	mCTRY_NEPAL
 = 524,

143 
	mCTRY_NETHERLANDS
 = 528,

144 
	mCTRY_NETHERLANDS_ANTILLES
 = 530,

145 
	mCTRY_NEW_ZEALAND
 = 554,

146 
	mCTRY_NICARAGUA
 = 558,

147 
	mCTRY_NORWAY
 = 578,

148 
	mCTRY_OMAN
 = 512,

149 
	mCTRY_PAKISTAN
 = 586,

150 
	mCTRY_PANAMA
 = 591,

151 
	mCTRY_PAPUA_NEW_GUINEA
 = 598,

152 
	mCTRY_PARAGUAY
 = 600,

153 
	mCTRY_PERU
 = 604,

154 
	mCTRY_PHILIPPINES
 = 608,

155 
	mCTRY_POLAND
 = 616,

156 
	mCTRY_PORTUGAL
 = 620,

157 
	mCTRY_PUERTO_RICO
 = 630,

158 
	mCTRY_QATAR
 = 634,

159 
	mCTRY_ROMANIA
 = 642,

160 
	mCTRY_RUSSIA
 = 643,

161 
	mCTRY_SAUDI_ARABIA
 = 682,

162 
	mCTRY_SERBIA_MONTENEGRO
 = 891,

163 
	mCTRY_SINGAPORE
 = 702,

164 
	mCTRY_SLOVAKIA
 = 703,

165 
	mCTRY_SLOVENIA
 = 705,

166 
	mCTRY_SOUTH_AFRICA
 = 710,

167 
	mCTRY_SPAIN
 = 724,

168 
	mCTRY_SRI_LANKA
 = 144,

169 
	mCTRY_SWEDEN
 = 752,

170 
	mCTRY_SWITZERLAND
 = 756,

171 
	mCTRY_SYRIA
 = 760,

172 
	mCTRY_TAIWAN
 = 158,

173 
	mCTRY_THAILAND
 = 764,

174 
	mCTRY_TRINIDAD_Y_TOBAGO
 = 780,

175 
	mCTRY_TUNISIA
 = 788,

176 
	mCTRY_TURKEY
 = 792,

177 
	mCTRY_UAE
 = 784,

178 
	mCTRY_UKRAINE
 = 804,

179 
	mCTRY_UNITED_KINGDOM
 = 826,

180 
	mCTRY_UNITED_STATES
 = 840,

181 
	mCTRY_UNITED_STATES_FCC49
 = 842,

182 
	mCTRY_URUGUAY
 = 858,

183 
	mCTRY_UZBEKISTAN
 = 860,

184 
	mCTRY_VENEZUELA
 = 862,

185 
	mCTRY_VIET_NAM
 = 704,

186 
	mCTRY_YEMEN
 = 887,

187 
	mCTRY_ZIMBABWE
 = 716,

188 
	mCTRY_JAPAN1
 = 393,

189 
	mCTRY_JAPAN2
 = 394,

190 
	mCTRY_JAPAN3
 = 395,

191 
	mCTRY_JAPAN4
 = 396,

192 
	mCTRY_JAPAN5
 = 397,

193 
	mCTRY_JAPAN6
 = 4006,

194 
	mCTRY_JAPAN7
 = 4007,

195 
	mCTRY_JAPAN8
 = 4008,

196 
	mCTRY_JAPAN9
 = 4009,

197 
	mCTRY_JAPAN10
 = 4010,

198 
	mCTRY_JAPAN11
 = 4011,

199 
	mCTRY_JAPAN12
 = 4012,

200 
	mCTRY_JAPAN13
 = 4013,

201 
	mCTRY_JAPAN14
 = 4014,

202 
	mCTRY_JAPAN15
 = 4015,

203 
	mCTRY_JAPAN16
 = 4016,

204 
	mCTRY_JAPAN17
 = 4017,

205 
	mCTRY_JAPAN18
 = 4018,

206 
	mCTRY_JAPAN19
 = 4019,

207 
	mCTRY_JAPAN20
 = 4020,

208 
	mCTRY_JAPAN21
 = 4021,

209 
	mCTRY_JAPAN22
 = 4022,

210 
	mCTRY_JAPAN23
 = 4023,

211 
	mCTRY_JAPAN24
 = 4024,

212 
	mCTRY_JAPAN25
 = 4025,

213 
	mCTRY_JAPAN26
 = 4026,

214 
	mCTRY_JAPAN27
 = 4027,

215 
	mCTRY_JAPAN28
 = 4028,

216 
	mCTRY_JAPAN29
 = 4029,

217 
	mCTRY_JAPAN30
 = 4030,

218 
	mCTRY_JAPAN31
 = 4031,

219 
	mCTRY_JAPAN32
 = 4032,

220 
	mCTRY_JAPAN33
 = 4033,

221 
	mCTRY_JAPAN34
 = 4034,

222 
	mCTRY_JAPAN35
 = 4035,

223 
	mCTRY_JAPAN36
 = 4036,

224 
	mCTRY_JAPAN37
 = 4037,

225 
	mCTRY_JAPAN38
 = 4038,

226 
	mCTRY_JAPAN39
 = 4039,

227 
	mCTRY_JAPAN40
 = 4040,

228 
	mCTRY_JAPAN41
 = 4041,

229 
	mCTRY_JAPAN42
 = 4042,

230 
	mCTRY_JAPAN43
 = 4043,

231 
	mCTRY_JAPAN44
 = 4044,

232 
	mCTRY_JAPAN45
 = 4045,

233 
	mCTRY_JAPAN46
 = 4046,

234 
	mCTRY_JAPAN47
 = 4047,

235 
	mCTRY_JAPAN48
 = 4048,

236 
	mCTRY_JAPAN49
 = 4049,

237 
	mCTRY_JAPAN50
 = 4050,

238 
	mCTRY_JAPAN51
 = 4051,

239 
	mCTRY_JAPAN52
 = 4052,

240 
	mCTRY_JAPAN53
 = 4053,

241 
	mCTRY_JAPAN54
 = 4054,

242 
	mCTRY_JAPAN55
 = 4055,

243 
	mCTRY_JAPAN56
 = 4056,

244 
	mCTRY_JAPAN57
 = 4057,

245 
	mCTRY_JAPAN58
 = 4058,

246 
	mCTRY_JAPAN59
 = 4059,

247 
	mCTRY_AUSTRALIA2
 = 5000,

248 
	mCTRY_CANADA2
 = 5001,

249 
	mCTRY_BELGIUM2
 = 5002

252 
boﬁ
 
©h_is_w‹ld_ªgd
(
©h_ªguœt‹y
 *
ªg
);

253 
boﬁ
 
©h_is_49ghz_Ælowed
(
u16
 
ªdomaö
);

254 
©h_ªgd_öô
(
©h_ªguœt‹y
 *
ªg
, 
wùhy
 *wiphy,

255 (*
ªg_nŸifõr
)(
wùhy
 *wiphy,

256 
ªguœt‹y_ªque°
 *
ªque°
));

257 
u32
 
	`©h_ªgd_gë_b™d_˘l
(
©h_ªguœt‹y
 *
ªg
,

258 
õì80211_b™d
 
b™d
);

259 
	`©h_ªg_nŸifõr_≠∂y
(
wùhy
 *wiphy,

260 
ªguœt‹y_ªque°
 *
ªque°
,

261 
©h_ªguœt‹y
 *
ªg
);

	@regd_common.h

17 #i‚de‡
REGD_COMMON_H


18 
	#REGD_COMMON_H


	)

20 
	eEnumRd
 {

21 
	mNO_ENUMRD
 = 0x00,

22 
	mNULL1_WORLD
 = 0x03,

23 
	mNULL1_ETSIB
 = 0x07,

24 
	mNULL1_ETSIC
 = 0x08,

25 
	mFCC1_FCCA
 = 0x10,

26 
	mFCC1_WORLD
 = 0x11,

27 
	mFCC4_FCCA
 = 0x12,

28 
	mFCC5_FCCA
 = 0x13,

29 
	mFCC6_FCCA
 = 0x14,

31 
	mFCC2_FCCA
 = 0x20,

32 
	mFCC2_WORLD
 = 0x21,

33 
	mFCC2_ETSIC
 = 0x22,

34 
	mFCC6_WORLD
 = 0x23,

35 
	mFRANCE_RES
 = 0x31,

36 
	mFCC3_FCCA
 = 0x3A,

37 
	mFCC3_WORLD
 = 0x3B,

39 
	mETSI1_WORLD
 = 0x37,

40 
	mETSI3_ETSIA
 = 0x32,

41 
	mETSI2_WORLD
 = 0x35,

42 
	mETSI3_WORLD
 = 0x36,

43 
	mETSI4_WORLD
 = 0x30,

44 
	mETSI4_ETSIC
 = 0x38,

45 
	mETSI5_WORLD
 = 0x39,

46 
	mETSI6_WORLD
 = 0x34,

47 
	mETSI_RESERVED
 = 0x33,

49 
	mMKK1_MKKA
 = 0x40,

50 
	mMKK1_MKKB
 = 0x41,

51 
	mAPL4_WORLD
 = 0x42,

52 
	mMKK2_MKKA
 = 0x43,

53 
	mAPL_RESERVED
 = 0x44,

54 
	mAPL2_WORLD
 = 0x45,

55 
	mAPL2_APLC
 = 0x46,

56 
	mAPL3_WORLD
 = 0x47,

57 
	mMKK1_FCCA
 = 0x48,

58 
	mAPL2_APLD
 = 0x49,

59 
	mMKK1_MKKA1
 = 0x4A,

60 
	mMKK1_MKKA2
 = 0x4B,

61 
	mMKK1_MKKC
 = 0x4C,

63 
	mAPL3_FCCA
 = 0x50,

64 
	mAPL1_WORLD
 = 0x52,

65 
	mAPL1_FCCA
 = 0x53,

66 
	mAPL1_APLA
 = 0x54,

67 
	mAPL1_ETSIC
 = 0x55,

68 
	mAPL2_ETSIC
 = 0x56,

69 
	mAPL5_WORLD
 = 0x58,

70 
	mAPL6_WORLD
 = 0x5B,

71 
	mAPL7_FCCA
 = 0x5C,

72 
	mAPL8_WORLD
 = 0x5D,

73 
	mAPL9_WORLD
 = 0x5E,

75 
	mWOR0_WORLD
 = 0x60,

76 
	mWOR1_WORLD
 = 0x61,

77 
	mWOR2_WORLD
 = 0x62,

78 
	mWOR3_WORLD
 = 0x63,

79 
	mWOR4_WORLD
 = 0x64,

80 
	mWOR5_ETSIC
 = 0x65,

82 
	mWOR01_WORLD
 = 0x66,

83 
	mWOR02_WORLD
 = 0x67,

84 
	mEU1_WORLD
 = 0x68,

86 
	mWOR9_WORLD
 = 0x69,

87 
	mWORA_WORLD
 = 0x6A,

88 
	mWORB_WORLD
 = 0x6B,

89 
	mWORC_WORLD
 = 0x6C,

91 
	mMKK3_MKKB
 = 0x80,

92 
	mMKK3_MKKA2
 = 0x81,

93 
	mMKK3_MKKC
 = 0x82,

95 
	mMKK4_MKKB
 = 0x83,

96 
	mMKK4_MKKA2
 = 0x84,

97 
	mMKK4_MKKC
 = 0x85,

99 
	mMKK5_MKKB
 = 0x86,

100 
	mMKK5_MKKA2
 = 0x87,

101 
	mMKK5_MKKC
 = 0x88,

103 
	mMKK6_MKKB
 = 0x89,

104 
	mMKK6_MKKA2
 = 0x8A,

105 
	mMKK6_MKKC
 = 0x8B,

107 
	mMKK7_MKKB
 = 0x8C,

108 
	mMKK7_MKKA2
 = 0x8D,

109 
	mMKK7_MKKC
 = 0x8E,

111 
	mMKK8_MKKB
 = 0x8F,

112 
	mMKK8_MKKA2
 = 0x90,

113 
	mMKK8_MKKC
 = 0x91,

115 
	mMKK14_MKKA1
 = 0x92,

116 
	mMKK15_MKKA1
 = 0x93,

118 
	mMKK10_FCCA
 = 0xD0,

119 
	mMKK10_MKKA1
 = 0xD1,

120 
	mMKK10_MKKC
 = 0xD2,

121 
	mMKK10_MKKA2
 = 0xD3,

123 
	mMKK11_MKKA
 = 0xD4,

124 
	mMKK11_FCCA
 = 0xD5,

125 
	mMKK11_MKKA1
 = 0xD6,

126 
	mMKK11_MKKC
 = 0xD7,

127 
	mMKK11_MKKA2
 = 0xD8,

129 
	mMKK12_MKKA
 = 0xD9,

130 
	mMKK12_FCCA
 = 0xDA,

131 
	mMKK12_MKKA1
 = 0xDB,

132 
	mMKK12_MKKC
 = 0xDC,

133 
	mMKK12_MKKA2
 = 0xDD,

135 
	mMKK13_MKKB
 = 0xDE,

137 
	mMKK3_MKKA
 = 0xF0,

138 
	mMKK3_MKKA1
 = 0xF1,

139 
	mMKK3_FCCA
 = 0xF2,

140 
	mMKK4_MKKA
 = 0xF3,

141 
	mMKK4_MKKA1
 = 0xF4,

142 
	mMKK4_FCCA
 = 0xF5,

143 
	mMKK9_MKKA
 = 0xF6,

144 
	mMKK10_MKKA
 = 0xF7,

145 
	mMKK6_MKKA1
 = 0xF8,

146 
	mMKK6_FCCA
 = 0xF9,

147 
	mMKK7_MKKA1
 = 0xFA,

148 
	mMKK7_FCCA
 = 0xFB,

149 
	mMKK9_FCCA
 = 0xFC,

150 
	mMKK9_MKKA1
 = 0xFD,

151 
	mMKK9_MKKC
 = 0xFE,

152 
	mMKK9_MKKA2
 = 0xFF,

154 
	mWORLD
 = 0x0199,

155 
	mDEBUG_REG_DMN
 = 0x01ff,

159 
ªg_dmn_∑ú_m≠pög
 
	gªgDomaöPaús
[] = {

161 {
NO_ENUMRD
, 
DEBUG_REG_DMN
, DEBUG_REG_DMN},

162 {
NULL1_WORLD
, 
NO_CTL
, 
CTL_ETSI
},

163 {
NULL1_ETSIB
, 
NO_CTL
, 
CTL_ETSI
},

164 {
NULL1_ETSIC
, 
NO_CTL
, 
CTL_ETSI
},

166 {
FCC2_FCCA
, 
CTL_FCC
, CTL_FCC},

167 {
FCC2_WORLD
, 
CTL_FCC
, 
CTL_ETSI
},

168 {
FCC2_ETSIC
, 
CTL_FCC
, 
CTL_ETSI
},

169 {
FCC3_FCCA
, 
CTL_FCC
, CTL_FCC},

170 {
FCC3_WORLD
, 
CTL_FCC
, 
CTL_ETSI
},

171 {
FCC4_FCCA
, 
CTL_FCC
, CTL_FCC},

172 {
FCC5_FCCA
, 
CTL_FCC
, CTL_FCC},

173 {
FCC6_FCCA
, 
CTL_FCC
, CTL_FCC},

174 {
FCC6_WORLD
, 
CTL_FCC
, 
CTL_ETSI
},

176 {
ETSI1_WORLD
, 
CTL_ETSI
, CTL_ETSI},

177 {
ETSI2_WORLD
, 
CTL_ETSI
, CTL_ETSI},

178 {
ETSI3_WORLD
, 
CTL_ETSI
, CTL_ETSI},

179 {
ETSI4_WORLD
, 
CTL_ETSI
, CTL_ETSI},

180 {
ETSI5_WORLD
, 
CTL_ETSI
, CTL_ETSI},

181 {
ETSI6_WORLD
, 
CTL_ETSI
, CTL_ETSI},

184 {
ETSI3_ETSIA
, 
CTL_ETSI
, CTL_ETSI},

185 {
FRANCE_RES
, 
CTL_ETSI
, CTL_ETSI},

187 {
FCC1_WORLD
, 
CTL_FCC
, 
CTL_ETSI
},

188 {
FCC1_FCCA
, 
CTL_FCC
, CTL_FCC},

189 {
APL1_WORLD
, 
CTL_FCC
, 
CTL_ETSI
},

190 {
APL2_WORLD
, 
CTL_FCC
, 
CTL_ETSI
},

191 {
APL3_WORLD
, 
CTL_FCC
, 
CTL_ETSI
},

192 {
APL4_WORLD
, 
CTL_FCC
, 
CTL_ETSI
},

193 {
APL5_WORLD
, 
CTL_FCC
, 
CTL_ETSI
},

194 {
APL6_WORLD
, 
CTL_ETSI
, CTL_ETSI},

195 {
APL8_WORLD
, 
CTL_ETSI
, CTL_ETSI},

196 {
APL9_WORLD
, 
CTL_ETSI
, CTL_ETSI},

198 {
APL3_FCCA
, 
CTL_FCC
, CTL_FCC},

199 {
APL7_FCCA
, 
CTL_FCC
, CTL_FCC},

200 {
APL1_ETSIC
, 
CTL_FCC
, 
CTL_ETSI
},

201 {
APL2_ETSIC
, 
CTL_FCC
, 
CTL_ETSI
},

202 {
APL2_APLD
, 
CTL_FCC
, 
NO_CTL
},

204 {
MKK1_MKKA
, 
CTL_MKK
, CTL_MKK},

205 {
MKK1_MKKB
, 
CTL_MKK
, CTL_MKK},

206 {
MKK1_FCCA
, 
CTL_MKK
, 
CTL_FCC
},

207 {
MKK1_MKKA1
, 
CTL_MKK
, CTL_MKK},

208 {
MKK1_MKKA2
, 
CTL_MKK
, CTL_MKK},

209 {
MKK1_MKKC
, 
CTL_MKK
, CTL_MKK},

211 {
MKK2_MKKA
, 
CTL_MKK
, CTL_MKK},

212 {
MKK3_MKKA
, 
CTL_MKK
, CTL_MKK},

213 {
MKK3_MKKB
, 
CTL_MKK
, CTL_MKK},

214 {
MKK3_MKKA1
, 
CTL_MKK
, CTL_MKK},

215 {
MKK3_MKKA2
, 
CTL_MKK
, CTL_MKK},

216 {
MKK3_MKKC
, 
CTL_MKK
, CTL_MKK},

217 {
MKK3_FCCA
, 
CTL_MKK
, 
CTL_FCC
},

219 {
MKK4_MKKA
, 
CTL_MKK
, CTL_MKK},

220 {
MKK4_MKKB
, 
CTL_MKK
, CTL_MKK},

221 {
MKK4_MKKA1
, 
CTL_MKK
, CTL_MKK},

222 {
MKK4_MKKA2
, 
CTL_MKK
, CTL_MKK},

223 {
MKK4_MKKC
, 
CTL_MKK
, CTL_MKK},

224 {
MKK4_FCCA
, 
CTL_MKK
, 
CTL_FCC
},

226 {
MKK5_MKKB
, 
CTL_MKK
, CTL_MKK},

227 {
MKK5_MKKA2
, 
CTL_MKK
, CTL_MKK},

228 {
MKK5_MKKC
, 
CTL_MKK
, CTL_MKK},

230 {
MKK6_MKKB
, 
CTL_MKK
, CTL_MKK},

231 {
MKK6_MKKA1
, 
CTL_MKK
, CTL_MKK},

232 {
MKK6_MKKA2
, 
CTL_MKK
, CTL_MKK},

233 {
MKK6_MKKC
, 
CTL_MKK
, CTL_MKK},

234 {
MKK6_FCCA
, 
CTL_MKK
, 
CTL_FCC
},

236 {
MKK7_MKKB
, 
CTL_MKK
, CTL_MKK},

237 {
MKK7_MKKA1
, 
CTL_MKK
, CTL_MKK},

238 {
MKK7_MKKA2
, 
CTL_MKK
, CTL_MKK},

239 {
MKK7_MKKC
, 
CTL_MKK
, CTL_MKK},

240 {
MKK7_FCCA
, 
CTL_MKK
, 
CTL_FCC
},

242 {
MKK8_MKKB
, 
CTL_MKK
, CTL_MKK},

243 {
MKK8_MKKA2
, 
CTL_MKK
, CTL_MKK},

244 {
MKK8_MKKC
, 
CTL_MKK
, CTL_MKK},

246 {
MKK9_MKKA
, 
CTL_MKK
, CTL_MKK},

247 {
MKK9_FCCA
, 
CTL_MKK
, 
CTL_FCC
},

248 {
MKK9_MKKA1
, 
CTL_MKK
, CTL_MKK},

249 {
MKK9_MKKA2
, 
CTL_MKK
, CTL_MKK},

250 {
MKK9_MKKC
, 
CTL_MKK
, CTL_MKK},

252 {
MKK10_MKKA
, 
CTL_MKK
, CTL_MKK},

253 {
MKK10_FCCA
, 
CTL_MKK
, 
CTL_FCC
},

254 {
MKK10_MKKA1
, 
CTL_MKK
, CTL_MKK},

255 {
MKK10_MKKA2
, 
CTL_MKK
, CTL_MKK},

256 {
MKK10_MKKC
, 
CTL_MKK
, CTL_MKK},

258 {
MKK11_MKKA
, 
CTL_MKK
, CTL_MKK},

259 {
MKK11_FCCA
, 
CTL_MKK
, 
CTL_FCC
},

260 {
MKK11_MKKA1
, 
CTL_MKK
, CTL_MKK},

261 {
MKK11_MKKA2
, 
CTL_MKK
, CTL_MKK},

262 {
MKK11_MKKC
, 
CTL_MKK
, CTL_MKK},

264 {
MKK12_MKKA
, 
CTL_MKK
, CTL_MKK},

265 {
MKK12_FCCA
, 
CTL_MKK
, 
CTL_FCC
},

266 {
MKK12_MKKA1
, 
CTL_MKK
, CTL_MKK},

267 {
MKK12_MKKA2
, 
CTL_MKK
, CTL_MKK},

268 {
MKK12_MKKC
, 
CTL_MKK
, CTL_MKK},

270 {
MKK13_MKKB
, 
CTL_MKK
, CTL_MKK},

271 {
MKK14_MKKA1
, 
CTL_MKK
, CTL_MKK},

272 {
MKK15_MKKA1
, 
CTL_MKK
, CTL_MKK},

274 {
WOR0_WORLD
, 
NO_CTL
, NO_CTL},

275 {
WOR1_WORLD
, 
NO_CTL
, NO_CTL},

276 {
WOR2_WORLD
, 
NO_CTL
, NO_CTL},

277 {
WOR3_WORLD
, 
NO_CTL
, NO_CTL},

278 {
WOR4_WORLD
, 
NO_CTL
, NO_CTL},

279 {
WOR5_ETSIC
, 
NO_CTL
, NO_CTL},

280 {
WOR01_WORLD
, 
NO_CTL
, NO_CTL},

281 {
WOR02_WORLD
, 
NO_CTL
, NO_CTL},

282 {
EU1_WORLD
, 
NO_CTL
, NO_CTL},

283 {
WOR9_WORLD
, 
NO_CTL
, NO_CTL},

284 {
WORA_WORLD
, 
NO_CTL
, NO_CTL},

285 {
WORB_WORLD
, 
NO_CTL
, NO_CTL},

286 {
WORC_WORLD
, 
NO_CTL
, NO_CTL},

289 
cou¡ry_code_to_íum_rd
 
	gÆlCou¡rõs
[] = {

290 {
CTRY_DEBUG
, 
NO_ENUMRD
, "DB"},

291 {
CTRY_DEFAULT
, 
FCC1_FCCA
, "CO"},

292 {
CTRY_ALBANIA
, 
NULL1_WORLD
, "AL"},

293 {
CTRY_ALGERIA
, 
NULL1_WORLD
, "DZ"},

294 {
CTRY_ARGENTINA
, 
FCC3_WORLD
, "AR"},

295 {
CTRY_ARMENIA
, 
ETSI4_WORLD
, "AM"},

296 {
CTRY_ARUBA
, 
ETSI1_WORLD
, "AW"},

297 {
CTRY_AUSTRALIA
, 
FCC2_WORLD
, "AU"},

298 {
CTRY_AUSTRALIA2
, 
FCC6_WORLD
, "AU"},

299 {
CTRY_AUSTRIA
, 
ETSI1_WORLD
, "AT"},

300 {
CTRY_AZERBAIJAN
, 
ETSI4_WORLD
, "AZ"},

301 {
CTRY_BAHRAIN
, 
APL6_WORLD
, "BH"},

302 {
CTRY_BANGLADESH
, 
NULL1_WORLD
, "BD"},

303 {
CTRY_BARBADOS
, 
FCC2_WORLD
, "BB"},

304 {
CTRY_BELARUS
, 
ETSI1_WORLD
, "BY"},

305 {
CTRY_BELGIUM
, 
ETSI1_WORLD
, "BE"},

306 {
CTRY_BELGIUM2
, 
ETSI4_WORLD
, "BL"},

307 {
CTRY_BELIZE
, 
APL1_ETSIC
, "BZ"},

308 {
CTRY_BOLIVIA
, 
APL1_ETSIC
, "BO"},

309 {
CTRY_BOSNIA_HERZ
, 
ETSI1_WORLD
, "BA"},

310 {
CTRY_BRAZIL
, 
FCC3_WORLD
, "BR"},

311 {
CTRY_BRUNEI_DARUSSALAM
, 
APL1_WORLD
, "BN"},

312 {
CTRY_BULGARIA
, 
ETSI6_WORLD
, "BG"},

313 {
CTRY_CAMBODIA
, 
ETSI1_WORLD
, "KH"},

314 {
CTRY_CANADA
, 
FCC3_FCCA
, "CA"},

315 {
CTRY_CANADA2
, 
FCC6_FCCA
, "CA"},

316 {
CTRY_CHILE
, 
APL6_WORLD
, "CL"},

317 {
CTRY_CHINA
, 
APL1_WORLD
, "CN"},

318 {
CTRY_COLOMBIA
, 
FCC1_FCCA
, "CO"},

319 {
CTRY_COSTA_RICA
, 
FCC1_WORLD
, "CR"},

320 {
CTRY_CROATIA
, 
ETSI1_WORLD
, "HR"},

321 {
CTRY_CYPRUS
, 
ETSI1_WORLD
, "CY"},

322 {
CTRY_CZECH
, 
ETSI3_WORLD
, "CZ"},

323 {
CTRY_DENMARK
, 
ETSI1_WORLD
, "DK"},

324 {
CTRY_DOMINICAN_REPUBLIC
, 
FCC1_FCCA
, "DO"},

325 {
CTRY_ECUADOR
, 
FCC1_WORLD
, "EC"},

326 {
CTRY_EGYPT
, 
ETSI3_WORLD
, "EG"},

327 {
CTRY_EL_SALVADOR
, 
FCC1_WORLD
, "SV"},

328 {
CTRY_ESTONIA
, 
ETSI1_WORLD
, "EE"},

329 {
CTRY_FINLAND
, 
ETSI1_WORLD
, "FI"},

330 {
CTRY_FRANCE
, 
ETSI1_WORLD
, "FR"},

331 {
CTRY_GEORGIA
, 
ETSI4_WORLD
, "GE"},

332 {
CTRY_GERMANY
, 
ETSI1_WORLD
, "DE"},

333 {
CTRY_GREECE
, 
ETSI1_WORLD
, "GR"},

334 {
CTRY_GREENLAND
, 
ETSI1_WORLD
, "GL"},

335 {
CTRY_GRENEDA
, 
FCC3_FCCA
, "GD"},

336 {
CTRY_GUAM
, 
FCC1_FCCA
, "GU"},

337 {
CTRY_GUATEMALA
, 
FCC1_FCCA
, "GT"},

338 {
CTRY_HAITI
, 
ETSI1_WORLD
, "HT"},

339 {
CTRY_HONDURAS
, 
NULL1_WORLD
, "HN"},

340 {
CTRY_HONG_KONG
, 
FCC3_WORLD
, "HK"},

341 {
CTRY_HUNGARY
, 
ETSI1_WORLD
, "HU"},

342 {
CTRY_ICELAND
, 
ETSI1_WORLD
, "IS"},

343 {
CTRY_INDIA
, 
APL6_WORLD
, "IN"},

344 {
CTRY_INDONESIA
, 
NULL1_WORLD
, "ID"},

345 {
CTRY_IRAN
, 
APL1_WORLD
, "IR"},

346 {
CTRY_IRELAND
, 
ETSI1_WORLD
, "IE"},

347 {
CTRY_ISRAEL
, 
NULL1_WORLD
, "IL"},

348 {
CTRY_ITALY
, 
ETSI1_WORLD
, "IT"},

349 {
CTRY_JAMAICA
, 
FCC3_WORLD
, "JM"},

351 {
CTRY_JAPAN
, 
MKK1_MKKA
, "JP"},

352 {
CTRY_JAPAN1
, 
MKK1_MKKB
, "JP"},

353 {
CTRY_JAPAN2
, 
MKK1_FCCA
, "JP"},

354 {
CTRY_JAPAN3
, 
MKK2_MKKA
, "JP"},

355 {
CTRY_JAPAN4
, 
MKK1_MKKA1
, "JP"},

356 {
CTRY_JAPAN5
, 
MKK1_MKKA2
, "JP"},

357 {
CTRY_JAPAN6
, 
MKK1_MKKC
, "JP"},

358 {
CTRY_JAPAN7
, 
MKK3_MKKB
, "JP"},

359 {
CTRY_JAPAN8
, 
MKK3_MKKA2
, "JP"},

360 {
CTRY_JAPAN9
, 
MKK3_MKKC
, "JP"},

361 {
CTRY_JAPAN10
, 
MKK4_MKKB
, "JP"},

362 {
CTRY_JAPAN11
, 
MKK4_MKKA2
, "JP"},

363 {
CTRY_JAPAN12
, 
MKK4_MKKC
, "JP"},

364 {
CTRY_JAPAN13
, 
MKK5_MKKB
, "JP"},

365 {
CTRY_JAPAN14
, 
MKK5_MKKA2
, "JP"},

366 {
CTRY_JAPAN15
, 
MKK5_MKKC
, "JP"},

367 {
CTRY_JAPAN16
, 
MKK6_MKKB
, "JP"},

368 {
CTRY_JAPAN17
, 
MKK6_MKKA2
, "JP"},

369 {
CTRY_JAPAN18
, 
MKK6_MKKC
, "JP"},

370 {
CTRY_JAPAN19
, 
MKK7_MKKB
, "JP"},

371 {
CTRY_JAPAN20
, 
MKK7_MKKA2
, "JP"},

372 {
CTRY_JAPAN21
, 
MKK7_MKKC
, "JP"},

373 {
CTRY_JAPAN22
, 
MKK8_MKKB
, "JP"},

374 {
CTRY_JAPAN23
, 
MKK8_MKKA2
, "JP"},

375 {
CTRY_JAPAN24
, 
MKK8_MKKC
, "JP"},

376 {
CTRY_JAPAN25
, 
MKK3_MKKA
, "JP"},

377 {
CTRY_JAPAN26
, 
MKK3_MKKA1
, "JP"},

378 {
CTRY_JAPAN27
, 
MKK3_FCCA
, "JP"},

379 {
CTRY_JAPAN28
, 
MKK4_MKKA1
, "JP"},

380 {
CTRY_JAPAN29
, 
MKK4_FCCA
, "JP"},

381 {
CTRY_JAPAN30
, 
MKK6_MKKA1
, "JP"},

382 {
CTRY_JAPAN31
, 
MKK6_FCCA
, "JP"},

383 {
CTRY_JAPAN32
, 
MKK7_MKKA1
, "JP"},

384 {
CTRY_JAPAN33
, 
MKK7_FCCA
, "JP"},

385 {
CTRY_JAPAN34
, 
MKK9_MKKA
, "JP"},

386 {
CTRY_JAPAN35
, 
MKK10_MKKA
, "JP"},

387 {
CTRY_JAPAN36
, 
MKK4_MKKA
, "JP"},

388 {
CTRY_JAPAN37
, 
MKK9_FCCA
, "JP"},

389 {
CTRY_JAPAN38
, 
MKK9_MKKA1
, "JP"},

390 {
CTRY_JAPAN39
, 
MKK9_MKKC
, "JP"},

391 {
CTRY_JAPAN40
, 
MKK9_MKKA2
, "JP"},

392 {
CTRY_JAPAN41
, 
MKK10_FCCA
, "JP"},

393 {
CTRY_JAPAN42
, 
MKK10_MKKA1
, "JP"},

394 {
CTRY_JAPAN43
, 
MKK10_MKKC
, "JP"},

395 {
CTRY_JAPAN44
, 
MKK10_MKKA2
, "JP"},

396 {
CTRY_JAPAN45
, 
MKK11_MKKA
, "JP"},

397 {
CTRY_JAPAN46
, 
MKK11_FCCA
, "JP"},

398 {
CTRY_JAPAN47
, 
MKK11_MKKA1
, "JP"},

399 {
CTRY_JAPAN48
, 
MKK11_MKKC
, "JP"},

400 {
CTRY_JAPAN49
, 
MKK11_MKKA2
, "JP"},

401 {
CTRY_JAPAN50
, 
MKK12_MKKA
, "JP"},

402 {
CTRY_JAPAN51
, 
MKK12_FCCA
, "JP"},

403 {
CTRY_JAPAN52
, 
MKK12_MKKA1
, "JP"},

404 {
CTRY_JAPAN53
, 
MKK12_MKKC
, "JP"},

405 {
CTRY_JAPAN54
, 
MKK12_MKKA2
, "JP"},

406 {
CTRY_JAPAN57
, 
MKK13_MKKB
, "JP"},

407 {
CTRY_JAPAN58
, 
MKK14_MKKA1
, "JP"},

408 {
CTRY_JAPAN59
, 
MKK15_MKKA1
, "JP"},

410 {
CTRY_JORDAN
, 
ETSI2_WORLD
, "JO"},

411 {
CTRY_KAZAKHSTAN
, 
NULL1_WORLD
, "KZ"},

412 {
CTRY_KOREA_NORTH
, 
APL9_WORLD
, "KP"},

413 {
CTRY_KOREA_ROC
, 
APL9_WORLD
, "KR"},

414 {
CTRY_KOREA_ROC2
, 
APL2_WORLD
, "K2"},

415 {
CTRY_KOREA_ROC3
, 
APL9_WORLD
, "K3"},

416 {
CTRY_KUWAIT
, 
ETSI3_WORLD
, "KW"},

417 {
CTRY_LATVIA
, 
ETSI1_WORLD
, "LV"},

418 {
CTRY_LEBANON
, 
NULL1_WORLD
, "LB"},

419 {
CTRY_LIECHTENSTEIN
, 
ETSI1_WORLD
, "LI"},

420 {
CTRY_LITHUANIA
, 
ETSI1_WORLD
, "LT"},

421 {
CTRY_LUXEMBOURG
, 
ETSI1_WORLD
, "LU"},

422 {
CTRY_MACAU
, 
FCC2_WORLD
, "MO"},

423 {
CTRY_MACEDONIA
, 
NULL1_WORLD
, "MK"},

424 {
CTRY_MALAYSIA
, 
APL8_WORLD
, "MY"},

425 {
CTRY_MALTA
, 
ETSI1_WORLD
, "MT"},

426 {
CTRY_MEXICO
, 
FCC1_FCCA
, "MX"},

427 {
CTRY_MONACO
, 
ETSI4_WORLD
, "MC"},

428 {
CTRY_MOROCCO
, 
APL4_WORLD
, "MA"},

429 {
CTRY_NEPAL
, 
APL1_WORLD
, "NP"},

430 {
CTRY_NETHERLANDS
, 
ETSI1_WORLD
, "NL"},

431 {
CTRY_NETHERLANDS_ANTILLES
, 
ETSI1_WORLD
, "AN"},

432 {
CTRY_NEW_ZEALAND
, 
FCC2_ETSIC
, "NZ"},

433 {
CTRY_NORWAY
, 
ETSI1_WORLD
, "NO"},

434 {
CTRY_OMAN
, 
FCC3_WORLD
, "OM"},

435 {
CTRY_PAKISTAN
, 
NULL1_WORLD
, "PK"},

436 {
CTRY_PANAMA
, 
FCC1_FCCA
, "PA"},

437 {
CTRY_PAPUA_NEW_GUINEA
, 
FCC1_WORLD
, "PG"},

438 {
CTRY_PERU
, 
APL1_WORLD
, "PE"},

439 {
CTRY_PHILIPPINES
, 
APL1_WORLD
, "PH"},

440 {
CTRY_POLAND
, 
ETSI1_WORLD
, "PL"},

441 {
CTRY_PORTUGAL
, 
ETSI1_WORLD
, "PT"},

442 {
CTRY_PUERTO_RICO
, 
FCC1_FCCA
, "PR"},

443 {
CTRY_QATAR
, 
APL1_WORLD
, "QA"},

444 {
CTRY_ROMANIA
, 
NULL1_WORLD
, "RO"},

445 {
CTRY_RUSSIA
, 
NULL1_WORLD
, "RU"},

446 {
CTRY_SAUDI_ARABIA
, 
NULL1_WORLD
, "SA"},

447 {
CTRY_SERBIA_MONTENEGRO
, 
ETSI1_WORLD
, "CS"},

448 {
CTRY_SINGAPORE
, 
APL6_WORLD
, "SG"},

449 {
CTRY_SLOVAKIA
, 
ETSI1_WORLD
, "SK"},

450 {
CTRY_SLOVENIA
, 
ETSI1_WORLD
, "SI"},

451 {
CTRY_SOUTH_AFRICA
, 
FCC3_WORLD
, "ZA"},

452 {
CTRY_SPAIN
, 
ETSI1_WORLD
, "ES"},

453 {
CTRY_SRI_LANKA
, 
FCC3_WORLD
, "LK"},

454 {
CTRY_SWEDEN
, 
ETSI1_WORLD
, "SE"},

455 {
CTRY_SWITZERLAND
, 
ETSI1_WORLD
, "CH"},

456 {
CTRY_SYRIA
, 
NULL1_WORLD
, "SY"},

457 {
CTRY_TAIWAN
, 
APL3_FCCA
, "TW"},

458 {
CTRY_THAILAND
, 
FCC3_WORLD
, "TH"},

459 {
CTRY_TRINIDAD_Y_TOBAGO
, 
FCC3_WORLD
, "TT"},

460 {
CTRY_TUNISIA
, 
ETSI3_WORLD
, "TN"},

461 {
CTRY_TURKEY
, 
ETSI3_WORLD
, "TR"},

462 {
CTRY_UKRAINE
, 
NULL1_WORLD
, "UA"},

463 {
CTRY_UAE
, 
NULL1_WORLD
, "AE"},

464 {
CTRY_UNITED_KINGDOM
, 
ETSI1_WORLD
, "GB"},

465 {
CTRY_UNITED_STATES
, 
FCC3_FCCA
, "US"},

469 {
CTRY_UNITED_STATES_FCC49
, 
FCC4_FCCA
, "PS"},

470 {
CTRY_URUGUAY
, 
FCC3_WORLD
, "UY"},

471 {
CTRY_UZBEKISTAN
, 
FCC3_FCCA
, "UZ"},

472 {
CTRY_VENEZUELA
, 
APL2_ETSIC
, "VE"},

473 {
CTRY_VIET_NAM
, 
NULL1_WORLD
, "VN"},

474 {
CTRY_YEMEN
, 
NULL1_WORLD
, "YE"},

475 {
CTRY_ZIMBABWE
, 
NULL1_WORLD
, "ZW"},

	@/usr/include/linux/ethtool.h

13 #i‚de‡
_LINUX_ETHTOOL_H


14 
	#_LINUX_ETHTOOL_H


	)

16 
	~<löux/ty≥s.h
>

17 
	~<löux/if_ëhî.h
>

20 
	sëhtoﬁ_cmd
 {

21 
__u32
 
	mcmd
;

22 
__u32
 
	msuµ‹ãd
;

23 
__u32
 
	madvîtisög
;

24 
__u16
 
	m•ìd
;

28 
__u8
 
	mdu∂ex
;

29 
__u8
 
	mp‹t
;

30 
__u8
 
	mphy_addªss
;

31 
__u8
 
	må™s˚ivî
;

32 
__u8
 
	maut⁄eg
;

33 
__u8
 
	mmdio_suµ‹t
;

34 
__u32
 
	mmaxtxpkt
;

35 
__u32
 
	mmaxrxpkt
;

36 
__u16
 
	m•ìd_hi
;

40 
__u8
 
	mëh_ç_mdix
;

41 
__u8
 
	mª£rved2
;

42 
__u32
 
	mÕ_advîtisög
;

43 
__u32
 
	mª£rved
[2];

46 
__ölöe__
 
	$ëhtoﬁ_cmd_•ìd_£t
(
ëhtoﬁ_cmd
 *
ï
,

47 
__u32
 
•ìd
)

50 
ï
->
•ìd
 = (
__u16
)speed;

51 
ï
->
•ìd_hi
 = (
__u16
)(
•ìd
 >> 16);

52 
	}
}

54 
__ölöe__
 
__u32
 
	$ëhtoﬁ_cmd_•ìd
(c⁄° 
ëhtoﬁ_cmd
 *
ï
)

56  (
ï
->
•ìd_hi
 << 16Ë|Ép->
•ìd
;

57 
	}
}

59 
	#ETHTOOL_FWVERS_LEN
 32

	)

60 
	#ETHTOOL_BUSINFO_LEN
 32

	)

62 
	sëhtoﬁ_drvöfo
 {

63 
__u32
 
	mcmd
;

64 
	mdrivî
[32];

65 
	mvîsi⁄
[32];

66 
	mfw_vîsi⁄
[
ETHTOOL_FWVERS_LEN
];

67 
	mbus_öfo
[
ETHTOOL_BUSINFO_LEN
];

69 
	mª£rved1
[32];

70 
	mª£rved2
[12];

78 
__u32
 
	mn_¥iv_Êags
;

79 
__u32
 
	mn_°©s
;

80 
__u32
 
	mã°öfo_Àn
;

81 
__u32
 
	mìdump_Àn
;

82 
__u32
 
	mªgdump_Àn
;

85 
	#SOPASS_MAX
 6

	)

87 
	sëhtoﬁ_wﬁöfo
 {

88 
__u32
 
	mcmd
;

89 
__u32
 
	msuµ‹ãd
;

90 
__u32
 
	mwﬁ›ts
;

91 
__u8
 
	ms›ass
[
SOPASS_MAX
];

95 
	sëhtoﬁ_vÆue
 {

96 
__u32
 
	mcmd
;

97 
__u32
 
	md©a
;

101 
	sëhtoﬁ_ªgs
 {

102 
__u32
 
	mcmd
;

103 
__u32
 
	mvîsi⁄
;

104 
__u32
 
	mÀn
;

105 
__u8
 
	md©a
[0];

109 
	sëhtoﬁ_ì¥om
 {

110 
__u32
 
	mcmd
;

111 
__u32
 
	mmagic
;

112 
__u32
 
	moff£t
;

113 
__u32
 
	mÀn
;

114 
__u8
 
	md©a
[0];

118 
	sëhtoﬁ_cﬂÀs˚
 {

119 
__u32
 
	mcmd
;

125 
__u32
 
	mrx_cﬂÀs˚_u£cs
;

133 
__u32
 
	mrx_max_cﬂÀs˚d_‰ames
;

140 
__u32
 
	mrx_cﬂÀs˚_u£cs_úq
;

141 
__u32
 
	mrx_max_cﬂÀs˚d_‰ames_úq
;

147 
__u32
 
	mtx_cﬂÀs˚_u£cs
;

155 
__u32
 
	mtx_max_cﬂÀs˚d_‰ames
;

162 
__u32
 
	mtx_cﬂÀs˚_u£cs_úq
;

163 
__u32
 
	mtx_max_cﬂÀs˚d_‰ames_úq
;

170 
__u32
 
	m°©s_block_cﬂÀs˚_u£cs
;

179 
__u32
 
	mu£_ad≠tive_rx_cﬂÀs˚
;

180 
__u32
 
	mu£_ad≠tive_tx_cﬂÀs˚
;

186 
__u32
 
	mpkt_øã_low
;

187 
__u32
 
	mrx_cﬂÀs˚_u£cs_low
;

188 
__u32
 
	mrx_max_cﬂÀs˚d_‰ames_low
;

189 
__u32
 
	mtx_cﬂÀs˚_u£cs_low
;

190 
__u32
 
	mtx_max_cﬂÀs˚d_‰ames_low
;

201 
__u32
 
	mpkt_øã_high
;

202 
__u32
 
	mrx_cﬂÀs˚_u£cs_high
;

203 
__u32
 
	mrx_max_cﬂÀs˚d_‰ames_high
;

204 
__u32
 
	mtx_cﬂÀs˚_u£cs_high
;

205 
__u32
 
	mtx_max_cﬂÀs˚d_‰ames_high
;

210 
__u32
 
	møã_ßm∂e_öãrvÆ
;

214 
	sëhtoﬁ_rög∑øm
 {

215 
__u32
 
	mcmd
;

221 
__u32
 
	mrx_max_≥ndög
;

222 
__u32
 
	mrx_möi_max_≥ndög
;

223 
__u32
 
	mrx_jumbo_max_≥ndög
;

224 
__u32
 
	mtx_max_≥ndög
;

229 
__u32
 
	mrx_≥ndög
;

230 
__u32
 
	mrx_möi_≥ndög
;

231 
__u32
 
	mrx_jumbo_≥ndög
;

232 
__u32
 
	mtx_≥ndög
;

251 
	sëhtoﬁ_ch™√ls
 {

252 
__u32
 
	mcmd
;

253 
__u32
 
	mmax_rx
;

254 
__u32
 
	mmax_tx
;

255 
__u32
 
	mmax_Ÿhî
;

256 
__u32
 
	mmax_comböed
;

257 
__u32
 
	mrx_cou¡
;

258 
__u32
 
	mtx_cou¡
;

259 
__u32
 
	mŸhî_cou¡
;

260 
__u32
 
	mcomböed_cou¡
;

264 
	sëhtoﬁ_∑u£∑øm
 {

265 
__u32
 
	mcmd
;

277 
__u32
 
	maut⁄eg
;

278 
__u32
 
	mrx_∑u£
;

279 
__u32
 
	mtx_∑u£
;

282 
	#ETH_GSTRING_LEN
 32

	)

283 
	eëhtoﬁ_°rög£t
 {

284 
	mETH_SS_TEST
 = 0,

285 
	mETH_SS_STATS
,

286 
	mETH_SS_PRIV_FLAGS
,

287 
	mETH_SS_NTUPLE_FILTERS
,

288 
	mETH_SS_FEATURES
,

292 
	sëhtoﬁ_g°rögs
 {

293 
__u32
 
	mcmd
;

294 
__u32
 
	m°rög_£t
;

295 
__u32
 
	mÀn
;

296 
__u8
 
	md©a
[0];

299 
	sëhtoﬁ_s£t_öfo
 {

300 
__u32
 
	mcmd
;

301 
__u32
 
	mª£rved
;

302 
__u64
 
	ms£t_mask
;

304 
__u32
 
	md©a
[0];

320 
	eëhtoﬁ_ã°_Êags
 {

321 
	mETH_TEST_FL_OFFLINE
 = (1 << 0),

322 
	mETH_TEST_FL_FAILED
 = (1 << 1),

323 
	mETH_TEST_FL_EXTERNAL_LB
 = (1 << 2),

324 
	mETH_TEST_FL_EXTERNAL_LB_DONE
 = (1 << 3),

328 
	sëhtoﬁ_ã°
 {

329 
__u32
 
	mcmd
;

330 
__u32
 
	mÊags
;

331 
__u32
 
	mª£rved
;

332 
__u32
 
	mÀn
;

333 
__u64
 
	md©a
[0];

337 
	sëhtoﬁ_°©s
 {

338 
__u32
 
	mcmd
;

339 
__u32
 
	mn_°©s
;

340 
__u64
 
	md©a
[0];

343 
	sëhtoﬁ_≥rm_addr
 {

344 
__u32
 
	mcmd
;

345 
__u32
 
	msize
;

346 
__u8
 
	md©a
[0];

358 
	eëhtoﬁ_Êags
 {

359 
	mETH_FLAG_TXVLAN
 = (1 << 7),

360 
	mETH_FLAG_RXVLAN
 = (1 << 8),

361 
	mETH_FLAG_LRO
 = (1 << 15),

362 
	mETH_FLAG_NTUPLE
 = (1 << 27),

363 
	mETH_FLAG_RXHASH
 = (1 << 28),

382 
	sëhtoﬁ_t˝ù4_•ec
 {

383 
__be32
 
	mù4§c
;

384 
__be32
 
	mù4d°
;

385 
__be16
 
	mp§c
;

386 
__be16
 
	mpd°
;

387 
__u8
 
	mtos
;

399 
	sëhtoﬁ_ah_e•ù4_•ec
 {

400 
__be32
 
	mù4§c
;

401 
__be32
 
	mù4d°
;

402 
__be32
 
	m•i
;

403 
__u8
 
	mtos
;

406 
	#ETH_RX_NFC_IP4
 1

	)

417 
	sëhtoﬁ_u§ù4_•ec
 {

418 
__be32
 
	mù4§c
;

419 
__be32
 
	mù4d°
;

420 
__be32
 
	ml4_4_byãs
;

421 
__u8
 
	mtos
;

422 
__u8
 
	mù_vî
;

423 
__u8
 
	m¥Ÿo
;

426 
	uëhtoﬁ_Êow_uni⁄
 {

427 
ëhtoﬁ_t˝ù4_•ec
 
	mt˝_ù4_•ec
;

428 
ëhtoﬁ_t˝ù4_•ec
 
	mudp_ù4_•ec
;

429 
ëhtoﬁ_t˝ù4_•ec
 
	ms˘p_ù4_•ec
;

430 
ëhtoﬁ_ah_e•ù4_•ec
 
	mah_ù4_•ec
;

431 
ëhtoﬁ_ah_e•ù4_•ec
 
	me•_ù4_•ec
;

432 
ëhtoﬁ_u§ù4_•ec
 
	mu§_ù4_•ec
;

433 
ëhhdr
 
	mëhî_•ec
;

434 
__u8
 
	mhd©a
[60];

437 
	sëhtoﬁ_Êow_ext
 {

438 
__be16
 
	mvœn_ëy≥
;

439 
__be16
 
	mvœn_tci
;

440 
__be32
 
	md©a
[2];

456 
	sëhtoﬁ_rx_Êow_•ec
 {

457 
__u32
 
	mÊow_ty≥
;

458 
ëhtoﬁ_Êow_uni⁄
 
	mh_u
;

459 
ëhtoﬁ_Êow_ext
 
	mh_ext
;

460 
ëhtoﬁ_Êow_uni⁄
 
	mm_u
;

461 
ëhtoﬁ_Êow_ext
 
	mm_ext
;

462 
__u64
 
	mrög_cookõ
;

463 
__u32
 
	mloˇti⁄
;

505 
	sëhtoﬁ_rxnfc
 {

506 
__u32
 
	mcmd
;

507 
__u32
 
	mÊow_ty≥
;

508 
__u64
 
	md©a
;

509 
ëhtoﬁ_rx_Êow_•ec
 
	mfs
;

510 
__u32
 
	mruÀ_˙t
;

511 
__u32
 
	mruÀ_locs
[0];

522 
	sëhtoﬁ_rxfh_ödú
 {

523 
__u32
 
	mcmd
;

524 
__u32
 
	msize
;

525 
__u32
 
	mrög_ödex
[0];

544 
	sëhtoﬁ_rx_¡u∂e_Êow_•ec
 {

545 
__u32
 
	mÊow_ty≥
;

547 
ëhtoﬁ_t˝ù4_•ec
 
	mt˝_ù4_•ec
;

548 
ëhtoﬁ_t˝ù4_•ec
 
	mudp_ù4_•ec
;

549 
ëhtoﬁ_t˝ù4_•ec
 
	ms˘p_ù4_•ec
;

550 
ëhtoﬁ_ah_e•ù4_•ec
 
	mah_ù4_•ec
;

551 
ëhtoﬁ_ah_e•ù4_•ec
 
	me•_ù4_•ec
;

552 
ëhtoﬁ_u§ù4_•ec
 
	mu§_ù4_•ec
;

553 
ëhhdr
 
	mëhî_•ec
;

554 
__u8
 
	mhd©a
[72];

555 } 
	mh_u
, 
	mm_u
;

557 
__u16
 
	mvœn_èg
;

558 
__u16
 
	mvœn_èg_mask
;

559 
__u64
 
	md©a
;

560 
__u64
 
	md©a_mask
;

562 
__s32
 
	ma˘i⁄
;

563 
	#ETHTOOL_RXNTUPLE_ACTION_DROP
 (-1Ë

	)

564 
	#ETHTOOL_RXNTUPLE_ACTION_CLEAR
 (-2Ë

	)

572 
	sëhtoﬁ_rx_¡u∂e
 {

573 
__u32
 
	mcmd
;

574 
ëhtoﬁ_rx_¡u∂e_Êow_•ec
 
	mfs
;

577 
	#ETHTOOL_FLASH_MAX_FILENAME
 128

	)

578 
	eëhtoﬁ_Êash_›_ty≥
 {

579 
	mETHTOOL_FLASH_ALL_REGIONS
 = 0,

583 
	sëhtoﬁ_Êash
 {

584 
__u32
 
	mcmd
;

585 
__u32
 
	mªgi⁄
;

586 
	md©a
[
ETHTOOL_FLASH_MAX_FILENAME
];

601 
	sëhtoﬁ_dump
 {

602 
__u32
 
	mcmd
;

603 
__u32
 
	mvîsi⁄
;

604 
__u32
 
	mÊag
;

605 
__u32
 
	mÀn
;

606 
__u8
 
	md©a
[0];

618 
	sëhtoﬁ_gë_„©uªs_block
 {

619 
__u32
 
	mavaûabÀ
;

620 
__u32
 
	mªque°ed
;

621 
__u32
 
	ma˘ive
;

622 
__u32
 
	m√vî_ch™ged
;

632 
	sëhtoﬁ_g„©uªs
 {

633 
__u32
 
	mcmd
;

634 
__u32
 
	msize
;

635 
ëhtoﬁ_gë_„©uªs_block
 
	m„©uªs
[0];

643 
	sëhtoﬁ_£t_„©uªs_block
 {

644 
__u32
 
	mvÆid
;

645 
__u32
 
	mªque°ed
;

654 
	sëhtoﬁ_s„©uªs
 {

655 
__u32
 
	mcmd
;

656 
__u32
 
	msize
;

657 
ëhtoﬁ_£t_„©uªs_block
 
	m„©uªs
[0];

685 
	eëhtoﬁ_s„©uªs_ªtvÆ_bôs
 {

686 
	mETHTOOL_F_UNSUPPORTED__BIT
,

687 
	mETHTOOL_F_WISH__BIT
,

688 
	mETHTOOL_F_COMPAT__BIT
,

691 
	#ETHTOOL_F_UNSUPPORTED
 (1 << 
ETHTOOL_F_UNSUPPORTED__BIT
)

	)

692 
	#ETHTOOL_F_WISH
 (1 << 
ETHTOOL_F_WISH__BIT
)

	)

693 
	#ETHTOOL_F_COMPAT
 (1 << 
ETHTOOL_F_COMPAT__BIT
)

	)

697 
	#ETHTOOL_GSET
 0x00000001

	)

698 
	#ETHTOOL_SSET
 0x00000002

	)

699 
	#ETHTOOL_GDRVINFO
 0x00000003

	)

700 
	#ETHTOOL_GREGS
 0x00000004

	)

701 
	#ETHTOOL_GWOL
 0x00000005

	)

702 
	#ETHTOOL_SWOL
 0x00000006

	)

703 
	#ETHTOOL_GMSGLVL
 0x00000007

	)

704 
	#ETHTOOL_SMSGLVL
 0x00000008

	)

705 
	#ETHTOOL_NWAY_RST
 0x00000009

	)

708 
	#ETHTOOL_GLINK
 0x0000000a

	)

709 
	#ETHTOOL_GEEPROM
 0x0000000b

	)

710 
	#ETHTOOL_SEEPROM
 0x0000000¯

	)

711 
	#ETHTOOL_GCOALESCE
 0x0000000ê

	)

712 
	#ETHTOOL_SCOALESCE
 0x0000000‡

	)

713 
	#ETHTOOL_GRINGPARAM
 0x00000010

	)

714 
	#ETHTOOL_SRINGPARAM
 0x00000011

	)

715 
	#ETHTOOL_GPAUSEPARAM
 0x00000012

	)

716 
	#ETHTOOL_SPAUSEPARAM
 0x00000013

	)

717 
	#ETHTOOL_GRXCSUM
 0x00000014

	)

718 
	#ETHTOOL_SRXCSUM
 0x00000015

	)

719 
	#ETHTOOL_GTXCSUM
 0x00000016

	)

720 
	#ETHTOOL_STXCSUM
 0x00000017

	)

721 
	#ETHTOOL_GSG
 0x00000018

	)

723 
	#ETHTOOL_SSG
 0x00000019

	)

725 
	#ETHTOOL_TEST
 0x0000001®

	)

726 
	#ETHTOOL_GSTRINGS
 0x0000001b

	)

727 
	#ETHTOOL_PHYS_ID
 0x0000001¯

	)

728 
	#ETHTOOL_GSTATS
 0x0000001d

	)

729 
	#ETHTOOL_GTSO
 0x0000001ê

	)

730 
	#ETHTOOL_STSO
 0x0000001‡

	)

731 
	#ETHTOOL_GPERMADDR
 0x00000020

	)

732 
	#ETHTOOL_GUFO
 0x00000021

	)

733 
	#ETHTOOL_SUFO
 0x00000022

	)

734 
	#ETHTOOL_GGSO
 0x00000023

	)

735 
	#ETHTOOL_SGSO
 0x00000024

	)

736 
	#ETHTOOL_GFLAGS
 0x00000025

	)

737 
	#ETHTOOL_SFLAGS
 0x00000026

	)

738 
	#ETHTOOL_GPFLAGS
 0x00000027

	)

739 
	#ETHTOOL_SPFLAGS
 0x00000028

	)

741 
	#ETHTOOL_GRXFH
 0x00000029

	)

742 
	#ETHTOOL_SRXFH
 0x0000002®

	)

743 
	#ETHTOOL_GGRO
 0x0000002b

	)

744 
	#ETHTOOL_SGRO
 0x0000002¯

	)

745 
	#ETHTOOL_GRXRINGS
 0x0000002d

	)

746 
	#ETHTOOL_GRXCLSRLCNT
 0x0000002ê

	)

747 
	#ETHTOOL_GRXCLSRULE
 0x0000002‡

	)

748 
	#ETHTOOL_GRXCLSRLALL
 0x00000030

	)

749 
	#ETHTOOL_SRXCLSRLDEL
 0x00000031

	)

750 
	#ETHTOOL_SRXCLSRLINS
 0x00000032

	)

751 
	#ETHTOOL_FLASHDEV
 0x00000033

	)

752 
	#ETHTOOL_RESET
 0x00000034

	)

753 
	#ETHTOOL_SRXNTUPLE
 0x00000035

	)

754 
	#ETHTOOL_GRXNTUPLE
 0x00000036

	)

755 
	#ETHTOOL_GSSET_INFO
 0x00000037

	)

756 
	#ETHTOOL_GRXFHINDIR
 0x00000038

	)

757 
	#ETHTOOL_SRXFHINDIR
 0x00000039

	)

759 
	#ETHTOOL_GFEATURES
 0x0000003®

	)

760 
	#ETHTOOL_SFEATURES
 0x0000003b

	)

761 
	#ETHTOOL_GCHANNELS
 0x0000003¯

	)

762 
	#ETHTOOL_SCHANNELS
 0x0000003d

	)

763 
	#ETHTOOL_SET_DUMP
 0x0000003ê

	)

764 
	#ETHTOOL_GET_DUMP_FLAG
 0x0000003‡

	)

765 
	#ETHTOOL_GET_DUMP_DATA
 0x00000040

	)

768 
	#SPARC_ETH_GSET
 
ETHTOOL_GSET


	)

769 
	#SPARC_ETH_SSET
 
ETHTOOL_SSET


	)

772 
	#SUPPORTED_10ba£T_HÆf
 (1 << 0)

	)

773 
	#SUPPORTED_10ba£T_FuŒ
 (1 << 1)

	)

774 
	#SUPPORTED_100ba£T_HÆf
 (1 << 2)

	)

775 
	#SUPPORTED_100ba£T_FuŒ
 (1 << 3)

	)

776 
	#SUPPORTED_1000ba£T_HÆf
 (1 << 4)

	)

777 
	#SUPPORTED_1000ba£T_FuŒ
 (1 << 5)

	)

778 
	#SUPPORTED_Aut⁄eg
 (1 << 6)

	)

779 
	#SUPPORTED_TP
 (1 << 7)

	)

780 
	#SUPPORTED_AUI
 (1 << 8)

	)

781 
	#SUPPORTED_MII
 (1 << 9)

	)

782 
	#SUPPORTED_FIBRE
 (1 << 10)

	)

783 
	#SUPPORTED_BNC
 (1 << 11)

	)

784 
	#SUPPORTED_10000ba£T_FuŒ
 (1 << 12)

	)

785 
	#SUPPORTED_Pau£
 (1 << 13)

	)

786 
	#SUPPORTED_Asym_Pau£
 (1 << 14)

	)

787 
	#SUPPORTED_2500ba£X_FuŒ
 (1 << 15)

	)

788 
	#SUPPORTED_Back∂™e
 (1 << 16)

	)

789 
	#SUPPORTED_1000ba£KX_FuŒ
 (1 << 17)

	)

790 
	#SUPPORTED_10000ba£KX4_FuŒ
 (1 << 18)

	)

791 
	#SUPPORTED_10000ba£KR_FuŒ
 (1 << 19)

	)

792 
	#SUPPORTED_10000ba£R_FEC
 (1 << 20)

	)

793 
	#SUPPORTED_20000ba£MLD2_FuŒ
 (1 << 21)

	)

794 
	#SUPPORTED_20000ba£KR2_FuŒ
 (1 << 22)

	)

797 
	#ADVERTISED_10ba£T_HÆf
 (1 << 0)

	)

798 
	#ADVERTISED_10ba£T_FuŒ
 (1 << 1)

	)

799 
	#ADVERTISED_100ba£T_HÆf
 (1 << 2)

	)

800 
	#ADVERTISED_100ba£T_FuŒ
 (1 << 3)

	)

801 
	#ADVERTISED_1000ba£T_HÆf
 (1 << 4)

	)

802 
	#ADVERTISED_1000ba£T_FuŒ
 (1 << 5)

	)

803 
	#ADVERTISED_Aut⁄eg
 (1 << 6)

	)

804 
	#ADVERTISED_TP
 (1 << 7)

	)

805 
	#ADVERTISED_AUI
 (1 << 8)

	)

806 
	#ADVERTISED_MII
 (1 << 9)

	)

807 
	#ADVERTISED_FIBRE
 (1 << 10)

	)

808 
	#ADVERTISED_BNC
 (1 << 11)

	)

809 
	#ADVERTISED_10000ba£T_FuŒ
 (1 << 12)

	)

810 
	#ADVERTISED_Pau£
 (1 << 13)

	)

811 
	#ADVERTISED_Asym_Pau£
 (1 << 14)

	)

812 
	#ADVERTISED_2500ba£X_FuŒ
 (1 << 15)

	)

813 
	#ADVERTISED_Back∂™e
 (1 << 16)

	)

814 
	#ADVERTISED_1000ba£KX_FuŒ
 (1 << 17)

	)

815 
	#ADVERTISED_10000ba£KX4_FuŒ
 (1 << 18)

	)

816 
	#ADVERTISED_10000ba£KR_FuŒ
 (1 << 19)

	)

817 
	#ADVERTISED_10000ba£R_FEC
 (1 << 20)

	)

818 
	#ADVERTISED_20000ba£MLD2_FuŒ
 (1 << 21)

	)

819 
	#ADVERTISED_20000ba£KR2_FuŒ
 (1 << 22)

	)

828 
	#SPEED_10
 10

	)

829 
	#SPEED_100
 100

	)

830 
	#SPEED_1000
 1000

	)

831 
	#SPEED_2500
 2500

	)

832 
	#SPEED_10000
 10000

	)

835 
	#DUPLEX_HALF
 0x00

	)

836 
	#DUPLEX_FULL
 0x01

	)

839 
	#PORT_TP
 0x00

	)

840 
	#PORT_AUI
 0x01

	)

841 
	#PORT_MII
 0x02

	)

842 
	#PORT_FIBRE
 0x03

	)

843 
	#PORT_BNC
 0x04

	)

844 
	#PORT_DA
 0x05

	)

845 
	#PORT_NONE
 0xef

	)

846 
	#PORT_OTHER
 0xff

	)

849 
	#XCVR_INTERNAL
 0x00

	)

850 
	#XCVR_EXTERNAL
 0x01

	)

851 
	#XCVR_DUMMY1
 0x02

	)

852 
	#XCVR_DUMMY2
 0x03

	)

853 
	#XCVR_DUMMY3
 0x04

	)

858 
	#AUTONEG_DISABLE
 0x00

	)

859 
	#AUTONEG_ENABLE
 0x01

	)

862 
	#ETH_TP_MDI_INVALID
 0x00

	)

863 
	#ETH_TP_MDI
 0x01

	)

864 
	#ETH_TP_MDI_X
 0x02

	)

867 
	#WAKE_PHY
 (1 << 0)

	)

868 
	#WAKE_UCAST
 (1 << 1)

	)

869 
	#WAKE_MCAST
 (1 << 2)

	)

870 
	#WAKE_BCAST
 (1 << 3)

	)

871 
	#WAKE_ARP
 (1 << 4)

	)

872 
	#WAKE_MAGIC
 (1 << 5)

	)

873 
	#WAKE_MAGICSECURE
 (1 << 6Ë

	)

876 
	#TCP_V4_FLOW
 0x01

	)

877 
	#UDP_V4_FLOW
 0x02

	)

878 
	#SCTP_V4_FLOW
 0x03

	)

879 
	#AH_ESP_V4_FLOW
 0x04

	)

880 
	#TCP_V6_FLOW
 0x05

	)

881 
	#UDP_V6_FLOW
 0x06

	)

882 
	#SCTP_V6_FLOW
 0x07

	)

883 
	#AH_ESP_V6_FLOW
 0x08

	)

884 
	#AH_V4_FLOW
 0x09

	)

885 
	#ESP_V4_FLOW
 0x0®

	)

886 
	#AH_V6_FLOW
 0x0b

	)

887 
	#ESP_V6_FLOW
 0x0¯

	)

888 
	#IP_USER_FLOW
 0x0d

	)

889 
	#IPV4_FLOW
 0x10

	)

890 
	#IPV6_FLOW
 0x11

	)

891 
	#ETHER_FLOW
 0x12

	)

893 
	#FLOW_EXT
 0x80000000

	)

896 
	#RXH_L2DA
 (1 << 1)

	)

897 
	#RXH_VLAN
 (1 << 2)

	)

898 
	#RXH_L3_PROTO
 (1 << 3)

	)

899 
	#RXH_IP_SRC
 (1 << 4)

	)

900 
	#RXH_IP_DST
 (1 << 5)

	)

901 
	#RXH_L4_B_0_1
 (1 << 6Ë

	)

902 
	#RXH_L4_B_2_3
 (1 << 7Ë

	)

903 
	#RXH_DISCARD
 (1 << 31)

	)

905 
	#RX_CLS_FLOW_DISC
 0xffffffffffffffffULL

	)

914 
	eëhtoﬁ_ª£t_Êags
 {

920 
	mETH_RESET_MGMT
 = 1 << 0,

921 
	mETH_RESET_IRQ
 = 1 << 1,

922 
	mETH_RESET_DMA
 = 1 << 2,

923 
	mETH_RESET_FILTER
 = 1 << 3,

924 
	mETH_RESET_OFFLOAD
 = 1 << 4,

925 
	mETH_RESET_MAC
 = 1 << 5,

926 
	mETH_RESET_PHY
 = 1 << 6,

927 
	mETH_RESET_RAM
 = 1 << 7,

930 
	mETH_RESET_DEDICATED
 = 0x0000ffff,

932 
	mETH_RESET_ALL
 = 0xffffffff,

935 
	#ETH_RESET_SHARED_SHIFT
 16

	)

	@/usr/include/linux/if.h

19 #i‚de‡
_LINUX_IF_H


20 
	#_LINUX_IF_H


	)

22 
	~<löux/ty≥s.h
>

23 
	~<löux/sockë.h
>

26 
	#IFNAMSIZ
 16

	)

27 
	#IFALIASZ
 256

	)

28 
	~<löux/hdlc/io˘l.h
>

31 
	#IFF_UP
 0x1

	)

32 
	#IFF_BROADCAST
 0x2

	)

33 
	#IFF_DEBUG
 0x4

	)

34 
	#IFF_LOOPBACK
 0x8

	)

35 
	#IFF_POINTOPOINT
 0x10

	)

36 
	#IFF_NOTRAILERS
 0x20

	)

37 
	#IFF_RUNNING
 0x40

	)

38 
	#IFF_NOARP
 0x80

	)

39 
	#IFF_PROMISC
 0x100

	)

40 
	#IFF_ALLMULTI
 0x200

	)

42 
	#IFF_MASTER
 0x400

	)

43 
	#IFF_SLAVE
 0x800

	)

45 
	#IFF_MULTICAST
 0x1000

	)

47 
	#IFF_PORTSEL
 0x2000

	)

48 
	#IFF_AUTOMEDIA
 0x4000

	)

49 
	#IFF_DYNAMIC
 0x8000

	)

51 
	#IFF_LOWER_UP
 0x10000

	)

52 
	#IFF_DORMANT
 0x20000

	)

54 
	#IFF_ECHO
 0x40000

	)

56 
	#IFF_VOLATILE
 (
IFF_LOOPBACK
|
IFF_POINTOPOINT
|
IFF_BROADCAST
|
IFF_ECHO
|\

57 
IFF_MASTER
|
IFF_SLAVE
|
IFF_RUNNING
|
IFF_LOWER_UP
|
IFF_DORMANT
)

	)

60 
	#IFF_802_1Q_VLAN
 0x1

	)

61 
	#IFF_EBRIDGE
 0x2

	)

62 
	#IFF_SLAVE_INACTIVE
 0x4

	)

63 
	#IFF_MASTER_8023AD
 0x8

	)

64 
	#IFF_MASTER_ALB
 0x10

	)

65 
	#IFF_BONDING
 0x20

	)

66 
	#IFF_SLAVE_NEEDARP
 0x40

	)

67 
	#IFF_ISATAP
 0x80

	)

68 
	#IFF_MASTER_ARPMON
 0x100

	)

69 
	#IFF_WAN_HDLC
 0x200

	)

70 
	#IFF_XMIT_DST_RELEASE
 0x400

	)

73 
	#IFF_DONT_BRIDGE
 0x800

	)

74 
	#IFF_DISABLE_NETPOLL
 0x1000

	)

75 
	#IFF_MACVLAN_PORT
 0x2000

	)

76 
	#IFF_BRIDGE_PORT
 0x4000

	)

77 
	#IFF_OVS_DATAPATH
 0x8000

	)

79 
	#IFF_TX_SKB_SHARING
 0x10000

	)

82 
	#IF_GET_IFACE
 0x0001

	)

83 
	#IF_GET_PROTO
 0x0002

	)

86 
	#IF_IFACE_V35
 0x1000

	)

87 
	#IF_IFACE_V24
 0x1001

	)

88 
	#IF_IFACE_X21
 0x1002

	)

89 
	#IF_IFACE_T1
 0x1003

	)

90 
	#IF_IFACE_E1
 0x1004

	)

91 
	#IF_IFACE_SYNC_SERIAL
 0x1005

	)

92 
	#IF_IFACE_X21D
 0x1006

	)

95 
	#IF_PROTO_HDLC
 0x2000

	)

96 
	#IF_PROTO_PPP
 0x2001

	)

97 
	#IF_PROTO_CISCO
 0x2002

	)

98 
	#IF_PROTO_FR
 0x2003

	)

99 
	#IF_PROTO_FR_ADD_PVC
 0x2004

	)

100 
	#IF_PROTO_FR_DEL_PVC
 0x2005

	)

101 
	#IF_PROTO_X25
 0x2006

	)

102 
	#IF_PROTO_HDLC_ETH
 0x2007

	)

103 
	#IF_PROTO_FR_ADD_ETH_PVC
 0x2008

	)

104 
	#IF_PROTO_FR_DEL_ETH_PVC
 0x2009

	)

105 
	#IF_PROTO_FR_PVC
 0x200A

	)

106 
	#IF_PROTO_FR_ETH_PVC
 0x200B

	)

107 
	#IF_PROTO_RAW
 0x200C

	)

111 
	mIF_OPER_UNKNOWN
,

112 
	mIF_OPER_NOTPRESENT
,

113 
	mIF_OPER_DOWN
,

114 
	mIF_OPER_LOWERLAYERDOWN
,

115 
	mIF_OPER_TESTING
,

116 
	mIF_OPER_DORMANT
,

117 
	mIF_OPER_UP
,

122 
	mIF_LINK_MODE_DEFAULT
,

123 
	mIF_LINK_MODE_DORMANT
,

136 
	sifm≠
 {

137 
	mmem_°¨t
;

138 
	mmem_íd
;

139 
	mba£_addr
;

140 
	múq
;

141 
	mdma
;

142 
	mp‹t
;

146 
	sif_£âögs
 {

147 
	mty≥
;

148 
	msize
;

151 
øw_hdlc_¥Ÿo
 *
	møw_hdlc
;

152 
cisco_¥Ÿo
 *
	mcisco
;

153 
‰_¥Ÿo
 *
	m‰
;

154 
‰_¥Ÿo_pvc
 *
	m‰_pvc
;

155 
‰_¥Ÿo_pvc_öfo
 *
	m‰_pvc_öfo
;

158 
sync_£rül_£âögs
 *
	msync
;

159 
ã1_£âögs
 *
	mã1
;

160 } 
	mifs_ifsu
;

170 
	si‰eq
 {

171 
	#IFHWADDRLEN
 6

	)

174 
	mi‰n_«me
[
IFNAMSIZ
];

175 } 
	mi‰_i‰n
;

178 
sockaddr
 
	mi‰u_addr
;

179 
sockaddr
 
	mi‰u_d°addr
;

180 
sockaddr
 
	mi‰u_brﬂdaddr
;

181 
sockaddr
 
	mi‰u_√tmask
;

182 
sockaddr
 
	mi‰u_hwaddr
;

183 
	mi‰u_Êags
;

184 
	mi‰u_ivÆue
;

185 
	mi‰u_mtu
;

186 
ifm≠
 
	mi‰u_m≠
;

187 
	mi‰u_¶ave
[
IFNAMSIZ
];

188 
	mi‰u_√w«me
[
IFNAMSIZ
];

189 * 
	mi‰u_d©a
;

190 
if_£âögs
 
	mi‰u_£âögs
;

191 } 
	mi‰_i‰u
;

194 
	#i‰_«me
 
i‰_i‰n
.
i‰n_«me


	)

195 
	#i‰_hwaddr
 
i‰_i‰u
.
i‰u_hwaddr


	)

196 
	#i‰_addr
 
i‰_i‰u
.
i‰u_addr


	)

197 
	#i‰_d°addr
 
i‰_i‰u
.
i‰u_d°addr


	)

198 
	#i‰_brﬂdaddr
 
i‰_i‰u
.
i‰u_brﬂdaddr


	)

199 
	#i‰_√tmask
 
i‰_i‰u
.
i‰u_√tmask


	)

200 
	#i‰_Êags
 
i‰_i‰u
.
i‰u_Êags


	)

201 
	#i‰_mëric
 
i‰_i‰u
.
i‰u_ivÆue


	)

202 
	#i‰_mtu
 
i‰_i‰u
.
i‰u_mtu


	)

203 
	#i‰_m≠
 
i‰_i‰u
.
i‰u_m≠


	)

204 
	#i‰_¶ave
 
i‰_i‰u
.
i‰u_¶ave


	)

205 
	#i‰_d©a
 
i‰_i‰u
.
i‰u_d©a


	)

206 
	#i‰_ifödex
 
i‰_i‰u
.
i‰u_ivÆue


	)

207 
	#i‰_b™dwidth
 
i‰_i‰u
.
i‰u_ivÆue


	)

208 
	#i‰_qÀn
 
i‰_i‰u
.
i‰u_ivÆue


	)

209 
	#i‰_√w«me
 
i‰_i‰u
.
i‰u_√w«me


	)

210 
	#i‰_£âögs
 
i‰_i‰u
.
i‰u_£âögs


	)

219 
	sifc⁄f
 {

220 
	mifc_Àn
;

222 *
	mifcu_buf
;

223 
i‰eq
 *
	mifcu_ªq
;

224 } 
	mifc_ifcu
;

226 
	#ifc_buf
 
ifc_ifcu
.
ifcu_buf


	)

227 
	#ifc_ªq
 
ifc_ifcu
.
ifcu_ªq


	)

	@/usr/include/linux/if_ether.h

21 #i‚de‡
_LINUX_IF_ETHER_H


22 
	#_LINUX_IF_ETHER_H


	)

24 
	~<löux/ty≥s.h
>

31 
	#ETH_ALEN
 6

	)

32 
	#ETH_HLEN
 14

	)

33 
	#ETH_ZLEN
 60

	)

34 
	#ETH_DATA_LEN
 1500

	)

35 
	#ETH_FRAME_LEN
 1514

	)

36 
	#ETH_FCS_LEN
 4

	)

42 
	#ETH_P_LOOP
 0x0060

	)

43 
	#ETH_P_PUP
 0x0200

	)

44 
	#ETH_P_PUPAT
 0x0201

	)

45 
	#ETH_P_IP
 0x0800

	)

46 
	#ETH_P_X25
 0x0805

	)

47 
	#ETH_P_ARP
 0x0806

	)

48 
	#ETH_P_BPQ
 0x08FF

	)

49 
	#ETH_P_IEEEPUP
 0x0a00

	)

50 
	#ETH_P_IEEEPUPAT
 0x0a01

	)

51 
	#ETH_P_DEC
 0x6000

	)

52 
	#ETH_P_DNA_DL
 0x6001

	)

53 
	#ETH_P_DNA_RC
 0x6002

	)

54 
	#ETH_P_DNA_RT
 0x6003

	)

55 
	#ETH_P_LAT
 0x6004

	)

56 
	#ETH_P_DIAG
 0x6005

	)

57 
	#ETH_P_CUST
 0x6006

	)

58 
	#ETH_P_SCA
 0x6007

	)

59 
	#ETH_P_TEB
 0x6558

	)

60 
	#ETH_P_RARP
 0x8035

	)

61 
	#ETH_P_ATALK
 0x809B

	)

62 
	#ETH_P_AARP
 0x80F3

	)

63 
	#ETH_P_8021Q
 0x8100

	)

64 
	#ETH_P_IPX
 0x8137

	)

65 
	#ETH_P_IPV6
 0x86DD

	)

66 
	#ETH_P_PAUSE
 0x8808

	)

67 
	#ETH_P_SLOW
 0x8809

	)

68 
	#ETH_P_WCCP
 0x883E

	)

70 
	#ETH_P_PPP_DISC
 0x8863

	)

71 
	#ETH_P_PPP_SES
 0x8864

	)

72 
	#ETH_P_MPLS_UC
 0x8847

	)

73 
	#ETH_P_MPLS_MC
 0x8848

	)

74 
	#ETH_P_ATMMPOA
 0x884¯

	)

75 
	#ETH_P_LINK_CTL
 0x886¯

	)

76 
	#ETH_P_ATMFATE
 0x8884

	)

79 
	#ETH_P_PAE
 0x888E

	)

80 
	#ETH_P_AOE
 0x88A2

	)

81 
	#ETH_P_8021AD
 0x88A8

	)

82 
	#ETH_P_TIPC
 0x88CA

	)

83 
	#ETH_P_8021AH
 0x88E7

	)

84 
	#ETH_P_1588
 0x88F7

	)

85 
	#ETH_P_FCOE
 0x8906

	)

86 
	#ETH_P_FIP
 0x8914

	)

87 
	#ETH_P_QINQ1
 0x9100

	)

88 
	#ETH_P_QINQ2
 0x9200

	)

89 
	#ETH_P_QINQ3
 0x9300

	)

90 
	#ETH_P_EDSA
 0xDADA

	)

96 
	#ETH_P_802_3
 0x0001

	)

97 
	#ETH_P_AX25
 0x0002

	)

98 
	#ETH_P_ALL
 0x0003

	)

99 
	#ETH_P_802_2
 0x0004

	)

100 
	#ETH_P_SNAP
 0x0005

	)

101 
	#ETH_P_DDCMP
 0x0006

	)

102 
	#ETH_P_WAN_PPP
 0x0007

	)

103 
	#ETH_P_PPP_MP
 0x0008

	)

104 
	#ETH_P_LOCALTALK
 0x0009

	)

105 
	#ETH_P_CAN
 0x000C

	)

106 
	#ETH_P_PPPTALK
 0x0010

	)

107 
	#ETH_P_TR_802_2
 0x0011

	)

108 
	#ETH_P_MOBITEX
 0x0015

	)

109 
	#ETH_P_CONTROL
 0x0016

	)

110 
	#ETH_P_IRDA
 0x0017

	)

111 
	#ETH_P_ECONET
 0x0018

	)

112 
	#ETH_P_HDLC
 0x0019

	)

113 
	#ETH_P_ARCNET
 0x001A

	)

114 
	#ETH_P_DSA
 0x001B

	)

115 
	#ETH_P_TRAILER
 0x001C

	)

116 
	#ETH_P_PHONET
 0x00F5

	)

117 
	#ETH_P_IEEE802154
 0x00F6

	)

118 
	#ETH_P_CAIF
 0x00F7

	)

124 
	sëhhdr
 {

125 
	mh_de°
[
ETH_ALEN
];

126 
	mh_sour˚
[
ETH_ALEN
];

127 
__be16
 
	mh_¥Ÿo
;

128 } 
__©åibuã__
((
∑cked
));

	@/usr/include/linux/kernel.h

1 #i‚de‡
_LINUX_KERNEL_H


2 
	#_LINUX_KERNEL_H


	)

7 
	#__ALIGN_KERNEL
(
x
, 
a
Ë
	`__ALIGN_KERNEL_MASK
(x, (
	`ty≥of
(x))◊Ë- 1)

	)

8 
	#__ALIGN_KERNEL_MASK
(
x
, 
mask
Ë(((xË+ (mask)Ë& ~(mask))

	)

11 
	#SI_LOAD_SHIFT
 16

	)

12 
	ssysöfo
 {

13 
	mu±ime
;

14 
	mlﬂds
[3];

15 
	mtŸÆøm
;

16 
	m‰ìøm
;

17 
	msh¨edøm
;

18 
	mbuf„ºam
;

19 
	mtŸÆsw≠
;

20 
	m‰ìsw≠
;

21 
	m¥ocs
;

22 
	m∑d
;

23 
	mtŸÆhigh
;

24 
	m‰ìhigh
;

25 
	mmem_unô
;

26 
	m_f
[20-2*()-()];

	@/usr/include/linux/netdevice.h

25 #i‚de‡
_LINUX_NETDEVICE_H


26 
	#_LINUX_NETDEVICE_H


	)

28 
	~<löux/if.h
>

29 
	~<löux/if_ëhî.h
>

30 
	~<löux/if_∑ckë.h
>

31 
	~<löux/if_lök.h
>

34 
	#MAX_ADDR_LEN
 32

	)

37 
	#INIT_NETDEV_GROUP
 0

	)

43 
	mIF_PORT_UNKNOWN
 = 0,

44 
	mIF_PORT_10BASE2
,

45 
	mIF_PORT_10BASET
,

46 
	mIF_PORT_AUI
,

47 
	mIF_PORT_100BASET
,

48 
	mIF_PORT_100BASETX
,

49 
	mIF_PORT_100BASEFX


	@/usr/include/linux/nl80211.h

1 #i‚de‡
__LINUX_NL80211_H


2 
	#__LINUX_NL80211_H


	)

28 
	~<löux/ty≥s.h
>

498 
	e∆80211_comm™ds
 {

500 
	mNL80211_CMD_UNSPEC
,

502 
	mNL80211_CMD_GET_WIPHY
,

503 
	mNL80211_CMD_SET_WIPHY
,

504 
	mNL80211_CMD_NEW_WIPHY
,

505 
	mNL80211_CMD_DEL_WIPHY
,

507 
	mNL80211_CMD_GET_INTERFACE
,

508 
	mNL80211_CMD_SET_INTERFACE
,

509 
	mNL80211_CMD_NEW_INTERFACE
,

510 
	mNL80211_CMD_DEL_INTERFACE
,

512 
	mNL80211_CMD_GET_KEY
,

513 
	mNL80211_CMD_SET_KEY
,

514 
	mNL80211_CMD_NEW_KEY
,

515 
	mNL80211_CMD_DEL_KEY
,

517 
	mNL80211_CMD_GET_BEACON
,

518 
	mNL80211_CMD_SET_BEACON
,

519 
	mNL80211_CMD_NEW_BEACON
,

520 
	mNL80211_CMD_DEL_BEACON
,

522 
	mNL80211_CMD_GET_STATION
,

523 
	mNL80211_CMD_SET_STATION
,

524 
	mNL80211_CMD_NEW_STATION
,

525 
	mNL80211_CMD_DEL_STATION
,

527 
	mNL80211_CMD_GET_MPATH
,

528 
	mNL80211_CMD_SET_MPATH
,

529 
	mNL80211_CMD_NEW_MPATH
,

530 
	mNL80211_CMD_DEL_MPATH
,

532 
	mNL80211_CMD_SET_BSS
,

534 
	mNL80211_CMD_SET_REG
,

535 
	mNL80211_CMD_REQ_SET_REG
,

537 
	mNL80211_CMD_GET_MESH_CONFIG
,

538 
	mNL80211_CMD_SET_MESH_CONFIG
,

540 
	mNL80211_CMD_SET_MGMT_EXTRA_IE
 ,

542 
	mNL80211_CMD_GET_REG
,

544 
	mNL80211_CMD_GET_SCAN
,

545 
	mNL80211_CMD_TRIGGER_SCAN
,

546 
	mNL80211_CMD_NEW_SCAN_RESULTS
,

547 
	mNL80211_CMD_SCAN_ABORTED
,

549 
	mNL80211_CMD_REG_CHANGE
,

551 
	mNL80211_CMD_AUTHENTICATE
,

552 
	mNL80211_CMD_ASSOCIATE
,

553 
	mNL80211_CMD_DEAUTHENTICATE
,

554 
	mNL80211_CMD_DISASSOCIATE
,

556 
	mNL80211_CMD_MICHAEL_MIC_FAILURE
,

558 
	mNL80211_CMD_REG_BEACON_HINT
,

560 
	mNL80211_CMD_JOIN_IBSS
,

561 
	mNL80211_CMD_LEAVE_IBSS
,

563 
	mNL80211_CMD_TESTMODE
,

565 
	mNL80211_CMD_CONNECT
,

566 
	mNL80211_CMD_ROAM
,

567 
	mNL80211_CMD_DISCONNECT
,

569 
	mNL80211_CMD_SET_WIPHY_NETNS
,

571 
	mNL80211_CMD_GET_SURVEY
,

572 
	mNL80211_CMD_NEW_SURVEY_RESULTS
,

574 
	mNL80211_CMD_SET_PMKSA
,

575 
	mNL80211_CMD_DEL_PMKSA
,

576 
	mNL80211_CMD_FLUSH_PMKSA
,

578 
	mNL80211_CMD_REMAIN_ON_CHANNEL
,

579 
	mNL80211_CMD_CANCEL_REMAIN_ON_CHANNEL
,

581 
	mNL80211_CMD_SET_TX_BITRATE_MASK
,

583 
	mNL80211_CMD_REGISTER_FRAME
,

584 
	mNL80211_CMD_REGISTER_ACTION
 = 
NL80211_CMD_REGISTER_FRAME
,

585 
	mNL80211_CMD_FRAME
,

586 
	mNL80211_CMD_ACTION
 = 
NL80211_CMD_FRAME
,

587 
	mNL80211_CMD_FRAME_TX_STATUS
,

588 
	mNL80211_CMD_ACTION_TX_STATUS
 = 
NL80211_CMD_FRAME_TX_STATUS
,

590 
	mNL80211_CMD_SET_POWER_SAVE
,

591 
	mNL80211_CMD_GET_POWER_SAVE
,

593 
	mNL80211_CMD_SET_CQM
,

594 
	mNL80211_CMD_NOTIFY_CQM
,

596 
	mNL80211_CMD_SET_CHANNEL
,

597 
	mNL80211_CMD_SET_WDS_PEER
,

599 
	mNL80211_CMD_FRAME_WAIT_CANCEL
,

601 
	mNL80211_CMD_JOIN_MESH
,

602 
	mNL80211_CMD_LEAVE_MESH
,

604 
	mNL80211_CMD_UNPROT_DEAUTHENTICATE
,

605 
	mNL80211_CMD_UNPROT_DISASSOCIATE
,

607 
	mNL80211_CMD_NEW_PEER_CANDIDATE
,

609 
	mNL80211_CMD_GET_WOWLAN
,

610 
	mNL80211_CMD_SET_WOWLAN
,

612 
	mNL80211_CMD_START_SCHED_SCAN
,

613 
	mNL80211_CMD_STOP_SCHED_SCAN
,

614 
	mNL80211_CMD_SCHED_SCAN_RESULTS
,

615 
	mNL80211_CMD_SCHED_SCAN_STOPPED
,

617 
	mNL80211_CMD_SET_REKEY_OFFLOAD
,

622 
	m__NL80211_CMD_AFTER_LAST
,

623 
	mNL80211_CMD_MAX
 = 
__NL80211_CMD_AFTER_LAST
 - 1

630 
	#NL80211_CMD_SET_BSS
 
NL80211_CMD_SET_BSS


	)

631 
	#NL80211_CMD_SET_MGMT_EXTRA_IE
 
NL80211_CMD_SET_MGMT_EXTRA_IE


	)

632 
	#NL80211_CMD_REG_CHANGE
 
NL80211_CMD_REG_CHANGE


	)

633 
	#NL80211_CMD_AUTHENTICATE
 
NL80211_CMD_AUTHENTICATE


	)

634 
	#NL80211_CMD_ASSOCIATE
 
NL80211_CMD_ASSOCIATE


	)

635 
	#NL80211_CMD_DEAUTHENTICATE
 
NL80211_CMD_DEAUTHENTICATE


	)

636 
	#NL80211_CMD_DISASSOCIATE
 
NL80211_CMD_DISASSOCIATE


	)

637 
	#NL80211_CMD_REG_BEACON_HINT
 
NL80211_CMD_REG_BEACON_HINT


	)

640 
	#NL80211_CMD_GET_MESH_PARAMS
 
NL80211_CMD_GET_MESH_CONFIG


	)

641 
	#NL80211_CMD_SET_MESH_PARAMS
 
NL80211_CMD_SET_MESH_CONFIG


	)

642 
	#NL80211_MESH_SETUP_VENDOR_PATH_SEL_IE
 
NL80211_MESH_SETUP_IE


	)

1025 
	e∆80211_©ås
 {

1027 
	mNL80211_ATTR_UNSPEC
,

1029 
	mNL80211_ATTR_WIPHY
,

1030 
	mNL80211_ATTR_WIPHY_NAME
,

1032 
	mNL80211_ATTR_IFINDEX
,

1033 
	mNL80211_ATTR_IFNAME
,

1034 
	mNL80211_ATTR_IFTYPE
,

1036 
	mNL80211_ATTR_MAC
,

1038 
	mNL80211_ATTR_KEY_DATA
,

1039 
	mNL80211_ATTR_KEY_IDX
,

1040 
	mNL80211_ATTR_KEY_CIPHER
,

1041 
	mNL80211_ATTR_KEY_SEQ
,

1042 
	mNL80211_ATTR_KEY_DEFAULT
,

1044 
	mNL80211_ATTR_BEACON_INTERVAL
,

1045 
	mNL80211_ATTR_DTIM_PERIOD
,

1046 
	mNL80211_ATTR_BEACON_HEAD
,

1047 
	mNL80211_ATTR_BEACON_TAIL
,

1049 
	mNL80211_ATTR_STA_AID
,

1050 
	mNL80211_ATTR_STA_FLAGS
,

1051 
	mNL80211_ATTR_STA_LISTEN_INTERVAL
,

1052 
	mNL80211_ATTR_STA_SUPPORTED_RATES
,

1053 
	mNL80211_ATTR_STA_VLAN
,

1054 
	mNL80211_ATTR_STA_INFO
,

1056 
	mNL80211_ATTR_WIPHY_BANDS
,

1058 
	mNL80211_ATTR_MNTR_FLAGS
,

1060 
	mNL80211_ATTR_MESH_ID
,

1061 
	mNL80211_ATTR_STA_PLINK_ACTION
,

1062 
	mNL80211_ATTR_MPATH_NEXT_HOP
,

1063 
	mNL80211_ATTR_MPATH_INFO
,

1065 
	mNL80211_ATTR_BSS_CTS_PROT
,

1066 
	mNL80211_ATTR_BSS_SHORT_PREAMBLE
,

1067 
	mNL80211_ATTR_BSS_SHORT_SLOT_TIME
,

1069 
	mNL80211_ATTR_HT_CAPABILITY
,

1071 
	mNL80211_ATTR_SUPPORTED_IFTYPES
,

1073 
	mNL80211_ATTR_REG_ALPHA2
,

1074 
	mNL80211_ATTR_REG_RULES
,

1076 
	mNL80211_ATTR_MESH_CONFIG
,

1078 
	mNL80211_ATTR_BSS_BASIC_RATES
,

1080 
	mNL80211_ATTR_WIPHY_TXQ_PARAMS
,

1081 
	mNL80211_ATTR_WIPHY_FREQ
,

1082 
	mNL80211_ATTR_WIPHY_CHANNEL_TYPE
,

1084 
	mNL80211_ATTR_KEY_DEFAULT_MGMT
,

1086 
	mNL80211_ATTR_MGMT_SUBTYPE
,

1087 
	mNL80211_ATTR_IE
,

1089 
	mNL80211_ATTR_MAX_NUM_SCAN_SSIDS
,

1091 
	mNL80211_ATTR_SCAN_FREQUENCIES
,

1092 
	mNL80211_ATTR_SCAN_SSIDS
,

1093 
	mNL80211_ATTR_GENERATION
,

1094 
	mNL80211_ATTR_BSS
,

1096 
	mNL80211_ATTR_REG_INITIATOR
,

1097 
	mNL80211_ATTR_REG_TYPE
,

1099 
	mNL80211_ATTR_SUPPORTED_COMMANDS
,

1101 
	mNL80211_ATTR_FRAME
,

1102 
	mNL80211_ATTR_SSID
,

1103 
	mNL80211_ATTR_AUTH_TYPE
,

1104 
	mNL80211_ATTR_REASON_CODE
,

1106 
	mNL80211_ATTR_KEY_TYPE
,

1108 
	mNL80211_ATTR_MAX_SCAN_IE_LEN
,

1109 
	mNL80211_ATTR_CIPHER_SUITES
,

1111 
	mNL80211_ATTR_FREQ_BEFORE
,

1112 
	mNL80211_ATTR_FREQ_AFTER
,

1114 
	mNL80211_ATTR_FREQ_FIXED
,

1117 
	mNL80211_ATTR_WIPHY_RETRY_SHORT
,

1118 
	mNL80211_ATTR_WIPHY_RETRY_LONG
,

1119 
	mNL80211_ATTR_WIPHY_FRAG_THRESHOLD
,

1120 
	mNL80211_ATTR_WIPHY_RTS_THRESHOLD
,

1122 
	mNL80211_ATTR_TIMED_OUT
,

1124 
	mNL80211_ATTR_USE_MFP
,

1126 
	mNL80211_ATTR_STA_FLAGS2
,

1128 
	mNL80211_ATTR_CONTROL_PORT
,

1130 
	mNL80211_ATTR_TESTDATA
,

1132 
	mNL80211_ATTR_PRIVACY
,

1134 
	mNL80211_ATTR_DISCONNECTED_BY_AP
,

1135 
	mNL80211_ATTR_STATUS_CODE
,

1137 
	mNL80211_ATTR_CIPHER_SUITES_PAIRWISE
,

1138 
	mNL80211_ATTR_CIPHER_SUITE_GROUP
,

1139 
	mNL80211_ATTR_WPA_VERSIONS
,

1140 
	mNL80211_ATTR_AKM_SUITES
,

1142 
	mNL80211_ATTR_REQ_IE
,

1143 
	mNL80211_ATTR_RESP_IE
,

1145 
	mNL80211_ATTR_PREV_BSSID
,

1147 
	mNL80211_ATTR_KEY
,

1148 
	mNL80211_ATTR_KEYS
,

1150 
	mNL80211_ATTR_PID
,

1152 
	mNL80211_ATTR_4ADDR
,

1154 
	mNL80211_ATTR_SURVEY_INFO
,

1156 
	mNL80211_ATTR_PMKID
,

1157 
	mNL80211_ATTR_MAX_NUM_PMKIDS
,

1159 
	mNL80211_ATTR_DURATION
,

1161 
	mNL80211_ATTR_COOKIE
,

1163 
	mNL80211_ATTR_WIPHY_COVERAGE_CLASS
,

1165 
	mNL80211_ATTR_TX_RATES
,

1167 
	mNL80211_ATTR_FRAME_MATCH
,

1169 
	mNL80211_ATTR_ACK
,

1171 
	mNL80211_ATTR_PS_STATE
,

1173 
	mNL80211_ATTR_CQM
,

1175 
	mNL80211_ATTR_LOCAL_STATE_CHANGE
,

1177 
	mNL80211_ATTR_AP_ISOLATE
,

1179 
	mNL80211_ATTR_WIPHY_TX_POWER_SETTING
,

1180 
	mNL80211_ATTR_WIPHY_TX_POWER_LEVEL
,

1182 
	mNL80211_ATTR_TX_FRAME_TYPES
,

1183 
	mNL80211_ATTR_RX_FRAME_TYPES
,

1184 
	mNL80211_ATTR_FRAME_TYPE
,

1186 
	mNL80211_ATTR_CONTROL_PORT_ETHERTYPE
,

1187 
	mNL80211_ATTR_CONTROL_PORT_NO_ENCRYPT
,

1189 
	mNL80211_ATTR_SUPPORT_IBSS_RSN
,

1191 
	mNL80211_ATTR_WIPHY_ANTENNA_TX
,

1192 
	mNL80211_ATTR_WIPHY_ANTENNA_RX
,

1194 
	mNL80211_ATTR_MCAST_RATE
,

1196 
	mNL80211_ATTR_OFFCHANNEL_TX_OK
,

1198 
	mNL80211_ATTR_BSS_HT_OPMODE
,

1200 
	mNL80211_ATTR_KEY_DEFAULT_TYPES
,

1202 
	mNL80211_ATTR_MAX_REMAIN_ON_CHANNEL_DURATION
,

1204 
	mNL80211_ATTR_MESH_SETUP
,

1206 
	mNL80211_ATTR_WIPHY_ANTENNA_AVAIL_TX
,

1207 
	mNL80211_ATTR_WIPHY_ANTENNA_AVAIL_RX
,

1209 
	mNL80211_ATTR_SUPPORT_MESH_AUTH
,

1210 
	mNL80211_ATTR_STA_PLINK_STATE
,

1212 
	mNL80211_ATTR_WOWLAN_TRIGGERS
,

1213 
	mNL80211_ATTR_WOWLAN_TRIGGERS_SUPPORTED
,

1215 
	mNL80211_ATTR_SCHED_SCAN_INTERVAL
,

1217 
	mNL80211_ATTR_INTERFACE_COMBINATIONS
,

1218 
	mNL80211_ATTR_SOFTWARE_IFTYPES
,

1220 
	mNL80211_ATTR_REKEY_DATA
,

1222 
	mNL80211_ATTR_MAX_NUM_SCHED_SCAN_SSIDS
,

1223 
	mNL80211_ATTR_MAX_SCHED_SCAN_IE_LEN
,

1225 
	mNL80211_ATTR_SCAN_SUPP_RATES
,

1229 
	m__NL80211_ATTR_AFTER_LAST
,

1230 
	mNL80211_ATTR_MAX
 = 
__NL80211_ATTR_AFTER_LAST
 - 1

1234 
	#NL80211_ATTR_SCAN_GENERATION
 
NL80211_ATTR_GENERATION


	)

1235 
	#NL80211_ATTR_MESH_PARAMS
 
NL80211_ATTR_MESH_CONFIG


	)

1241 
	#NL80211_CMD_CONNECT
 
NL80211_CMD_CONNECT


	)

1242 
	#NL80211_ATTR_HT_CAPABILITY
 
NL80211_ATTR_HT_CAPABILITY


	)

1243 
	#NL80211_ATTR_BSS_BASIC_RATES
 
NL80211_ATTR_BSS_BASIC_RATES


	)

1244 
	#NL80211_ATTR_WIPHY_TXQ_PARAMS
 
NL80211_ATTR_WIPHY_TXQ_PARAMS


	)

1245 
	#NL80211_ATTR_WIPHY_FREQ
 
NL80211_ATTR_WIPHY_FREQ


	)

1246 
	#NL80211_ATTR_WIPHY_CHANNEL_TYPE
 
NL80211_ATTR_WIPHY_CHANNEL_TYPE


	)

1247 
	#NL80211_ATTR_MGMT_SUBTYPE
 
NL80211_ATTR_MGMT_SUBTYPE


	)

1248 
	#NL80211_ATTR_IE
 
NL80211_ATTR_IE


	)

1249 
	#NL80211_ATTR_REG_INITIATOR
 
NL80211_ATTR_REG_INITIATOR


	)

1250 
	#NL80211_ATTR_REG_TYPE
 
NL80211_ATTR_REG_TYPE


	)

1251 
	#NL80211_ATTR_FRAME
 
NL80211_ATTR_FRAME


	)

1252 
	#NL80211_ATTR_SSID
 
NL80211_ATTR_SSID


	)

1253 
	#NL80211_ATTR_AUTH_TYPE
 
NL80211_ATTR_AUTH_TYPE


	)

1254 
	#NL80211_ATTR_REASON_CODE
 
NL80211_ATTR_REASON_CODE


	)

1255 
	#NL80211_ATTR_CIPHER_SUITES_PAIRWISE
 
NL80211_ATTR_CIPHER_SUITES_PAIRWISE


	)

1256 
	#NL80211_ATTR_CIPHER_SUITE_GROUP
 
NL80211_ATTR_CIPHER_SUITE_GROUP


	)

1257 
	#NL80211_ATTR_WPA_VERSIONS
 
NL80211_ATTR_WPA_VERSIONS


	)

1258 
	#NL80211_ATTR_AKM_SUITES
 
NL80211_ATTR_AKM_SUITES


	)

1259 
	#NL80211_ATTR_KEY
 
NL80211_ATTR_KEY


	)

1260 
	#NL80211_ATTR_KEYS
 
NL80211_ATTR_KEYS


	)

1262 
	#NL80211_MAX_SUPP_RATES
 32

	)

1263 
	#NL80211_MAX_SUPP_REG_RULES
 32

	)

1264 
	#NL80211_TKIP_DATA_OFFSET_ENCR_KEY
 0

	)

1265 
	#NL80211_TKIP_DATA_OFFSET_TX_MIC_KEY
 16

	)

1266 
	#NL80211_TKIP_DATA_OFFSET_RX_MIC_KEY
 24

	)

1267 
	#NL80211_HT_CAPABILITY_LEN
 26

	)

1269 
	#NL80211_MAX_NR_CIPHER_SUITES
 5

	)

1270 
	#NL80211_MAX_NR_AKM_SUITES
 2

	)

1294 
	e∆80211_i·y≥
 {

1295 
	mNL80211_IFTYPE_UNSPECIFIED
,

1296 
	mNL80211_IFTYPE_ADHOC
,

1297 
	mNL80211_IFTYPE_STATION
,

1298 
	mNL80211_IFTYPE_AP
,

1299 
	mNL80211_IFTYPE_AP_VLAN
,

1300 
	mNL80211_IFTYPE_WDS
,

1301 
	mNL80211_IFTYPE_MONITOR
,

1302 
	mNL80211_IFTYPE_MESH_POINT
,

1303 
	mNL80211_IFTYPE_P2P_CLIENT
,

1304 
	mNL80211_IFTYPE_P2P_GO
,

1307 
	mNUM_NL80211_IFTYPES
,

1308 
	mNL80211_IFTYPE_MAX
 = 
NUM_NL80211_IFTYPES
 - 1

1327 
	e∆80211_°a_Êags
 {

1328 
	m__NL80211_STA_FLAG_INVALID
,

1329 
	mNL80211_STA_FLAG_AUTHORIZED
,

1330 
	mNL80211_STA_FLAG_SHORT_PREAMBLE
,

1331 
	mNL80211_STA_FLAG_WME
,

1332 
	mNL80211_STA_FLAG_MFP
,

1333 
	mNL80211_STA_FLAG_AUTHENTICATED
,

1336 
	m__NL80211_STA_FLAG_AFTER_LAST
,

1337 
	mNL80211_STA_FLAG_MAX
 = 
__NL80211_STA_FLAG_AFTER_LAST
 - 1

1347 
	s∆80211_°a_Êag_upd©e
 {

1348 
__u32
 
	mmask
;

1349 
__u32
 
	m£t
;

1350 } 
__©åibuã__
((
∑cked
));

1366 
	e∆80211_øã_öfo
 {

1367 
	m__NL80211_RATE_INFO_INVALID
,

1368 
	mNL80211_RATE_INFO_BITRATE
,

1369 
	mNL80211_RATE_INFO_MCS
,

1370 
	mNL80211_RATE_INFO_40_MHZ_WIDTH
,

1371 
	mNL80211_RATE_INFO_SHORT_GI
,

1374 
	m__NL80211_RATE_INFO_AFTER_LAST
,

1375 
	mNL80211_RATE_INFO_MAX
 = 
__NL80211_RATE_INFO_AFTER_LAST
 - 1

1395 
	e∆80211_°a_bss_∑øm
 {

1396 
	m__NL80211_STA_BSS_PARAM_INVALID
,

1397 
	mNL80211_STA_BSS_PARAM_CTS_PROT
,

1398 
	mNL80211_STA_BSS_PARAM_SHORT_PREAMBLE
,

1399 
	mNL80211_STA_BSS_PARAM_SHORT_SLOT_TIME
,

1400 
	mNL80211_STA_BSS_PARAM_DTIM_PERIOD
,

1401 
	mNL80211_STA_BSS_PARAM_BEACON_INTERVAL
,

1404 
	m__NL80211_STA_BSS_PARAM_AFTER_LAST
,

1405 
	mNL80211_STA_BSS_PARAM_MAX
 = 
__NL80211_STA_BSS_PARAM_AFTER_LAST
 - 1

1439 
	e∆80211_°a_öfo
 {

1440 
	m__NL80211_STA_INFO_INVALID
,

1441 
	mNL80211_STA_INFO_INACTIVE_TIME
,

1442 
	mNL80211_STA_INFO_RX_BYTES
,

1443 
	mNL80211_STA_INFO_TX_BYTES
,

1444 
	mNL80211_STA_INFO_LLID
,

1445 
	mNL80211_STA_INFO_PLID
,

1446 
	mNL80211_STA_INFO_PLINK_STATE
,

1447 
	mNL80211_STA_INFO_SIGNAL
,

1448 
	mNL80211_STA_INFO_TX_BITRATE
,

1449 
	mNL80211_STA_INFO_RX_PACKETS
,

1450 
	mNL80211_STA_INFO_TX_PACKETS
,

1451 
	mNL80211_STA_INFO_TX_RETRIES
,

1452 
	mNL80211_STA_INFO_TX_FAILED
,

1453 
	mNL80211_STA_INFO_SIGNAL_AVG
,

1454 
	mNL80211_STA_INFO_RX_BITRATE
,

1455 
	mNL80211_STA_INFO_BSS_PARAM
,

1456 
	mNL80211_STA_INFO_CONNECTED_TIME
,

1459 
	m__NL80211_STA_INFO_AFTER_LAST
,

1460 
	mNL80211_STA_INFO_MAX
 = 
__NL80211_STA_INFO_AFTER_LAST
 - 1

1472 
	e∆80211_m∑th_Êags
 {

1473 
	mNL80211_MPATH_FLAG_ACTIVE
 = 1<<0,

1474 
	mNL80211_MPATH_FLAG_RESOLVING
 = 1<<1,

1475 
	mNL80211_MPATH_FLAG_SN_VALID
 = 1<<2,

1476 
	mNL80211_MPATH_FLAG_FIXED
 = 1<<3,

1477 
	mNL80211_MPATH_FLAG_RESOLVED
 = 1<<4,

1499 
	e∆80211_m∑th_öfo
 {

1500 
	m__NL80211_MPATH_INFO_INVALID
,

1501 
	mNL80211_MPATH_INFO_FRAME_QLEN
,

1502 
	mNL80211_MPATH_INFO_SN
,

1503 
	mNL80211_MPATH_INFO_METRIC
,

1504 
	mNL80211_MPATH_INFO_EXPTIME
,

1505 
	mNL80211_MPATH_INFO_FLAGS
,

1506 
	mNL80211_MPATH_INFO_DISCOVERY_TIMEOUT
,

1507 
	mNL80211_MPATH_INFO_DISCOVERY_RETRIES
,

1510 
	m__NL80211_MPATH_INFO_AFTER_LAST
,

1511 
	mNL80211_MPATH_INFO_MAX
 = 
__NL80211_MPATH_INFO_AFTER_LAST
 - 1

1529 
	e∆80211_b™d_©å
 {

1530 
	m__NL80211_BAND_ATTR_INVALID
,

1531 
	mNL80211_BAND_ATTR_FREQS
,

1532 
	mNL80211_BAND_ATTR_RATES
,

1534 
	mNL80211_BAND_ATTR_HT_MCS_SET
,

1535 
	mNL80211_BAND_ATTR_HT_CAPA
,

1536 
	mNL80211_BAND_ATTR_HT_AMPDU_FACTOR
,

1537 
	mNL80211_BAND_ATTR_HT_AMPDU_DENSITY
,

1540 
	m__NL80211_BAND_ATTR_AFTER_LAST
,

1541 
	mNL80211_BAND_ATTR_MAX
 = 
__NL80211_BAND_ATTR_AFTER_LAST
 - 1

1544 
	#NL80211_BAND_ATTR_HT_CAPA
 
NL80211_BAND_ATTR_HT_CAPA


	)

1564 
	e∆80211_‰equícy_©å
 {

1565 
	m__NL80211_FREQUENCY_ATTR_INVALID
,

1566 
	mNL80211_FREQUENCY_ATTR_FREQ
,

1567 
	mNL80211_FREQUENCY_ATTR_DISABLED
,

1568 
	mNL80211_FREQUENCY_ATTR_PASSIVE_SCAN
,

1569 
	mNL80211_FREQUENCY_ATTR_NO_IBSS
,

1570 
	mNL80211_FREQUENCY_ATTR_RADAR
,

1571 
	mNL80211_FREQUENCY_ATTR_MAX_TX_POWER
,

1574 
	m__NL80211_FREQUENCY_ATTR_AFTER_LAST
,

1575 
	mNL80211_FREQUENCY_ATTR_MAX
 = 
__NL80211_FREQUENCY_ATTR_AFTER_LAST
 - 1

1578 
	#NL80211_FREQUENCY_ATTR_MAX_TX_POWER
 
NL80211_FREQUENCY_ATTR_MAX_TX_POWER


	)

1590 
	e∆80211_bôøã_©å
 {

1591 
	m__NL80211_BITRATE_ATTR_INVALID
,

1592 
	mNL80211_BITRATE_ATTR_RATE
,

1593 
	mNL80211_BITRATE_ATTR_2GHZ_SHORTPREAMBLE
,

1596 
	m__NL80211_BITRATE_ATTR_AFTER_LAST
,

1597 
	mNL80211_BITRATE_ATTR_MAX
 = 
__NL80211_BITRATE_ATTR_AFTER_LAST
 - 1

1616 
	e∆80211_ªg_öôüt‹
 {

1617 
	mNL80211_REGDOM_SET_BY_CORE
,

1618 
	mNL80211_REGDOM_SET_BY_USER
,

1619 
	mNL80211_REGDOM_SET_BY_DRIVER
,

1620 
	mNL80211_REGDOM_SET_BY_COUNTRY_IE
,

1639 
	e∆80211_ªg_ty≥
 {

1640 
	mNL80211_REGDOM_TYPE_COUNTRY
,

1641 
	mNL80211_REGDOM_TYPE_WORLD
,

1642 
	mNL80211_REGDOM_TYPE_CUSTOM_WORLD
,

1643 
	mNL80211_REGDOM_TYPE_INTERSECTION
,

1669 
	e∆80211_ªg_ruÀ_©å
 {

1670 
	m__NL80211_REG_RULE_ATTR_INVALID
,

1671 
	mNL80211_ATTR_REG_RULE_FLAGS
,

1673 
	mNL80211_ATTR_FREQ_RANGE_START
,

1674 
	mNL80211_ATTR_FREQ_RANGE_END
,

1675 
	mNL80211_ATTR_FREQ_RANGE_MAX_BW
,

1677 
	mNL80211_ATTR_POWER_RULE_MAX_ANT_GAIN
,

1678 
	mNL80211_ATTR_POWER_RULE_MAX_EIRP
,

1681 
	m__NL80211_REG_RULE_ATTR_AFTER_LAST
,

1682 
	mNL80211_REG_RULE_ATTR_MAX
 = 
__NL80211_REG_RULE_ATTR_AFTER_LAST
 - 1

1698 
	e∆80211_ªg_ruÀ_Êags
 {

1699 
	mNL80211_RRF_NO_OFDM
 = 1<<0,

1700 
	mNL80211_RRF_NO_CCK
 = 1<<1,

1701 
	mNL80211_RRF_NO_INDOOR
 = 1<<2,

1702 
	mNL80211_RRF_NO_OUTDOOR
 = 1<<3,

1703 
	mNL80211_RRF_DFS
 = 1<<4,

1704 
	mNL80211_RRF_PTP_ONLY
 = 1<<5,

1705 
	mNL80211_RRF_PTMP_ONLY
 = 1<<6,

1706 
	mNL80211_RRF_PASSIVE_SCAN
 = 1<<7,

1707 
	mNL80211_RRF_NO_IBSS
 = 1<<8,

1734 
	e∆80211_survey_öfo
 {

1735 
	m__NL80211_SURVEY_INFO_INVALID
,

1736 
	mNL80211_SURVEY_INFO_FREQUENCY
,

1737 
	mNL80211_SURVEY_INFO_NOISE
,

1738 
	mNL80211_SURVEY_INFO_IN_USE
,

1739 
	mNL80211_SURVEY_INFO_CHANNEL_TIME
,

1740 
	mNL80211_SURVEY_INFO_CHANNEL_TIME_BUSY
,

1741 
	mNL80211_SURVEY_INFO_CHANNEL_TIME_EXT_BUSY
,

1742 
	mNL80211_SURVEY_INFO_CHANNEL_TIME_RX
,

1743 
	mNL80211_SURVEY_INFO_CHANNEL_TIME_TX
,

1746 
	m__NL80211_SURVEY_INFO_AFTER_LAST
,

1747 
	mNL80211_SURVEY_INFO_MAX
 = 
__NL80211_SURVEY_INFO_AFTER_LAST
 - 1

1767 
	e∆80211_m¡r_Êags
 {

1768 
	m__NL80211_MNTR_FLAG_INVALID
,

1769 
	mNL80211_MNTR_FLAG_FCSFAIL
,

1770 
	mNL80211_MNTR_FLAG_PLCPFAIL
,

1771 
	mNL80211_MNTR_FLAG_CONTROL
,

1772 
	mNL80211_MNTR_FLAG_OTHER_BSS
,

1773 
	mNL80211_MNTR_FLAG_COOK_FRAMES
,

1776 
	m__NL80211_MNTR_FLAG_AFTER_LAST
,

1777 
	mNL80211_MNTR_FLAG_MAX
 = 
__NL80211_MNTR_FLAG_AFTER_LAST
 - 1

1840 
	e∆80211_meshc⁄f_∑øms
 {

1841 
	m__NL80211_MESHCONF_INVALID
,

1842 
	mNL80211_MESHCONF_RETRY_TIMEOUT
,

1843 
	mNL80211_MESHCONF_CONFIRM_TIMEOUT
,

1844 
	mNL80211_MESHCONF_HOLDING_TIMEOUT
,

1845 
	mNL80211_MESHCONF_MAX_PEER_LINKS
,

1846 
	mNL80211_MESHCONF_MAX_RETRIES
,

1847 
	mNL80211_MESHCONF_TTL
,

1848 
	mNL80211_MESHCONF_AUTO_OPEN_PLINKS
,

1849 
	mNL80211_MESHCONF_HWMP_MAX_PREQ_RETRIES
,

1850 
	mNL80211_MESHCONF_PATH_REFRESH_TIME
,

1851 
	mNL80211_MESHCONF_MIN_DISCOVERY_TIMEOUT
,

1852 
	mNL80211_MESHCONF_HWMP_ACTIVE_PATH_TIMEOUT
,

1853 
	mNL80211_MESHCONF_HWMP_PREQ_MIN_INTERVAL
,

1854 
	mNL80211_MESHCONF_HWMP_NET_DIAM_TRVS_TIME
,

1855 
	mNL80211_MESHCONF_HWMP_ROOTMODE
,

1856 
	mNL80211_MESHCONF_ELEMENT_TTL
,

1859 
	m__NL80211_MESHCONF_ATTR_AFTER_LAST
,

1860 
	mNL80211_MESHCONF_ATTR_MAX
 = 
__NL80211_MESHCONF_ATTR_AFTER_LAST
 - 1

1898 
	e∆80211_mesh_£tup_∑øms
 {

1899 
	m__NL80211_MESH_SETUP_INVALID
,

1900 
	mNL80211_MESH_SETUP_ENABLE_VENDOR_PATH_SEL
,

1901 
	mNL80211_MESH_SETUP_ENABLE_VENDOR_METRIC
,

1902 
	mNL80211_MESH_SETUP_IE
,

1903 
	mNL80211_MESH_SETUP_USERSPACE_AUTH
,

1904 
	mNL80211_MESH_SETUP_USERSPACE_AMPE
,

1907 
	m__NL80211_MESH_SETUP_ATTR_AFTER_LAST
,

1908 
	mNL80211_MESH_SETUP_ATTR_MAX
 = 
__NL80211_MESH_SETUP_ATTR_AFTER_LAST
 - 1

1925 
	e∆80211_txq_©å
 {

1926 
	m__NL80211_TXQ_ATTR_INVALID
,

1927 
	mNL80211_TXQ_ATTR_QUEUE
,

1928 
	mNL80211_TXQ_ATTR_TXOP
,

1929 
	mNL80211_TXQ_ATTR_CWMIN
,

1930 
	mNL80211_TXQ_ATTR_CWMAX
,

1931 
	mNL80211_TXQ_ATTR_AIFS
,

1934 
	m__NL80211_TXQ_ATTR_AFTER_LAST
,

1935 
	mNL80211_TXQ_ATTR_MAX
 = 
__NL80211_TXQ_ATTR_AFTER_LAST
 - 1

1938 
	e∆80211_txq_q
 {

1939 
	mNL80211_TXQ_Q_VO
,

1940 
	mNL80211_TXQ_Q_VI
,

1941 
	mNL80211_TXQ_Q_BE
,

1942 
	mNL80211_TXQ_Q_BK


1945 
	e∆80211_ch™√l_ty≥
 {

1946 
	mNL80211_CHAN_NO_HT
,

1947 
	mNL80211_CHAN_HT20
,

1948 
	mNL80211_CHAN_HT40MINUS
,

1949 
	mNL80211_CHAN_HT40PLUS


1979 
	e∆80211_bss
 {

1980 
	m__NL80211_BSS_INVALID
,

1981 
	mNL80211_BSS_BSSID
,

1982 
	mNL80211_BSS_FREQUENCY
,

1983 
	mNL80211_BSS_TSF
,

1984 
	mNL80211_BSS_BEACON_INTERVAL
,

1985 
	mNL80211_BSS_CAPABILITY
,

1986 
	mNL80211_BSS_INFORMATION_ELEMENTS
,

1987 
	mNL80211_BSS_SIGNAL_MBM
,

1988 
	mNL80211_BSS_SIGNAL_UNSPEC
,

1989 
	mNL80211_BSS_STATUS
,

1990 
	mNL80211_BSS_SEEN_MS_AGO
,

1991 
	mNL80211_BSS_BEACON_IES
,

1994 
	m__NL80211_BSS_AFTER_LAST
,

1995 
	mNL80211_BSS_MAX
 = 
__NL80211_BSS_AFTER_LAST
 - 1

2007 
	e∆80211_bss_°©us
 {

2008 
	mNL80211_BSS_STATUS_AUTHENTICATED
,

2009 
	mNL80211_BSS_STATUS_ASSOCIATED
,

2010 
	mNL80211_BSS_STATUS_IBSS_JOINED
,

2026 
	e∆80211_auth_ty≥
 {

2027 
	mNL80211_AUTHTYPE_OPEN_SYSTEM
,

2028 
	mNL80211_AUTHTYPE_SHARED_KEY
,

2029 
	mNL80211_AUTHTYPE_FT
,

2030 
	mNL80211_AUTHTYPE_NETWORK_EAP
,

2033 
	m__NL80211_AUTHTYPE_NUM
,

2034 
	mNL80211_AUTHTYPE_MAX
 = 
__NL80211_AUTHTYPE_NUM
 - 1,

2035 
	mNL80211_AUTHTYPE_AUTOMATIC


2045 
	e∆80211_key_ty≥
 {

2046 
	mNL80211_KEYTYPE_GROUP
,

2047 
	mNL80211_KEYTYPE_PAIRWISE
,

2048 
	mNL80211_KEYTYPE_PEERKEY
,

2050 
	mNUM_NL80211_KEYTYPES


2058 
	e∆80211_mÂ
 {

2059 
	mNL80211_MFP_NO
,

2060 
	mNL80211_MFP_REQUIRED
,

2063 
	e∆80211_w∑_vîsi⁄s
 {

2064 
	mNL80211_WPA_VERSION_1
 = 1 << 0,

2065 
	mNL80211_WPA_VERSION_2
 = 1 << 1,

2077 
	e∆80211_key_deÁu…_ty≥s
 {

2078 
	m__NL80211_KEY_DEFAULT_TYPE_INVALID
,

2079 
	mNL80211_KEY_DEFAULT_TYPE_UNICAST
,

2080 
	mNL80211_KEY_DEFAULT_TYPE_MULTICAST
,

2082 
	mNUM_NL80211_KEY_DEFAULT_TYPES


2107 
	e∆80211_key_©åibuãs
 {

2108 
	m__NL80211_KEY_INVALID
,

2109 
	mNL80211_KEY_DATA
,

2110 
	mNL80211_KEY_IDX
,

2111 
	mNL80211_KEY_CIPHER
,

2112 
	mNL80211_KEY_SEQ
,

2113 
	mNL80211_KEY_DEFAULT
,

2114 
	mNL80211_KEY_DEFAULT_MGMT
,

2115 
	mNL80211_KEY_TYPE
,

2116 
	mNL80211_KEY_DEFAULT_TYPES
,

2119 
	m__NL80211_KEY_AFTER_LAST
,

2120 
	mNL80211_KEY_MAX
 = 
__NL80211_KEY_AFTER_LAST
 - 1

2133 
	e∆80211_tx_øã_©åibuãs
 {

2134 
	m__NL80211_TXRATE_INVALID
,

2135 
	mNL80211_TXRATE_LEGACY
,

2138 
	m__NL80211_TXRATE_AFTER_LAST
,

2139 
	mNL80211_TXRATE_MAX
 = 
__NL80211_TXRATE_AFTER_LAST
 - 1

2147 
	e∆80211_b™d
 {

2148 
	mNL80211_BAND_2GHZ
,

2149 
	mNL80211_BAND_5GHZ
,

2152 
	e∆80211_ps_°©e
 {

2153 
	mNL80211_PS_DISABLED
,

2154 
	mNL80211_PS_ENABLED
,

2172 
	e∆80211_©å_cqm
 {

2173 
	m__NL80211_ATTR_CQM_INVALID
,

2174 
	mNL80211_ATTR_CQM_RSSI_THOLD
,

2175 
	mNL80211_ATTR_CQM_RSSI_HYST
,

2176 
	mNL80211_ATTR_CQM_RSSI_THRESHOLD_EVENT
,

2177 
	mNL80211_ATTR_CQM_PKT_LOSS_EVENT
,

2180 
	m__NL80211_ATTR_CQM_AFTER_LAST
,

2181 
	mNL80211_ATTR_CQM_MAX
 = 
__NL80211_ATTR_CQM_AFTER_LAST
 - 1

2191 
	e∆80211_cqm_rssi_thªshﬁd_evít
 {

2192 
	mNL80211_CQM_RSSI_THRESHOLD_EVENT_LOW
,

2193 
	mNL80211_CQM_RSSI_THRESHOLD_EVENT_HIGH
,

2203 
	e∆80211_tx_powî_£âög
 {

2204 
	mNL80211_TX_POWER_AUTOMATIC
,

2205 
	mNL80211_TX_POWER_LIMITED
,

2206 
	mNL80211_TX_POWER_FIXED
,

2228 
	e∆80211_wowœn_∑ckë_∑âîn_©å
 {

2229 
	m__NL80211_WOWLAN_PKTPAT_INVALID
,

2230 
	mNL80211_WOWLAN_PKTPAT_MASK
,

2231 
	mNL80211_WOWLAN_PKTPAT_PATTERN
,

2233 
	mNUM_NL80211_WOWLAN_PKTPAT
,

2234 
	mMAX_NL80211_WOWLAN_PKTPAT
 = 
NUM_NL80211_WOWLAN_PKTPAT
 - 1,

2247 
	s∆80211_wowœn_∑âîn_suµ‹t
 {

2248 
__u32
 
	mmax_∑âîns
;

2249 
__u32
 
	mmö_∑âîn_Àn
;

2250 
__u32
 
	mmax_∑âîn_Àn
;

2251 } 
__©åibuã__
((
∑cked
));

2285 
	e∆80211_wowœn_åiggîs
 {

2286 
	m__NL80211_WOWLAN_TRIG_INVALID
,

2287 
	mNL80211_WOWLAN_TRIG_ANY
,

2288 
	mNL80211_WOWLAN_TRIG_DISCONNECT
,

2289 
	mNL80211_WOWLAN_TRIG_MAGIC_PKT
,

2290 
	mNL80211_WOWLAN_TRIG_PKT_PATTERN
,

2291 
	mNL80211_WOWLAN_TRIG_GTK_REKEY_SUPPORTED
,

2292 
	mNL80211_WOWLAN_TRIG_GTK_REKEY_FAILURE
,

2293 
	mNL80211_WOWLAN_TRIG_EAP_IDENT_REQUEST
,

2294 
	mNL80211_WOWLAN_TRIG_4WAY_HANDSHAKE
,

2295 
	mNL80211_WOWLAN_TRIG_RFKILL_RELEASE
,

2298 
	mNUM_NL80211_WOWLAN_TRIG
,

2299 
	mMAX_NL80211_WOWLAN_TRIG
 = 
NUM_NL80211_WOWLAN_TRIG
 - 1

2312 
	e∆80211_iÁ˚_limô_©ås
 {

2313 
	mNL80211_IFACE_LIMIT_UNSPEC
,

2314 
	mNL80211_IFACE_LIMIT_MAX
,

2315 
	mNL80211_IFACE_LIMIT_TYPES
,

2318 
	mNUM_NL80211_IFACE_LIMIT
,

2319 
	mMAX_NL80211_IFACE_LIMIT
 = 
NUM_NL80211_IFACE_LIMIT
 - 1

2364 
	e∆80211_if_combö©i⁄_©ås
 {

2365 
	mNL80211_IFACE_COMB_UNSPEC
,

2366 
	mNL80211_IFACE_COMB_LIMITS
,

2367 
	mNL80211_IFACE_COMB_MAXNUM
,

2368 
	mNL80211_IFACE_COMB_STA_AP_BI_MATCH
,

2369 
	mNL80211_IFACE_COMB_NUM_CHANNELS
,

2372 
	mNUM_NL80211_IFACE_COMB
,

2373 
	mMAX_NL80211_IFACE_COMB
 = 
NUM_NL80211_IFACE_COMB
 - 1

2395 
	e∆80211_∂ök_°©e
 {

2396 
	mNL80211_PLINK_LISTEN
,

2397 
	mNL80211_PLINK_OPN_SNT
,

2398 
	mNL80211_PLINK_OPN_RCVD
,

2399 
	mNL80211_PLINK_CNF_RCVD
,

2400 
	mNL80211_PLINK_ESTAB
,

2401 
	mNL80211_PLINK_HOLDING
,

2402 
	mNL80211_PLINK_BLOCKED
,

2405 
	mNUM_NL80211_PLINK_STATES
,

2406 
	mMAX_NL80211_PLINK_STATES
 = 
NUM_NL80211_PLINK_STATES
 - 1

2409 
	#NL80211_KCK_LEN
 16

	)

2410 
	#NL80211_KEK_LEN
 16

	)

2411 
	#NL80211_REPLAY_CTR_LEN
 8

	)

2422 
	e∆80211_ªkey_d©a
 {

2423 
	m__NL80211_REKEY_DATA_INVALID
,

2424 
	mNL80211_REKEY_DATA_KEK
,

2425 
	mNL80211_REKEY_DATA_KCK
,

2426 
	mNL80211_REKEY_DATA_REPLAY_CTR
,

2429 
	mNUM_NL80211_REKEY_DATA
,

2430 
	mMAX_NL80211_REKEY_DATA
 = 
NUM_NL80211_REKEY_DATA
 - 1

	@/usr/include/linux/pci.h

17 #i‚de‡
LINUX_PCI_H


18 
	#LINUX_PCI_H


	)

20 
	~<löux/pci_ªgs.h
>

30 
	#PCI_DEVFN
(
¶Ÿ
, 
func
Ë((((¶ŸË& 0x1fË<< 3Ë| ((funcË& 0x07))

	)

31 
	#PCI_SLOT
(
dev‚
Ë(((dev‚Ë>> 3Ë& 0x1f)

	)

32 
	#PCI_FUNC
(
dev‚
Ë((dev‚Ë& 0x07)

	)

35 
	#PCIIOC_BASE
 ('P' << 24 | 'C' << 16 | 'I' << 8)

	)

36 
	#PCIIOC_CONTROLLER
 (
PCIIOC_BASE
 | 0x00Ë

	)

37 
	#PCIIOC_MMAP_IS_IO
 (
PCIIOC_BASE
 | 0x01Ë

	)

38 
	#PCIIOC_MMAP_IS_MEM
 (
PCIIOC_BASE
 | 0x02Ë

	)

39 
	#PCIIOC_WRITE_COMBINE
 (
PCIIOC_BASE
 | 0x03Ë

	)

	@/usr/include/linux/rfkill.h

1 #i‚de‡
__RFKILL_H


2 
	#__RFKILL_H


	)

22 
	~<löux/ty≥s.h
>

25 
	#RFKILL_STATE_SOFT_BLOCKED
 0

	)

26 
	#RFKILL_STATE_UNBLOCKED
 1

	)

27 
	#RFKILL_STATE_HARD_BLOCKED
 2

	)

42 
	erfkûl_ty≥
 {

43 
	mRFKILL_TYPE_ALL
 = 0,

44 
	mRFKILL_TYPE_WLAN
,

45 
	mRFKILL_TYPE_BLUETOOTH
,

46 
	mRFKILL_TYPE_UWB
,

47 
	mRFKILL_TYPE_WIMAX
,

48 
	mRFKILL_TYPE_WWAN
,

49 
	mRFKILL_TYPE_GPS
,

50 
	mRFKILL_TYPE_FM
,

51 
	mNUM_RFKILL_TYPES
,

61 
	erfkûl_›î©i⁄
 {

62 
	mRFKILL_OP_ADD
 = 0,

63 
	mRFKILL_OP_DEL
,

64 
	mRFKILL_OP_CHANGE
,

65 
	mRFKILL_OP_CHANGE_ALL
,

79 
	srfkûl_evít
 {

80 
__u32
 
	midx
;

81 
__u8
 
	mty≥
;

82 
__u8
 
	m›
;

83 
__u8
 
	mso·
, 
	mh¨d
;

84 } 
__©åibuã__
((
∑cked
));

98 
	#RFKILL_EVENT_SIZE_V1
 8

	)

101 
	#RFKILL_IOC_MAGIC
 'R'

	)

102 
	#RFKILL_IOC_NOINPUT
 1

	)

103 
	#RFKILL_IOCTL_NOINPUT
 
	`_IO
(
RFKILL_IOC_MAGIC
, 
RFKILL_IOC_NOINPUT
)

	)

	@/usr/include/linux/types.h

1 #i‚de‡
_LINUX_TYPES_H


2 
	#_LINUX_TYPES_H


	)

4 
	~<asm/ty≥s.h
>

6 #i‚de‡
__ASSEMBLY__


8 
	~<löux/posix_ty≥s.h
>

16 #ifde‡
__CHECKER__


17 
	#__bôwi£__
 
	`__©åibuã__
((
bôwi£
))

	)

19 
	#__bôwi£__


	)

21 #ifde‡
__CHECK_ENDIAN__


22 
	#__bôwi£
 
__bôwi£__


	)

24 
	#__bôwi£


	)

27 
__u16
 
	t__bôwi£
 
	t__À16
;

28 
__u16
 
	t__bôwi£
 
	t__be16
;

29 
__u32
 
	t__bôwi£
 
	t__À32
;

30 
__u32
 
	t__bôwi£
 
	t__be32
;

31 
__u64
 
	t__bôwi£
 
	t__À64
;

32 
__u64
 
	t__bôwi£
 
	t__be64
;

34 
__u16
 
	t__bôwi£
 
	t__sum16
;

35 
__u32
 
	t__bôwi£
 
	t__wsum
;

46 
	#__Æig√d_u64
 
__u64
 
	`__©åibuã__
((
	`Æig√d
(8)))

	)

47 
	#__Æig√d_be64
 
__be64
 
	`__©åibuã__
((
	`Æig√d
(8)))

	)

48 
	#__Æig√d_À64
 
__À64
 
	`__©åibuã__
((
	`Æig√d
(8)))

	)

	@/usr/include/linux/wireless.h

10 #i‚de‡
_LINUX_WIRELESS_H


11 
	#_LINUX_WIRELESS_H


	)

72 
	~<löux/ty≥s.h
>

73 
	~<löux/sockë.h
>

74 
	~<löux/if.h
>

83 
	#WIRELESS_EXT
 22

	)

230 
	#SIOCSIWCOMMIT
 0x8B00

	)

231 
	#SIOCGIWNAME
 0x8B01

	)

237 
	#SIOCSIWNWID
 0x8B02

	)

238 
	#SIOCGIWNWID
 0x8B03

	)

239 
	#SIOCSIWFREQ
 0x8B04

	)

240 
	#SIOCGIWFREQ
 0x8B05

	)

241 
	#SIOCSIWMODE
 0x8B06

	)

242 
	#SIOCGIWMODE
 0x8B07

	)

243 
	#SIOCSIWSENS
 0x8B08

	)

244 
	#SIOCGIWSENS
 0x8B09

	)

247 
	#SIOCSIWRANGE
 0x8B0A

	)

248 
	#SIOCGIWRANGE
 0x8B0B

	)

249 
	#SIOCSIWPRIV
 0x8B0C

	)

250 
	#SIOCGIWPRIV
 0x8B0D

	)

251 
	#SIOCSIWSTATS
 0x8B0E

	)

252 
	#SIOCGIWSTATS
 0x8B0F

	)

257 
	#SIOCSIWSPY
 0x8B10

	)

258 
	#SIOCGIWSPY
 0x8B11

	)

259 
	#SIOCSIWTHRSPY
 0x8B12

	)

260 
	#SIOCGIWTHRSPY
 0x8B13

	)

263 
	#SIOCSIWAP
 0x8B14

	)

264 
	#SIOCGIWAP
 0x8B15

	)

265 
	#SIOCGIWAPLIST
 0x8B17

	)

266 
	#SIOCSIWSCAN
 0x8B18

	)

267 
	#SIOCGIWSCAN
 0x8B19

	)

270 
	#SIOCSIWESSID
 0x8B1A

	)

271 
	#SIOCGIWESSID
 0x8B1B

	)

272 
	#SIOCSIWNICKN
 0x8B1C

	)

273 
	#SIOCGIWNICKN
 0x8B1D

	)

279 
	#SIOCSIWRATE
 0x8B20

	)

280 
	#SIOCGIWRATE
 0x8B21

	)

281 
	#SIOCSIWRTS
 0x8B22

	)

282 
	#SIOCGIWRTS
 0x8B23

	)

283 
	#SIOCSIWFRAG
 0x8B24

	)

284 
	#SIOCGIWFRAG
 0x8B25

	)

285 
	#SIOCSIWTXPOW
 0x8B26

	)

286 
	#SIOCGIWTXPOW
 0x8B27

	)

287 
	#SIOCSIWRETRY
 0x8B28

	)

288 
	#SIOCGIWRETRY
 0x8B29

	)

291 
	#SIOCSIWENCODE
 0x8B2A

	)

292 
	#SIOCGIWENCODE
 0x8B2B

	)

294 
	#SIOCSIWPOWER
 0x8B2C

	)

295 
	#SIOCGIWPOWER
 0x8B2D

	)

304 
	#SIOCSIWGENIE
 0x8B30

	)

305 
	#SIOCGIWGENIE
 0x8B31

	)

308 
	#SIOCSIWMLME
 0x8B16

	)

311 
	#SIOCSIWAUTH
 0x8B32

	)

312 
	#SIOCGIWAUTH
 0x8B33

	)

315 
	#SIOCSIWENCODEEXT
 0x8B34

	)

316 
	#SIOCGIWENCODEEXT
 0x8B35

	)

319 
	#SIOCSIWPMKSA
 0x8B36

	)

330 
	#SIOCIWFIRSTPRIV
 0x8BE0

	)

331 
	#SIOCIWLASTPRIV
 0x8BFF

	)

346 
	#SIOCIWFIRST
 0x8B00

	)

347 
	#SIOCIWLAST
 
SIOCIWLASTPRIV


	)

348 
	#IW_IOCTL_IDX
(
cmd
Ë((cmdË- 
SIOCIWFIRST
)

	)

349 
	#IW_HANDLER
(
id
, 
func
) \

350 [
	`IW_IOCTL_IDX
(
id
)] = 
func


	)

353 
	#IW_IS_SET
(
cmd
Ë(!((cmdË& 0x1))

	)

354 
	#IW_IS_GET
(
cmd
Ë((cmdË& 0x1)

	)

360 
	#IWEVTXDROP
 0x8C00

	)

361 
	#IWEVQUAL
 0x8C01

	)

362 
	#IWEVCUSTOM
 0x8C02

	)

363 
	#IWEVREGISTERED
 0x8C03

	)

364 
	#IWEVEXPIRED
 0x8C04

	)

365 
	#IWEVGENIE
 0x8C05

	)

371 
	#IWEVMICHAELMICFAILURE
 0x8C06

	)

374 
	#IWEVASSOCREQIE
 0x8C07

	)

383 
	#IWEVASSOCRESPIE
 0x8C08

	)

390 
	#IWEVPMKIDCAND
 0x8C09

	)

394 
	#IWEVFIRST
 0x8C00

	)

395 
	#IW_EVENT_IDX
(
cmd
Ë((cmdË- 
IWEVFIRST
)

	)

404 
	#IW_PRIV_TYPE_MASK
 0x7000

	)

405 
	#IW_PRIV_TYPE_NONE
 0x0000

	)

406 
	#IW_PRIV_TYPE_BYTE
 0x1000

	)

407 
	#IW_PRIV_TYPE_CHAR
 0x2000

	)

408 
	#IW_PRIV_TYPE_INT
 0x4000

	)

409 
	#IW_PRIV_TYPE_FLOAT
 0x5000

	)

410 
	#IW_PRIV_TYPE_ADDR
 0x6000

	)

412 
	#IW_PRIV_SIZE_FIXED
 0x0800

	)

414 
	#IW_PRIV_SIZE_MASK
 0x07FF

	)

424 
	#IW_MAX_FREQUENCIES
 32

	)

430 
	#IW_MAX_BITRATES
 32

	)

433 
	#IW_MAX_TXPOWER
 8

	)

438 
	#IW_MAX_SPY
 8

	)

442 
	#IW_MAX_AP
 64

	)

445 
	#IW_ESSID_MAX_SIZE
 32

	)

448 
	#IW_MODE_AUTO
 0

	)

449 
	#IW_MODE_ADHOC
 1

	)

450 
	#IW_MODE_INFRA
 2

	)

451 
	#IW_MODE_MASTER
 3

	)

452 
	#IW_MODE_REPEAT
 4

	)

453 
	#IW_MODE_SECOND
 5

	)

454 
	#IW_MODE_MONITOR
 6

	)

455 
	#IW_MODE_MESH
 7

	)

458 
	#IW_QUAL_QUAL_UPDATED
 0x01

	)

459 
	#IW_QUAL_LEVEL_UPDATED
 0x02

	)

460 
	#IW_QUAL_NOISE_UPDATED
 0x04

	)

461 
	#IW_QUAL_ALL_UPDATED
 0x07

	)

462 
	#IW_QUAL_DBM
 0x08

	)

463 
	#IW_QUAL_QUAL_INVALID
 0x10

	)

464 
	#IW_QUAL_LEVEL_INVALID
 0x20

	)

465 
	#IW_QUAL_NOISE_INVALID
 0x40

	)

466 
	#IW_QUAL_RCPI
 0x80

	)

467 
	#IW_QUAL_ALL_INVALID
 0x70

	)

470 
	#IW_FREQ_AUTO
 0x00

	)

471 
	#IW_FREQ_FIXED
 0x01

	)

475 
	#IW_MAX_ENCODING_SIZES
 8

	)

478 
	#IW_ENCODING_TOKEN_MAX
 64

	)

481 
	#IW_ENCODE_INDEX
 0x00FF

	)

482 
	#IW_ENCODE_FLAGS
 0xFF00

	)

483 
	#IW_ENCODE_MODE
 0xF000

	)

484 
	#IW_ENCODE_DISABLED
 0x8000

	)

485 
	#IW_ENCODE_ENABLED
 0x0000

	)

486 
	#IW_ENCODE_RESTRICTED
 0x4000

	)

487 
	#IW_ENCODE_OPEN
 0x2000

	)

488 
	#IW_ENCODE_NOKEY
 0x0800

	)

489 
	#IW_ENCODE_TEMP
 0x0400

	)

492 
	#IW_POWER_ON
 0x0000

	)

493 
	#IW_POWER_TYPE
 0xF000

	)

494 
	#IW_POWER_PERIOD
 0x1000

	)

495 
	#IW_POWER_TIMEOUT
 0x2000

	)

496 
	#IW_POWER_MODE
 0x0F00

	)

497 
	#IW_POWER_UNICAST_R
 0x0100

	)

498 
	#IW_POWER_MULTICAST_R
 0x0200

	)

499 
	#IW_POWER_ALL_R
 0x0300

	)

500 
	#IW_POWER_FORCE_S
 0x0400

	)

501 
	#IW_POWER_REPEATER
 0x0800

	)

502 
	#IW_POWER_MODIFIER
 0x000F

	)

503 
	#IW_POWER_MIN
 0x0001

	)

504 
	#IW_POWER_MAX
 0x0002

	)

505 
	#IW_POWER_RELATIVE
 0x0004

	)

508 
	#IW_TXPOW_TYPE
 0x00FF

	)

509 
	#IW_TXPOW_DBM
 0x0000

	)

510 
	#IW_TXPOW_MWATT
 0x0001

	)

511 
	#IW_TXPOW_RELATIVE
 0x0002

	)

512 
	#IW_TXPOW_RANGE
 0x1000

	)

515 
	#IW_RETRY_ON
 0x0000

	)

516 
	#IW_RETRY_TYPE
 0xF000

	)

517 
	#IW_RETRY_LIMIT
 0x1000

	)

518 
	#IW_RETRY_LIFETIME
 0x2000

	)

519 
	#IW_RETRY_MODIFIER
 0x00FF

	)

520 
	#IW_RETRY_MIN
 0x0001

	)

521 
	#IW_RETRY_MAX
 0x0002

	)

522 
	#IW_RETRY_RELATIVE
 0x0004

	)

523 
	#IW_RETRY_SHORT
 0x0010

	)

524 
	#IW_RETRY_LONG
 0x0020

	)

527 
	#IW_SCAN_DEFAULT
 0x0000

	)

528 
	#IW_SCAN_ALL_ESSID
 0x0001

	)

529 
	#IW_SCAN_THIS_ESSID
 0x0002

	)

530 
	#IW_SCAN_ALL_FREQ
 0x0004

	)

531 
	#IW_SCAN_THIS_FREQ
 0x0008

	)

532 
	#IW_SCAN_ALL_MODE
 0x0010

	)

533 
	#IW_SCAN_THIS_MODE
 0x0020

	)

534 
	#IW_SCAN_ALL_RATE
 0x0040

	)

535 
	#IW_SCAN_THIS_RATE
 0x0080

	)

537 
	#IW_SCAN_TYPE_ACTIVE
 0

	)

538 
	#IW_SCAN_TYPE_PASSIVE
 1

	)

540 
	#IW_SCAN_MAX_DATA
 4096

	)

543 
	#IW_SCAN_CAPA_NONE
 0x00

	)

544 
	#IW_SCAN_CAPA_ESSID
 0x01

	)

545 
	#IW_SCAN_CAPA_BSSID
 0x02

	)

546 
	#IW_SCAN_CAPA_CHANNEL
 0x04

	)

547 
	#IW_SCAN_CAPA_MODE
 0x08

	)

548 
	#IW_SCAN_CAPA_RATE
 0x10

	)

549 
	#IW_SCAN_CAPA_TYPE
 0x20

	)

550 
	#IW_SCAN_CAPA_TIME
 0x40

	)

553 
	#IW_CUSTOM_MAX
 256

	)

556 
	#IW_GENERIC_IE_MAX
 1024

	)

559 
	#IW_MLME_DEAUTH
 0

	)

560 
	#IW_MLME_DISASSOC
 1

	)

561 
	#IW_MLME_AUTH
 2

	)

562 
	#IW_MLME_ASSOC
 3

	)

565 
	#IW_AUTH_INDEX
 0x0FFF

	)

566 
	#IW_AUTH_FLAGS
 0xF000

	)

571 
	#IW_AUTH_WPA_VERSION
 0

	)

572 
	#IW_AUTH_CIPHER_PAIRWISE
 1

	)

573 
	#IW_AUTH_CIPHER_GROUP
 2

	)

574 
	#IW_AUTH_KEY_MGMT
 3

	)

575 
	#IW_AUTH_TKIP_COUNTERMEASURES
 4

	)

576 
	#IW_AUTH_DROP_UNENCRYPTED
 5

	)

577 
	#IW_AUTH_80211_AUTH_ALG
 6

	)

578 
	#IW_AUTH_WPA_ENABLED
 7

	)

579 
	#IW_AUTH_RX_UNENCRYPTED_EAPOL
 8

	)

580 
	#IW_AUTH_ROAMING_CONTROL
 9

	)

581 
	#IW_AUTH_PRIVACY_INVOKED
 10

	)

582 
	#IW_AUTH_CIPHER_GROUP_MGMT
 11

	)

583 
	#IW_AUTH_MFP
 12

	)

586 
	#IW_AUTH_WPA_VERSION_DISABLED
 0x00000001

	)

587 
	#IW_AUTH_WPA_VERSION_WPA
 0x00000002

	)

588 
	#IW_AUTH_WPA_VERSION_WPA2
 0x00000004

	)

592 
	#IW_AUTH_CIPHER_NONE
 0x00000001

	)

593 
	#IW_AUTH_CIPHER_WEP40
 0x00000002

	)

594 
	#IW_AUTH_CIPHER_TKIP
 0x00000004

	)

595 
	#IW_AUTH_CIPHER_CCMP
 0x00000008

	)

596 
	#IW_AUTH_CIPHER_WEP104
 0x00000010

	)

597 
	#IW_AUTH_CIPHER_AES_CMAC
 0x00000020

	)

600 
	#IW_AUTH_KEY_MGMT_802_1X
 1

	)

601 
	#IW_AUTH_KEY_MGMT_PSK
 2

	)

604 
	#IW_AUTH_ALG_OPEN_SYSTEM
 0x00000001

	)

605 
	#IW_AUTH_ALG_SHARED_KEY
 0x00000002

	)

606 
	#IW_AUTH_ALG_LEAP
 0x00000004

	)

609 
	#IW_AUTH_ROAMING_ENABLE
 0

	)

610 
	#IW_AUTH_ROAMING_DISABLE
 1

	)

614 
	#IW_AUTH_MFP_DISABLED
 0

	)

615 
	#IW_AUTH_MFP_OPTIONAL
 1

	)

616 
	#IW_AUTH_MFP_REQUIRED
 2

	)

619 
	#IW_ENCODE_SEQ_MAX_SIZE
 8

	)

621 
	#IW_ENCODE_ALG_NONE
 0

	)

622 
	#IW_ENCODE_ALG_WEP
 1

	)

623 
	#IW_ENCODE_ALG_TKIP
 2

	)

624 
	#IW_ENCODE_ALG_CCMP
 3

	)

625 
	#IW_ENCODE_ALG_PMK
 4

	)

626 
	#IW_ENCODE_ALG_AES_CMAC
 5

	)

628 
	#IW_ENCODE_EXT_TX_SEQ_VALID
 0x00000001

	)

629 
	#IW_ENCODE_EXT_RX_SEQ_VALID
 0x00000002

	)

630 
	#IW_ENCODE_EXT_GROUP_KEY
 0x00000004

	)

631 
	#IW_ENCODE_EXT_SET_TX_KEY
 0x00000008

	)

634 
	#IW_MICFAILURE_KEY_ID
 0x00000003

	)

635 
	#IW_MICFAILURE_GROUP
 0x00000004

	)

636 
	#IW_MICFAILURE_PAIRWISE
 0x00000008

	)

637 
	#IW_MICFAILURE_STAKEY
 0x00000010

	)

638 
	#IW_MICFAILURE_COUNT
 0x00000060

	)

642 
	#IW_ENC_CAPA_WPA
 0x00000001

	)

643 
	#IW_ENC_CAPA_WPA2
 0x00000002

	)

644 
	#IW_ENC_CAPA_CIPHER_TKIP
 0x00000004

	)

645 
	#IW_ENC_CAPA_CIPHER_CCMP
 0x00000008

	)

646 
	#IW_ENC_CAPA_4WAY_HANDSHAKE
 0x00000010

	)

651 
	#IW_EVENT_CAPA_BASE
(
cmd
Ë((cmd >
SIOCIWFIRSTPRIV
) ? \

652 (
cmd
 - 
SIOCIWFIRSTPRIV
 + 0x60) : \

653 (
cmd
 - 
SIOCIWFIRST
))

	)

654 
	#IW_EVENT_CAPA_INDEX
(
cmd
Ë(
	`IW_EVENT_CAPA_BASE
(cmdË>> 5)

	)

655 
	#IW_EVENT_CAPA_MASK
(
cmd
Ë(1 << (
	`IW_EVENT_CAPA_BASE
(cmdË& 0x1F))

	)

658 
	#IW_EVENT_CAPA_K_0
 (
	`IW_EVENT_CAPA_MASK
(0x8B04) | \

659 
	`IW_EVENT_CAPA_MASK
(0x8B06) | \

660 
	`IW_EVENT_CAPA_MASK
(0x8B1A))

	)

661 
	#IW_EVENT_CAPA_K_1
 (
	`IW_EVENT_CAPA_MASK
(0x8B2A))

	)

663 
	#IW_EVENT_CAPA_SET
(
evít_ˇ∑
, 
cmd
Ë”vít_ˇ∑[
	`IW_EVENT_CAPA_INDEX
(cmd)] |
	`IW_EVENT_CAPA_MASK
(cmd))

	)

664 
	#IW_EVENT_CAPA_SET_KERNEL
(
evít_ˇ∑
Ë{evít_ˇ∑[0] |
IW_EVENT_CAPA_K_0
;Évít_ˇ∑[1] |
IW_EVENT_CAPA_K_1
; }

	)

673 
	siw_∑øm


675 
__s32
 
	mvÆue
;

676 
__u8
 
	mfixed
;

677 
__u8
 
	mdißbÀd
;

678 
__u16
 
	mÊags
;

685 
	siw_poöt


687 *
	mpoöãr
;

688 
__u16
 
	mÀngth
;

689 
__u16
 
	mÊags
;

701 
	siw_‰eq


703 
__s32
 
	mm
;

704 
__s16
 
	me
;

705 
__u8
 
	mi
;

706 
__u8
 
	mÊags
;

712 
	siw_quÆôy


714 
__u8
 
	mquÆ
;

716 
__u8
 
	mÀvñ
;

717 
__u8
 
	mnoi£
;

718 
__u8
 
	mupd©ed
;

728 
	siw_disˇrded


730 
__u32
 
	mnwid
;

731 
__u32
 
	mcode
;

732 
__u32
 
	m‰agmít
;

733 
__u32
 
	mªåõs
;

734 
__u32
 
	mmisc
;

741 
	siw_mis£d


743 
__u32
 
	mbóc⁄
;

749 
	siw_thr•y


751 
sockaddr
 
	maddr
;

752 
iw_quÆôy
 
	mquÆ
;

753 
iw_quÆôy
 
	mlow
;

754 
iw_quÆôy
 
	mhigh
;

768 
	siw_sˇn_ªq


770 
__u8
 
	msˇn_ty≥
;

771 
__u8
 
	messid_Àn
;

772 
__u8
 
	mnum_ch™√ls
;

774 
__u8
 
	mÊags
;

777 
sockaddr
 
	mbssid
;

786 
__u8
 
	messid
[
IW_ESSID_MAX_SIZE
];

798 
__u32
 
	mmö_ch™√l_time
;

799 
__u32
 
	mmax_ch™√l_time
;

801 
iw_‰eq
 
	mch™√l_li°
[
IW_MAX_FREQUENCIES
];

830 
	siw_ícode_ext


832 
__u32
 
	mext_Êags
;

833 
__u8
 
	mtx_£q
[
IW_ENCODE_SEQ_MAX_SIZE
];

834 
__u8
 
	mrx_£q
[
IW_ENCODE_SEQ_MAX_SIZE
];

835 
sockaddr
 
	maddr
;

838 
__u16
 
	mÆg
;

839 
__u16
 
	mkey_Àn
;

840 
__u8
 
	mkey
[0];

844 
	siw_mlme


846 
__u16
 
	mcmd
;

847 
__u16
 
	mªas⁄_code
;

848 
sockaddr
 
	maddr
;

852 
	#IW_PMKSA_ADD
 1

	)

853 
	#IW_PMKSA_REMOVE
 2

	)

854 
	#IW_PMKSA_FLUSH
 3

	)

856 
	#IW_PMKID_LEN
 16

	)

858 
	siw_pmkß


860 
__u32
 
	mcmd
;

861 
sockaddr
 
	mbssid
;

862 
__u8
 
	mpmkid
[
IW_PMKID_LEN
];

866 
	siw_mich´lmicÁûuª


868 
__u32
 
	mÊags
;

869 
sockaddr
 
	m§c_addr
;

870 
__u8
 
	mtsc
[
IW_ENCODE_SEQ_MAX_SIZE
];

874 
	#IW_PMKID_CAND_PREAUTH
 0x00000001

	)

875 
	siw_pmkid_ˇnd


877 
__u32
 
	mÊags
;

878 
__u32
 
	mödex
;

880 
sockaddr
 
	mbssid
;

887 
	siw_°©i°ics


889 
__u16
 
	m°©us
;

892 
iw_quÆôy
 
	mquÆ
;

894 
iw_disˇrded
 
	mdisˇrd
;

895 
iw_mis£d
 
	mmiss
;

909 
	uiwªq_d©a


912 
	m«me
[
IFNAMSIZ
];

916 
iw_poöt
 
	messid
;

917 
iw_∑øm
 
	mnwid
;

918 
iw_‰eq
 
	m‰eq
;

922 
iw_∑øm
 
	m£ns
;

923 
iw_∑øm
 
	mbôøã
;

924 
iw_∑øm
 
	mtxpowî
;

925 
iw_∑øm
 
	mπs
;

926 
iw_∑øm
 
	m‰ag
;

927 
__u32
 
	mmode
;

928 
iw_∑øm
 
	mªåy
;

930 
iw_poöt
 
	mícodög
;

931 
iw_∑øm
 
	mpowî
;

932 
iw_quÆôy
 
	mquÆ
;

934 
sockaddr
 
	m≠_addr
;

935 
sockaddr
 
	maddr
;

937 
iw_∑øm
 
	m∑øm
;

938 
iw_poöt
 
	md©a
;

947 
	siwªq


951 
	mi‰n_«me
[
IFNAMSIZ
];

952 } 
	mi‰_i‰n
;

955 
iwªq_d©a
 
	mu
;

968 
	siw_ønge


971 
__u32
 
	mthroughput
;

980 
__u32
 
	mmö_nwid
;

981 
__u32
 
	mmax_nwid
;

984 
__u16
 
	mﬁd_num_ch™√ls
;

985 
__u8
 
	mﬁd_num_‰equícy
;

988 
__u8
 
	msˇn_ˇ∑
;

991 
__u32
 
	mevít_ˇ∑
[6];

994 
__s32
 
	m£nsôivôy
;

1001 
iw_quÆôy
 
	mmax_quÆ
;

1011 
iw_quÆôy
 
	mavg_quÆ
;

1014 
__u8
 
	mnum_bôøãs
;

1015 
__s32
 
	mbôøã
[
IW_MAX_BITRATES
];

1018 
__s32
 
	mmö_πs
;

1019 
__s32
 
	mmax_πs
;

1022 
__s32
 
	mmö_‰ag
;

1023 
__s32
 
	mmax_‰ag
;

1026 
__s32
 
	mmö_pmp
;

1027 
__s32
 
	mmax_pmp
;

1028 
__s32
 
	mmö_pmt
;

1029 
__s32
 
	mmax_pmt
;

1030 
__u16
 
	mpmp_Êags
;

1031 
__u16
 
	mpmt_Êags
;

1032 
__u16
 
	mpm_ˇ∑
;

1035 
__u16
 
	mícodög_size
[
IW_MAX_ENCODING_SIZES
];

1036 
__u8
 
	mnum_ícodög_sizes
;

1037 
__u8
 
	mmax_ícodög_tokís
;

1039 
__u8
 
	mícodög_logö_ödex
;

1042 
__u16
 
	mtxpowî_ˇ∑
;

1043 
__u8
 
	mnum_txpowî
;

1044 
__s32
 
	mtxpowî
[
IW_MAX_TXPOWER
];

1047 
__u8
 
	mwe_vîsi⁄_compûed
;

1048 
__u8
 
	mwe_vîsi⁄_sour˚
;

1051 
__u16
 
	mªåy_ˇ∑
;

1052 
__u16
 
	mªåy_Êags
;

1053 
__u16
 
	mr_time_Êags
;

1054 
__s32
 
	mmö_ªåy
;

1055 
__s32
 
	mmax_ªåy
;

1056 
__s32
 
	mmö_r_time
;

1057 
__s32
 
	mmax_r_time
;

1060 
__u16
 
	mnum_ch™√ls
;

1061 
__u8
 
	mnum_‰equícy
;

1062 
iw_‰eq
 
	m‰eq
[
IW_MAX_FREQUENCIES
];

1066 
__u32
 
	míc_ˇ∑
;

1073 
	siw_¥iv_¨gs


1075 
__u32
 
	mcmd
;

1076 
__u16
 
	m£t_¨gs
;

1077 
__u16
 
	mgë_¨gs
;

1078 
	m«me
[
IFNAMSIZ
];

1091 
	siw_evít


1093 
__u16
 
	mÀn
;

1094 
__u16
 
	mcmd
;

1095 
iwªq_d©a
 
	mu
;

1099 
	#IW_EV_LCP_LEN
 ((
iw_evít
Ë- (
iwªq_d©a
))

	)

1101 
	#IW_EV_CHAR_LEN
 (
IW_EV_LCP_LEN
 + 
IFNAMSIZ
)

	)

1102 
	#IW_EV_UINT_LEN
 (
IW_EV_LCP_LEN
 + (
__u32
))

	)

1103 
	#IW_EV_FREQ_LEN
 (
IW_EV_LCP_LEN
 + (
iw_‰eq
))

	)

1104 
	#IW_EV_PARAM_LEN
 (
IW_EV_LCP_LEN
 + (
iw_∑øm
))

	)

1105 
	#IW_EV_ADDR_LEN
 (
IW_EV_LCP_LEN
 + (
sockaddr
))

	)

1106 
	#IW_EV_QUAL_LEN
 (
IW_EV_LCP_LEN
 + (
iw_quÆôy
))

	)

1111 
	#IW_EV_POINT_OFF
 (((*Ë&(((
iw_poöt
 *Ë
NULL
)->
Àngth
)) - \

1112 (*Ë
NULL
)

	)

1113 
	#IW_EV_POINT_LEN
 (
IW_EV_LCP_LEN
 + (
iw_poöt
) - \

1114 
IW_EV_POINT_OFF
)

	)

1118 
	#IW_EV_LCP_PK_LEN
 (4)

	)

1120 
	#IW_EV_CHAR_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + 
IFNAMSIZ
)

	)

1121 
	#IW_EV_UINT_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + (
__u32
))

	)

1122 
	#IW_EV_FREQ_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + (
iw_‰eq
))

	)

1123 
	#IW_EV_PARAM_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + (
iw_∑øm
))

	)

1124 
	#IW_EV_ADDR_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + (
sockaddr
))

	)

1125 
	#IW_EV_QUAL_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + (
iw_quÆôy
))

	)

1126 
	#IW_EV_POINT_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + 4)

	)

	@/usr/include/asm/types.h

1 #i‚de‡
_ASM_X86_TYPES_H


2 
	#_ASM_X86_TYPES_H


	)

4 
	~<asm-gíîic/ty≥s.h
>

	@/usr/include/linux/hdlc/ioctl.h

1 #i‚de‡
__HDLC_IOCTL_H__


2 
	#__HDLC_IOCTL_H__


	)

5 
	#GENERIC_HDLC_VERSION
 4

	)

7 
	#CLOCK_DEFAULT
 0

	)

8 
	#CLOCK_EXT
 1

	)

9 
	#CLOCK_INT
 2

	)

10 
	#CLOCK_TXINT
 3

	)

11 
	#CLOCK_TXFROMRX
 4

	)

14 
	#ENCODING_DEFAULT
 0

	)

15 
	#ENCODING_NRZ
 1

	)

16 
	#ENCODING_NRZI
 2

	)

17 
	#ENCODING_FM_MARK
 3

	)

18 
	#ENCODING_FM_SPACE
 4

	)

19 
	#ENCODING_MANCHESTER
 5

	)

22 
	#PARITY_DEFAULT
 0

	)

23 
	#PARITY_NONE
 1

	)

24 
	#PARITY_CRC16_PR0
 2

	)

25 
	#PARITY_CRC16_PR1
 3

	)

26 
	#PARITY_CRC16_PR0_CCITT
 4

	)

27 
	#PARITY_CRC16_PR1_CCITT
 5

	)

28 
	#PARITY_CRC32_PR0_CCITT
 6

	)

29 
	#PARITY_CRC32_PR1_CCITT
 7

	)

31 
	#LMI_DEFAULT
 0

	)

32 
	#LMI_NONE
 1

	)

33 
	#LMI_ANSI
 2

	)

34 
	#LMI_CCITT
 3

	)

35 
	#LMI_CISCO
 4

	)

38 
	m˛ock_øã
;

39 
	m˛ock_ty≥
;

40 
	mlo›back
;

41 } 
	tsync_£rül_£âögs
;

44 
	m˛ock_øã
;

45 
	m˛ock_ty≥
;

46 
	mlo›back
;

47 
	m¶Ÿ_m≠
;

48 } 
	tã1_£âögs
;

51 
	mícodög
;

52 
	m∑rôy
;

53 } 
	tøw_hdlc_¥Ÿo
;

56 
	mt391
;

57 
	mt392
;

58 
	mn391
;

59 
	mn392
;

60 
	mn393
;

61 
	mlmi
;

62 
	md˚
;

63 } 
	t‰_¥Ÿo
;

66 
	mdlci
;

67 } 
	t‰_¥Ÿo_pvc
;

70 
	mdlci
;

71 
	mma°î
[
IFNAMSIZ
];

72 }
	t‰_¥Ÿo_pvc_öfo
;

75 
	möãrvÆ
;

76 
	mtimeout
;

77 } 
	tcisco_¥Ÿo
;

	@/usr/include/linux/if_link.h

1 #i‚de‡
_LINUX_IF_LINK_H


2 
	#_LINUX_IF_LINK_H


	)

4 
	~<löux/ty≥s.h
>

5 
	~<löux/√éök.h
>

8 
	sπ∆_lök_°©s
 {

9 
__u32
 
	mrx_∑ckës
;

10 
__u32
 
	mtx_∑ckës
;

11 
__u32
 
	mrx_byãs
;

12 
__u32
 
	mtx_byãs
;

13 
__u32
 
	mrx_îr‹s
;

14 
__u32
 
	mtx_îr‹s
;

15 
__u32
 
	mrx_dr›≥d
;

16 
__u32
 
	mtx_dr›≥d
;

17 
__u32
 
	mmu…iˇ°
;

18 
__u32
 
	mcﬁlisi⁄s
;

21 
__u32
 
	mrx_Àngth_îr‹s
;

22 
__u32
 
	mrx_ovî_îr‹s
;

23 
__u32
 
	mrx_¸c_îr‹s
;

24 
__u32
 
	mrx_‰ame_îr‹s
;

25 
__u32
 
	mrx_fifo_îr‹s
;

26 
__u32
 
	mrx_mis£d_îr‹s
;

29 
__u32
 
	mtx_ab‹ãd_îr‹s
;

30 
__u32
 
	mtx_ˇºõr_îr‹s
;

31 
__u32
 
	mtx_fifo_îr‹s
;

32 
__u32
 
	mtx_hóπbót_îr‹s
;

33 
__u32
 
	mtx_wödow_îr‹s
;

36 
__u32
 
	mrx_com¥es£d
;

37 
__u32
 
	mtx_com¥es£d
;

41 
	sπ∆_lök_°©s64
 {

42 
__u64
 
	mrx_∑ckës
;

43 
__u64
 
	mtx_∑ckës
;

44 
__u64
 
	mrx_byãs
;

45 
__u64
 
	mtx_byãs
;

46 
__u64
 
	mrx_îr‹s
;

47 
__u64
 
	mtx_îr‹s
;

48 
__u64
 
	mrx_dr›≥d
;

49 
__u64
 
	mtx_dr›≥d
;

50 
__u64
 
	mmu…iˇ°
;

51 
__u64
 
	mcﬁlisi⁄s
;

54 
__u64
 
	mrx_Àngth_îr‹s
;

55 
__u64
 
	mrx_ovî_îr‹s
;

56 
__u64
 
	mrx_¸c_îr‹s
;

57 
__u64
 
	mrx_‰ame_îr‹s
;

58 
__u64
 
	mrx_fifo_îr‹s
;

59 
__u64
 
	mrx_mis£d_îr‹s
;

62 
__u64
 
	mtx_ab‹ãd_îr‹s
;

63 
__u64
 
	mtx_ˇºõr_îr‹s
;

64 
__u64
 
	mtx_fifo_îr‹s
;

65 
__u64
 
	mtx_hóπbót_îr‹s
;

66 
__u64
 
	mtx_wödow_îr‹s
;

69 
__u64
 
	mrx_com¥es£d
;

70 
__u64
 
	mtx_com¥es£d
;

74 
	sπ∆_lök_ifm≠
 {

75 
__u64
 
	mmem_°¨t
;

76 
__u64
 
	mmem_íd
;

77 
__u64
 
	mba£_addr
;

78 
__u16
 
	múq
;

79 
__u8
 
	mdma
;

80 
__u8
 
	mp‹t
;

102 
	mIFLA_UNSPEC
,

103 
	mIFLA_ADDRESS
,

104 
	mIFLA_BROADCAST
,

105 
	mIFLA_IFNAME
,

106 
	mIFLA_MTU
,

107 
	mIFLA_LINK
,

108 
	mIFLA_QDISC
,

109 
	mIFLA_STATS
,

110 
	mIFLA_COST
,

111 
	#IFLA_COST
 
IFLA_COST


	)

112 
	mIFLA_PRIORITY
,

113 
	#IFLA_PRIORITY
 
IFLA_PRIORITY


	)

114 
	mIFLA_MASTER
,

115 
	#IFLA_MASTER
 
IFLA_MASTER


	)

116 
	mIFLA_WIRELESS
,

117 
	#IFLA_WIRELESS
 
IFLA_WIRELESS


	)

118 
	mIFLA_PROTINFO
,

119 
	#IFLA_PROTINFO
 
IFLA_PROTINFO


	)

120 
	mIFLA_TXQLEN
,

121 
	#IFLA_TXQLEN
 
IFLA_TXQLEN


	)

122 
	mIFLA_MAP
,

123 
	#IFLA_MAP
 
IFLA_MAP


	)

124 
	mIFLA_WEIGHT
,

125 
	#IFLA_WEIGHT
 
IFLA_WEIGHT


	)

126 
	mIFLA_OPERSTATE
,

127 
	mIFLA_LINKMODE
,

128 
	mIFLA_LINKINFO
,

129 
	#IFLA_LINKINFO
 
IFLA_LINKINFO


	)

130 
	mIFLA_NET_NS_PID
,

131 
	mIFLA_IFALIAS
,

132 
	mIFLA_NUM_VF
,

133 
	mIFLA_VFINFO_LIST
,

134 
	mIFLA_STATS64
,

135 
	mIFLA_VF_PORTS
,

136 
	mIFLA_PORT_SELF
,

137 
	mIFLA_AF_SPEC
,

138 
	mIFLA_GROUP
,

139 
	mIFLA_NET_NS_FD
,

140 
	m__IFLA_MAX


144 
	#IFLA_MAX
 (
__IFLA_MAX
 - 1)

	)

147 
	#IFLA_RTA
(
r
Ë((
π©å
*)(((*)‘)Ë+ 
	`NLMSG_ALIGN
((
iföfomsg
))))

	)

148 
	#IFLA_PAYLOAD
(
n
Ë
	`NLMSG_PAYLOAD
“,(
iföfomsg
))

	)

151 
	mIFLA_INET_UNSPEC
,

152 
	mIFLA_INET_CONF
,

153 
	m__IFLA_INET_MAX
,

156 
	#IFLA_INET_MAX
 (
__IFLA_INET_MAX
 - 1)

	)

189 
	mIFLA_INET6_UNSPEC
,

190 
	mIFLA_INET6_FLAGS
,

191 
	mIFLA_INET6_CONF
,

192 
	mIFLA_INET6_STATS
,

193 
	mIFLA_INET6_MCAST
,

194 
	mIFLA_INET6_CACHEINFO
,

195 
	mIFLA_INET6_ICMP6STATS
,

196 
	m__IFLA_INET6_MAX


199 
	#IFLA_INET6_MAX
 (
__IFLA_INET6_MAX
 - 1)

	)

201 
	siÊa_ˇcheöfo
 {

202 
__u32
 
	mmax_ªasm_Àn
;

203 
__u32
 
	mt°amp
;

204 
__u32
 
	mªachabÀ_time
;

205 
__u32
 
	mªå™s_time
;

209 
	mIFLA_INFO_UNSPEC
,

210 
	mIFLA_INFO_KIND
,

211 
	mIFLA_INFO_DATA
,

212 
	mIFLA_INFO_XSTATS
,

213 
	m__IFLA_INFO_MAX
,

216 
	#IFLA_INFO_MAX
 (
__IFLA_INFO_MAX
 - 1)

	)

221 
	mIFLA_VLAN_UNSPEC
,

222 
	mIFLA_VLAN_ID
,

223 
	mIFLA_VLAN_FLAGS
,

224 
	mIFLA_VLAN_EGRESS_QOS
,

225 
	mIFLA_VLAN_INGRESS_QOS
,

226 
	m__IFLA_VLAN_MAX
,

229 
	#IFLA_VLAN_MAX
 (
__IFLA_VLAN_MAX
 - 1)

	)

231 
	siÊa_vœn_Êags
 {

232 
__u32
 
	mÊags
;

233 
__u32
 
	mmask
;

237 
	mIFLA_VLAN_QOS_UNSPEC
,

238 
	mIFLA_VLAN_QOS_MAPPING
,

239 
	m__IFLA_VLAN_QOS_MAX


242 
	#IFLA_VLAN_QOS_MAX
 (
__IFLA_VLAN_QOS_MAX
 - 1)

	)

244 
	siÊa_vœn_qos_m≠pög
 {

245 
__u32
 
	m‰om
;

246 
__u32
 
	mto
;

251 
	mIFLA_MACVLAN_UNSPEC
,

252 
	mIFLA_MACVLAN_MODE
,

253 
	m__IFLA_MACVLAN_MAX
,

256 
	#IFLA_MACVLAN_MAX
 (
__IFLA_MACVLAN_MAX
 - 1)

	)

258 
	emacvœn_mode
 {

259 
	mMACVLAN_MODE_PRIVATE
 = 1,

260 
	mMACVLAN_MODE_VEPA
 = 2,

261 
	mMACVLAN_MODE_BRIDGE
 = 4,

262 
	mMACVLAN_MODE_PASSTHRU
 = 8,

268 
	mIFLA_VF_INFO_UNSPEC
,

269 
	mIFLA_VF_INFO
,

270 
	m__IFLA_VF_INFO_MAX
,

273 
	#IFLA_VF_INFO_MAX
 (
__IFLA_VF_INFO_MAX
 - 1)

	)

276 
	mIFLA_VF_UNSPEC
,

277 
	mIFLA_VF_MAC
,

278 
	mIFLA_VF_VLAN
,

279 
	mIFLA_VF_TX_RATE
,

280 
	m__IFLA_VF_MAX
,

283 
	#IFLA_VF_MAX
 (
__IFLA_VF_MAX
 - 1)

	)

285 
	siÊa_vf_mac
 {

286 
__u32
 
	mvf
;

287 
__u8
 
	mmac
[32];

290 
	siÊa_vf_vœn
 {

291 
__u32
 
	mvf
;

292 
__u32
 
	mvœn
;

293 
__u32
 
	mqos
;

296 
	siÊa_vf_tx_øã
 {

297 
__u32
 
	mvf
;

298 
__u32
 
	møã
;

301 
	siÊa_vf_öfo
 {

302 
__u32
 
	mvf
;

303 
__u8
 
	mmac
[32];

304 
__u32
 
	mvœn
;

305 
__u32
 
	mqos
;

306 
__u32
 
	mtx_øã
;

325 
	mIFLA_VF_PORT_UNSPEC
,

326 
	mIFLA_VF_PORT
,

327 
	m__IFLA_VF_PORT_MAX
,

330 
	#IFLA_VF_PORT_MAX
 (
__IFLA_VF_PORT_MAX
 - 1)

	)

333 
	mIFLA_PORT_UNSPEC
,

334 
	mIFLA_PORT_VF
,

335 
	mIFLA_PORT_PROFILE
,

336 
	mIFLA_PORT_VSI_TYPE
,

337 
	mIFLA_PORT_INSTANCE_UUID
,

338 
	mIFLA_PORT_HOST_UUID
,

339 
	mIFLA_PORT_REQUEST
,

340 
	mIFLA_PORT_RESPONSE
,

341 
	m__IFLA_PORT_MAX
,

344 
	#IFLA_PORT_MAX
 (
__IFLA_PORT_MAX
 - 1)

	)

346 
	#PORT_PROFILE_MAX
 40

	)

347 
	#PORT_UUID_MAX
 16

	)

348 
	#PORT_SELF_VF
 -1

	)

351 
	mPORT_REQUEST_PREASSOCIATE
 = 0,

352 
	mPORT_REQUEST_PREASSOCIATE_RR
,

353 
	mPORT_REQUEST_ASSOCIATE
,

354 
	mPORT_REQUEST_DISASSOCIATE
,

358 
	mPORT_VDP_RESPONSE_SUCCESS
 = 0,

359 
	mPORT_VDP_RESPONSE_INVALID_FORMAT
,

360 
	mPORT_VDP_RESPONSE_INSUFFICIENT_RESOURCES
,

361 
	mPORT_VDP_RESPONSE_UNUSED_VTID
,

362 
	mPORT_VDP_RESPONSE_VTID_VIOLATION
,

363 
	mPORT_VDP_RESPONSE_VTID_VERSION_VIOALTION
,

364 
	mPORT_VDP_RESPONSE_OUT_OF_SYNC
,

366 
	mPORT_PROFILE_RESPONSE_SUCCESS
 = 0x100,

367 
	mPORT_PROFILE_RESPONSE_INPROGRESS
,

368 
	mPORT_PROFILE_RESPONSE_INVALID
,

369 
	mPORT_PROFILE_RESPONSE_BADSTATE
,

370 
	mPORT_PROFILE_RESPONSE_INSUFFICIENT_RESOURCES
,

371 
	mPORT_PROFILE_RESPONSE_ERROR
,

374 
	siÊa_p‹t_vsi
 {

375 
__u8
 
	mvsi_mgr_id
;

376 
__u8
 
	mvsi_ty≥_id
[3];

377 
__u8
 
	mvsi_ty≥_vîsi⁄
;

378 
__u8
 
	m∑d
[3];

	@/usr/include/linux/if_packet.h

1 #i‚de‡
__LINUX_IF_PACKET_H


2 
	#__LINUX_IF_PACKET_H


	)

4 
	~<löux/ty≥s.h
>

6 
	ssockaddr_pkt
 {

7 
	m•kt_Ámûy
;

8 
	m•kt_devi˚
[14];

9 
__be16
 
	m•kt_¥Ÿocﬁ
;

12 
	ssockaddr_Œ
 {

13 
	m¶l_Ámûy
;

14 
__be16
 
	m¶l_¥Ÿocﬁ
;

15 
	m¶l_ifödex
;

16 
	m¶l_h©y≥
;

17 
	m¶l_pkây≥
;

18 
	m¶l_hÆí
;

19 
	m¶l_addr
[8];

24 
	#PACKET_HOST
 0

	)

25 
	#PACKET_BROADCAST
 1

	)

26 
	#PACKET_MULTICAST
 2

	)

27 
	#PACKET_OTHERHOST
 3

	)

28 
	#PACKET_OUTGOING
 4

	)

30 
	#PACKET_LOOPBACK
 5

	)

31 
	#PACKET_FASTROUTE
 6

	)

35 
	#PACKET_ADD_MEMBERSHIP
 1

	)

36 
	#PACKET_DROP_MEMBERSHIP
 2

	)

37 
	#PACKET_RECV_OUTPUT
 3

	)

39 
	#PACKET_RX_RING
 5

	)

40 
	#PACKET_STATISTICS
 6

	)

41 
	#PACKET_COPY_THRESH
 7

	)

42 
	#PACKET_AUXDATA
 8

	)

43 
	#PACKET_ORIGDEV
 9

	)

44 
	#PACKET_VERSION
 10

	)

45 
	#PACKET_HDRLEN
 11

	)

46 
	#PACKET_RESERVE
 12

	)

47 
	#PACKET_TX_RING
 13

	)

48 
	#PACKET_LOSS
 14

	)

49 
	#PACKET_VNET_HDR
 15

	)

50 
	#PACKET_TX_TIMESTAMP
 16

	)

51 
	#PACKET_TIMESTAMP
 17

	)

52 
	#PACKET_FANOUT
 18

	)

54 
	#PACKET_FANOUT_HASH
 0

	)

55 
	#PACKET_FANOUT_LB
 1

	)

56 
	#PACKET_FANOUT_CPU
 2

	)

57 
	#PACKET_FANOUT_FLAG_DEFRAG
 0x8000

	)

59 
	sçackë_°©s
 {

60 
	mç_∑ckës
;

61 
	mç_dr›s
;

64 
	sçackë_auxd©a
 {

65 
__u32
 
	mç_°©us
;

66 
__u32
 
	mç_Àn
;

67 
__u32
 
	mç_¢≠Àn
;

68 
__u16
 
	mç_mac
;

69 
__u16
 
	mç_√t
;

70 
__u16
 
	mç_vœn_tci
;

71 
__u16
 
	mç_∑ddög
;

75 
	#TP_STATUS_KERNEL
 0x0

	)

76 
	#TP_STATUS_USER
 0x1

	)

77 
	#TP_STATUS_COPY
 0x2

	)

78 
	#TP_STATUS_LOSING
 0x4

	)

79 
	#TP_STATUS_CSUMNOTREADY
 0x8

	)

80 
	#TP_STATUS_VLAN_VALID
 0x10

	)

83 
	#TP_STATUS_AVAILABLE
 0x0

	)

84 
	#TP_STATUS_SEND_REQUEST
 0x1

	)

85 
	#TP_STATUS_SENDING
 0x2

	)

86 
	#TP_STATUS_WRONG_FORMAT
 0x4

	)

88 
	sçackë_hdr
 {

89 
	mç_°©us
;

90 
	mç_Àn
;

91 
	mç_¢≠Àn
;

92 
	mç_mac
;

93 
	mç_√t
;

94 
	mç_£c
;

95 
	mç_u£c
;

98 
	#TPACKET_ALIGNMENT
 16

	)

99 
	#TPACKET_ALIGN
(
x
Ë(((x)+
TPACKET_ALIGNMENT
-1)&~(TPACKET_ALIGNMENT-1))

	)

100 
	#TPACKET_HDRLEN
 (
	`TPACKET_ALIGN
((
çackë_hdr
)Ë+ (
sockaddr_Œ
))

	)

102 
	sçackë2_hdr
 {

103 
__u32
 
	mç_°©us
;

104 
__u32
 
	mç_Àn
;

105 
__u32
 
	mç_¢≠Àn
;

106 
__u16
 
	mç_mac
;

107 
__u16
 
	mç_√t
;

108 
__u32
 
	mç_£c
;

109 
__u32
 
	mç_n£c
;

110 
__u16
 
	mç_vœn_tci
;

111 
__u16
 
	mç_∑ddög
;

114 
	#TPACKET2_HDRLEN
 (
	`TPACKET_ALIGN
((
çackë2_hdr
)Ë+ (
sockaddr_Œ
))

	)

116 
	eçackë_vîsi⁄s
 {

117 
	mTPACKET_V1
,

118 
	mTPACKET_V2
,

134 
	sçackë_ªq
 {

135 
	mç_block_size
;

136 
	mç_block_ƒ
;

137 
	mç_‰ame_size
;

138 
	mç_‰ame_ƒ
;

141 
	s∑ckë_mªq
 {

142 
	mmr_ifödex
;

143 
	mmr_ty≥
;

144 
	mmr_Æí
;

145 
	mmr_addªss
[8];

148 
	#PACKET_MR_MULTICAST
 0

	)

149 
	#PACKET_MR_PROMISC
 1

	)

150 
	#PACKET_MR_ALLMULTI
 2

	)

151 
	#PACKET_MR_UNICAST
 3

	)

	@/usr/include/linux/pci_regs.h

22 #i‚de‡
LINUX_PCI_REGS_H


23 
	#LINUX_PCI_REGS_H


	)

29 
	#PCI_VENDOR_ID
 0x00

	)

30 
	#PCI_DEVICE_ID
 0x02

	)

31 
	#PCI_COMMAND
 0x04

	)

32 
	#PCI_COMMAND_IO
 0x1

	)

33 
	#PCI_COMMAND_MEMORY
 0x2

	)

34 
	#PCI_COMMAND_MASTER
 0x4

	)

35 
	#PCI_COMMAND_SPECIAL
 0x8

	)

36 
	#PCI_COMMAND_INVALIDATE
 0x10

	)

37 
	#PCI_COMMAND_VGA_PALETTE
 0x20

	)

38 
	#PCI_COMMAND_PARITY
 0x40

	)

39 
	#PCI_COMMAND_WAIT
 0x80

	)

40 
	#PCI_COMMAND_SERR
 0x100

	)

41 
	#PCI_COMMAND_FAST_BACK
 0x200

	)

42 
	#PCI_COMMAND_INTX_DISABLE
 0x400

	)

44 
	#PCI_STATUS
 0x06

	)

45 
	#PCI_STATUS_INTERRUPT
 0x08

	)

46 
	#PCI_STATUS_CAP_LIST
 0x10

	)

47 
	#PCI_STATUS_66MHZ
 0x20

	)

48 
	#PCI_STATUS_UDF
 0x40

	)

49 
	#PCI_STATUS_FAST_BACK
 0x80

	)

50 
	#PCI_STATUS_PARITY
 0x100

	)

51 
	#PCI_STATUS_DEVSEL_MASK
 0x600

	)

52 
	#PCI_STATUS_DEVSEL_FAST
 0x000

	)

53 
	#PCI_STATUS_DEVSEL_MEDIUM
 0x200

	)

54 
	#PCI_STATUS_DEVSEL_SLOW
 0x400

	)

55 
	#PCI_STATUS_SIG_TARGET_ABORT
 0x800

	)

56 
	#PCI_STATUS_REC_TARGET_ABORT
 0x1000

	)

57 
	#PCI_STATUS_REC_MASTER_ABORT
 0x2000

	)

58 
	#PCI_STATUS_SIG_SYSTEM_ERROR
 0x4000

	)

59 
	#PCI_STATUS_DETECTED_PARITY
 0x8000

	)

61 
	#PCI_CLASS_REVISION
 0x08

	)

62 
	#PCI_REVISION_ID
 0x08

	)

63 
	#PCI_CLASS_PROG
 0x09

	)

64 
	#PCI_CLASS_DEVICE
 0x0®

	)

66 
	#PCI_CACHE_LINE_SIZE
 0x0¯

	)

67 
	#PCI_LATENCY_TIMER
 0x0d

	)

68 
	#PCI_HEADER_TYPE
 0x0ê

	)

69 
	#PCI_HEADER_TYPE_NORMAL
 0

	)

70 
	#PCI_HEADER_TYPE_BRIDGE
 1

	)

71 
	#PCI_HEADER_TYPE_CARDBUS
 2

	)

73 
	#PCI_BIST
 0x0‡

	)

74 
	#PCI_BIST_CODE_MASK
 0x0‡

	)

75 
	#PCI_BIST_START
 0x40

	)

76 
	#PCI_BIST_CAPABLE
 0x80

	)

84 
	#PCI_BASE_ADDRESS_0
 0x10

	)

85 
	#PCI_BASE_ADDRESS_1
 0x14

	)

86 
	#PCI_BASE_ADDRESS_2
 0x18

	)

87 
	#PCI_BASE_ADDRESS_3
 0x1¯

	)

88 
	#PCI_BASE_ADDRESS_4
 0x20

	)

89 
	#PCI_BASE_ADDRESS_5
 0x24

	)

90 
	#PCI_BASE_ADDRESS_SPACE
 0x01

	)

91 
	#PCI_BASE_ADDRESS_SPACE_IO
 0x01

	)

92 
	#PCI_BASE_ADDRESS_SPACE_MEMORY
 0x00

	)

93 
	#PCI_BASE_ADDRESS_MEM_TYPE_MASK
 0x06

	)

94 
	#PCI_BASE_ADDRESS_MEM_TYPE_32
 0x00

	)

95 
	#PCI_BASE_ADDRESS_MEM_TYPE_1M
 0x02

	)

96 
	#PCI_BASE_ADDRESS_MEM_TYPE_64
 0x04

	)

97 
	#PCI_BASE_ADDRESS_MEM_PREFETCH
 0x08

	)

98 
	#PCI_BASE_ADDRESS_MEM_MASK
 (~0x0fUL)

	)

99 
	#PCI_BASE_ADDRESS_IO_MASK
 (~0x03UL)

	)

103 
	#PCI_CARDBUS_CIS
 0x28

	)

104 
	#PCI_SUBSYSTEM_VENDOR_ID
 0x2c

	)

105 
	#PCI_SUBSYSTEM_ID
 0x2e

	)

106 
	#PCI_ROM_ADDRESS
 0x30

	)

107 
	#PCI_ROM_ADDRESS_ENABLE
 0x01

	)

108 
	#PCI_ROM_ADDRESS_MASK
 (~0x7ffUL)

	)

110 
	#PCI_CAPABILITY_LIST
 0x34

	)

113 
	#PCI_INTERRUPT_LINE
 0x3¯

	)

114 
	#PCI_INTERRUPT_PIN
 0x3d

	)

115 
	#PCI_MIN_GNT
 0x3ê

	)

116 
	#PCI_MAX_LAT
 0x3‡

	)

119 
	#PCI_PRIMARY_BUS
 0x18

	)

120 
	#PCI_SECONDARY_BUS
 0x19

	)

121 
	#PCI_SUBORDINATE_BUS
 0x1®

	)

122 
	#PCI_SEC_LATENCY_TIMER
 0x1b

	)

123 
	#PCI_IO_BASE
 0x1¯

	)

124 
	#PCI_IO_LIMIT
 0x1d

	)

125 
	#PCI_IO_RANGE_TYPE_MASK
 0x0fUL

	)

126 
	#PCI_IO_RANGE_TYPE_16
 0x00

	)

127 
	#PCI_IO_RANGE_TYPE_32
 0x01

	)

128 
	#PCI_IO_RANGE_MASK
 (~0x0fUL)

	)

129 
	#PCI_SEC_STATUS
 0x1ê

	)

130 
	#PCI_MEMORY_BASE
 0x20

	)

131 
	#PCI_MEMORY_LIMIT
 0x22

	)

132 
	#PCI_MEMORY_RANGE_TYPE_MASK
 0x0fUL

	)

133 
	#PCI_MEMORY_RANGE_MASK
 (~0x0fUL)

	)

134 
	#PCI_PREF_MEMORY_BASE
 0x24

	)

135 
	#PCI_PREF_MEMORY_LIMIT
 0x26

	)

136 
	#PCI_PREF_RANGE_TYPE_MASK
 0x0fUL

	)

137 
	#PCI_PREF_RANGE_TYPE_32
 0x00

	)

138 
	#PCI_PREF_RANGE_TYPE_64
 0x01

	)

139 
	#PCI_PREF_RANGE_MASK
 (~0x0fUL)

	)

140 
	#PCI_PREF_BASE_UPPER32
 0x28

	)

141 
	#PCI_PREF_LIMIT_UPPER32
 0x2c

	)

142 
	#PCI_IO_BASE_UPPER16
 0x30

	)

143 
	#PCI_IO_LIMIT_UPPER16
 0x32

	)

146 
	#PCI_ROM_ADDRESS1
 0x38

	)

148 
	#PCI_BRIDGE_CONTROL
 0x3e

	)

149 
	#PCI_BRIDGE_CTL_PARITY
 0x01

	)

150 
	#PCI_BRIDGE_CTL_SERR
 0x02

	)

151 
	#PCI_BRIDGE_CTL_ISA
 0x04

	)

152 
	#PCI_BRIDGE_CTL_VGA
 0x08

	)

153 
	#PCI_BRIDGE_CTL_MASTER_ABORT
 0x20

	)

154 
	#PCI_BRIDGE_CTL_BUS_RESET
 0x40

	)

155 
	#PCI_BRIDGE_CTL_FAST_BACK
 0x80

	)

158 
	#PCI_CB_CAPABILITY_LIST
 0x14

	)

160 
	#PCI_CB_SEC_STATUS
 0x16

	)

161 
	#PCI_CB_PRIMARY_BUS
 0x18

	)

162 
	#PCI_CB_CARD_BUS
 0x19

	)

163 
	#PCI_CB_SUBORDINATE_BUS
 0x1®

	)

164 
	#PCI_CB_LATENCY_TIMER
 0x1b

	)

165 
	#PCI_CB_MEMORY_BASE_0
 0x1c

	)

166 
	#PCI_CB_MEMORY_LIMIT_0
 0x20

	)

167 
	#PCI_CB_MEMORY_BASE_1
 0x24

	)

168 
	#PCI_CB_MEMORY_LIMIT_1
 0x28

	)

169 
	#PCI_CB_IO_BASE_0
 0x2c

	)

170 
	#PCI_CB_IO_BASE_0_HI
 0x2e

	)

171 
	#PCI_CB_IO_LIMIT_0
 0x30

	)

172 
	#PCI_CB_IO_LIMIT_0_HI
 0x32

	)

173 
	#PCI_CB_IO_BASE_1
 0x34

	)

174 
	#PCI_CB_IO_BASE_1_HI
 0x36

	)

175 
	#PCI_CB_IO_LIMIT_1
 0x38

	)

176 
	#PCI_CB_IO_LIMIT_1_HI
 0x3a

	)

177 
	#PCI_CB_IO_RANGE_MASK
 (~0x03UL)

	)

179 
	#PCI_CB_BRIDGE_CONTROL
 0x3e

	)

180 
	#PCI_CB_BRIDGE_CTL_PARITY
 0x01

	)

181 
	#PCI_CB_BRIDGE_CTL_SERR
 0x02

	)

182 
	#PCI_CB_BRIDGE_CTL_ISA
 0x04

	)

183 
	#PCI_CB_BRIDGE_CTL_VGA
 0x08

	)

184 
	#PCI_CB_BRIDGE_CTL_MASTER_ABORT
 0x20

	)

185 
	#PCI_CB_BRIDGE_CTL_CB_RESET
 0x40

	)

186 
	#PCI_CB_BRIDGE_CTL_16BIT_INT
 0x80

	)

187 
	#PCI_CB_BRIDGE_CTL_PREFETCH_MEM0
 0x100

	)

188 
	#PCI_CB_BRIDGE_CTL_PREFETCH_MEM1
 0x200

	)

189 
	#PCI_CB_BRIDGE_CTL_POST_WRITES
 0x400

	)

190 
	#PCI_CB_SUBSYSTEM_VENDOR_ID
 0x40

	)

191 
	#PCI_CB_SUBSYSTEM_ID
 0x42

	)

192 
	#PCI_CB_LEGACY_MODE_BASE
 0x44

	)

197 
	#PCI_CAP_LIST_ID
 0

	)

198 
	#PCI_CAP_ID_PM
 0x01

	)

199 
	#PCI_CAP_ID_AGP
 0x02

	)

200 
	#PCI_CAP_ID_VPD
 0x03

	)

201 
	#PCI_CAP_ID_SLOTID
 0x04

	)

202 
	#PCI_CAP_ID_MSI
 0x05

	)

203 
	#PCI_CAP_ID_CHSWP
 0x06

	)

204 
	#PCI_CAP_ID_PCIX
 0x07

	)

205 
	#PCI_CAP_ID_HT
 0x08

	)

206 
	#PCI_CAP_ID_VNDR
 0x09

	)

207 
	#PCI_CAP_ID_DBG
 0x0A

	)

208 
	#PCI_CAP_ID_CCRC
 0x0B

	)

209 
	#PCI_CAP_ID_SHPC
 0x0C

	)

210 
	#PCI_CAP_ID_SSVID
 0x0D

	)

211 
	#PCI_CAP_ID_AGP3
 0x0E

	)

212 
	#PCI_CAP_ID_EXP
 0x10

	)

213 
	#PCI_CAP_ID_MSIX
 0x11

	)

214 
	#PCI_CAP_ID_AF
 0x13

	)

215 
	#PCI_CAP_LIST_NEXT
 1

	)

216 
	#PCI_CAP_FLAGS
 2

	)

217 
	#PCI_CAP_SIZEOF
 4

	)

221 
	#PCI_PM_PMC
 2

	)

222 
	#PCI_PM_CAP_VER_MASK
 0x0007

	)

223 
	#PCI_PM_CAP_PME_CLOCK
 0x0008

	)

224 
	#PCI_PM_CAP_RESERVED
 0x0010

	)

225 
	#PCI_PM_CAP_DSI
 0x0020

	)

226 
	#PCI_PM_CAP_AUX_POWER
 0x01C0

	)

227 
	#PCI_PM_CAP_D1
 0x0200

	)

228 
	#PCI_PM_CAP_D2
 0x0400

	)

229 
	#PCI_PM_CAP_PME
 0x0800

	)

230 
	#PCI_PM_CAP_PME_MASK
 0xF800

	)

231 
	#PCI_PM_CAP_PME_D0
 0x0800

	)

232 
	#PCI_PM_CAP_PME_D1
 0x1000

	)

233 
	#PCI_PM_CAP_PME_D2
 0x2000

	)

234 
	#PCI_PM_CAP_PME_D3
 0x4000

	)

235 
	#PCI_PM_CAP_PME_D3cﬁd
 0x8000

	)

236 
	#PCI_PM_CAP_PME_SHIFT
 11

	)

237 
	#PCI_PM_CTRL
 4

	)

238 
	#PCI_PM_CTRL_STATE_MASK
 0x0003

	)

239 
	#PCI_PM_CTRL_NO_SOFT_RESET
 0x0008

	)

240 
	#PCI_PM_CTRL_PME_ENABLE
 0x0100

	)

241 
	#PCI_PM_CTRL_DATA_SEL_MASK
 0x1e00

	)

242 
	#PCI_PM_CTRL_DATA_SCALE_MASK
 0x6000

	)

243 
	#PCI_PM_CTRL_PME_STATUS
 0x8000

	)

244 
	#PCI_PM_PPB_EXTENSIONS
 6

	)

245 
	#PCI_PM_PPB_B2_B3
 0x40

	)

246 
	#PCI_PM_BPCC_ENABLE
 0x80

	)

247 
	#PCI_PM_DATA_REGISTER
 7

	)

248 
	#PCI_PM_SIZEOF
 8

	)

252 
	#PCI_AGP_VERSION
 2

	)

253 
	#PCI_AGP_RFU
 3

	)

254 
	#PCI_AGP_STATUS
 4

	)

255 
	#PCI_AGP_STATUS_RQ_MASK
 0xff000000

	)

256 
	#PCI_AGP_STATUS_SBA
 0x0200

	)

257 
	#PCI_AGP_STATUS_64BIT
 0x0020

	)

258 
	#PCI_AGP_STATUS_FW
 0x0010

	)

259 
	#PCI_AGP_STATUS_RATE4
 0x0004

	)

260 
	#PCI_AGP_STATUS_RATE2
 0x0002

	)

261 
	#PCI_AGP_STATUS_RATE1
 0x0001

	)

262 
	#PCI_AGP_COMMAND
 8

	)

263 
	#PCI_AGP_COMMAND_RQ_MASK
 0xff000000

	)

264 
	#PCI_AGP_COMMAND_SBA
 0x0200

	)

265 
	#PCI_AGP_COMMAND_AGP
 0x0100

	)

266 
	#PCI_AGP_COMMAND_64BIT
 0x0020

	)

267 
	#PCI_AGP_COMMAND_FW
 0x0010

	)

268 
	#PCI_AGP_COMMAND_RATE4
 0x0004

	)

269 
	#PCI_AGP_COMMAND_RATE2
 0x0002

	)

270 
	#PCI_AGP_COMMAND_RATE1
 0x0001

	)

271 
	#PCI_AGP_SIZEOF
 12

	)

275 
	#PCI_VPD_ADDR
 2

	)

276 
	#PCI_VPD_ADDR_MASK
 0x7ff‡

	)

277 
	#PCI_VPD_ADDR_F
 0x8000

	)

278 
	#PCI_VPD_DATA
 4

	)

282 
	#PCI_SID_ESR
 2

	)

283 
	#PCI_SID_ESR_NSLOTS
 0x1‡

	)

284 
	#PCI_SID_ESR_FIC
 0x20

	)

285 
	#PCI_SID_CHASSIS_NR
 3

	)

289 
	#PCI_MSI_FLAGS
 2

	)

290 
	#PCI_MSI_FLAGS_64BIT
 0x80

	)

291 
	#PCI_MSI_FLAGS_QSIZE
 0x70

	)

292 
	#PCI_MSI_FLAGS_QMASK
 0x0ê

	)

293 
	#PCI_MSI_FLAGS_ENABLE
 0x01

	)

294 
	#PCI_MSI_FLAGS_MASKBIT
 0x100

	)

295 
	#PCI_MSI_RFU
 3

	)

296 
	#PCI_MSI_ADDRESS_LO
 4

	)

297 
	#PCI_MSI_ADDRESS_HI
 8

	)

298 
	#PCI_MSI_DATA_32
 8

	)

299 
	#PCI_MSI_MASK_32
 12

	)

300 
	#PCI_MSI_DATA_64
 12

	)

301 
	#PCI_MSI_MASK_64
 16

	)

304 
	#PCI_MSIX_FLAGS
 2

	)

305 
	#PCI_MSIX_FLAGS_QSIZE
 0x7FF

	)

306 
	#PCI_MSIX_FLAGS_ENABLE
 (1 << 15)

	)

307 
	#PCI_MSIX_FLAGS_MASKALL
 (1 << 14)

	)

308 
	#PCI_MSIX_TABLE
 4

	)

309 
	#PCI_MSIX_PBA
 8

	)

310 
	#PCI_MSIX_FLAGS_BIRMASK
 (7 << 0)

	)

313 
	#PCI_MSIX_ENTRY_SIZE
 16

	)

314 
	#PCI_MSIX_ENTRY_LOWER_ADDR
 0

	)

315 
	#PCI_MSIX_ENTRY_UPPER_ADDR
 4

	)

316 
	#PCI_MSIX_ENTRY_DATA
 8

	)

317 
	#PCI_MSIX_ENTRY_VECTOR_CTRL
 12

	)

318 
	#PCI_MSIX_ENTRY_CTRL_MASKBIT
 1

	)

322 
	#PCI_CHSWP_CSR
 2

	)

323 
	#PCI_CHSWP_DHA
 0x01

	)

324 
	#PCI_CHSWP_EIM
 0x02

	)

325 
	#PCI_CHSWP_PIE
 0x04

	)

326 
	#PCI_CHSWP_LOO
 0x08

	)

327 
	#PCI_CHSWP_PI
 0x30

	)

328 
	#PCI_CHSWP_EXT
 0x40

	)

329 
	#PCI_CHSWP_INS
 0x80

	)

333 
	#PCI_AF_LENGTH
 2

	)

334 
	#PCI_AF_CAP
 3

	)

335 
	#PCI_AF_CAP_TP
 0x01

	)

336 
	#PCI_AF_CAP_FLR
 0x02

	)

337 
	#PCI_AF_CTRL
 4

	)

338 
	#PCI_AF_CTRL_FLR
 0x01

	)

339 
	#PCI_AF_STATUS
 5

	)

340 
	#PCI_AF_STATUS_TP
 0x01

	)

344 
	#PCI_X_CMD
 2

	)

345 
	#PCI_X_CMD_DPERR_E
 0x0001

	)

346 
	#PCI_X_CMD_ERO
 0x0002

	)

347 
	#PCI_X_CMD_READ_512
 0x0000

	)

348 
	#PCI_X_CMD_READ_1K
 0x0004

	)

349 
	#PCI_X_CMD_READ_2K
 0x0008

	)

350 
	#PCI_X_CMD_READ_4K
 0x000¯

	)

351 
	#PCI_X_CMD_MAX_READ
 0x000¯

	)

353 
	#PCI_X_CMD_SPLIT_1
 0x0000

	)

354 
	#PCI_X_CMD_SPLIT_2
 0x0010

	)

355 
	#PCI_X_CMD_SPLIT_3
 0x0020

	)

356 
	#PCI_X_CMD_SPLIT_4
 0x0030

	)

357 
	#PCI_X_CMD_SPLIT_8
 0x0040

	)

358 
	#PCI_X_CMD_SPLIT_12
 0x0050

	)

359 
	#PCI_X_CMD_SPLIT_16
 0x0060

	)

360 
	#PCI_X_CMD_SPLIT_32
 0x0070

	)

361 
	#PCI_X_CMD_MAX_SPLIT
 0x0070

	)

362 
	#PCI_X_CMD_VERSION
(
x
Ë(((xË>> 12Ë& 3Ë

	)

363 
	#PCI_X_STATUS
 4

	)

364 
	#PCI_X_STATUS_DEVFN
 0x000000f‡

	)

365 
	#PCI_X_STATUS_BUS
 0x0000ff00

	)

366 
	#PCI_X_STATUS_64BIT
 0x00010000

	)

367 
	#PCI_X_STATUS_133MHZ
 0x00020000

	)

368 
	#PCI_X_STATUS_SPL_DISC
 0x00040000

	)

369 
	#PCI_X_STATUS_UNX_SPL
 0x00080000

	)

370 
	#PCI_X_STATUS_COMPLEX
 0x00100000

	)

371 
	#PCI_X_STATUS_MAX_READ
 0x00600000

	)

372 
	#PCI_X_STATUS_MAX_SPLIT
 0x03800000

	)

373 
	#PCI_X_STATUS_MAX_CUM
 0x1c000000

	)

374 
	#PCI_X_STATUS_SPL_ERR
 0x20000000

	)

375 
	#PCI_X_STATUS_266MHZ
 0x40000000

	)

376 
	#PCI_X_STATUS_533MHZ
 0x80000000

	)

380 
	#PCI_SSVID_VENDOR_ID
 4

	)

381 
	#PCI_SSVID_DEVICE_ID
 6

	)

385 
	#PCI_EXP_FLAGS
 2

	)

386 
	#PCI_EXP_FLAGS_VERS
 0x000‡

	)

387 
	#PCI_EXP_FLAGS_TYPE
 0x00f0

	)

388 
	#PCI_EXP_TYPE_ENDPOINT
 0x0

	)

389 
	#PCI_EXP_TYPE_LEG_END
 0x1

	)

390 
	#PCI_EXP_TYPE_ROOT_PORT
 0x4

	)

391 
	#PCI_EXP_TYPE_UPSTREAM
 0x5

	)

392 
	#PCI_EXP_TYPE_DOWNSTREAM
 0x6

	)

393 
	#PCI_EXP_TYPE_PCI_BRIDGE
 0x7

	)

394 
	#PCI_EXP_TYPE_RC_END
 0x9

	)

395 
	#PCI_EXP_TYPE_RC_EC
 0x10

	)

396 
	#PCI_EXP_FLAGS_SLOT
 0x0100

	)

397 
	#PCI_EXP_FLAGS_IRQ
 0x3e00

	)

398 
	#PCI_EXP_DEVCAP
 4

	)

399 
	#PCI_EXP_DEVCAP_PAYLOAD
 0x07

	)

400 
	#PCI_EXP_DEVCAP_PHANTOM
 0x18

	)

401 
	#PCI_EXP_DEVCAP_EXT_TAG
 0x20

	)

402 
	#PCI_EXP_DEVCAP_L0S
 0x1c0

	)

403 
	#PCI_EXP_DEVCAP_L1
 0xe00

	)

404 
	#PCI_EXP_DEVCAP_ATN_BUT
 0x1000

	)

405 
	#PCI_EXP_DEVCAP_ATN_IND
 0x2000

	)

406 
	#PCI_EXP_DEVCAP_PWR_IND
 0x4000

	)

407 
	#PCI_EXP_DEVCAP_RBER
 0x8000

	)

408 
	#PCI_EXP_DEVCAP_PWR_VAL
 0x3fc0000

	)

409 
	#PCI_EXP_DEVCAP_PWR_SCL
 0xc000000

	)

410 
	#PCI_EXP_DEVCAP_FLR
 0x10000000

	)

411 
	#PCI_EXP_DEVCTL
 8

	)

412 
	#PCI_EXP_DEVCTL_CERE
 0x0001

	)

413 
	#PCI_EXP_DEVCTL_NFERE
 0x0002

	)

414 
	#PCI_EXP_DEVCTL_FERE
 0x0004

	)

415 
	#PCI_EXP_DEVCTL_URRE
 0x0008

	)

416 
	#PCI_EXP_DEVCTL_RELAX_EN
 0x0010

	)

417 
	#PCI_EXP_DEVCTL_PAYLOAD
 0x00e0

	)

418 
	#PCI_EXP_DEVCTL_EXT_TAG
 0x0100

	)

419 
	#PCI_EXP_DEVCTL_PHANTOM
 0x0200

	)

420 
	#PCI_EXP_DEVCTL_AUX_PME
 0x0400

	)

421 
	#PCI_EXP_DEVCTL_NOSNOOP_EN
 0x0800

	)

422 
	#PCI_EXP_DEVCTL_READRQ
 0x7000

	)

423 
	#PCI_EXP_DEVCTL_BCR_FLR
 0x8000

	)

424 
	#PCI_EXP_DEVSTA
 10

	)

425 
	#PCI_EXP_DEVSTA_CED
 0x01

	)

426 
	#PCI_EXP_DEVSTA_NFED
 0x02

	)

427 
	#PCI_EXP_DEVSTA_FED
 0x04

	)

428 
	#PCI_EXP_DEVSTA_URD
 0x08

	)

429 
	#PCI_EXP_DEVSTA_AUXPD
 0x10

	)

430 
	#PCI_EXP_DEVSTA_TRPND
 0x20

	)

431 
	#PCI_EXP_LNKCAP
 12

	)

432 
	#PCI_EXP_LNKCAP_SLS
 0x0000000‡

	)

433 
	#PCI_EXP_LNKCAP_MLW
 0x000003f0

	)

434 
	#PCI_EXP_LNKCAP_ASPMS
 0x00000c00

	)

435 
	#PCI_EXP_LNKCAP_L0SEL
 0x00007000

	)

436 
	#PCI_EXP_LNKCAP_L1EL
 0x00038000

	)

437 
	#PCI_EXP_LNKCAP_CLKPM
 0x00040000

	)

438 
	#PCI_EXP_LNKCAP_SDERC
 0x00080000

	)

439 
	#PCI_EXP_LNKCAP_DLLLARC
 0x00100000

	)

440 
	#PCI_EXP_LNKCAP_LBNC
 0x00200000

	)

441 
	#PCI_EXP_LNKCAP_PN
 0xff000000

	)

442 
	#PCI_EXP_LNKCTL
 16

	)

443 
	#PCI_EXP_LNKCTL_ASPMC
 0x0003

	)

444 
	#PCI_EXP_LNKCTL_RCB
 0x0008

	)

445 
	#PCI_EXP_LNKCTL_LD
 0x0010

	)

446 
	#PCI_EXP_LNKCTL_RL
 0x0020

	)

447 
	#PCI_EXP_LNKCTL_CCC
 0x0040

	)

448 
	#PCI_EXP_LNKCTL_ES
 0x0080

	)

449 
	#PCI_EXP_LNKCTL_CLKREQ_EN
 0x100

	)

450 
	#PCI_EXP_LNKCTL_HAWD
 0x0200

	)

451 
	#PCI_EXP_LNKCTL_LBMIE
 0x0400

	)

452 
	#PCI_EXP_LNKCTL_LABIE
 0x0800

	)

453 
	#PCI_EXP_LNKSTA
 18

	)

454 
	#PCI_EXP_LNKSTA_CLS
 0x000‡

	)

455 
	#PCI_EXP_LNKSTA_CLS_2_5GB
 0x01

	)

456 
	#PCI_EXP_LNKSTA_CLS_5_0GB
 0x02

	)

457 
	#PCI_EXP_LNKSTA_NLW
 0x03f0

	)

458 
	#PCI_EXP_LNKSTA_NLW_SHIFT
 4

	)

459 
	#PCI_EXP_LNKSTA_LT
 0x0800

	)

460 
	#PCI_EXP_LNKSTA_SLC
 0x1000

	)

461 
	#PCI_EXP_LNKSTA_DLLLA
 0x2000

	)

462 
	#PCI_EXP_LNKSTA_LBMS
 0x4000

	)

463 
	#PCI_EXP_LNKSTA_LABS
 0x8000

	)

464 
	#PCI_EXP_SLTCAP
 20

	)

465 
	#PCI_EXP_SLTCAP_ABP
 0x00000001

	)

466 
	#PCI_EXP_SLTCAP_PCP
 0x00000002

	)

467 
	#PCI_EXP_SLTCAP_MRLSP
 0x00000004

	)

468 
	#PCI_EXP_SLTCAP_AIP
 0x00000008

	)

469 
	#PCI_EXP_SLTCAP_PIP
 0x00000010

	)

470 
	#PCI_EXP_SLTCAP_HPS
 0x00000020

	)

471 
	#PCI_EXP_SLTCAP_HPC
 0x00000040

	)

472 
	#PCI_EXP_SLTCAP_SPLV
 0x00007f80

	)

473 
	#PCI_EXP_SLTCAP_SPLS
 0x00018000

	)

474 
	#PCI_EXP_SLTCAP_EIP
 0x00020000

	)

475 
	#PCI_EXP_SLTCAP_NCCS
 0x00040000

	)

476 
	#PCI_EXP_SLTCAP_PSN
 0xfff80000

	)

477 
	#PCI_EXP_SLTCTL
 24

	)

478 
	#PCI_EXP_SLTCTL_ABPE
 0x0001

	)

479 
	#PCI_EXP_SLTCTL_PFDE
 0x0002

	)

480 
	#PCI_EXP_SLTCTL_MRLSCE
 0x0004

	)

481 
	#PCI_EXP_SLTCTL_PDCE
 0x0008

	)

482 
	#PCI_EXP_SLTCTL_CCIE
 0x0010

	)

483 
	#PCI_EXP_SLTCTL_HPIE
 0x0020

	)

484 
	#PCI_EXP_SLTCTL_AIC
 0x00c0

	)

485 
	#PCI_EXP_SLTCTL_PIC
 0x0300

	)

486 
	#PCI_EXP_SLTCTL_PCC
 0x0400

	)

487 
	#PCI_EXP_SLTCTL_EIC
 0x0800

	)

488 
	#PCI_EXP_SLTCTL_DLLSCE
 0x1000

	)

489 
	#PCI_EXP_SLTSTA
 26

	)

490 
	#PCI_EXP_SLTSTA_ABP
 0x0001

	)

491 
	#PCI_EXP_SLTSTA_PFD
 0x0002

	)

492 
	#PCI_EXP_SLTSTA_MRLSC
 0x0004

	)

493 
	#PCI_EXP_SLTSTA_PDC
 0x0008

	)

494 
	#PCI_EXP_SLTSTA_CC
 0x0010

	)

495 
	#PCI_EXP_SLTSTA_MRLSS
 0x0020

	)

496 
	#PCI_EXP_SLTSTA_PDS
 0x0040

	)

497 
	#PCI_EXP_SLTSTA_EIS
 0x0080

	)

498 
	#PCI_EXP_SLTSTA_DLLSC
 0x0100

	)

499 
	#PCI_EXP_RTCTL
 28

	)

500 
	#PCI_EXP_RTCTL_SECEE
 0x01

	)

501 
	#PCI_EXP_RTCTL_SENFEE
 0x02

	)

502 
	#PCI_EXP_RTCTL_SEFEE
 0x04

	)

503 
	#PCI_EXP_RTCTL_PMEIE
 0x08

	)

504 
	#PCI_EXP_RTCTL_CRSSVE
 0x10

	)

505 
	#PCI_EXP_RTCAP
 30

	)

506 
	#PCI_EXP_RTSTA
 32

	)

507 
	#PCI_EXP_RTSTA_PME
 0x10000

	)

508 
	#PCI_EXP_RTSTA_PENDING
 0x20000

	)

509 
	#PCI_EXP_DEVCAP2
 36

	)

510 
	#PCI_EXP_DEVCAP2_ARI
 0x20

	)

511 
	#PCI_EXP_DEVCAP2_LTR
 0x800

	)

512 
	#PCI_EXP_OBFF_MASK
 0xc0000

	)

513 
	#PCI_EXP_OBFF_MSG
 0x40000

	)

514 
	#PCI_EXP_OBFF_WAKE
 0x80000

	)

515 
	#PCI_EXP_DEVCTL2
 40

	)

516 
	#PCI_EXP_DEVCTL2_ARI
 0x20

	)

517 
	#PCI_EXP_IDO_REQ_EN
 0x100

	)

518 
	#PCI_EXP_IDO_CMP_EN
 0x200

	)

519 
	#PCI_EXP_LTR_EN
 0x400

	)

520 
	#PCI_EXP_OBFF_MSGA_EN
 0x2000

	)

521 
	#PCI_EXP_OBFF_MSGB_EN
 0x4000

	)

522 
	#PCI_EXP_OBFF_WAKE_EN
 0x6000

	)

523 
	#PCI_EXP_LNKCTL2
 48

	)

524 
	#PCI_EXP_SLTCTL2
 56

	)

527 
	#PCI_EXT_CAP_ID
(
hódî
Ë(hódî & 0x0000ffff)

	)

528 
	#PCI_EXT_CAP_VER
(
hódî
Ë((hódî >> 16Ë& 0xf)

	)

529 
	#PCI_EXT_CAP_NEXT
(
hódî
Ë((hódî >> 20Ë& 0xffc)

	)

531 
	#PCI_EXT_CAP_ID_ERR
 1

	)

532 
	#PCI_EXT_CAP_ID_VC
 2

	)

533 
	#PCI_EXT_CAP_ID_DSN
 3

	)

534 
	#PCI_EXT_CAP_ID_PWR
 4

	)

535 
	#PCI_EXT_CAP_ID_VNDR
 11

	)

536 
	#PCI_EXT_CAP_ID_ACS
 13

	)

537 
	#PCI_EXT_CAP_ID_ARI
 14

	)

538 
	#PCI_EXT_CAP_ID_ATS
 15

	)

539 
	#PCI_EXT_CAP_ID_SRIOV
 16

	)

540 
	#PCI_EXT_CAP_ID_LTR
 24

	)

543 
	#PCI_ERR_UNCOR_STATUS
 4

	)

544 
	#PCI_ERR_UNC_TRAIN
 0x00000001

	)

545 
	#PCI_ERR_UNC_DLP
 0x00000010

	)

546 
	#PCI_ERR_UNC_POISON_TLP
 0x00001000

	)

547 
	#PCI_ERR_UNC_FCP
 0x00002000

	)

548 
	#PCI_ERR_UNC_COMP_TIME
 0x00004000

	)

549 
	#PCI_ERR_UNC_COMP_ABORT
 0x00008000

	)

550 
	#PCI_ERR_UNC_UNX_COMP
 0x00010000

	)

551 
	#PCI_ERR_UNC_RX_OVER
 0x00020000

	)

552 
	#PCI_ERR_UNC_MALF_TLP
 0x00040000

	)

553 
	#PCI_ERR_UNC_ECRC
 0x00080000

	)

554 
	#PCI_ERR_UNC_UNSUP
 0x00100000

	)

555 
	#PCI_ERR_UNCOR_MASK
 8

	)

557 
	#PCI_ERR_UNCOR_SEVER
 12

	)

559 
	#PCI_ERR_COR_STATUS
 16

	)

560 
	#PCI_ERR_COR_RCVR
 0x00000001

	)

561 
	#PCI_ERR_COR_BAD_TLP
 0x00000040

	)

562 
	#PCI_ERR_COR_BAD_DLLP
 0x00000080

	)

563 
	#PCI_ERR_COR_REP_ROLL
 0x00000100

	)

564 
	#PCI_ERR_COR_REP_TIMER
 0x00001000

	)

565 
	#PCI_ERR_COR_MASK
 20

	)

567 
	#PCI_ERR_CAP
 24

	)

568 
	#PCI_ERR_CAP_FEP
(
x
Ë((xË& 31Ë

	)

569 
	#PCI_ERR_CAP_ECRC_GENC
 0x00000020

	)

570 
	#PCI_ERR_CAP_ECRC_GENE
 0x00000040

	)

571 
	#PCI_ERR_CAP_ECRC_CHKC
 0x00000080

	)

572 
	#PCI_ERR_CAP_ECRC_CHKE
 0x00000100

	)

573 
	#PCI_ERR_HEADER_LOG
 28

	)

574 
	#PCI_ERR_ROOT_COMMAND
 44

	)

576 
	#PCI_ERR_ROOT_CMD_COR_EN
 0x00000001

	)

578 
	#PCI_ERR_ROOT_CMD_NONFATAL_EN
 0x00000002

	)

580 
	#PCI_ERR_ROOT_CMD_FATAL_EN
 0x00000004

	)

581 
	#PCI_ERR_ROOT_STATUS
 48

	)

582 
	#PCI_ERR_ROOT_COR_RCV
 0x00000001

	)

584 
	#PCI_ERR_ROOT_MULTI_COR_RCV
 0x00000002

	)

586 
	#PCI_ERR_ROOT_UNCOR_RCV
 0x00000004

	)

588 
	#PCI_ERR_ROOT_MULTI_UNCOR_RCV
 0x00000008

	)

589 
	#PCI_ERR_ROOT_FIRST_FATAL
 0x00000010

	)

590 
	#PCI_ERR_ROOT_NONFATAL_RCV
 0x00000020

	)

591 
	#PCI_ERR_ROOT_FATAL_RCV
 0x00000040

	)

592 
	#PCI_ERR_ROOT_ERR_SRC
 52

	)

595 
	#PCI_VC_PORT_REG1
 4

	)

596 
	#PCI_VC_PORT_REG2
 8

	)

597 
	#PCI_VC_PORT_CTRL
 12

	)

598 
	#PCI_VC_PORT_STATUS
 14

	)

599 
	#PCI_VC_RES_CAP
 16

	)

600 
	#PCI_VC_RES_CTRL
 20

	)

601 
	#PCI_VC_RES_STATUS
 26

	)

604 
	#PCI_PWR_DSR
 4

	)

605 
	#PCI_PWR_DATA
 8

	)

606 
	#PCI_PWR_DATA_BASE
(
x
Ë((xË& 0xffË

	)

607 
	#PCI_PWR_DATA_SCALE
(
x
Ë(((xË>> 8Ë& 3Ë

	)

608 
	#PCI_PWR_DATA_PM_SUB
(
x
Ë(((xË>> 10Ë& 7Ë

	)

609 
	#PCI_PWR_DATA_PM_STATE
(
x
Ë(((xË>> 13Ë& 3Ë

	)

610 
	#PCI_PWR_DATA_TYPE
(
x
Ë(((xË>> 15Ë& 7Ë

	)

611 
	#PCI_PWR_DATA_RAIL
(
x
Ë(((xË>> 18Ë& 7Ë

	)

612 
	#PCI_PWR_CAP
 12

	)

613 
	#PCI_PWR_CAP_BUDGET
(
x
Ë((xË& 1Ë

	)

623 
	#HT_3BIT_CAP_MASK
 0xE0

	)

624 
	#HT_CAPTYPE_SLAVE
 0x00

	)

625 
	#HT_CAPTYPE_HOST
 0x20

	)

627 
	#HT_5BIT_CAP_MASK
 0xF8

	)

628 
	#HT_CAPTYPE_IRQ
 0x80

	)

629 
	#HT_CAPTYPE_REMAPPING_40
 0xA0

	)

630 
	#HT_CAPTYPE_REMAPPING_64
 0xA2

	)

631 
	#HT_CAPTYPE_UNITID_CLUMP
 0x90

	)

632 
	#HT_CAPTYPE_EXTCONF
 0x98

	)

633 
	#HT_CAPTYPE_MSI_MAPPING
 0xA8

	)

634 
	#HT_MSI_FLAGS
 0x02

	)

635 
	#HT_MSI_FLAGS_ENABLE
 0x1

	)

636 
	#HT_MSI_FLAGS_FIXED
 0x2

	)

637 
	#HT_MSI_FIXED_ADDR
 0x00000000FEE00000ULL

	)

638 
	#HT_MSI_ADDR_LO
 0x04

	)

639 
	#HT_MSI_ADDR_LO_MASK
 0xFFF00000

	)

640 
	#HT_MSI_ADDR_HI
 0x08

	)

641 
	#HT_CAPTYPE_DIRECT_ROUTE
 0xB0

	)

642 
	#HT_CAPTYPE_VCSET
 0xB8

	)

643 
	#HT_CAPTYPE_ERROR_RETRY
 0xC0

	)

644 
	#HT_CAPTYPE_GEN3
 0xD0

	)

645 
	#HT_CAPTYPE_PM
 0xE0

	)

648 
	#PCI_ARI_CAP
 0x04

	)

649 
	#PCI_ARI_CAP_MFVC
 0x0001

	)

650 
	#PCI_ARI_CAP_ACS
 0x0002

	)

651 
	#PCI_ARI_CAP_NFN
(
x
Ë(((xË>> 8Ë& 0xffË

	)

652 
	#PCI_ARI_CTRL
 0x06

	)

653 
	#PCI_ARI_CTRL_MFVC
 0x0001

	)

654 
	#PCI_ARI_CTRL_ACS
 0x0002

	)

655 
	#PCI_ARI_CTRL_FG
(
x
Ë(((xË>> 4Ë& 7Ë

	)

658 
	#PCI_ATS_CAP
 0x04

	)

659 
	#PCI_ATS_CAP_QDEP
(
x
Ë((xË& 0x1fË

	)

660 
	#PCI_ATS_MAX_QDEP
 32

	)

661 
	#PCI_ATS_CTRL
 0x06

	)

662 
	#PCI_ATS_CTRL_ENABLE
 0x8000

	)

663 
	#PCI_ATS_CTRL_STU
(
x
Ë((xË& 0x1fË

	)

664 
	#PCI_ATS_MIN_STU
 12

	)

667 
	#PCI_SRIOV_CAP
 0x04

	)

668 
	#PCI_SRIOV_CAP_VFM
 0x01

	)

669 
	#PCI_SRIOV_CAP_INTR
(
x
Ë((xË>> 21Ë

	)

670 
	#PCI_SRIOV_CTRL
 0x08

	)

671 
	#PCI_SRIOV_CTRL_VFE
 0x01

	)

672 
	#PCI_SRIOV_CTRL_VFM
 0x02

	)

673 
	#PCI_SRIOV_CTRL_INTR
 0x04

	)

674 
	#PCI_SRIOV_CTRL_MSE
 0x08

	)

675 
	#PCI_SRIOV_CTRL_ARI
 0x10

	)

676 
	#PCI_SRIOV_STATUS
 0x0®

	)

677 
	#PCI_SRIOV_STATUS_VFM
 0x01

	)

678 
	#PCI_SRIOV_INITIAL_VF
 0x0¯

	)

679 
	#PCI_SRIOV_TOTAL_VF
 0x0ê

	)

680 
	#PCI_SRIOV_NUM_VF
 0x10

	)

681 
	#PCI_SRIOV_FUNC_LINK
 0x12

	)

682 
	#PCI_SRIOV_VF_OFFSET
 0x14

	)

683 
	#PCI_SRIOV_VF_STRIDE
 0x16

	)

684 
	#PCI_SRIOV_VF_DID
 0x1®

	)

685 
	#PCI_SRIOV_SUP_PGSIZE
 0x1¯

	)

686 
	#PCI_SRIOV_SYS_PGSIZE
 0x20

	)

687 
	#PCI_SRIOV_BAR
 0x24

	)

688 
	#PCI_SRIOV_NUM_BARS
 6

	)

689 
	#PCI_SRIOV_VFM
 0x3¯

	)

690 
	#PCI_SRIOV_VFM_BIR
(
x
Ë((xË& 7Ë

	)

691 
	#PCI_SRIOV_VFM_OFFSET
(
x
Ë((xË& ~7Ë

	)

692 
	#PCI_SRIOV_VFM_UA
 0x0

	)

693 
	#PCI_SRIOV_VFM_MI
 0x1

	)

694 
	#PCI_SRIOV_VFM_MO
 0x2

	)

695 
	#PCI_SRIOV_VFM_AV
 0x3

	)

697 
	#PCI_LTR_MAX_SNOOP_LAT
 0x4

	)

698 
	#PCI_LTR_MAX_NOSNOOP_LAT
 0x6

	)

699 
	#PCI_LTR_VALUE_MASK
 0x000003ff

	)

700 
	#PCI_LTR_SCALE_MASK
 0x00001c00

	)

701 
	#PCI_LTR_SCALE_SHIFT
 10

	)

704 
	#PCI_ACS_CAP
 0x04

	)

705 
	#PCI_ACS_SV
 0x01

	)

706 
	#PCI_ACS_TB
 0x02

	)

707 
	#PCI_ACS_RR
 0x04

	)

708 
	#PCI_ACS_CR
 0x08

	)

709 
	#PCI_ACS_UF
 0x10

	)

710 
	#PCI_ACS_EC
 0x20

	)

711 
	#PCI_ACS_DT
 0x40

	)

712 
	#PCI_ACS_CTRL
 0x06

	)

713 
	#PCI_ACS_EGRESS_CTL_V
 0x08

	)

	@/usr/include/linux/posix_types.h

1 #i‚de‡
_LINUX_POSIX_TYPES_H


2 
	#_LINUX_POSIX_TYPES_H


	)

4 
	~<löux/°ddef.h
>

21 #unde‡
__NFDBITS


22 
	#__NFDBITS
 (8 * ())

	)

24 #unde‡
__FD_SETSIZE


25 
	#__FD_SETSIZE
 1024

	)

27 #unde‡
__FDSET_LONGS


28 
	#__FDSET_LONGS
 (
__FD_SETSIZE
/
__NFDBITS
)

	)

30 #unde‡
__FDELT


31 
	#__FDELT
(
d
Ë((dË/ 
__NFDBITS
)

	)

33 #unde‡
__FDMASK


34 
	#__FDMASK
(
d
Ë(1UL << ((dË% 
__NFDBITS
))

	)

37 
	mfds_bôs
 [
__FDSET_LONGS
];

38 } 
	t__kî√l_fd_£t
;

41 (*
	t__kî√l_sigh™dÀr_t
)();

44 
	t__kî√l_key_t
;

45 
	t__kî√l_mqd_t
;

47 
	~<asm/posix_ty≥s.h
>

	@/usr/include/linux/socket.h

1 #i‚de‡
_LINUX_SOCKET_H


2 
	#_LINUX_SOCKET_H


	)

7 
	#_K_SS_MAXSIZE
 128

	)

8 
	#_K_SS_ALIGNSIZE
 (
	`__Æignof__
 (
sockaddr
 *))

	)

11 
	t__kî√l_ß_Ámûy_t
;

13 
	s__kî√l_sockaddr_°‹age
 {

14 
__kî√l_ß_Ámûy_t
 
	mss_Ámûy
;

16 
	m__d©a
[
_K_SS_MAXSIZE
 - ()];

19 } 
__©åibuã__
 ((
Æig√d
(
_K_SS_ALIGNSIZE
)));

	@/usr/include/asm-generic/types.h

1 #i‚de‡
_ASM_GENERIC_TYPES_H


2 
	#_ASM_GENERIC_TYPES_H


	)

7 
	~<asm-gíîic/öt-Œ64.h
>

9 #i‚de‡
__ASSEMBLY__


11 
	tumode_t
;

	@/usr/include/asm/posix_types.h

1 #ifde‡
__i386__


2 
	~"posix_ty≥s_32.h
"

4 
	~"posix_ty≥s_64.h
"

	@/usr/include/linux/netlink.h

1 #i‚de‡
__LINUX_NETLINK_H


2 
	#__LINUX_NETLINK_H


	)

4 
	~<löux/sockë.h
>

5 
	~<löux/ty≥s.h
>

7 
	#NETLINK_ROUTE
 0

	)

8 
	#NETLINK_UNUSED
 1

	)

9 
	#NETLINK_USERSOCK
 2

	)

10 
	#NETLINK_FIREWALL
 3

	)

11 
	#NETLINK_INET_DIAG
 4

	)

12 
	#NETLINK_NFLOG
 5

	)

13 
	#NETLINK_XFRM
 6

	)

14 
	#NETLINK_SELINUX
 7

	)

15 
	#NETLINK_ISCSI
 8

	)

16 
	#NETLINK_AUDIT
 9

	)

17 
	#NETLINK_FIB_LOOKUP
 10

	)

18 
	#NETLINK_CONNECTOR
 11

	)

19 
	#NETLINK_NETFILTER
 12

	)

20 
	#NETLINK_IP6_FW
 13

	)

21 
	#NETLINK_DNRTMSG
 14

	)

22 
	#NETLINK_KOBJECT_UEVENT
 15

	)

23 
	#NETLINK_GENERIC
 16

	)

25 
	#NETLINK_SCSITRANSPORT
 18

	)

26 
	#NETLINK_ECRYPTFS
 19

	)

27 
	#NETLINK_RDMA
 20

	)

29 
	#MAX_LINKS
 32

	)

31 
	ssockaddr_∆
 {

32 
__kî√l_ß_Ámûy_t
 
	m∆_Ámûy
;

33 
	m∆_∑d
;

34 
__u32
 
	m∆_pid
;

35 
__u32
 
	m∆_groups
;

38 
	s∆msghdr
 {

39 
__u32
 
	m∆msg_Àn
;

40 
__u16
 
	m∆msg_ty≥
;

41 
__u16
 
	m∆msg_Êags
;

42 
__u32
 
	m∆msg_£q
;

43 
__u32
 
	m∆msg_pid
;

48 
	#NLM_F_REQUEST
 1

	)

49 
	#NLM_F_MULTI
 2

	)

50 
	#NLM_F_ACK
 4

	)

51 
	#NLM_F_ECHO
 8

	)

52 
	#NLM_F_DUMP_INTR
 16

	)

55 
	#NLM_F_ROOT
 0x100

	)

56 
	#NLM_F_MATCH
 0x200

	)

57 
	#NLM_F_ATOMIC
 0x400

	)

58 
	#NLM_F_DUMP
 (
NLM_F_ROOT
|
NLM_F_MATCH
)

	)

61 
	#NLM_F_REPLACE
 0x100

	)

62 
	#NLM_F_EXCL
 0x200

	)

63 
	#NLM_F_CREATE
 0x400

	)

64 
	#NLM_F_APPEND
 0x800

	)

75 
	#NLMSG_ALIGNTO
 4U

	)

76 
	#NLMSG_ALIGN
(
Àn
Ë–(÷í)+
NLMSG_ALIGNTO
-1Ë& ~(NLMSG_ALIGNTO-1Ë)

	)

77 
	#NLMSG_HDRLEN
 ((Ë
	`NLMSG_ALIGN
((
∆msghdr
)))

	)

78 
	#NLMSG_LENGTH
(
Àn
Ë(÷í)+
	`NLMSG_ALIGN
(
NLMSG_HDRLEN
))

	)

79 
	#NLMSG_SPACE
(
Àn
Ë
	`NLMSG_ALIGN
(
	`NLMSG_LENGTH
÷í))

	)

80 
	#NLMSG_DATA
(
∆h
Ë((*)(((*ÍlhË+ 
	`NLMSG_LENGTH
(0)))

	)

81 
	#NLMSG_NEXT
(
∆h
,
Àn
Ë(÷íË-
	`NLMSG_ALIGN
(“lh)->
∆msg_Àn
), \

82 (
∆msghdr
*)(((*)(
∆h
)Ë+ 
	`NLMSG_ALIGN
(“lh)->
∆msg_Àn
)))

	)

83 
	#NLMSG_OK
(
∆h
,
Àn
Ë(÷íË>()(
∆msghdr
) && \

84 (
∆h
)->
∆msg_Àn
 >(
∆msghdr
) && \

85 (
∆h
)->
∆msg_Àn
 <(
Àn
))

	)

86 
	#NLMSG_PAYLOAD
(
∆h
,
Àn
Ë(“lh)->
∆msg_Àn
 - 
	`NLMSG_SPACE
(÷í)))

	)

88 
	#NLMSG_NOOP
 0x1

	)

89 
	#NLMSG_ERROR
 0x2

	)

90 
	#NLMSG_DONE
 0x3

	)

91 
	#NLMSG_OVERRUN
 0x4

	)

93 
	#NLMSG_MIN_TYPE
 0x10

	)

95 
	s∆msgîr
 {

96 
	mîr‹
;

97 
∆msghdr
 
	mmsg
;

100 
	#NETLINK_ADD_MEMBERSHIP
 1

	)

101 
	#NETLINK_DROP_MEMBERSHIP
 2

	)

102 
	#NETLINK_PKTINFO
 3

	)

103 
	#NETLINK_BROADCAST_ERROR
 4

	)

104 
	#NETLINK_NO_ENOBUFS
 5

	)

106 
	s∆_pktöfo
 {

107 
__u32
 
	mgroup
;

110 
	#NET_MAJOR
 36

	)

113 
	mNETLINK_UNCONNECTED
 = 0,

114 
	mNETLINK_CONNECTED
,

126 
	s∆©å
 {

127 
__u16
 
	m∆a_Àn
;

128 
__u16
 
	m∆a_ty≥
;

141 
	#NLA_F_NESTED
 (1 << 15)

	)

142 
	#NLA_F_NET_BYTEORDER
 (1 << 14)

	)

143 
	#NLA_TYPE_MASK
 ~(
NLA_F_NESTED
 | 
NLA_F_NET_BYTEORDER
)

	)

145 
	#NLA_ALIGNTO
 4

	)

146 
	#NLA_ALIGN
(
Àn
Ë((÷íË+ 
NLA_ALIGNTO
 - 1Ë& ~(NLA_ALIGNTO - 1))

	)

147 
	#NLA_HDRLEN
 ((Ë
	`NLA_ALIGN
((
∆©å
)))

	)

	@/usr/include/linux/stddef.h

1 #i‚de‡
_LINUX_STDDEF_H


2 
	#_LINUX_STDDEF_H


	)

6 #unde‡
NULL


7 #i‡
deföed
(
__˝lu•lus
)

8 
	#NULL
 0

	)

10 
	#NULL
 ((*)0)

	)

	@/usr/include/asm-generic/int-ll64.h

8 #i‚de‡
_ASM_GENERIC_INT_LL64_H


9 
	#_ASM_GENERIC_INT_LL64_H


	)

11 
	~<asm/bô•îl⁄g.h
>

13 #i‚de‡
__ASSEMBLY__


19 
__sig√d__
 
	t__s8
;

20 
	t__u8
;

22 
__sig√d__
 
	t__s16
;

23 
	t__u16
;

25 
__sig√d__
 
	t__s32
;

26 
	t__u32
;

28 #ifde‡
__GNUC__


29 
__exãnsi⁄__
 
__sig√d__
 
	t__s64
;

30 
__exãnsi⁄__
 
	t__u64
;

32 
__sig√d__
 
	t__s64
;

33 
	t__u64
;

	@/usr/include/asm/bitsperlong.h

1 #i‚de‡
__ASM_X86_BITSPERLONG_H


2 
	#__ASM_X86_BITSPERLONG_H


	)

4 #ifde‡
__x86_64__


5 
	#__BITS_PER_LONG
 64

	)

7 
	#__BITS_PER_LONG
 32

	)

10 
	~<asm-gíîic/bô•îl⁄g.h
>

	@/usr/include/asm-generic/bitsperlong.h

1 #i‚de‡
__ASM_GENERIC_BITS_PER_LONG


2 
	#__ASM_GENERIC_BITS_PER_LONG


	)

11 #i‚de‡
__BITS_PER_LONG


12 
	#__BITS_PER_LONG
 32

	)

	@
1
.
1
/usr/include
65
1222
ath.h
ath.mod.c
ath5k/ahb.c
ath5k/ani.c
ath5k/ani.h
ath5k/ath5k.h
ath5k/ath5k.mod.c
ath5k/attach.c
ath5k/base.c
ath5k/base.h
ath5k/caps.c
ath5k/debug.c
ath5k/debug.h
ath5k/desc.c
ath5k/desc.h
ath5k/dma.c
ath5k/eeprom.c
ath5k/eeprom.h
ath5k/gpio.c
ath5k/initvals.c
ath5k/led.c
ath5k/mac80211-ops.c
ath5k/pci.c
ath5k/pcu.c
ath5k/phy.c
ath5k/qcu.c
ath5k/reg.h
ath5k/reset.c
ath5k/rfbuffer.h
ath5k/rfgain.h
ath5k/rfkill.c
ath5k/sysfs.c
ath5k/trace.h
debug.c
hw.c
key.c
main.c
reg.h
regd.c
regd.h
regd_common.h
/usr/include/linux/ethtool.h
/usr/include/linux/if.h
/usr/include/linux/if_ether.h
/usr/include/linux/kernel.h
/usr/include/linux/netdevice.h
/usr/include/linux/nl80211.h
/usr/include/linux/pci.h
/usr/include/linux/rfkill.h
/usr/include/linux/types.h
/usr/include/linux/wireless.h
/usr/include/asm/types.h
/usr/include/linux/hdlc/ioctl.h
/usr/include/linux/if_link.h
/usr/include/linux/if_packet.h
/usr/include/linux/pci_regs.h
/usr/include/linux/posix_types.h
/usr/include/linux/socket.h
/usr/include/asm-generic/types.h
/usr/include/asm/posix_types.h
/usr/include/linux/netlink.h
/usr/include/linux/stddef.h
/usr/include/asm-generic/int-ll64.h
/usr/include/asm/bitsperlong.h
/usr/include/asm-generic/bitsperlong.h
